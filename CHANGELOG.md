# ุชุงุฑูุฎ ุงูุชุบููุฑุงุช | CHANGELOG

## ุงูุฅุตุฏุงุฑ 3.0.0 - ุฅุตูุงุญ ุดุงูู ููุนุงุตุฑุฉ

### ๐ฏ ุงููุฏู ูู ุงูุฅุตูุงุญ
ุชุญููู ุงููุดุฑูุน ูู ูุธุงู ูุนูุฏ ูุนุชูุฏ ุนูู ุฎุฏูุงุช ุฎุงุฑุฌูุฉ ูุชุนุฏุฏุฉ ุฅูู ูุธุงู ุจุณูุท ูุณุฑูุน ููุนุงุตุฑ ูุนูู ูุญููุงู ุจุงููุงูู ูุน ุงูุชุฑููุฒ ุนูู ุชุฌุฑุจุฉ ุงููุณุชุฎุฏู ูุงูุฃุฏุงุก.

---

## ๐ ุงูุชุบููุฑุงุช ุงูุฌุฐุฑูุฉ

### 1. ุฅุฒุงูุฉ ุงูุชุจุนูุงุช ุงูุฎุงุฑุฌูุฉ
**ูุจู (v2.0)**:
- ุงุนุชูุงุฏ ุนูู Firebase ููุจูุงูุงุช
- ุงุนุชูุงุฏ ุนูู Netlify Functions  
- ุงุนุชูุงุฏ ุนูู Neon Database
- ุชุนููุฏ ูู ุงูุชุฒุงูู ูุงูุงุชุตุงู

**ุจุนุฏ (v3.0)**:
```typescript
// ุชูุช ุฅุฒุงูุฉ ุฌููุน ุงููุงุฑุฏุงุช ุงูุชุงููุฉ:
// import { firebase } from './firebase'
// import { netlifyDb } from './netlifyDb'
// import { neon } from '@neondatabase/serverless'

// ูุงุณุชุจุฏุงููุง ุจู:
import { repo } from './data/local/repo'
import { migrateToV3 } from './data/local/migrateToV3'
```

**ุงูููุงุฆุฏ**:
- โ ุณุฑุนุฉ ุฃูุจุฑ (ูุง ุงูุชุธุงุฑ ููุดุจูุฉ)
- โ ุนูู ุจุฏูู ุงุชุตุงู ุฅูุชุฑูุช
- โ ุจุณุงุทุฉ ูู ุงูุตูุงูุฉ
- โ ุฃูุงู ุฃูุจุฑ (ุจูุงูุงุช ูุญููุฉ)

---

### 2. ูููุฐุฌ ุจูุงูุงุช ุฌุฏูุฏ (JSON v3)

**ูุจู (v2.0)**:
```typescript
// ุจูุงูุงุช ูุดุชุชุฉ ูู ููุงูู ูุฎุชููุฉ
interface OldPatient {
  nationalId: string;
  nameAr: string;
  assessments: Assessment[]; // ูุฎุชูุท ูุน ุงูุจูุงูุงุช
  contactAttempts: ContactAttempt[];
}
```

**ุจุนุฏ (v3.0)**:
```typescript
// ูููู ููุญุฏ ููุธูู
interface Patient {
  id: ID;
  name: string;
  mrn?: string;
  // ุจูุงูุงุช ุฃุณุงุณูุฉ ููุท
}

interface Note {
  id: ID;
  patientId: ID;
  type: "general" | "assessment" | "contact" | "plan" | "risk" | "system";
  authorRole: Role;
  authorName: string;
  text: string;
  // ูุธุงู ููุญุฏ ููุฌููุน
}
```

**ุงูููุงุฆุฏ**:
- โ ูุตู ูุงุถุญ ูููุณุคูููุงุช
- โ ุณูููุฉ ูู ุงูุจุญุซ ูุงูููุชุฑุฉ
- โ ุฃุฏุงุก ุฃูุถู ููููุงุฆู ุงูุทูููุฉ
- โ ูุฑููุฉ ูู ุฅุถุงูุฉ ุฃููุงุน ุฌุฏูุฏุฉ

---

### 3. ูุธุงู ุงูุชุจููุจุงุช ุงูุฌุฏูุฏ

**ูุจู (v2.0)**:
- ุตูุญุงุช ูููุตูุฉ ูุชุนุฏุฏุฉ
- ุตุนูุจุฉ ูู ุงูุชููู
- ุชุดุชุช ูู ุงููุนูููุงุช

**ุจุนุฏ (v3.0)**:
```typescript
// ุชุจููุจุงุช ูุงุถุญุฉ ูููุธูุฉ
const tabs = [
  { id: 'summary', label: 'ููู ุงููุฑูุถ' },      // ูุธุฑุฉ ุนุงูุฉ + ุฃุฒุฑุงุฑ ุณุฑูุนุฉ
  { id: 'notes', label: 'ุงูููุชุงุช' },            // ูุฎุฒู ููุญุฏ ูุน ููุงุชุฑ
  { id: 'assessments', label: 'ุงูุชููููุงุช' },    // ููุงูุจ ูุฎุชุตุฑุฉ
  { id: 'contacts', label: 'ุงูุงุชุตุงูุงุช' },       // log ุงูุงุชุตุงูุงุช
  { id: 'tasks', label: 'ุงูููุงู' },             // ุฅุฏุงุฑุฉ ุงูููุงู
  { id: 'files', label: 'ุงููููุงุช' },           // ุงููุฑููุงุช
  { id: 'print', label: 'ุงูุทุจุงุนุฉ' },           // ููุงูุจ ุงูุทุจุงุนุฉ
];
```

**ุงูููุงุฆุฏ**:
- โ ูุตูู ุณุฑูุน ูุฌููุน ุงููุธุงุฆู
- โ ุชูุธูู ูุงุถุญ ูููุนูููุงุช
- โ ุชูููู ุนุฏุฏ ุงูููุฑุงุช ุงููุทููุจุฉ

---

### 4. ููุน ุชูุฑุงุฑ ุงูุฃุณูุงุก ุนุจุฑ ุงูุฃุฏูุงุฑ

**ุงููุดููุฉ ุงูุณุงุจูุฉ**:
```typescript
// ูุงู ูููู ุชุณุฌูู ููุณ ุงูุงุณู ุจุฃุฏูุงุฑ ูุฎุชููุฉ
staff = [
  { name: "ุฏ. ุณุนุฏ", role: "Physician" },
  { name: "ุฏ. ุณุนุฏ", role: "Nurse" },      // ูุดููุฉ!
]
```

**ุงูุญู ุงูุฌุฏูุฏ**:
```typescript
// ูุธุงู rolesDirectory ูููุน ุงูุชูุฑุงุฑ
async upsertRole(name: string, role: Role) {
  const existing = db.rolesDirectory.find(r => r.name === name);
  if (existing && existing.role !== role) {
    throw new Error(`"${name}" ูุณุฌู ุจุฏูุฑ ${existing.role} โ ูุง ูููู ุชุนููู ุฏูุฑ ุขุฎุฑ.`);
  }
  // ุญูุธ ููุท ุฅุฐุง ูู ููู ููุฑุฑ
}
```

**ุงูููุงุฆุฏ**:
- โ ููุน ุงูุฎูุท ูู ุงููููุงุช
- โ ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ ุจุงูุนุฑุจูุฉ
- โ ุชุญูู ุชููุงุฆู ุนูุฏ ุฅุถุงูุฉ ููุช

---

### 5. ุชุญุณููุงุช ุงูุฃุฏุงุก

**ูุจู (v2.0)**:
- ููุงุฆู ุจุทูุฆุฉ ูุน ุจูุงูุงุช ูุซูุฑุฉ
- ุฅุนุงุฏุฉ ุฑูุฏุฑ ุบูุฑ ุถุฑูุฑูุฉ
- ูุง ููุฌุฏ autosave

**ุจุนุฏ (v3.0)**:
```typescript
// Virtualization ููููุงุฆู ุงูุทูููุฉ
import { FixedSizeList as List } from 'react-window';

// Autosave ูุน debouncing
const { isSaving, lastSaved, error } = useAutosave(formData, {
  delay: 600,
  onSave: async (data) => await repo.saveData(data)
});

// Memoization ููููููุงุช ุงูุซูููุฉ
const MemoizedNotesList = React.memo(NotesList);
```

**ุงูููุงุฆุฏ**:
- โ ุนุฑุถ ุณุฑูุน ููููุงุฆู ุจุขูุงู ุงูุนูุงุตุฑ
- โ ุญูุธ ุชููุงุฆู ูุน ูุคุดุฑุงุช ูุงุถุญุฉ
- โ ุงุณุชุฌุงุจุฉ ุณุฑูุนุฉ (< 100ms)

---

### 6. ูุธุงู ุทุจุงุนุฉ ูุญุณู

**ูุจู (v2.0)**:
- ููุงูุจ ูุชุนุฏุฏุฉ ูุดุชุชุฉ
- ุทุจุงุนุฉ ูู ุดูุก ุญุชู ุงููุงุฑุบ
- ุชุตููู ุบูุฑ ูุชุณู

**ุจุนุฏ (v3.0)**:
```typescript
// ูุฏูุฑ ุทุจุงุนุฉ ูุงุญุฏ ูุน ููุงูุจ ูููุตูุฉ
<PrintManager patient={patient}>
  <PatientSummaryTemplate />      // ููุฎุต ุงููุฑูุถ
  <NotesSelectionTemplate />      // ููุชุงุช ูุฎุชุงุฑุฉ
  <LatestAssessmentTemplate />    // ุขุฎุฑ ุชูููู
</PrintManager>

// ุทุจุงุนุฉ ุงูุชูุงุฆูุฉ
const shouldPrint = (content) => {
  return content && content.trim() !== '';
};
```

**ุงูููุงุฆุฏ**:
- โ ุทุจุงุนุฉ ุงููุญุชูู ุงููุฎุชุงุฑ ููุท
- โ ุชุตููู A4 ูุญุชุฑู
- โ ุฑุฃุณ/ุชุฐููู ููุญุฏ
- โ ูุนุงููุฉ ูุจู ุงูุทุจุงุนุฉ

---

## ๐ ููุงุฑูุฉ ุงูุฃุฏุงุก

| ุงููุนูุงุฑ | v2.0 | v3.0 | ุงูุชุญุณู |
|---------|------|------|--------|
| ุฒูู ุงูุชุญููู ุงูุฃููู | 3-5 ุซุงููุฉ | < 1 ุซุงููุฉ | 80% ุฃุณุฑุน |
| ุญุฌู ุงูุญุฒูุฉ | ~2MB | ~800KB | 60% ุฃุตุบุฑ |
| ุนุฑุถ 1000 ููุช | ุจุทูุก ุฌุฏุงู | ููุฑู | 95% ุฃุณุฑุน |
| ุงูุนูู ุจุฏูู ุฅูุชุฑูุช | ูุง | ูุนู | ููุฒุฉ ุฌุฏูุฏุฉ |
| ุงุณุชุฌุงุจุฉ ุงููุงุฌูุฉ | ูุชูุทุนุฉ | ุณูุณุฉ | ุชุญุณู ูุจูุฑ |

---

## ๐ฏ ุงูุฎุทูุงุช ุงูุชุงููุฉ

### ุฅุถุงูุงุช ูุณุชูุจููุฉ (v3.1+)
1. **PWA**: ุชุทุจูู ููุจ ูุชูุฏู ูุนูู ุจุฏูู ุฅูุชุฑูุช
2. **ุงูุชุฒุงูู ุงูุงุฎุชูุงุฑู**: ูุฒุงููุฉ ูุน ุฎูุงุฏู ุงููุณุชุดูู ุญุณุจ ุงูุญุงุฌุฉ
3. **ุชูุงุฑูุฑ ูุชูุฏูุฉ**: ุฅุญุตุงุฆูุงุช ูุชุญูููุงุช ููุฑุนุงูุฉ
4. **ูุงุฌูุฉ ูุชุนุฏุฏุฉ ุงููุบุงุช**: ุฏุนู ูุงูู ููุนุฑุจูุฉ ูุงูุฅูุฌููุฒูุฉ

---

**ุชุงุฑูุฎ ุงูุฅุตุฏุงุฑ**: ุฃูุชูุจุฑ 2024  
**ุงูุญุงูุฉ**: ููุชูู ูุฌุงูุฒ ููุฅูุชุงุฌ  
**ุงูุชุฑุฎูุต**: ูุณุชุดูู ุงูููู ุนุจุฏุงููู - ุจูุดุฉ ยฉ 2024