var sS=Object.defineProperty,nS=Object.defineProperties;var rS=Object.getOwnPropertyDescriptors;var fd=Object.getOwnPropertySymbols,iS=Object.getPrototypeOf,Ax=Object.prototype.hasOwnProperty,Cx=Object.prototype.propertyIsEnumerable,aS=Reflect.get;var Kt=Math.pow,Tx=(n,e,s)=>e in n?sS(n,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[e]=s,X=(n,e)=>{for(var s in e||(e={}))Ax.call(e,s)&&Tx(n,s,e[s]);if(fd)for(var s of fd(e))Cx.call(e,s)&&Tx(n,s,e[s]);return n},oe=(n,e)=>nS(n,rS(e));var md=(n,e)=>{var s={};for(var a in n)Ax.call(n,a)&&e.indexOf(a)<0&&(s[a]=n[a]);if(n!=null&&fd)for(var a of fd(n))e.indexOf(a)<0&&Cx.call(n,a)&&(s[a]=n[a]);return s};var oS=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports);var co=(n,e,s)=>aS(iS(n),s,e);var K=(n,e,s)=>new Promise((a,l)=>{var d=b=>{try{f(s.next(b))}catch(v){l(v)}},h=b=>{try{f(s.throw(b))}catch(v){l(v)}},f=b=>b.done?a(b.value):Promise.resolve(b.value).then(d,h);f((s=s.apply(n,e)).next())});import{r as Pe,C as Hc,a as mg,M as lS,L as cS,E as uS,b as Dv,c as dS,S as Ui,H as ih,d as gg,A as pg,e as hS,U as ah,B as fS,f as rr,g as Ov,h as mS,X as xn,i as Gc,T as gS,j as pS,k as fo,l as yS,m as Ic,n as Gi,o as yg,P as xS,F as yn,p as bS,q as _l,s as Ix,t as vS,u as Kr,v as kv,w as ml,x as Rx,y as Dx,z as Rc,D as Ir,G as Bm,I as _S,Q as xg,J as Ox,R as wS,K as Pi,N as Yr,O as zm,V as Mv,W as Pv,Y as Lv,Z as NS,_ as kx,$ as SS,a0 as Vv,a1 as ES,a2 as Mx,a3 as jS,a4 as TS}from"./ui-DrlliSgO.js";import{r as AS,a as CS,g as IS}from"./vendor-BP0qhIbX.js";var y4=oS(Pn=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))a(l);new MutationObserver(l=>{for(const d of l)if(d.type==="childList")for(const h of d.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&a(h)}).observe(document,{childList:!0,subtree:!0});function s(l){const d={};return l.integrity&&(d.integrity=l.integrity),l.referrerPolicy&&(d.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?d.credentials="include":l.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function a(l){if(l.ep)return;l.ep=!0;const d=s(l);fetch(l.href,d)}})();var xm={exports:{}},jc={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Px;function RS(){if(Px)return jc;Px=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function s(a,l,d){var h=null;if(d!==void 0&&(h=""+d),l.key!==void 0&&(h=""+l.key),"key"in l){d={};for(var f in l)f!=="key"&&(d[f]=l[f])}else d=l;return l=d.ref,{$$typeof:n,type:a,key:h,ref:l!==void 0?l:null,props:d}}return jc.Fragment=e,jc.jsx=s,jc.jsxs=s,jc}var Lx;function DS(){return Lx||(Lx=1,xm.exports=RS()),xm.exports}var i=DS(),bm={exports:{}},Tc={},vm={exports:{}},_m={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vx;function OS(){return Vx||(Vx=1,(function(n){function e(Ae,Ue){var et=Ae.length;Ae.push(Ue);e:for(;0<et;){var Ie=et-1>>>1,Ge=Ae[Ie];if(0<l(Ge,Ue))Ae[Ie]=Ue,Ae[et]=Ge,et=Ie;else break e}}function s(Ae){return Ae.length===0?null:Ae[0]}function a(Ae){if(Ae.length===0)return null;var Ue=Ae[0],et=Ae.pop();if(et!==Ue){Ae[0]=et;e:for(var Ie=0,Ge=Ae.length,bt=Ge>>>1;Ie<bt;){var xt=2*(Ie+1)-1,yt=Ae[xt],Ht=xt+1,Us=Ae[Ht];if(0>l(yt,et))Ht<Ge&&0>l(Us,yt)?(Ae[Ie]=Us,Ae[Ht]=et,Ie=Ht):(Ae[Ie]=yt,Ae[xt]=et,Ie=xt);else if(Ht<Ge&&0>l(Us,et))Ae[Ie]=Us,Ae[Ht]=et,Ie=Ht;else break e}}return Ue}function l(Ae,Ue){var et=Ae.sortIndex-Ue.sortIndex;return et!==0?et:Ae.id-Ue.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var d=performance;n.unstable_now=function(){return d.now()}}else{var h=Date,f=h.now();n.unstable_now=function(){return h.now()-f}}var b=[],v=[],E=1,D=null,_=3,R=!1,U=!1,ie=!1,he=!1,Se=typeof setTimeout=="function"?setTimeout:null,Be=typeof clearTimeout=="function"?clearTimeout:null,xe=typeof setImmediate!="undefined"?setImmediate:null;function _e(Ae){for(var Ue=s(v);Ue!==null;){if(Ue.callback===null)a(v);else if(Ue.startTime<=Ae)a(v),Ue.sortIndex=Ue.expirationTime,e(b,Ue);else break;Ue=s(v)}}function Ne(Ae){if(ie=!1,_e(Ae),!U)if(s(b)!==null)U=!0,De||(De=!0,Y());else{var Ue=s(v);Ue!==null&&Ct(Ne,Ue.startTime-Ae)}}var De=!1,G=-1,V=5,L=-1;function z(){return he?!0:!(n.unstable_now()-L<V)}function Q(){if(he=!1,De){var Ae=n.unstable_now();L=Ae;var Ue=!0;try{e:{U=!1,ie&&(ie=!1,Be(G),G=-1),R=!0;var et=_;try{t:{for(_e(Ae),D=s(b);D!==null&&!(D.expirationTime>Ae&&z());){var Ie=D.callback;if(typeof Ie=="function"){D.callback=null,_=D.priorityLevel;var Ge=Ie(D.expirationTime<=Ae);if(Ae=n.unstable_now(),typeof Ge=="function"){D.callback=Ge,_e(Ae),Ue=!0;break t}D===s(b)&&a(b),_e(Ae)}else a(b);D=s(b)}if(D!==null)Ue=!0;else{var bt=s(v);bt!==null&&Ct(Ne,bt.startTime-Ae),Ue=!1}}break e}finally{D=null,_=et,R=!1}Ue=void 0}}finally{Ue?Y():De=!1}}}var Y;if(typeof xe=="function")Y=function(){xe(Q)};else if(typeof MessageChannel!="undefined"){var J=new MessageChannel,pt=J.port2;J.port1.onmessage=Q,Y=function(){pt.postMessage(null)}}else Y=function(){Se(Q,0)};function Ct(Ae,Ue){G=Se(function(){Ae(n.unstable_now())},Ue)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(Ae){Ae.callback=null},n.unstable_forceFrameRate=function(Ae){0>Ae||125<Ae?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):V=0<Ae?Math.floor(1e3/Ae):5},n.unstable_getCurrentPriorityLevel=function(){return _},n.unstable_next=function(Ae){switch(_){case 1:case 2:case 3:var Ue=3;break;default:Ue=_}var et=_;_=Ue;try{return Ae()}finally{_=et}},n.unstable_requestPaint=function(){he=!0},n.unstable_runWithPriority=function(Ae,Ue){switch(Ae){case 1:case 2:case 3:case 4:case 5:break;default:Ae=3}var et=_;_=Ae;try{return Ue()}finally{_=et}},n.unstable_scheduleCallback=function(Ae,Ue,et){var Ie=n.unstable_now();switch(typeof et=="object"&&et!==null?(et=et.delay,et=typeof et=="number"&&0<et?Ie+et:Ie):et=Ie,Ae){case 1:var Ge=-1;break;case 2:Ge=250;break;case 5:Ge=1073741823;break;case 4:Ge=1e4;break;default:Ge=5e3}return Ge=et+Ge,Ae={id:E++,callback:Ue,priorityLevel:Ae,startTime:et,expirationTime:Ge,sortIndex:-1},et>Ie?(Ae.sortIndex=et,e(v,Ae),s(b)===null&&Ae===s(v)&&(ie?(Be(G),G=-1):ie=!0,Ct(Ne,et-Ie))):(Ae.sortIndex=Ge,e(b,Ae),U||R||(U=!0,De||(De=!0,Y()))),Ae},n.unstable_shouldYield=z,n.unstable_wrapCallback=function(Ae){var Ue=_;return function(){var et=_;_=Ue;try{return Ae.apply(this,arguments)}finally{_=et}}}})(_m)),_m}var Ux;function kS(){return Ux||(Ux=1,vm.exports=OS()),vm.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bx;function MS(){if(Bx)return Tc;Bx=1;var n=kS(),e=AS(),s=CS();function a(t){var r="https://react.dev/errors/"+t;if(1<arguments.length){r+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)r+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+t+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function d(t){var r=t,o=t;if(t.alternate)for(;r.return;)r=r.return;else{t=r;do r=t,(r.flags&4098)!==0&&(o=r.return),t=r.return;while(t)}return r.tag===3?o:null}function h(t){if(t.tag===13){var r=t.memoizedState;if(r===null&&(t=t.alternate,t!==null&&(r=t.memoizedState)),r!==null)return r.dehydrated}return null}function f(t){if(d(t)!==t)throw Error(a(188))}function b(t){var r=t.alternate;if(!r){if(r=d(t),r===null)throw Error(a(188));return r!==t?null:t}for(var o=t,u=r;;){var m=o.return;if(m===null)break;var p=m.alternate;if(p===null){if(u=m.return,u!==null){o=u;continue}break}if(m.child===p.child){for(p=m.child;p;){if(p===o)return f(m),t;if(p===u)return f(m),r;p=p.sibling}throw Error(a(188))}if(o.return!==u.return)o=m,u=p;else{for(var S=!1,P=m.child;P;){if(P===o){S=!0,o=m,u=p;break}if(P===u){S=!0,u=m,o=p;break}P=P.sibling}if(!S){for(P=p.child;P;){if(P===o){S=!0,o=p,u=m;break}if(P===u){S=!0,u=p,o=m;break}P=P.sibling}if(!S)throw Error(a(189))}}if(o.alternate!==u)throw Error(a(190))}if(o.tag!==3)throw Error(a(188));return o.stateNode.current===o?t:r}function v(t){var r=t.tag;if(r===5||r===26||r===27||r===6)return t;for(t=t.child;t!==null;){if(r=v(t),r!==null)return r;t=t.sibling}return null}var E=Object.assign,D=Symbol.for("react.element"),_=Symbol.for("react.transitional.element"),R=Symbol.for("react.portal"),U=Symbol.for("react.fragment"),ie=Symbol.for("react.strict_mode"),he=Symbol.for("react.profiler"),Se=Symbol.for("react.provider"),Be=Symbol.for("react.consumer"),xe=Symbol.for("react.context"),_e=Symbol.for("react.forward_ref"),Ne=Symbol.for("react.suspense"),De=Symbol.for("react.suspense_list"),G=Symbol.for("react.memo"),V=Symbol.for("react.lazy"),L=Symbol.for("react.activity"),z=Symbol.for("react.memo_cache_sentinel"),Q=Symbol.iterator;function Y(t){return t===null||typeof t!="object"?null:(t=Q&&t[Q]||t["@@iterator"],typeof t=="function"?t:null)}var J=Symbol.for("react.client.reference");function pt(t){if(t==null)return null;if(typeof t=="function")return t.$$typeof===J?null:t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case U:return"Fragment";case he:return"Profiler";case ie:return"StrictMode";case Ne:return"Suspense";case De:return"SuspenseList";case L:return"Activity"}if(typeof t=="object")switch(t.$$typeof){case R:return"Portal";case xe:return(t.displayName||"Context")+".Provider";case Be:return(t._context.displayName||"Context")+".Consumer";case _e:var r=t.render;return t=t.displayName,t||(t=r.displayName||r.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case G:return r=t.displayName||null,r!==null?r:pt(t.type)||"Memo";case V:r=t._payload,t=t._init;try{return pt(t(r))}catch(o){}}return null}var Ct=Array.isArray,Ae=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ue=s.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,et={pending:!1,data:null,method:null,action:null},Ie=[],Ge=-1;function bt(t){return{current:t}}function xt(t){0>Ge||(t.current=Ie[Ge],Ie[Ge]=null,Ge--)}function yt(t,r){Ge++,Ie[Ge]=t.current,t.current=r}var Ht=bt(null),Us=bt(null),nn=bt(null),Dr=bt(null);function Or(t,r){switch(yt(nn,r),yt(Us,t),yt(Ht,null),r.nodeType){case 9:case 11:t=(t=r.documentElement)&&(t=t.namespaceURI)?tx(t):0;break;default:if(t=r.tagName,r=r.namespaceURI)r=tx(r),t=sx(r,t);else switch(t){case"svg":t=1;break;case"math":t=2;break;default:t=0}}xt(Ht),yt(Ht,t)}function ir(){xt(Ht),xt(Us),xt(nn)}function Ua(t){t.memoizedState!==null&&yt(Dr,t);var r=Ht.current,o=sx(r,t.type);r!==o&&(yt(Us,t),yt(Ht,o))}function $i(t){Us.current===t&&(xt(Ht),xt(Us)),Dr.current===t&&(xt(Dr),_c._currentValue=et)}var ar=Object.prototype.hasOwnProperty,Ln=n.unstable_scheduleCallback,or=n.unstable_cancelCallback,Ml=n.unstable_shouldYield,oi=n.unstable_requestPaint,Is=n.unstable_now,Ba=n.unstable_getCurrentPriorityLevel,Zt=n.unstable_ImmediatePriority,ls=n.unstable_UserBlockingPriority,Vn=n.unstable_NormalPriority,za=n.unstable_LowPriority,Qi=n.unstable_IdlePriority,Io=n.log,kr=n.unstable_setDisableYieldValue,Un=null,vs=null;function rn(t){if(typeof Io=="function"&&kr(t),vs&&typeof vs.setStrictMode=="function")try{vs.setStrictMode(Un,t)}catch(r){}}var Rs=Math.clz32?Math.clz32:Ki,Pl=Math.log,Ro=Math.LN2;function Ki(t){return t>>>=0,t===0?32:31-(Pl(t)/Ro|0)|0}var bn=256,lr=4194304;function vn(t){var r=t&42;if(r!==0)return r;switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return t&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return t}}function Qs(t,r,o){var u=t.pendingLanes;if(u===0)return 0;var m=0,p=t.suspendedLanes,S=t.pingedLanes;t=t.warmLanes;var P=u&134217727;return P!==0?(u=P&~p,u!==0?m=vn(u):(S&=P,S!==0?m=vn(S):o||(o=P&~t,o!==0&&(m=vn(o))))):(P=u&~p,P!==0?m=vn(P):S!==0?m=vn(S):o||(o=u&~t,o!==0&&(m=vn(o)))),m===0?0:r!==0&&r!==m&&(r&p)===0&&(p=m&-m,o=r&-r,p>=o||p===32&&(o&4194048)!==0)?r:m}function Bn(t,r){return(t.pendingLanes&~(t.suspendedLanes&~t.pingedLanes)&r)===0}function li(t,r){switch(t){case 1:case 2:case 4:case 8:case 64:return r+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Fa(){var t=bn;return bn<<=1,(bn&4194048)===0&&(bn=256),t}function zn(){var t=lr;return lr<<=1,(lr&62914560)===0&&(lr=4194304),t}function Yi(t){for(var r=[],o=0;31>o;o++)r.push(t);return r}function es(t,r){t.pendingLanes|=r,r!==268435456&&(t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0)}function qa(t,r,o,u,m,p){var S=t.pendingLanes;t.pendingLanes=o,t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0,t.expiredLanes&=o,t.entangledLanes&=o,t.errorRecoveryDisabledLanes&=o,t.shellSuspendCounter=0;var P=t.entanglements,Z=t.expirationTimes,ye=t.hiddenUpdates;for(o=S&~o;0<o;){var Re=31-Rs(o),Me=1<<Re;P[Re]=0,Z[Re]=-1;var be=ye[Re];if(be!==null)for(ye[Re]=null,Re=0;Re<be.length;Re++){var we=be[Re];we!==null&&(we.lane&=-536870913)}o&=~Me}u!==0&&cr(t,u,0),p!==0&&m===0&&t.tag!==0&&(t.suspendedLanes|=p&~(S&~r))}function cr(t,r,o){t.pendingLanes|=r,t.suspendedLanes&=~r;var u=31-Rs(r);t.entangledLanes|=r,t.entanglements[u]=t.entanglements[u]|1073741824|o&4194090}function ur(t,r){var o=t.entangledLanes|=r;for(t=t.entanglements;o;){var u=31-Rs(o),m=1<<u;m&r|t[u]&r&&(t[u]|=r),o&=~m}}function ci(t){switch(t){case 2:t=1;break;case 8:t=4;break;case 32:t=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:t=128;break;case 268435456:t=134217728;break;default:t=0}return t}function dr(t){return t&=-t,2<t?8<t?(t&134217727)!==0?32:268435456:8:2}function Ks(){var t=Ue.p;return t!==0?t:(t=window.event,t===void 0?32:_x(t.type))}function Ha(t,r){var o=Ue.p;try{return Ue.p=t,r()}finally{Ue.p=o}}var _n=Math.random().toString(36).slice(2),ts="__reactFiber$"+_n,_s="__reactProps$"+_n,hr="__reactContainer$"+_n,ui="__reactEvents$"+_n,Mr="__reactListeners$"+_n,Do="__reactHandles$"+_n,an="__reactResources$"+_n,Pr="__reactMarker$"+_n;function di(t){delete t[ts],delete t[_s],delete t[ui],delete t[Mr],delete t[Do]}function Fn(t){var r=t[ts];if(r)return r;for(var o=t.parentNode;o;){if(r=o[hr]||o[ts]){if(o=r.alternate,r.child!==null||o!==null&&o.child!==null)for(t=ax(t);t!==null;){if(o=t[ts])return o;t=ax(t)}return r}t=o,o=t.parentNode}return null}function qn(t){if(t=t[ts]||t[hr]){var r=t.tag;if(r===5||r===6||r===13||r===26||r===27||r===3)return t}return null}function fr(t){var r=t.tag;if(r===5||r===26||r===27||r===6)return t.stateNode;throw Error(a(33))}function mr(t){var r=t[an];return r||(r=t[an]={hoistableStyles:new Map,hoistableScripts:new Map}),r}function ss(t){t[Pr]=!0}var Oo=new Set,hi={};function Hn(t,r){wn(t,r),wn(t+"Capture",r)}function wn(t,r){for(hi[t]=r,t=0;t<r.length;t++)Oo.add(r[t])}var gr=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Nn={},fi={};function Ll(t){return ar.call(fi,t)?!0:ar.call(Nn,t)?!1:gr.test(t)?fi[t]=!0:(Nn[t]=!0,!1)}function mi(t,r,o){if(Ll(r))if(o===null)t.removeAttribute(r);else{switch(typeof o){case"undefined":case"function":case"symbol":t.removeAttribute(r);return;case"boolean":var u=r.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){t.removeAttribute(r);return}}t.setAttribute(r,""+o)}}function Lr(t,r,o){if(o===null)t.removeAttribute(r);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(r);return}t.setAttribute(r,""+o)}}function Ys(t,r,o,u){if(u===null)t.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(o);return}t.setAttributeNS(r,o,""+u)}}var Xs,gi;function pr(t){if(Xs===void 0)try{throw Error()}catch(o){var r=o.stack.trim().match(/\n( *(at )?)/);Xs=r&&r[1]||"",gi=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Xs+t+gi}var Vr=!1;function pi(t,r){if(!t||Vr)return"";Vr=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(r){var Me=function(){throw Error()};if(Object.defineProperty(Me.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Me,[])}catch(we){var be=we}Reflect.construct(t,[],Me)}else{try{Me.call()}catch(we){be=we}t.call(Me.prototype)}}else{try{throw Error()}catch(we){be=we}(Me=t())&&typeof Me.catch=="function"&&Me.catch(function(){})}}catch(we){if(we&&be&&typeof we.stack=="string")return[we.stack,be.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var m=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");m&&m.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var p=u.DetermineComponentFrameRoot(),S=p[0],P=p[1];if(S&&P){var Z=S.split(`
`),ye=P.split(`
`);for(m=u=0;u<Z.length&&!Z[u].includes("DetermineComponentFrameRoot");)u++;for(;m<ye.length&&!ye[m].includes("DetermineComponentFrameRoot");)m++;if(u===Z.length||m===ye.length)for(u=Z.length-1,m=ye.length-1;1<=u&&0<=m&&Z[u]!==ye[m];)m--;for(;1<=u&&0<=m;u--,m--)if(Z[u]!==ye[m]){if(u!==1||m!==1)do if(u--,m--,0>m||Z[u]!==ye[m]){var Re=`
`+Z[u].replace(" at new "," at ");return t.displayName&&Re.includes("<anonymous>")&&(Re=Re.replace("<anonymous>",t.displayName)),Re}while(1<=u&&0<=m);break}}}finally{Vr=!1,Error.prepareStackTrace=o}return(o=t?t.displayName||t.name:"")?pr(o):""}function Ga(t){switch(t.tag){case 26:case 27:case 5:return pr(t.type);case 16:return pr("Lazy");case 13:return pr("Suspense");case 19:return pr("SuspenseList");case 0:case 15:return pi(t.type,!1);case 11:return pi(t.type.render,!1);case 1:return pi(t.type,!0);case 31:return pr("Activity");default:return""}}function on(t){try{var r="";do r+=Ga(t),t=t.return;while(t);return r}catch(o){return`
Error generating stack: `+o.message+`
`+o.stack}}function Xt(t){switch(typeof t){case"bigint":case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Ws(t){var r=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function Ur(t){var r=Ws(t)?"checked":"value",o=Object.getOwnPropertyDescriptor(t.constructor.prototype,r),u=""+t[r];if(!t.hasOwnProperty(r)&&typeof o!="undefined"&&typeof o.get=="function"&&typeof o.set=="function"){var m=o.get,p=o.set;return Object.defineProperty(t,r,{configurable:!0,get:function(){return m.call(this)},set:function(S){u=""+S,p.call(this,S)}}),Object.defineProperty(t,r,{enumerable:o.enumerable}),{getValue:function(){return u},setValue:function(S){u=""+S},stopTracking:function(){t._valueTracker=null,delete t[r]}}}}function yr(t){t._valueTracker||(t._valueTracker=Ur(t))}function Dt(t){if(!t)return!1;var r=t._valueTracker;if(!r)return!0;var o=r.getValue(),u="";return t&&(u=Ws(t)?t.checked?"true":"false":t.value),t=u,t!==o?(r.setValue(t),!0):!1}function Gn(t){if(t=t||(typeof document!="undefined"?document:void 0),typeof t=="undefined")return null;try{return t.activeElement||t.body}catch(r){return t.body}}var yi=/[\n"\\]/g;function ee(t){return t.replace(yi,function(r){return"\\"+r.charCodeAt(0).toString(16)+" "})}function T(t,r,o,u,m,p,S,P){t.name="",S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"?t.type=S:t.removeAttribute("type"),r!=null?S==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+Xt(r)):t.value!==""+Xt(r)&&(t.value=""+Xt(r)):S!=="submit"&&S!=="reset"||t.removeAttribute("value"),r!=null?k(t,S,Xt(r)):o!=null?k(t,S,Xt(o)):u!=null&&t.removeAttribute("value"),m==null&&p!=null&&(t.defaultChecked=!!p),m!=null&&(t.checked=m&&typeof m!="function"&&typeof m!="symbol"),P!=null&&typeof P!="function"&&typeof P!="symbol"&&typeof P!="boolean"?t.name=""+Xt(P):t.removeAttribute("name")}function O(t,r,o,u,m,p,S,P){if(p!=null&&typeof p!="function"&&typeof p!="symbol"&&typeof p!="boolean"&&(t.type=p),r!=null||o!=null){if(!(p!=="submit"&&p!=="reset"||r!=null))return;o=o!=null?""+Xt(o):"",r=r!=null?""+Xt(r):o,P||r===t.value||(t.value=r),t.defaultValue=r}u=u!=null?u:m,u=typeof u!="function"&&typeof u!="symbol"&&!!u,t.checked=P?t.checked:!!u,t.defaultChecked=!!u,S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"&&(t.name=S)}function k(t,r,o){r==="number"&&Gn(t.ownerDocument)===t||t.defaultValue===""+o||(t.defaultValue=""+o)}function I(t,r,o,u){if(t=t.options,r){r={};for(var m=0;m<o.length;m++)r["$"+o[m]]=!0;for(o=0;o<t.length;o++)m=r.hasOwnProperty("$"+t[o].value),t[o].selected!==m&&(t[o].selected=m),m&&u&&(t[o].defaultSelected=!0)}else{for(o=""+Xt(o),r=null,m=0;m<t.length;m++){if(t[m].value===o){t[m].selected=!0,u&&(t[m].defaultSelected=!0);return}r!==null||t[m].disabled||(r=t[m])}r!==null&&(r.selected=!0)}}function j(t,r,o){if(r!=null&&(r=""+Xt(r),r!==t.value&&(t.value=r),o==null)){t.defaultValue!==r&&(t.defaultValue=r);return}t.defaultValue=o!=null?""+Xt(o):""}function M(t,r,o,u){if(r==null){if(u!=null){if(o!=null)throw Error(a(92));if(Ct(u)){if(1<u.length)throw Error(a(93));u=u[0]}o=u}o==null&&(o=""),r=o}o=Xt(r),t.defaultValue=o,u=t.textContent,u===o&&u!==""&&u!==null&&(t.value=u)}function A(t,r){if(r){var o=t.firstChild;if(o&&o===t.lastChild&&o.nodeType===3){o.nodeValue=r;return}}t.textContent=r}var B=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function re(t,r,o){var u=r.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?u?t.setProperty(r,""):r==="float"?t.cssFloat="":t[r]="":u?t.setProperty(r,o):typeof o!="number"||o===0||B.has(r)?r==="float"?t.cssFloat=o:t[r]=(""+o).trim():t[r]=o+"px"}function $(t,r,o){if(r!=null&&typeof r!="object")throw Error(a(62));if(t=t.style,o!=null){for(var u in o)!o.hasOwnProperty(u)||r!=null&&r.hasOwnProperty(u)||(u.indexOf("--")===0?t.setProperty(u,""):u==="float"?t.cssFloat="":t[u]="");for(var m in r)u=r[m],r.hasOwnProperty(m)&&o[m]!==u&&re(t,m,u)}else for(var p in r)r.hasOwnProperty(p)&&re(t,p,r[p])}function W(t){if(t.indexOf("-")===-1)return!1;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var F=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),te=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function N(t){return te.test(""+t)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":t}var C=null;function q(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var ae=null,le=null;function ue(t){var r=qn(t);if(r&&(t=r.stateNode)){var o=t[_s]||null;e:switch(t=r.stateNode,r.type){case"input":if(T(t,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),r=o.name,o.type==="radio"&&r!=null){for(o=t;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+ee(""+r)+'"][type="radio"]'),r=0;r<o.length;r++){var u=o[r];if(u!==t&&u.form===t.form){var m=u[_s]||null;if(!m)throw Error(a(90));T(u,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name)}}for(r=0;r<o.length;r++)u=o[r],u.form===t.form&&Dt(u)}break e;case"textarea":j(t,o.value,o.defaultValue);break e;case"select":r=o.value,r!=null&&I(t,!!o.multiple,r,!1)}}}var Ee=!1;function Te(t,r,o){if(Ee)return t(r,o);Ee=!0;try{var u=t(r);return u}finally{if(Ee=!1,(ae!==null||le!==null)&&($u(),ae&&(r=ae,t=le,le=ae=null,ue(r),t)))for(r=0;r<t.length;r++)ue(t[r])}}function se(t,r){var o=t.stateNode;if(o===null)return null;var u=o[_s]||null;if(u===null)return null;o=u[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(t=t.type,u=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!u;break e;default:t=!1}if(t)return null;if(o&&typeof o!="function")throw Error(a(231,r,typeof o));return o}var ge=!(typeof window=="undefined"||typeof window.document=="undefined"||typeof window.document.createElement=="undefined"),me=!1;if(ge)try{var ce={};Object.defineProperty(ce,"passive",{get:function(){me=!0}}),window.addEventListener("test",ce,ce),window.removeEventListener("test",ce,ce)}catch(t){me=!1}var je=null,ve=null,$e=null;function We(){if($e)return $e;var t,r=ve,o=r.length,u,m="value"in je?je.value:je.textContent,p=m.length;for(t=0;t<o&&r[t]===m[t];t++);var S=o-t;for(u=1;u<=S&&r[o-u]===m[p-u];u++);return $e=m.slice(t,1<u?1-u:void 0)}function Ce(t){var r=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&r===13&&(t=13)):t=r,t===10&&(t=13),32<=t||t===13?t:0}function Fe(){return!0}function Ze(){return!1}function Ye(t){function r(o,u,m,p,S){this._reactName=o,this._targetInst=m,this.type=u,this.nativeEvent=p,this.target=S,this.currentTarget=null;for(var P in t)t.hasOwnProperty(P)&&(o=t[P],this[P]=o?o(p):p[P]);return this.isDefaultPrevented=(p.defaultPrevented!=null?p.defaultPrevented:p.returnValue===!1)?Fe:Ze,this.isPropagationStopped=Ze,this}return E(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=Fe)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=Fe)},persist:function(){},isPersistent:Fe}),r}var ut={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},It=Ye(ut),Js=E({},ut,{view:0,detail:0}),Mt=Ye(Js),Ot,$t,cs,ws=E({},Js,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Qn,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==cs&&(cs&&t.type==="mousemove"?(Ot=t.screenX-cs.screenX,$t=t.screenY-cs.screenY):$t=Ot=0,cs=t),Ot)},movementY:function(t){return"movementY"in t?t.movementY:$t}}),Zs=Ye(ws),xi=E({},ws,{dataTransfer:0}),Sn=Ye(xi),en=E({},Js,{relatedTarget:0}),En=Ye(en),Br=E({},ut,{animationName:0,elapsedTime:0,pseudoElement:0}),bi=Ye(Br),jn=E({},ut,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),xr=Ye(jn),Xi=E({},ut,{data:0}),Wi=Ye(Xi),vi={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},$n={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},$a={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ji(t){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(t):(t=$a[t])?!!r[t]:!1}function Qn(){return Ji}var Bs=E({},Js,{key:function(t){if(t.key){var r=vi[t.key]||t.key;if(r!=="Unidentified")return r}return t.type==="keypress"?(t=Ce(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?$n[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Qn,charCode:function(t){return t.type==="keypress"?Ce(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Ce(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),br=Ye(Bs),Ds=E({},ws,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),tn=Ye(Ds),Qa=E({},Js,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Qn}),y=Ye(Qa),c=E({},ut,{propertyName:0,elapsedTime:0,pseudoElement:0}),g=Ye(c),x=E({},ws,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),w=Ye(x),H=E({},ut,{newState:0,oldState:0}),ne=Ye(H),Ve=[9,13,27,32],Xe=ge&&"CompositionEvent"in window,at=null;ge&&"documentMode"in document&&(at=document.documentMode);var st=ge&&"TextEvent"in window&&!at,gt=ge&&(!Xe||at&&8<at&&11>=at),Tn=" ",zr=!1;function vr(t,r){switch(t){case"keyup":return Ve.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function _r(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var wr=!1;function Vl(t,r){switch(t){case"compositionend":return _r(r);case"keypress":return r.which!==32?null:(zr=!0,Tn);case"textInput":return t=r.data,t===Tn&&zr?null:t;default:return null}}function C1(t,r){if(wr)return t==="compositionend"||!Xe&&vr(t,r)?(t=We(),$e=ve=je=null,wr=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return gt&&r.locale!=="ko"?null:r.data;default:return null}}var I1={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function gp(t){var r=t&&t.nodeName&&t.nodeName.toLowerCase();return r==="input"?!!I1[t.type]:r==="textarea"}function pp(t,r,o,u){ae?le?le.push(u):le=[u]:ae=u,r=Ju(r,"onChange"),0<r.length&&(o=new It("onChange","change",null,o,u),t.push({event:o,listeners:r}))}var Ul=null,Bl=null;function R1(t){Xy(t,0)}function fu(t){var r=fr(t);if(Dt(r))return t}function yp(t,r){if(t==="change")return r}var xp=!1;if(ge){var Th;if(ge){var Ah="oninput"in document;if(!Ah){var bp=document.createElement("div");bp.setAttribute("oninput","return;"),Ah=typeof bp.oninput=="function"}Th=Ah}else Th=!1;xp=Th&&(!document.documentMode||9<document.documentMode)}function vp(){Ul&&(Ul.detachEvent("onpropertychange",_p),Bl=Ul=null)}function _p(t){if(t.propertyName==="value"&&fu(Bl)){var r=[];pp(r,Bl,t,q(t)),Te(R1,r)}}function D1(t,r,o){t==="focusin"?(vp(),Ul=r,Bl=o,Ul.attachEvent("onpropertychange",_p)):t==="focusout"&&vp()}function O1(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return fu(Bl)}function k1(t,r){if(t==="click")return fu(r)}function M1(t,r){if(t==="input"||t==="change")return fu(r)}function P1(t,r){return t===r&&(t!==0||1/t===1/r)||t!==t&&r!==r}var An=typeof Object.is=="function"?Object.is:P1;function zl(t,r){if(An(t,r))return!0;if(typeof t!="object"||t===null||typeof r!="object"||r===null)return!1;var o=Object.keys(t),u=Object.keys(r);if(o.length!==u.length)return!1;for(u=0;u<o.length;u++){var m=o[u];if(!ar.call(r,m)||!An(t[m],r[m]))return!1}return!0}function wp(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Np(t,r){var o=wp(t);t=0;for(var u;o;){if(o.nodeType===3){if(u=t+o.textContent.length,t<=r&&u>=r)return{node:o,offset:r-t};t=u}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=wp(o)}}function Sp(t,r){return t&&r?t===r?!0:t&&t.nodeType===3?!1:r&&r.nodeType===3?Sp(t,r.parentNode):"contains"in t?t.contains(r):t.compareDocumentPosition?!!(t.compareDocumentPosition(r)&16):!1:!1}function Ep(t){t=t!=null&&t.ownerDocument!=null&&t.ownerDocument.defaultView!=null?t.ownerDocument.defaultView:window;for(var r=Gn(t.document);r instanceof t.HTMLIFrameElement;){try{var o=typeof r.contentWindow.location.href=="string"}catch(u){o=!1}if(o)t=r.contentWindow;else break;r=Gn(t.document)}return r}function Ch(t){var r=t&&t.nodeName&&t.nodeName.toLowerCase();return r&&(r==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||r==="textarea"||t.contentEditable==="true")}var L1=ge&&"documentMode"in document&&11>=document.documentMode,ko=null,Ih=null,Fl=null,Rh=!1;function jp(t,r,o){var u=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Rh||ko==null||ko!==Gn(u)||(u=ko,"selectionStart"in u&&Ch(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),Fl&&zl(Fl,u)||(Fl=u,u=Ju(Ih,"onSelect"),0<u.length&&(r=new It("onSelect","select",null,r,o),t.push({event:r,listeners:u}),r.target=ko)))}function Ka(t,r){var o={};return o[t.toLowerCase()]=r.toLowerCase(),o["Webkit"+t]="webkit"+r,o["Moz"+t]="moz"+r,o}var Mo={animationend:Ka("Animation","AnimationEnd"),animationiteration:Ka("Animation","AnimationIteration"),animationstart:Ka("Animation","AnimationStart"),transitionrun:Ka("Transition","TransitionRun"),transitionstart:Ka("Transition","TransitionStart"),transitioncancel:Ka("Transition","TransitionCancel"),transitionend:Ka("Transition","TransitionEnd")},Dh={},Tp={};ge&&(Tp=document.createElement("div").style,"AnimationEvent"in window||(delete Mo.animationend.animation,delete Mo.animationiteration.animation,delete Mo.animationstart.animation),"TransitionEvent"in window||delete Mo.transitionend.transition);function Ya(t){if(Dh[t])return Dh[t];if(!Mo[t])return t;var r=Mo[t],o;for(o in r)if(r.hasOwnProperty(o)&&o in Tp)return Dh[t]=r[o];return t}var Ap=Ya("animationend"),Cp=Ya("animationiteration"),Ip=Ya("animationstart"),V1=Ya("transitionrun"),U1=Ya("transitionstart"),B1=Ya("transitioncancel"),Rp=Ya("transitionend"),Dp=new Map,Oh="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Oh.push("scrollEnd");function Nr(t,r){Dp.set(t,r),Hn(r,[t])}var Op=new WeakMap;function Kn(t,r){if(typeof t=="object"&&t!==null){var o=Op.get(t);return o!==void 0?o:(r={value:t,source:r,stack:on(r)},Op.set(t,r),r)}return{value:t,source:r,stack:on(r)}}var Yn=[],Po=0,kh=0;function mu(){for(var t=Po,r=kh=Po=0;r<t;){var o=Yn[r];Yn[r++]=null;var u=Yn[r];Yn[r++]=null;var m=Yn[r];Yn[r++]=null;var p=Yn[r];if(Yn[r++]=null,u!==null&&m!==null){var S=u.pending;S===null?m.next=m:(m.next=S.next,S.next=m),u.pending=m}p!==0&&kp(o,m,p)}}function gu(t,r,o,u){Yn[Po++]=t,Yn[Po++]=r,Yn[Po++]=o,Yn[Po++]=u,kh|=u,t.lanes|=u,t=t.alternate,t!==null&&(t.lanes|=u)}function Mh(t,r,o,u){return gu(t,r,o,u),pu(t)}function Lo(t,r){return gu(t,null,null,r),pu(t)}function kp(t,r,o){t.lanes|=o;var u=t.alternate;u!==null&&(u.lanes|=o);for(var m=!1,p=t.return;p!==null;)p.childLanes|=o,u=p.alternate,u!==null&&(u.childLanes|=o),p.tag===22&&(t=p.stateNode,t===null||t._visibility&1||(m=!0)),t=p,p=p.return;return t.tag===3?(p=t.stateNode,m&&r!==null&&(m=31-Rs(o),t=p.hiddenUpdates,u=t[m],u===null?t[m]=[r]:u.push(r),r.lane=o|536870912),p):null}function pu(t){if(50<fc)throw fc=0,Ff=null,Error(a(185));for(var r=t.return;r!==null;)t=r,r=t.return;return t.tag===3?t.stateNode:null}var Vo={};function z1(t,r,o,u){this.tag=t,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Cn(t,r,o,u){return new z1(t,r,o,u)}function Ph(t){return t=t.prototype,!(!t||!t.isReactComponent)}function _i(t,r){var o=t.alternate;return o===null?(o=Cn(t.tag,r,t.key,t.mode),o.elementType=t.elementType,o.type=t.type,o.stateNode=t.stateNode,o.alternate=t,t.alternate=o):(o.pendingProps=r,o.type=t.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=t.flags&65011712,o.childLanes=t.childLanes,o.lanes=t.lanes,o.child=t.child,o.memoizedProps=t.memoizedProps,o.memoizedState=t.memoizedState,o.updateQueue=t.updateQueue,r=t.dependencies,o.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},o.sibling=t.sibling,o.index=t.index,o.ref=t.ref,o.refCleanup=t.refCleanup,o}function Mp(t,r){t.flags&=65011714;var o=t.alternate;return o===null?(t.childLanes=0,t.lanes=r,t.child=null,t.subtreeFlags=0,t.memoizedProps=null,t.memoizedState=null,t.updateQueue=null,t.dependencies=null,t.stateNode=null):(t.childLanes=o.childLanes,t.lanes=o.lanes,t.child=o.child,t.subtreeFlags=0,t.deletions=null,t.memoizedProps=o.memoizedProps,t.memoizedState=o.memoizedState,t.updateQueue=o.updateQueue,t.type=o.type,r=o.dependencies,t.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),t}function yu(t,r,o,u,m,p){var S=0;if(u=t,typeof t=="function")Ph(t)&&(S=1);else if(typeof t=="string")S=qN(t,o,Ht.current)?26:t==="html"||t==="head"||t==="body"?27:5;else e:switch(t){case L:return t=Cn(31,o,r,m),t.elementType=L,t.lanes=p,t;case U:return Xa(o.children,m,p,r);case ie:S=8,m|=24;break;case he:return t=Cn(12,o,r,m|2),t.elementType=he,t.lanes=p,t;case Ne:return t=Cn(13,o,r,m),t.elementType=Ne,t.lanes=p,t;case De:return t=Cn(19,o,r,m),t.elementType=De,t.lanes=p,t;default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Se:case xe:S=10;break e;case Be:S=9;break e;case _e:S=11;break e;case G:S=14;break e;case V:S=16,u=null;break e}S=29,o=Error(a(130,t===null?"null":typeof t,"")),u=null}return r=Cn(S,o,r,m),r.elementType=t,r.type=u,r.lanes=p,r}function Xa(t,r,o,u){return t=Cn(7,t,u,r),t.lanes=o,t}function Lh(t,r,o){return t=Cn(6,t,null,r),t.lanes=o,t}function Vh(t,r,o){return r=Cn(4,t.children!==null?t.children:[],t.key,r),r.lanes=o,r.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},r}var Uo=[],Bo=0,xu=null,bu=0,Xn=[],Wn=0,Wa=null,wi=1,Ni="";function Ja(t,r){Uo[Bo++]=bu,Uo[Bo++]=xu,xu=t,bu=r}function Pp(t,r,o){Xn[Wn++]=wi,Xn[Wn++]=Ni,Xn[Wn++]=Wa,Wa=t;var u=wi;t=Ni;var m=32-Rs(u)-1;u&=~(1<<m),o+=1;var p=32-Rs(r)+m;if(30<p){var S=m-m%5;p=(u&(1<<S)-1).toString(32),u>>=S,m-=S,wi=1<<32-Rs(r)+m|o<<m|u,Ni=p+t}else wi=1<<p|o<<m|u,Ni=t}function Uh(t){t.return!==null&&(Ja(t,1),Pp(t,1,0))}function Bh(t){for(;t===xu;)xu=Uo[--Bo],Uo[Bo]=null,bu=Uo[--Bo],Uo[Bo]=null;for(;t===Wa;)Wa=Xn[--Wn],Xn[Wn]=null,Ni=Xn[--Wn],Xn[Wn]=null,wi=Xn[--Wn],Xn[Wn]=null}var sn=null,is=null,kt=!1,Za=null,Fr=!1,zh=Error(a(519));function eo(t){var r=Error(a(418,""));throw Gl(Kn(r,t)),zh}function Lp(t){var r=t.stateNode,o=t.type,u=t.memoizedProps;switch(r[ts]=t,r[_s]=u,o){case"dialog":Nt("cancel",r),Nt("close",r);break;case"iframe":case"object":case"embed":Nt("load",r);break;case"video":case"audio":for(o=0;o<gc.length;o++)Nt(gc[o],r);break;case"source":Nt("error",r);break;case"img":case"image":case"link":Nt("error",r),Nt("load",r);break;case"details":Nt("toggle",r);break;case"input":Nt("invalid",r),O(r,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0),yr(r);break;case"select":Nt("invalid",r);break;case"textarea":Nt("invalid",r),M(r,u.value,u.defaultValue,u.children),yr(r)}o=u.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||r.textContent===""+o||u.suppressHydrationWarning===!0||ex(r.textContent,o)?(u.popover!=null&&(Nt("beforetoggle",r),Nt("toggle",r)),u.onScroll!=null&&Nt("scroll",r),u.onScrollEnd!=null&&Nt("scrollend",r),u.onClick!=null&&(r.onclick=Zu),r=!0):r=!1,r||eo(t)}function Vp(t){for(sn=t.return;sn;)switch(sn.tag){case 5:case 13:Fr=!1;return;case 27:case 3:Fr=!0;return;default:sn=sn.return}}function ql(t){if(t!==sn)return!1;if(!kt)return Vp(t),kt=!0,!1;var r=t.tag,o;if((o=r!==3&&r!==27)&&((o=r===5)&&(o=t.type,o=!(o!=="form"&&o!=="button")||rm(t.type,t.memoizedProps)),o=!o),o&&is&&eo(t),Vp(t),r===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(a(317));e:{for(t=t.nextSibling,r=0;t;){if(t.nodeType===8)if(o=t.data,o==="/$"){if(r===0){is=Er(t.nextSibling);break e}r--}else o!=="$"&&o!=="$!"&&o!=="$?"||r++;t=t.nextSibling}is=null}}else r===27?(r=is,ma(t.type)?(t=lm,lm=null,is=t):is=r):is=sn?Er(t.stateNode.nextSibling):null;return!0}function Hl(){is=sn=null,kt=!1}function Up(){var t=Za;return t!==null&&(un===null?un=t:un.push.apply(un,t),Za=null),t}function Gl(t){Za===null?Za=[t]:Za.push(t)}var Fh=bt(null),to=null,Si=null;function Zi(t,r,o){yt(Fh,r._currentValue),r._currentValue=o}function Ei(t){t._currentValue=Fh.current,xt(Fh)}function qh(t,r,o){for(;t!==null;){var u=t.alternate;if((t.childLanes&r)!==r?(t.childLanes|=r,u!==null&&(u.childLanes|=r)):u!==null&&(u.childLanes&r)!==r&&(u.childLanes|=r),t===o)break;t=t.return}}function Hh(t,r,o,u){var m=t.child;for(m!==null&&(m.return=t);m!==null;){var p=m.dependencies;if(p!==null){var S=m.child;p=p.firstContext;e:for(;p!==null;){var P=p;p=m;for(var Z=0;Z<r.length;Z++)if(P.context===r[Z]){p.lanes|=o,P=p.alternate,P!==null&&(P.lanes|=o),qh(p.return,o,t),u||(S=null);break e}p=P.next}}else if(m.tag===18){if(S=m.return,S===null)throw Error(a(341));S.lanes|=o,p=S.alternate,p!==null&&(p.lanes|=o),qh(S,o,t),S=null}else S=m.child;if(S!==null)S.return=m;else for(S=m;S!==null;){if(S===t){S=null;break}if(m=S.sibling,m!==null){m.return=S.return,S=m;break}S=S.return}m=S}}function $l(t,r,o,u){t=null;for(var m=r,p=!1;m!==null;){if(!p){if((m.flags&524288)!==0)p=!0;else if((m.flags&262144)!==0)break}if(m.tag===10){var S=m.alternate;if(S===null)throw Error(a(387));if(S=S.memoizedProps,S!==null){var P=m.type;An(m.pendingProps.value,S.value)||(t!==null?t.push(P):t=[P])}}else if(m===Dr.current){if(S=m.alternate,S===null)throw Error(a(387));S.memoizedState.memoizedState!==m.memoizedState.memoizedState&&(t!==null?t.push(_c):t=[_c])}m=m.return}t!==null&&Hh(r,t,o,u),r.flags|=262144}function vu(t){for(t=t.firstContext;t!==null;){if(!An(t.context._currentValue,t.memoizedValue))return!0;t=t.next}return!1}function so(t){to=t,Si=null,t=t.dependencies,t!==null&&(t.firstContext=null)}function zs(t){return Bp(to,t)}function _u(t,r){return to===null&&so(t),Bp(t,r)}function Bp(t,r){var o=r._currentValue;if(r={context:r,memoizedValue:o,next:null},Si===null){if(t===null)throw Error(a(308));Si=r,t.dependencies={lanes:0,firstContext:r},t.flags|=524288}else Si=Si.next=r;return o}var F1=typeof AbortController!="undefined"?AbortController:function(){var t=[],r=this.signal={aborted:!1,addEventListener:function(o,u){t.push(u)}};this.abort=function(){r.aborted=!0,t.forEach(function(o){return o()})}},q1=n.unstable_scheduleCallback,H1=n.unstable_NormalPriority,Ns={$$typeof:xe,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Gh(){return{controller:new F1,data:new Map,refCount:0}}function Ql(t){t.refCount--,t.refCount===0&&q1(H1,function(){t.controller.abort()})}var Kl=null,$h=0,zo=0,Fo=null;function G1(t,r){if(Kl===null){var o=Kl=[];$h=0,zo=Yf(),Fo={status:"pending",value:void 0,then:function(u){o.push(u)}}}return $h++,r.then(zp,zp),r}function zp(){if(--$h===0&&Kl!==null){Fo!==null&&(Fo.status="fulfilled");var t=Kl;Kl=null,zo=0,Fo=null;for(var r=0;r<t.length;r++)(0,t[r])()}}function $1(t,r){var o=[],u={status:"pending",value:null,reason:null,then:function(m){o.push(m)}};return t.then(function(){u.status="fulfilled",u.value=r;for(var m=0;m<o.length;m++)(0,o[m])(r)},function(m){for(u.status="rejected",u.reason=m,m=0;m<o.length;m++)(0,o[m])(void 0)}),u}var Fp=Ae.S;Ae.S=function(t,r){typeof r=="object"&&r!==null&&typeof r.then=="function"&&G1(t,r),Fp!==null&&Fp(t,r)};var no=bt(null);function Qh(){var t=no.current;return t!==null?t:Qt.pooledCache}function wu(t,r){r===null?yt(no,no.current):yt(no,r.pool)}function qp(){var t=Qh();return t===null?null:{parent:Ns._currentValue,pool:t}}var Yl=Error(a(460)),Hp=Error(a(474)),Nu=Error(a(542)),Kh={then:function(){}};function Gp(t){return t=t.status,t==="fulfilled"||t==="rejected"}function Su(){}function $p(t,r,o){switch(o=t[o],o===void 0?t.push(r):o!==r&&(r.then(Su,Su),r=o),r.status){case"fulfilled":return r.value;case"rejected":throw t=r.reason,Kp(t),t;default:if(typeof r.status=="string")r.then(Su,Su);else{if(t=Qt,t!==null&&100<t.shellSuspendCounter)throw Error(a(482));t=r,t.status="pending",t.then(function(u){if(r.status==="pending"){var m=r;m.status="fulfilled",m.value=u}},function(u){if(r.status==="pending"){var m=r;m.status="rejected",m.reason=u}})}switch(r.status){case"fulfilled":return r.value;case"rejected":throw t=r.reason,Kp(t),t}throw Xl=r,Yl}}var Xl=null;function Qp(){if(Xl===null)throw Error(a(459));var t=Xl;return Xl=null,t}function Kp(t){if(t===Yl||t===Nu)throw Error(a(483))}var ea=!1;function Yh(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Xh(t,r){t=t.updateQueue,r.updateQueue===t&&(r.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,callbacks:null})}function ta(t){return{lane:t,tag:0,payload:null,callback:null,next:null}}function sa(t,r,o){var u=t.updateQueue;if(u===null)return null;if(u=u.shared,(Lt&2)!==0){var m=u.pending;return m===null?r.next=r:(r.next=m.next,m.next=r),u.pending=r,r=pu(t),kp(t,null,o),r}return gu(t,u,r,o),pu(t)}function Wl(t,r,o){if(r=r.updateQueue,r!==null&&(r=r.shared,(o&4194048)!==0)){var u=r.lanes;u&=t.pendingLanes,o|=u,r.lanes=o,ur(t,o)}}function Wh(t,r){var o=t.updateQueue,u=t.alternate;if(u!==null&&(u=u.updateQueue,o===u)){var m=null,p=null;if(o=o.firstBaseUpdate,o!==null){do{var S={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};p===null?m=p=S:p=p.next=S,o=o.next}while(o!==null);p===null?m=p=r:p=p.next=r}else m=p=r;o={baseState:u.baseState,firstBaseUpdate:m,lastBaseUpdate:p,shared:u.shared,callbacks:u.callbacks},t.updateQueue=o;return}t=o.lastBaseUpdate,t===null?o.firstBaseUpdate=r:t.next=r,o.lastBaseUpdate=r}var Jh=!1;function Jl(){if(Jh){var t=Fo;if(t!==null)throw t}}function Zl(t,r,o,u){Jh=!1;var m=t.updateQueue;ea=!1;var p=m.firstBaseUpdate,S=m.lastBaseUpdate,P=m.shared.pending;if(P!==null){m.shared.pending=null;var Z=P,ye=Z.next;Z.next=null,S===null?p=ye:S.next=ye,S=Z;var Re=t.alternate;Re!==null&&(Re=Re.updateQueue,P=Re.lastBaseUpdate,P!==S&&(P===null?Re.firstBaseUpdate=ye:P.next=ye,Re.lastBaseUpdate=Z))}if(p!==null){var Me=m.baseState;S=0,Re=ye=Z=null,P=p;do{var be=P.lane&-536870913,we=be!==P.lane;if(we?(Tt&be)===be:(u&be)===be){be!==0&&be===zo&&(Jh=!0),Re!==null&&(Re=Re.next={lane:0,tag:P.tag,payload:P.payload,callback:null,next:null});e:{var dt=t,it=P;be=r;var qt=o;switch(it.tag){case 1:if(dt=it.payload,typeof dt=="function"){Me=dt.call(qt,Me,be);break e}Me=dt;break e;case 3:dt.flags=dt.flags&-65537|128;case 0:if(dt=it.payload,be=typeof dt=="function"?dt.call(qt,Me,be):dt,be==null)break e;Me=E({},Me,be);break e;case 2:ea=!0}}be=P.callback,be!==null&&(t.flags|=64,we&&(t.flags|=8192),we=m.callbacks,we===null?m.callbacks=[be]:we.push(be))}else we={lane:be,tag:P.tag,payload:P.payload,callback:P.callback,next:null},Re===null?(ye=Re=we,Z=Me):Re=Re.next=we,S|=be;if(P=P.next,P===null){if(P=m.shared.pending,P===null)break;we=P,P=we.next,we.next=null,m.lastBaseUpdate=we,m.shared.pending=null}}while(!0);Re===null&&(Z=Me),m.baseState=Z,m.firstBaseUpdate=ye,m.lastBaseUpdate=Re,p===null&&(m.shared.lanes=0),ua|=S,t.lanes=S,t.memoizedState=Me}}function Yp(t,r){if(typeof t!="function")throw Error(a(191,t));t.call(r)}function Xp(t,r){var o=t.callbacks;if(o!==null)for(t.callbacks=null,t=0;t<o.length;t++)Yp(o[t],r)}var qo=bt(null),Eu=bt(0);function Wp(t,r){t=Di,yt(Eu,t),yt(qo,r),Di=t|r.baseLanes}function Zh(){yt(Eu,Di),yt(qo,qo.current)}function ef(){Di=Eu.current,xt(qo),xt(Eu)}var na=0,vt=null,zt=null,fs=null,ju=!1,Ho=!1,ro=!1,Tu=0,ec=0,Go=null,Q1=0;function us(){throw Error(a(321))}function tf(t,r){if(r===null)return!1;for(var o=0;o<r.length&&o<t.length;o++)if(!An(t[o],r[o]))return!1;return!0}function sf(t,r,o,u,m,p){return na=p,vt=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,Ae.H=t===null||t.memoizedState===null?k0:M0,ro=!1,p=o(u,m),ro=!1,Ho&&(p=Zp(r,o,u,m)),Jp(t),p}function Jp(t){Ae.H=Ou;var r=zt!==null&&zt.next!==null;if(na=0,fs=zt=vt=null,ju=!1,ec=0,Go=null,r)throw Error(a(300));t===null||js||(t=t.dependencies,t!==null&&vu(t)&&(js=!0))}function Zp(t,r,o,u){vt=t;var m=0;do{if(Ho&&(Go=null),ec=0,Ho=!1,25<=m)throw Error(a(301));if(m+=1,fs=zt=null,t.updateQueue!=null){var p=t.updateQueue;p.lastEffect=null,p.events=null,p.stores=null,p.memoCache!=null&&(p.memoCache.index=0)}Ae.H=eN,p=r(o,u)}while(Ho);return p}function K1(){var t=Ae.H,r=t.useState()[0];return r=typeof r.then=="function"?tc(r):r,t=t.useState()[0],(zt!==null?zt.memoizedState:null)!==t&&(vt.flags|=1024),r}function nf(){var t=Tu!==0;return Tu=0,t}function rf(t,r,o){r.updateQueue=t.updateQueue,r.flags&=-2053,t.lanes&=~o}function af(t){if(ju){for(t=t.memoizedState;t!==null;){var r=t.queue;r!==null&&(r.pending=null),t=t.next}ju=!1}na=0,fs=zt=vt=null,Ho=!1,ec=Tu=0,Go=null}function ln(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return fs===null?vt.memoizedState=fs=t:fs=fs.next=t,fs}function ms(){if(zt===null){var t=vt.alternate;t=t!==null?t.memoizedState:null}else t=zt.next;var r=fs===null?vt.memoizedState:fs.next;if(r!==null)fs=r,zt=t;else{if(t===null)throw vt.alternate===null?Error(a(467)):Error(a(310));zt=t,t={memoizedState:zt.memoizedState,baseState:zt.baseState,baseQueue:zt.baseQueue,queue:zt.queue,next:null},fs===null?vt.memoizedState=fs=t:fs=fs.next=t}return fs}function of(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function tc(t){var r=ec;return ec+=1,Go===null&&(Go=[]),t=$p(Go,t,r),r=vt,(fs===null?r.memoizedState:fs.next)===null&&(r=r.alternate,Ae.H=r===null||r.memoizedState===null?k0:M0),t}function Au(t){if(t!==null&&typeof t=="object"){if(typeof t.then=="function")return tc(t);if(t.$$typeof===xe)return zs(t)}throw Error(a(438,String(t)))}function lf(t){var r=null,o=vt.updateQueue;if(o!==null&&(r=o.memoCache),r==null){var u=vt.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(r={data:u.data.map(function(m){return m.slice()}),index:0})))}if(r==null&&(r={data:[],index:0}),o===null&&(o=of(),vt.updateQueue=o),o.memoCache=r,o=r.data[r.index],o===void 0)for(o=r.data[r.index]=Array(t),u=0;u<t;u++)o[u]=z;return r.index++,o}function ji(t,r){return typeof r=="function"?r(t):r}function Cu(t){var r=ms();return cf(r,zt,t)}function cf(t,r,o){var u=t.queue;if(u===null)throw Error(a(311));u.lastRenderedReducer=o;var m=t.baseQueue,p=u.pending;if(p!==null){if(m!==null){var S=m.next;m.next=p.next,p.next=S}r.baseQueue=m=p,u.pending=null}if(p=t.baseState,m===null)t.memoizedState=p;else{r=m.next;var P=S=null,Z=null,ye=r,Re=!1;do{var Me=ye.lane&-536870913;if(Me!==ye.lane?(Tt&Me)===Me:(na&Me)===Me){var be=ye.revertLane;if(be===0)Z!==null&&(Z=Z.next={lane:0,revertLane:0,action:ye.action,hasEagerState:ye.hasEagerState,eagerState:ye.eagerState,next:null}),Me===zo&&(Re=!0);else if((na&be)===be){ye=ye.next,be===zo&&(Re=!0);continue}else Me={lane:0,revertLane:ye.revertLane,action:ye.action,hasEagerState:ye.hasEagerState,eagerState:ye.eagerState,next:null},Z===null?(P=Z=Me,S=p):Z=Z.next=Me,vt.lanes|=be,ua|=be;Me=ye.action,ro&&o(p,Me),p=ye.hasEagerState?ye.eagerState:o(p,Me)}else be={lane:Me,revertLane:ye.revertLane,action:ye.action,hasEagerState:ye.hasEagerState,eagerState:ye.eagerState,next:null},Z===null?(P=Z=be,S=p):Z=Z.next=be,vt.lanes|=Me,ua|=Me;ye=ye.next}while(ye!==null&&ye!==r);if(Z===null?S=p:Z.next=P,!An(p,t.memoizedState)&&(js=!0,Re&&(o=Fo,o!==null)))throw o;t.memoizedState=p,t.baseState=S,t.baseQueue=Z,u.lastRenderedState=p}return m===null&&(u.lanes=0),[t.memoizedState,u.dispatch]}function uf(t){var r=ms(),o=r.queue;if(o===null)throw Error(a(311));o.lastRenderedReducer=t;var u=o.dispatch,m=o.pending,p=r.memoizedState;if(m!==null){o.pending=null;var S=m=m.next;do p=t(p,S.action),S=S.next;while(S!==m);An(p,r.memoizedState)||(js=!0),r.memoizedState=p,r.baseQueue===null&&(r.baseState=p),o.lastRenderedState=p}return[p,u]}function e0(t,r,o){var u=vt,m=ms(),p=kt;if(p){if(o===void 0)throw Error(a(407));o=o()}else o=r();var S=!An((zt||m).memoizedState,o);S&&(m.memoizedState=o,js=!0),m=m.queue;var P=n0.bind(null,u,m,t);if(sc(2048,8,P,[t]),m.getSnapshot!==r||S||fs!==null&&fs.memoizedState.tag&1){if(u.flags|=2048,$o(9,Iu(),s0.bind(null,u,m,o,r),null),Qt===null)throw Error(a(349));p||(na&124)!==0||t0(u,r,o)}return o}function t0(t,r,o){t.flags|=16384,t={getSnapshot:r,value:o},r=vt.updateQueue,r===null?(r=of(),vt.updateQueue=r,r.stores=[t]):(o=r.stores,o===null?r.stores=[t]:o.push(t))}function s0(t,r,o,u){r.value=o,r.getSnapshot=u,r0(r)&&i0(t)}function n0(t,r,o){return o(function(){r0(r)&&i0(t)})}function r0(t){var r=t.getSnapshot;t=t.value;try{var o=r();return!An(t,o)}catch(u){return!0}}function i0(t){var r=Lo(t,2);r!==null&&kn(r,t,2)}function df(t){var r=ln();if(typeof t=="function"){var o=t;if(t=o(),ro){rn(!0);try{o()}finally{rn(!1)}}}return r.memoizedState=r.baseState=t,r.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ji,lastRenderedState:t},r}function a0(t,r,o,u){return t.baseState=o,cf(t,zt,typeof u=="function"?u:ji)}function Y1(t,r,o,u,m){if(Du(t))throw Error(a(485));if(t=r.action,t!==null){var p={payload:m,action:t,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(S){p.listeners.push(S)}};Ae.T!==null?o(!0):p.isTransition=!1,u(p),o=r.pending,o===null?(p.next=r.pending=p,o0(r,p)):(p.next=o.next,r.pending=o.next=p)}}function o0(t,r){var o=r.action,u=r.payload,m=t.state;if(r.isTransition){var p=Ae.T,S={};Ae.T=S;try{var P=o(m,u),Z=Ae.S;Z!==null&&Z(S,P),l0(t,r,P)}catch(ye){hf(t,r,ye)}finally{Ae.T=p}}else try{p=o(m,u),l0(t,r,p)}catch(ye){hf(t,r,ye)}}function l0(t,r,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(u){c0(t,r,u)},function(u){return hf(t,r,u)}):c0(t,r,o)}function c0(t,r,o){r.status="fulfilled",r.value=o,u0(r),t.state=o,r=t.pending,r!==null&&(o=r.next,o===r?t.pending=null:(o=o.next,r.next=o,o0(t,o)))}function hf(t,r,o){var u=t.pending;if(t.pending=null,u!==null){u=u.next;do r.status="rejected",r.reason=o,u0(r),r=r.next;while(r!==u)}t.action=null}function u0(t){t=t.listeners;for(var r=0;r<t.length;r++)(0,t[r])()}function d0(t,r){return r}function h0(t,r){if(kt){var o=Qt.formState;if(o!==null){e:{var u=vt;if(kt){if(is){t:{for(var m=is,p=Fr;m.nodeType!==8;){if(!p){m=null;break t}if(m=Er(m.nextSibling),m===null){m=null;break t}}p=m.data,m=p==="F!"||p==="F"?m:null}if(m){is=Er(m.nextSibling),u=m.data==="F!";break e}}eo(u)}u=!1}u&&(r=o[0])}}return o=ln(),o.memoizedState=o.baseState=r,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:d0,lastRenderedState:r},o.queue=u,o=R0.bind(null,vt,u),u.dispatch=o,u=df(!1),p=yf.bind(null,vt,!1,u.queue),u=ln(),m={state:r,dispatch:null,action:t,pending:null},u.queue=m,o=Y1.bind(null,vt,m,p,o),m.dispatch=o,u.memoizedState=t,[r,o,!1]}function f0(t){var r=ms();return m0(r,zt,t)}function m0(t,r,o){if(r=cf(t,r,d0)[0],t=Cu(ji)[0],typeof r=="object"&&r!==null&&typeof r.then=="function")try{var u=tc(r)}catch(S){throw S===Yl?Nu:S}else u=r;r=ms();var m=r.queue,p=m.dispatch;return o!==r.memoizedState&&(vt.flags|=2048,$o(9,Iu(),X1.bind(null,m,o),null)),[u,p,t]}function X1(t,r){t.action=r}function g0(t){var r=ms(),o=zt;if(o!==null)return m0(r,o,t);ms(),r=r.memoizedState,o=ms();var u=o.queue.dispatch;return o.memoizedState=t,[r,u,!1]}function $o(t,r,o,u){return t={tag:t,create:o,deps:u,inst:r,next:null},r=vt.updateQueue,r===null&&(r=of(),vt.updateQueue=r),o=r.lastEffect,o===null?r.lastEffect=t.next=t:(u=o.next,o.next=t,t.next=u,r.lastEffect=t),t}function Iu(){return{destroy:void 0,resource:void 0}}function p0(){return ms().memoizedState}function Ru(t,r,o,u){var m=ln();u=u===void 0?null:u,vt.flags|=t,m.memoizedState=$o(1|r,Iu(),o,u)}function sc(t,r,o,u){var m=ms();u=u===void 0?null:u;var p=m.memoizedState.inst;zt!==null&&u!==null&&tf(u,zt.memoizedState.deps)?m.memoizedState=$o(r,p,o,u):(vt.flags|=t,m.memoizedState=$o(1|r,p,o,u))}function y0(t,r){Ru(8390656,8,t,r)}function x0(t,r){sc(2048,8,t,r)}function b0(t,r){return sc(4,2,t,r)}function v0(t,r){return sc(4,4,t,r)}function _0(t,r){if(typeof r=="function"){t=t();var o=r(t);return function(){typeof o=="function"?o():r(null)}}if(r!=null)return t=t(),r.current=t,function(){r.current=null}}function w0(t,r,o){o=o!=null?o.concat([t]):null,sc(4,4,_0.bind(null,r,t),o)}function ff(){}function N0(t,r){var o=ms();r=r===void 0?null:r;var u=o.memoizedState;return r!==null&&tf(r,u[1])?u[0]:(o.memoizedState=[t,r],t)}function S0(t,r){var o=ms();r=r===void 0?null:r;var u=o.memoizedState;if(r!==null&&tf(r,u[1]))return u[0];if(u=t(),ro){rn(!0);try{t()}finally{rn(!1)}}return o.memoizedState=[u,r],u}function mf(t,r,o){return o===void 0||(na&1073741824)!==0?t.memoizedState=r:(t.memoizedState=o,t=Ty(),vt.lanes|=t,ua|=t,o)}function E0(t,r,o,u){return An(o,r)?o:qo.current!==null?(t=mf(t,o,u),An(t,r)||(js=!0),t):(na&42)===0?(js=!0,t.memoizedState=o):(t=Ty(),vt.lanes|=t,ua|=t,r)}function j0(t,r,o,u,m){var p=Ue.p;Ue.p=p!==0&&8>p?p:8;var S=Ae.T,P={};Ae.T=P,yf(t,!1,r,o);try{var Z=m(),ye=Ae.S;if(ye!==null&&ye(P,Z),Z!==null&&typeof Z=="object"&&typeof Z.then=="function"){var Re=$1(Z,u);nc(t,r,Re,On(t))}else nc(t,r,u,On(t))}catch(Me){nc(t,r,{then:function(){},status:"rejected",reason:Me},On())}finally{Ue.p=p,Ae.T=S}}function W1(){}function gf(t,r,o,u){if(t.tag!==5)throw Error(a(476));var m=T0(t).queue;j0(t,m,r,et,o===null?W1:function(){return A0(t),o(u)})}function T0(t){var r=t.memoizedState;if(r!==null)return r;r={memoizedState:et,baseState:et,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ji,lastRenderedState:et},next:null};var o={};return r.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ji,lastRenderedState:o},next:null},t.memoizedState=r,t=t.alternate,t!==null&&(t.memoizedState=r),r}function A0(t){var r=T0(t).next.queue;nc(t,r,{},On())}function pf(){return zs(_c)}function C0(){return ms().memoizedState}function I0(){return ms().memoizedState}function J1(t){for(var r=t.return;r!==null;){switch(r.tag){case 24:case 3:var o=On();t=ta(o);var u=sa(r,t,o);u!==null&&(kn(u,r,o),Wl(u,r,o)),r={cache:Gh()},t.payload=r;return}r=r.return}}function Z1(t,r,o){var u=On();o={lane:u,revertLane:0,action:o,hasEagerState:!1,eagerState:null,next:null},Du(t)?D0(r,o):(o=Mh(t,r,o,u),o!==null&&(kn(o,t,u),O0(o,r,u)))}function R0(t,r,o){var u=On();nc(t,r,o,u)}function nc(t,r,o,u){var m={lane:u,revertLane:0,action:o,hasEagerState:!1,eagerState:null,next:null};if(Du(t))D0(r,m);else{var p=t.alternate;if(t.lanes===0&&(p===null||p.lanes===0)&&(p=r.lastRenderedReducer,p!==null))try{var S=r.lastRenderedState,P=p(S,o);if(m.hasEagerState=!0,m.eagerState=P,An(P,S))return gu(t,r,m,0),Qt===null&&mu(),!1}catch(Z){}finally{}if(o=Mh(t,r,m,u),o!==null)return kn(o,t,u),O0(o,r,u),!0}return!1}function yf(t,r,o,u){if(u={lane:2,revertLane:Yf(),action:u,hasEagerState:!1,eagerState:null,next:null},Du(t)){if(r)throw Error(a(479))}else r=Mh(t,o,u,2),r!==null&&kn(r,t,2)}function Du(t){var r=t.alternate;return t===vt||r!==null&&r===vt}function D0(t,r){Ho=ju=!0;var o=t.pending;o===null?r.next=r:(r.next=o.next,o.next=r),t.pending=r}function O0(t,r,o){if((o&4194048)!==0){var u=r.lanes;u&=t.pendingLanes,o|=u,r.lanes=o,ur(t,o)}}var Ou={readContext:zs,use:Au,useCallback:us,useContext:us,useEffect:us,useImperativeHandle:us,useLayoutEffect:us,useInsertionEffect:us,useMemo:us,useReducer:us,useRef:us,useState:us,useDebugValue:us,useDeferredValue:us,useTransition:us,useSyncExternalStore:us,useId:us,useHostTransitionStatus:us,useFormState:us,useActionState:us,useOptimistic:us,useMemoCache:us,useCacheRefresh:us},k0={readContext:zs,use:Au,useCallback:function(t,r){return ln().memoizedState=[t,r===void 0?null:r],t},useContext:zs,useEffect:y0,useImperativeHandle:function(t,r,o){o=o!=null?o.concat([t]):null,Ru(4194308,4,_0.bind(null,r,t),o)},useLayoutEffect:function(t,r){return Ru(4194308,4,t,r)},useInsertionEffect:function(t,r){Ru(4,2,t,r)},useMemo:function(t,r){var o=ln();r=r===void 0?null:r;var u=t();if(ro){rn(!0);try{t()}finally{rn(!1)}}return o.memoizedState=[u,r],u},useReducer:function(t,r,o){var u=ln();if(o!==void 0){var m=o(r);if(ro){rn(!0);try{o(r)}finally{rn(!1)}}}else m=r;return u.memoizedState=u.baseState=m,t={pending:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:m},u.queue=t,t=t.dispatch=Z1.bind(null,vt,t),[u.memoizedState,t]},useRef:function(t){var r=ln();return t={current:t},r.memoizedState=t},useState:function(t){t=df(t);var r=t.queue,o=R0.bind(null,vt,r);return r.dispatch=o,[t.memoizedState,o]},useDebugValue:ff,useDeferredValue:function(t,r){var o=ln();return mf(o,t,r)},useTransition:function(){var t=df(!1);return t=j0.bind(null,vt,t.queue,!0,!1),ln().memoizedState=t,[!1,t]},useSyncExternalStore:function(t,r,o){var u=vt,m=ln();if(kt){if(o===void 0)throw Error(a(407));o=o()}else{if(o=r(),Qt===null)throw Error(a(349));(Tt&124)!==0||t0(u,r,o)}m.memoizedState=o;var p={value:o,getSnapshot:r};return m.queue=p,y0(n0.bind(null,u,p,t),[t]),u.flags|=2048,$o(9,Iu(),s0.bind(null,u,p,o,r),null),o},useId:function(){var t=ln(),r=Qt.identifierPrefix;if(kt){var o=Ni,u=wi;o=(u&~(1<<32-Rs(u)-1)).toString(32)+o,r=""+r+"R"+o,o=Tu++,0<o&&(r+="H"+o.toString(32)),r+=""}else o=Q1++,r=""+r+"r"+o.toString(32)+"";return t.memoizedState=r},useHostTransitionStatus:pf,useFormState:h0,useActionState:h0,useOptimistic:function(t){var r=ln();r.memoizedState=r.baseState=t;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return r.queue=o,r=yf.bind(null,vt,!0,o),o.dispatch=r,[t,r]},useMemoCache:lf,useCacheRefresh:function(){return ln().memoizedState=J1.bind(null,vt)}},M0={readContext:zs,use:Au,useCallback:N0,useContext:zs,useEffect:x0,useImperativeHandle:w0,useInsertionEffect:b0,useLayoutEffect:v0,useMemo:S0,useReducer:Cu,useRef:p0,useState:function(){return Cu(ji)},useDebugValue:ff,useDeferredValue:function(t,r){var o=ms();return E0(o,zt.memoizedState,t,r)},useTransition:function(){var t=Cu(ji)[0],r=ms().memoizedState;return[typeof t=="boolean"?t:tc(t),r]},useSyncExternalStore:e0,useId:C0,useHostTransitionStatus:pf,useFormState:f0,useActionState:f0,useOptimistic:function(t,r){var o=ms();return a0(o,zt,t,r)},useMemoCache:lf,useCacheRefresh:I0},eN={readContext:zs,use:Au,useCallback:N0,useContext:zs,useEffect:x0,useImperativeHandle:w0,useInsertionEffect:b0,useLayoutEffect:v0,useMemo:S0,useReducer:uf,useRef:p0,useState:function(){return uf(ji)},useDebugValue:ff,useDeferredValue:function(t,r){var o=ms();return zt===null?mf(o,t,r):E0(o,zt.memoizedState,t,r)},useTransition:function(){var t=uf(ji)[0],r=ms().memoizedState;return[typeof t=="boolean"?t:tc(t),r]},useSyncExternalStore:e0,useId:C0,useHostTransitionStatus:pf,useFormState:g0,useActionState:g0,useOptimistic:function(t,r){var o=ms();return zt!==null?a0(o,zt,t,r):(o.baseState=t,[t,o.queue.dispatch])},useMemoCache:lf,useCacheRefresh:I0},Qo=null,rc=0;function ku(t){var r=rc;return rc+=1,Qo===null&&(Qo=[]),$p(Qo,t,r)}function ic(t,r){r=r.props.ref,t.ref=r!==void 0?r:null}function Mu(t,r){throw r.$$typeof===D?Error(a(525)):(t=Object.prototype.toString.call(r),Error(a(31,t==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":t)))}function P0(t){var r=t._init;return r(t._payload)}function L0(t){function r(fe,de){if(t){var pe=fe.deletions;pe===null?(fe.deletions=[de],fe.flags|=16):pe.push(de)}}function o(fe,de){if(!t)return null;for(;de!==null;)r(fe,de),de=de.sibling;return null}function u(fe){for(var de=new Map;fe!==null;)fe.key!==null?de.set(fe.key,fe):de.set(fe.index,fe),fe=fe.sibling;return de}function m(fe,de){return fe=_i(fe,de),fe.index=0,fe.sibling=null,fe}function p(fe,de,pe){return fe.index=pe,t?(pe=fe.alternate,pe!==null?(pe=pe.index,pe<de?(fe.flags|=67108866,de):pe):(fe.flags|=67108866,de)):(fe.flags|=1048576,de)}function S(fe){return t&&fe.alternate===null&&(fe.flags|=67108866),fe}function P(fe,de,pe,Oe){return de===null||de.tag!==6?(de=Lh(pe,fe.mode,Oe),de.return=fe,de):(de=m(de,pe),de.return=fe,de)}function Z(fe,de,pe,Oe){var Qe=pe.type;return Qe===U?Re(fe,de,pe.props.children,Oe,pe.key):de!==null&&(de.elementType===Qe||typeof Qe=="object"&&Qe!==null&&Qe.$$typeof===V&&P0(Qe)===de.type)?(de=m(de,pe.props),ic(de,pe),de.return=fe,de):(de=yu(pe.type,pe.key,pe.props,null,fe.mode,Oe),ic(de,pe),de.return=fe,de)}function ye(fe,de,pe,Oe){return de===null||de.tag!==4||de.stateNode.containerInfo!==pe.containerInfo||de.stateNode.implementation!==pe.implementation?(de=Vh(pe,fe.mode,Oe),de.return=fe,de):(de=m(de,pe.children||[]),de.return=fe,de)}function Re(fe,de,pe,Oe,Qe){return de===null||de.tag!==7?(de=Xa(pe,fe.mode,Oe,Qe),de.return=fe,de):(de=m(de,pe),de.return=fe,de)}function Me(fe,de,pe){if(typeof de=="string"&&de!==""||typeof de=="number"||typeof de=="bigint")return de=Lh(""+de,fe.mode,pe),de.return=fe,de;if(typeof de=="object"&&de!==null){switch(de.$$typeof){case _:return pe=yu(de.type,de.key,de.props,null,fe.mode,pe),ic(pe,de),pe.return=fe,pe;case R:return de=Vh(de,fe.mode,pe),de.return=fe,de;case V:var Oe=de._init;return de=Oe(de._payload),Me(fe,de,pe)}if(Ct(de)||Y(de))return de=Xa(de,fe.mode,pe,null),de.return=fe,de;if(typeof de.then=="function")return Me(fe,ku(de),pe);if(de.$$typeof===xe)return Me(fe,_u(fe,de),pe);Mu(fe,de)}return null}function be(fe,de,pe,Oe){var Qe=de!==null?de.key:null;if(typeof pe=="string"&&pe!==""||typeof pe=="number"||typeof pe=="bigint")return Qe!==null?null:P(fe,de,""+pe,Oe);if(typeof pe=="object"&&pe!==null){switch(pe.$$typeof){case _:return pe.key===Qe?Z(fe,de,pe,Oe):null;case R:return pe.key===Qe?ye(fe,de,pe,Oe):null;case V:return Qe=pe._init,pe=Qe(pe._payload),be(fe,de,pe,Oe)}if(Ct(pe)||Y(pe))return Qe!==null?null:Re(fe,de,pe,Oe,null);if(typeof pe.then=="function")return be(fe,de,ku(pe),Oe);if(pe.$$typeof===xe)return be(fe,de,_u(fe,pe),Oe);Mu(fe,pe)}return null}function we(fe,de,pe,Oe,Qe){if(typeof Oe=="string"&&Oe!==""||typeof Oe=="number"||typeof Oe=="bigint")return fe=fe.get(pe)||null,P(de,fe,""+Oe,Qe);if(typeof Oe=="object"&&Oe!==null){switch(Oe.$$typeof){case _:return fe=fe.get(Oe.key===null?pe:Oe.key)||null,Z(de,fe,Oe,Qe);case R:return fe=fe.get(Oe.key===null?pe:Oe.key)||null,ye(de,fe,Oe,Qe);case V:var _t=Oe._init;return Oe=_t(Oe._payload),we(fe,de,pe,Oe,Qe)}if(Ct(Oe)||Y(Oe))return fe=fe.get(pe)||null,Re(de,fe,Oe,Qe,null);if(typeof Oe.then=="function")return we(fe,de,pe,ku(Oe),Qe);if(Oe.$$typeof===xe)return we(fe,de,pe,_u(de,Oe),Qe);Mu(de,Oe)}return null}function dt(fe,de,pe,Oe){for(var Qe=null,_t=null,tt=de,ot=de=0,As=null;tt!==null&&ot<pe.length;ot++){tt.index>ot?(As=tt,tt=null):As=tt.sibling;var Rt=be(fe,tt,pe[ot],Oe);if(Rt===null){tt===null&&(tt=As);break}t&&tt&&Rt.alternate===null&&r(fe,tt),de=p(Rt,de,ot),_t===null?Qe=Rt:_t.sibling=Rt,_t=Rt,tt=As}if(ot===pe.length)return o(fe,tt),kt&&Ja(fe,ot),Qe;if(tt===null){for(;ot<pe.length;ot++)tt=Me(fe,pe[ot],Oe),tt!==null&&(de=p(tt,de,ot),_t===null?Qe=tt:_t.sibling=tt,_t=tt);return kt&&Ja(fe,ot),Qe}for(tt=u(tt);ot<pe.length;ot++)As=we(tt,fe,ot,pe[ot],Oe),As!==null&&(t&&As.alternate!==null&&tt.delete(As.key===null?ot:As.key),de=p(As,de,ot),_t===null?Qe=As:_t.sibling=As,_t=As);return t&&tt.forEach(function(ba){return r(fe,ba)}),kt&&Ja(fe,ot),Qe}function it(fe,de,pe,Oe){if(pe==null)throw Error(a(151));for(var Qe=null,_t=null,tt=de,ot=de=0,As=null,Rt=pe.next();tt!==null&&!Rt.done;ot++,Rt=pe.next()){tt.index>ot?(As=tt,tt=null):As=tt.sibling;var ba=be(fe,tt,Rt.value,Oe);if(ba===null){tt===null&&(tt=As);break}t&&tt&&ba.alternate===null&&r(fe,tt),de=p(ba,de,ot),_t===null?Qe=ba:_t.sibling=ba,_t=ba,tt=As}if(Rt.done)return o(fe,tt),kt&&Ja(fe,ot),Qe;if(tt===null){for(;!Rt.done;ot++,Rt=pe.next())Rt=Me(fe,Rt.value,Oe),Rt!==null&&(de=p(Rt,de,ot),_t===null?Qe=Rt:_t.sibling=Rt,_t=Rt);return kt&&Ja(fe,ot),Qe}for(tt=u(tt);!Rt.done;ot++,Rt=pe.next())Rt=we(tt,fe,ot,Rt.value,Oe),Rt!==null&&(t&&Rt.alternate!==null&&tt.delete(Rt.key===null?ot:Rt.key),de=p(Rt,de,ot),_t===null?Qe=Rt:_t.sibling=Rt,_t=Rt);return t&&tt.forEach(function(tS){return r(fe,tS)}),kt&&Ja(fe,ot),Qe}function qt(fe,de,pe,Oe){if(typeof pe=="object"&&pe!==null&&pe.type===U&&pe.key===null&&(pe=pe.props.children),typeof pe=="object"&&pe!==null){switch(pe.$$typeof){case _:e:{for(var Qe=pe.key;de!==null;){if(de.key===Qe){if(Qe=pe.type,Qe===U){if(de.tag===7){o(fe,de.sibling),Oe=m(de,pe.props.children),Oe.return=fe,fe=Oe;break e}}else if(de.elementType===Qe||typeof Qe=="object"&&Qe!==null&&Qe.$$typeof===V&&P0(Qe)===de.type){o(fe,de.sibling),Oe=m(de,pe.props),ic(Oe,pe),Oe.return=fe,fe=Oe;break e}o(fe,de);break}else r(fe,de);de=de.sibling}pe.type===U?(Oe=Xa(pe.props.children,fe.mode,Oe,pe.key),Oe.return=fe,fe=Oe):(Oe=yu(pe.type,pe.key,pe.props,null,fe.mode,Oe),ic(Oe,pe),Oe.return=fe,fe=Oe)}return S(fe);case R:e:{for(Qe=pe.key;de!==null;){if(de.key===Qe)if(de.tag===4&&de.stateNode.containerInfo===pe.containerInfo&&de.stateNode.implementation===pe.implementation){o(fe,de.sibling),Oe=m(de,pe.children||[]),Oe.return=fe,fe=Oe;break e}else{o(fe,de);break}else r(fe,de);de=de.sibling}Oe=Vh(pe,fe.mode,Oe),Oe.return=fe,fe=Oe}return S(fe);case V:return Qe=pe._init,pe=Qe(pe._payload),qt(fe,de,pe,Oe)}if(Ct(pe))return dt(fe,de,pe,Oe);if(Y(pe)){if(Qe=Y(pe),typeof Qe!="function")throw Error(a(150));return pe=Qe.call(pe),it(fe,de,pe,Oe)}if(typeof pe.then=="function")return qt(fe,de,ku(pe),Oe);if(pe.$$typeof===xe)return qt(fe,de,_u(fe,pe),Oe);Mu(fe,pe)}return typeof pe=="string"&&pe!==""||typeof pe=="number"||typeof pe=="bigint"?(pe=""+pe,de!==null&&de.tag===6?(o(fe,de.sibling),Oe=m(de,pe),Oe.return=fe,fe=Oe):(o(fe,de),Oe=Lh(pe,fe.mode,Oe),Oe.return=fe,fe=Oe),S(fe)):o(fe,de)}return function(fe,de,pe,Oe){try{rc=0;var Qe=qt(fe,de,pe,Oe);return Qo=null,Qe}catch(tt){if(tt===Yl||tt===Nu)throw tt;var _t=Cn(29,tt,null,fe.mode);return _t.lanes=Oe,_t.return=fe,_t}finally{}}}var Ko=L0(!0),V0=L0(!1),Jn=bt(null),qr=null;function ra(t){var r=t.alternate;yt(Ss,Ss.current&1),yt(Jn,t),qr===null&&(r===null||qo.current!==null||r.memoizedState!==null)&&(qr=t)}function U0(t){if(t.tag===22){if(yt(Ss,Ss.current),yt(Jn,t),qr===null){var r=t.alternate;r!==null&&r.memoizedState!==null&&(qr=t)}}else ia()}function ia(){yt(Ss,Ss.current),yt(Jn,Jn.current)}function Ti(t){xt(Jn),qr===t&&(qr=null),xt(Ss)}var Ss=bt(0);function Pu(t){for(var r=t;r!==null;){if(r.tag===13){var o=r.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||o.data==="$?"||om(o)))return r}else if(r.tag===19&&r.memoizedProps.revealOrder!==void 0){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}function xf(t,r,o,u){r=t.memoizedState,o=o(u,r),o=o==null?r:E({},r,o),t.memoizedState=o,t.lanes===0&&(t.updateQueue.baseState=o)}var bf={enqueueSetState:function(t,r,o){t=t._reactInternals;var u=On(),m=ta(u);m.payload=r,o!=null&&(m.callback=o),r=sa(t,m,u),r!==null&&(kn(r,t,u),Wl(r,t,u))},enqueueReplaceState:function(t,r,o){t=t._reactInternals;var u=On(),m=ta(u);m.tag=1,m.payload=r,o!=null&&(m.callback=o),r=sa(t,m,u),r!==null&&(kn(r,t,u),Wl(r,t,u))},enqueueForceUpdate:function(t,r){t=t._reactInternals;var o=On(),u=ta(o);u.tag=2,r!=null&&(u.callback=r),r=sa(t,u,o),r!==null&&(kn(r,t,o),Wl(r,t,o))}};function B0(t,r,o,u,m,p,S){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(u,p,S):r.prototype&&r.prototype.isPureReactComponent?!zl(o,u)||!zl(m,p):!0}function z0(t,r,o,u){t=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(o,u),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(o,u),r.state!==t&&bf.enqueueReplaceState(r,r.state,null)}function io(t,r){var o=r;if("ref"in r){o={};for(var u in r)u!=="ref"&&(o[u]=r[u])}if(t=t.defaultProps){o===r&&(o=E({},o));for(var m in t)o[m]===void 0&&(o[m]=t[m])}return o}var Lu=typeof reportError=="function"?reportError:function(t){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var r=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof t=="object"&&t!==null&&typeof t.message=="string"?String(t.message):String(t),error:t});if(!window.dispatchEvent(r))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",t);return}console.error(t)};function F0(t){Lu(t)}function q0(t){console.error(t)}function H0(t){Lu(t)}function Vu(t,r){try{var o=t.onUncaughtError;o(r.value,{componentStack:r.stack})}catch(u){setTimeout(function(){throw u})}}function G0(t,r,o){try{var u=t.onCaughtError;u(o.value,{componentStack:o.stack,errorBoundary:r.tag===1?r.stateNode:null})}catch(m){setTimeout(function(){throw m})}}function vf(t,r,o){return o=ta(o),o.tag=3,o.payload={element:null},o.callback=function(){Vu(t,r)},o}function $0(t){return t=ta(t),t.tag=3,t}function Q0(t,r,o,u){var m=o.type.getDerivedStateFromError;if(typeof m=="function"){var p=u.value;t.payload=function(){return m(p)},t.callback=function(){G0(r,o,u)}}var S=o.stateNode;S!==null&&typeof S.componentDidCatch=="function"&&(t.callback=function(){G0(r,o,u),typeof m!="function"&&(da===null?da=new Set([this]):da.add(this));var P=u.stack;this.componentDidCatch(u.value,{componentStack:P!==null?P:""})})}function tN(t,r,o,u,m){if(o.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(r=o.alternate,r!==null&&$l(r,o,m,!0),o=Jn.current,o!==null){switch(o.tag){case 13:return qr===null?Hf():o.alternate===null&&as===0&&(as=3),o.flags&=-257,o.flags|=65536,o.lanes=m,u===Kh?o.flags|=16384:(r=o.updateQueue,r===null?o.updateQueue=new Set([u]):r.add(u),$f(t,u,m)),!1;case 22:return o.flags|=65536,u===Kh?o.flags|=16384:(r=o.updateQueue,r===null?(r={transitions:null,markerInstances:null,retryQueue:new Set([u])},o.updateQueue=r):(o=r.retryQueue,o===null?r.retryQueue=new Set([u]):o.add(u)),$f(t,u,m)),!1}throw Error(a(435,o.tag))}return $f(t,u,m),Hf(),!1}if(kt)return r=Jn.current,r!==null?((r.flags&65536)===0&&(r.flags|=256),r.flags|=65536,r.lanes=m,u!==zh&&(t=Error(a(422),{cause:u}),Gl(Kn(t,o)))):(u!==zh&&(r=Error(a(423),{cause:u}),Gl(Kn(r,o))),t=t.current.alternate,t.flags|=65536,m&=-m,t.lanes|=m,u=Kn(u,o),m=vf(t.stateNode,u,m),Wh(t,m),as!==4&&(as=2)),!1;var p=Error(a(520),{cause:u});if(p=Kn(p,o),hc===null?hc=[p]:hc.push(p),as!==4&&(as=2),r===null)return!0;u=Kn(u,o),o=r;do{switch(o.tag){case 3:return o.flags|=65536,t=m&-m,o.lanes|=t,t=vf(o.stateNode,u,t),Wh(o,t),!1;case 1:if(r=o.type,p=o.stateNode,(o.flags&128)===0&&(typeof r.getDerivedStateFromError=="function"||p!==null&&typeof p.componentDidCatch=="function"&&(da===null||!da.has(p))))return o.flags|=65536,m&=-m,o.lanes|=m,m=$0(m),Q0(m,t,o,u),Wh(o,m),!1}o=o.return}while(o!==null);return!1}var K0=Error(a(461)),js=!1;function Os(t,r,o,u){r.child=t===null?V0(r,null,o,u):Ko(r,t.child,o,u)}function Y0(t,r,o,u,m){o=o.render;var p=r.ref;if("ref"in u){var S={};for(var P in u)P!=="ref"&&(S[P]=u[P])}else S=u;return so(r),u=sf(t,r,o,S,p,m),P=nf(),t!==null&&!js?(rf(t,r,m),Ai(t,r,m)):(kt&&P&&Uh(r),r.flags|=1,Os(t,r,u,m),r.child)}function X0(t,r,o,u,m){if(t===null){var p=o.type;return typeof p=="function"&&!Ph(p)&&p.defaultProps===void 0&&o.compare===null?(r.tag=15,r.type=p,W0(t,r,p,u,m)):(t=yu(o.type,null,u,r,r.mode,m),t.ref=r.ref,t.return=r,r.child=t)}if(p=t.child,!Af(t,m)){var S=p.memoizedProps;if(o=o.compare,o=o!==null?o:zl,o(S,u)&&t.ref===r.ref)return Ai(t,r,m)}return r.flags|=1,t=_i(p,u),t.ref=r.ref,t.return=r,r.child=t}function W0(t,r,o,u,m){if(t!==null){var p=t.memoizedProps;if(zl(p,u)&&t.ref===r.ref)if(js=!1,r.pendingProps=u=p,Af(t,m))(t.flags&131072)!==0&&(js=!0);else return r.lanes=t.lanes,Ai(t,r,m)}return _f(t,r,o,u,m)}function J0(t,r,o){var u=r.pendingProps,m=u.children,p=t!==null?t.memoizedState:null;if(u.mode==="hidden"){if((r.flags&128)!==0){if(u=p!==null?p.baseLanes|o:o,t!==null){for(m=r.child=t.child,p=0;m!==null;)p=p|m.lanes|m.childLanes,m=m.sibling;r.childLanes=p&~u}else r.childLanes=0,r.child=null;return Z0(t,r,u,o)}if((o&536870912)!==0)r.memoizedState={baseLanes:0,cachePool:null},t!==null&&wu(r,p!==null?p.cachePool:null),p!==null?Wp(r,p):Zh(),U0(r);else return r.lanes=r.childLanes=536870912,Z0(t,r,p!==null?p.baseLanes|o:o,o)}else p!==null?(wu(r,p.cachePool),Wp(r,p),ia(),r.memoizedState=null):(t!==null&&wu(r,null),Zh(),ia());return Os(t,r,m,o),r.child}function Z0(t,r,o,u){var m=Qh();return m=m===null?null:{parent:Ns._currentValue,pool:m},r.memoizedState={baseLanes:o,cachePool:m},t!==null&&wu(r,null),Zh(),U0(r),t!==null&&$l(t,r,u,!0),null}function Uu(t,r){var o=r.ref;if(o===null)t!==null&&t.ref!==null&&(r.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(a(284));(t===null||t.ref!==o)&&(r.flags|=4194816)}}function _f(t,r,o,u,m){return so(r),o=sf(t,r,o,u,void 0,m),u=nf(),t!==null&&!js?(rf(t,r,m),Ai(t,r,m)):(kt&&u&&Uh(r),r.flags|=1,Os(t,r,o,m),r.child)}function ey(t,r,o,u,m,p){return so(r),r.updateQueue=null,o=Zp(r,u,o,m),Jp(t),u=nf(),t!==null&&!js?(rf(t,r,p),Ai(t,r,p)):(kt&&u&&Uh(r),r.flags|=1,Os(t,r,o,p),r.child)}function ty(t,r,o,u,m){if(so(r),r.stateNode===null){var p=Vo,S=o.contextType;typeof S=="object"&&S!==null&&(p=zs(S)),p=new o(u,p),r.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,p.updater=bf,r.stateNode=p,p._reactInternals=r,p=r.stateNode,p.props=u,p.state=r.memoizedState,p.refs={},Yh(r),S=o.contextType,p.context=typeof S=="object"&&S!==null?zs(S):Vo,p.state=r.memoizedState,S=o.getDerivedStateFromProps,typeof S=="function"&&(xf(r,o,S,u),p.state=r.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof p.getSnapshotBeforeUpdate=="function"||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(S=p.state,typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount(),S!==p.state&&bf.enqueueReplaceState(p,p.state,null),Zl(r,u,p,m),Jl(),p.state=r.memoizedState),typeof p.componentDidMount=="function"&&(r.flags|=4194308),u=!0}else if(t===null){p=r.stateNode;var P=r.memoizedProps,Z=io(o,P);p.props=Z;var ye=p.context,Re=o.contextType;S=Vo,typeof Re=="object"&&Re!==null&&(S=zs(Re));var Me=o.getDerivedStateFromProps;Re=typeof Me=="function"||typeof p.getSnapshotBeforeUpdate=="function",P=r.pendingProps!==P,Re||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(P||ye!==S)&&z0(r,p,u,S),ea=!1;var be=r.memoizedState;p.state=be,Zl(r,u,p,m),Jl(),ye=r.memoizedState,P||be!==ye||ea?(typeof Me=="function"&&(xf(r,o,Me,u),ye=r.memoizedState),(Z=ea||B0(r,o,Z,u,be,ye,S))?(Re||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount()),typeof p.componentDidMount=="function"&&(r.flags|=4194308)):(typeof p.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=u,r.memoizedState=ye),p.props=u,p.state=ye,p.context=S,u=Z):(typeof p.componentDidMount=="function"&&(r.flags|=4194308),u=!1)}else{p=r.stateNode,Xh(t,r),S=r.memoizedProps,Re=io(o,S),p.props=Re,Me=r.pendingProps,be=p.context,ye=o.contextType,Z=Vo,typeof ye=="object"&&ye!==null&&(Z=zs(ye)),P=o.getDerivedStateFromProps,(ye=typeof P=="function"||typeof p.getSnapshotBeforeUpdate=="function")||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(S!==Me||be!==Z)&&z0(r,p,u,Z),ea=!1,be=r.memoizedState,p.state=be,Zl(r,u,p,m),Jl();var we=r.memoizedState;S!==Me||be!==we||ea||t!==null&&t.dependencies!==null&&vu(t.dependencies)?(typeof P=="function"&&(xf(r,o,P,u),we=r.memoizedState),(Re=ea||B0(r,o,Re,u,be,we,Z)||t!==null&&t.dependencies!==null&&vu(t.dependencies))?(ye||typeof p.UNSAFE_componentWillUpdate!="function"&&typeof p.componentWillUpdate!="function"||(typeof p.componentWillUpdate=="function"&&p.componentWillUpdate(u,we,Z),typeof p.UNSAFE_componentWillUpdate=="function"&&p.UNSAFE_componentWillUpdate(u,we,Z)),typeof p.componentDidUpdate=="function"&&(r.flags|=4),typeof p.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof p.componentDidUpdate!="function"||S===t.memoizedProps&&be===t.memoizedState||(r.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||S===t.memoizedProps&&be===t.memoizedState||(r.flags|=1024),r.memoizedProps=u,r.memoizedState=we),p.props=u,p.state=we,p.context=Z,u=Re):(typeof p.componentDidUpdate!="function"||S===t.memoizedProps&&be===t.memoizedState||(r.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||S===t.memoizedProps&&be===t.memoizedState||(r.flags|=1024),u=!1)}return p=u,Uu(t,r),u=(r.flags&128)!==0,p||u?(p=r.stateNode,o=u&&typeof o.getDerivedStateFromError!="function"?null:p.render(),r.flags|=1,t!==null&&u?(r.child=Ko(r,t.child,null,m),r.child=Ko(r,null,o,m)):Os(t,r,o,m),r.memoizedState=p.state,t=r.child):t=Ai(t,r,m),t}function sy(t,r,o,u){return Hl(),r.flags|=256,Os(t,r,o,u),r.child}var wf={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Nf(t){return{baseLanes:t,cachePool:qp()}}function Sf(t,r,o){return t=t!==null?t.childLanes&~o:0,r&&(t|=Zn),t}function ny(t,r,o){var u=r.pendingProps,m=!1,p=(r.flags&128)!==0,S;if((S=p)||(S=t!==null&&t.memoizedState===null?!1:(Ss.current&2)!==0),S&&(m=!0,r.flags&=-129),S=(r.flags&32)!==0,r.flags&=-33,t===null){if(kt){if(m?ra(r):ia(),kt){var P=is,Z;if(Z=P){e:{for(Z=P,P=Fr;Z.nodeType!==8;){if(!P){P=null;break e}if(Z=Er(Z.nextSibling),Z===null){P=null;break e}}P=Z}P!==null?(r.memoizedState={dehydrated:P,treeContext:Wa!==null?{id:wi,overflow:Ni}:null,retryLane:536870912,hydrationErrors:null},Z=Cn(18,null,null,0),Z.stateNode=P,Z.return=r,r.child=Z,sn=r,is=null,Z=!0):Z=!1}Z||eo(r)}if(P=r.memoizedState,P!==null&&(P=P.dehydrated,P!==null))return om(P)?r.lanes=32:r.lanes=536870912,null;Ti(r)}return P=u.children,u=u.fallback,m?(ia(),m=r.mode,P=Bu({mode:"hidden",children:P},m),u=Xa(u,m,o,null),P.return=r,u.return=r,P.sibling=u,r.child=P,m=r.child,m.memoizedState=Nf(o),m.childLanes=Sf(t,S,o),r.memoizedState=wf,u):(ra(r),Ef(r,P))}if(Z=t.memoizedState,Z!==null&&(P=Z.dehydrated,P!==null)){if(p)r.flags&256?(ra(r),r.flags&=-257,r=jf(t,r,o)):r.memoizedState!==null?(ia(),r.child=t.child,r.flags|=128,r=null):(ia(),m=u.fallback,P=r.mode,u=Bu({mode:"visible",children:u.children},P),m=Xa(m,P,o,null),m.flags|=2,u.return=r,m.return=r,u.sibling=m,r.child=u,Ko(r,t.child,null,o),u=r.child,u.memoizedState=Nf(o),u.childLanes=Sf(t,S,o),r.memoizedState=wf,r=m);else if(ra(r),om(P)){if(S=P.nextSibling&&P.nextSibling.dataset,S)var ye=S.dgst;S=ye,u=Error(a(419)),u.stack="",u.digest=S,Gl({value:u,source:null,stack:null}),r=jf(t,r,o)}else if(js||$l(t,r,o,!1),S=(o&t.childLanes)!==0,js||S){if(S=Qt,S!==null&&(u=o&-o,u=(u&42)!==0?1:ci(u),u=(u&(S.suspendedLanes|o))!==0?0:u,u!==0&&u!==Z.retryLane))throw Z.retryLane=u,Lo(t,u),kn(S,t,u),K0;P.data==="$?"||Hf(),r=jf(t,r,o)}else P.data==="$?"?(r.flags|=192,r.child=t.child,r=null):(t=Z.treeContext,is=Er(P.nextSibling),sn=r,kt=!0,Za=null,Fr=!1,t!==null&&(Xn[Wn++]=wi,Xn[Wn++]=Ni,Xn[Wn++]=Wa,wi=t.id,Ni=t.overflow,Wa=r),r=Ef(r,u.children),r.flags|=4096);return r}return m?(ia(),m=u.fallback,P=r.mode,Z=t.child,ye=Z.sibling,u=_i(Z,{mode:"hidden",children:u.children}),u.subtreeFlags=Z.subtreeFlags&65011712,ye!==null?m=_i(ye,m):(m=Xa(m,P,o,null),m.flags|=2),m.return=r,u.return=r,u.sibling=m,r.child=u,u=m,m=r.child,P=t.child.memoizedState,P===null?P=Nf(o):(Z=P.cachePool,Z!==null?(ye=Ns._currentValue,Z=Z.parent!==ye?{parent:ye,pool:ye}:Z):Z=qp(),P={baseLanes:P.baseLanes|o,cachePool:Z}),m.memoizedState=P,m.childLanes=Sf(t,S,o),r.memoizedState=wf,u):(ra(r),o=t.child,t=o.sibling,o=_i(o,{mode:"visible",children:u.children}),o.return=r,o.sibling=null,t!==null&&(S=r.deletions,S===null?(r.deletions=[t],r.flags|=16):S.push(t)),r.child=o,r.memoizedState=null,o)}function Ef(t,r){return r=Bu({mode:"visible",children:r},t.mode),r.return=t,t.child=r}function Bu(t,r){return t=Cn(22,t,null,r),t.lanes=0,t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},t}function jf(t,r,o){return Ko(r,t.child,null,o),t=Ef(r,r.pendingProps.children),t.flags|=2,r.memoizedState=null,t}function ry(t,r,o){t.lanes|=r;var u=t.alternate;u!==null&&(u.lanes|=r),qh(t.return,r,o)}function Tf(t,r,o,u,m){var p=t.memoizedState;p===null?t.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:u,tail:o,tailMode:m}:(p.isBackwards=r,p.rendering=null,p.renderingStartTime=0,p.last=u,p.tail=o,p.tailMode=m)}function iy(t,r,o){var u=r.pendingProps,m=u.revealOrder,p=u.tail;if(Os(t,r,u.children,o),u=Ss.current,(u&2)!==0)u=u&1|2,r.flags|=128;else{if(t!==null&&(t.flags&128)!==0)e:for(t=r.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&ry(t,o,r);else if(t.tag===19)ry(t,o,r);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===r)break e;for(;t.sibling===null;){if(t.return===null||t.return===r)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}u&=1}switch(yt(Ss,u),m){case"forwards":for(o=r.child,m=null;o!==null;)t=o.alternate,t!==null&&Pu(t)===null&&(m=o),o=o.sibling;o=m,o===null?(m=r.child,r.child=null):(m=o.sibling,o.sibling=null),Tf(r,!1,m,o,p);break;case"backwards":for(o=null,m=r.child,r.child=null;m!==null;){if(t=m.alternate,t!==null&&Pu(t)===null){r.child=m;break}t=m.sibling,m.sibling=o,o=m,m=t}Tf(r,!0,o,null,p);break;case"together":Tf(r,!1,null,null,void 0);break;default:r.memoizedState=null}return r.child}function Ai(t,r,o){if(t!==null&&(r.dependencies=t.dependencies),ua|=r.lanes,(o&r.childLanes)===0)if(t!==null){if($l(t,r,o,!1),(o&r.childLanes)===0)return null}else return null;if(t!==null&&r.child!==t.child)throw Error(a(153));if(r.child!==null){for(t=r.child,o=_i(t,t.pendingProps),r.child=o,o.return=r;t.sibling!==null;)t=t.sibling,o=o.sibling=_i(t,t.pendingProps),o.return=r;o.sibling=null}return r.child}function Af(t,r){return(t.lanes&r)!==0?!0:(t=t.dependencies,!!(t!==null&&vu(t)))}function sN(t,r,o){switch(r.tag){case 3:Or(r,r.stateNode.containerInfo),Zi(r,Ns,t.memoizedState.cache),Hl();break;case 27:case 5:Ua(r);break;case 4:Or(r,r.stateNode.containerInfo);break;case 10:Zi(r,r.type,r.memoizedProps.value);break;case 13:var u=r.memoizedState;if(u!==null)return u.dehydrated!==null?(ra(r),r.flags|=128,null):(o&r.child.childLanes)!==0?ny(t,r,o):(ra(r),t=Ai(t,r,o),t!==null?t.sibling:null);ra(r);break;case 19:var m=(t.flags&128)!==0;if(u=(o&r.childLanes)!==0,u||($l(t,r,o,!1),u=(o&r.childLanes)!==0),m){if(u)return iy(t,r,o);r.flags|=128}if(m=r.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),yt(Ss,Ss.current),u)break;return null;case 22:case 23:return r.lanes=0,J0(t,r,o);case 24:Zi(r,Ns,t.memoizedState.cache)}return Ai(t,r,o)}function ay(t,r,o){if(t!==null)if(t.memoizedProps!==r.pendingProps)js=!0;else{if(!Af(t,o)&&(r.flags&128)===0)return js=!1,sN(t,r,o);js=(t.flags&131072)!==0}else js=!1,kt&&(r.flags&1048576)!==0&&Pp(r,bu,r.index);switch(r.lanes=0,r.tag){case 16:e:{t=r.pendingProps;var u=r.elementType,m=u._init;if(u=m(u._payload),r.type=u,typeof u=="function")Ph(u)?(t=io(u,t),r.tag=1,r=ty(null,r,u,t,o)):(r.tag=0,r=_f(null,r,u,t,o));else{if(u!=null){if(m=u.$$typeof,m===_e){r.tag=11,r=Y0(null,r,u,t,o);break e}else if(m===G){r.tag=14,r=X0(null,r,u,t,o);break e}}throw r=pt(u)||u,Error(a(306,r,""))}}return r;case 0:return _f(t,r,r.type,r.pendingProps,o);case 1:return u=r.type,m=io(u,r.pendingProps),ty(t,r,u,m,o);case 3:e:{if(Or(r,r.stateNode.containerInfo),t===null)throw Error(a(387));u=r.pendingProps;var p=r.memoizedState;m=p.element,Xh(t,r),Zl(r,u,null,o);var S=r.memoizedState;if(u=S.cache,Zi(r,Ns,u),u!==p.cache&&Hh(r,[Ns],o,!0),Jl(),u=S.element,p.isDehydrated)if(p={element:u,isDehydrated:!1,cache:S.cache},r.updateQueue.baseState=p,r.memoizedState=p,r.flags&256){r=sy(t,r,u,o);break e}else if(u!==m){m=Kn(Error(a(424)),r),Gl(m),r=sy(t,r,u,o);break e}else{switch(t=r.stateNode.containerInfo,t.nodeType){case 9:t=t.body;break;default:t=t.nodeName==="HTML"?t.ownerDocument.body:t}for(is=Er(t.firstChild),sn=r,kt=!0,Za=null,Fr=!0,o=V0(r,null,u,o),r.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling}else{if(Hl(),u===m){r=Ai(t,r,o);break e}Os(t,r,u,o)}r=r.child}return r;case 26:return Uu(t,r),t===null?(o=ux(r.type,null,r.pendingProps,null))?r.memoizedState=o:kt||(o=r.type,t=r.pendingProps,u=ed(nn.current).createElement(o),u[ts]=r,u[_s]=t,Ms(u,o,t),ss(u),r.stateNode=u):r.memoizedState=ux(r.type,t.memoizedProps,r.pendingProps,t.memoizedState),null;case 27:return Ua(r),t===null&&kt&&(u=r.stateNode=ox(r.type,r.pendingProps,nn.current),sn=r,Fr=!0,m=is,ma(r.type)?(lm=m,is=Er(u.firstChild)):is=m),Os(t,r,r.pendingProps.children,o),Uu(t,r),t===null&&(r.flags|=4194304),r.child;case 5:return t===null&&kt&&((m=u=is)&&(u=IN(u,r.type,r.pendingProps,Fr),u!==null?(r.stateNode=u,sn=r,is=Er(u.firstChild),Fr=!1,m=!0):m=!1),m||eo(r)),Ua(r),m=r.type,p=r.pendingProps,S=t!==null?t.memoizedProps:null,u=p.children,rm(m,p)?u=null:S!==null&&rm(m,S)&&(r.flags|=32),r.memoizedState!==null&&(m=sf(t,r,K1,null,null,o),_c._currentValue=m),Uu(t,r),Os(t,r,u,o),r.child;case 6:return t===null&&kt&&((t=o=is)&&(o=RN(o,r.pendingProps,Fr),o!==null?(r.stateNode=o,sn=r,is=null,t=!0):t=!1),t||eo(r)),null;case 13:return ny(t,r,o);case 4:return Or(r,r.stateNode.containerInfo),u=r.pendingProps,t===null?r.child=Ko(r,null,u,o):Os(t,r,u,o),r.child;case 11:return Y0(t,r,r.type,r.pendingProps,o);case 7:return Os(t,r,r.pendingProps,o),r.child;case 8:return Os(t,r,r.pendingProps.children,o),r.child;case 12:return Os(t,r,r.pendingProps.children,o),r.child;case 10:return u=r.pendingProps,Zi(r,r.type,u.value),Os(t,r,u.children,o),r.child;case 9:return m=r.type._context,u=r.pendingProps.children,so(r),m=zs(m),u=u(m),r.flags|=1,Os(t,r,u,o),r.child;case 14:return X0(t,r,r.type,r.pendingProps,o);case 15:return W0(t,r,r.type,r.pendingProps,o);case 19:return iy(t,r,o);case 31:return u=r.pendingProps,o=r.mode,u={mode:u.mode,children:u.children},t===null?(o=Bu(u,o),o.ref=r.ref,r.child=o,o.return=r,r=o):(o=_i(t.child,u),o.ref=r.ref,r.child=o,o.return=r,r=o),r;case 22:return J0(t,r,o);case 24:return so(r),u=zs(Ns),t===null?(m=Qh(),m===null&&(m=Qt,p=Gh(),m.pooledCache=p,p.refCount++,p!==null&&(m.pooledCacheLanes|=o),m=p),r.memoizedState={parent:u,cache:m},Yh(r),Zi(r,Ns,m)):((t.lanes&o)!==0&&(Xh(t,r),Zl(r,null,null,o),Jl()),m=t.memoizedState,p=r.memoizedState,m.parent!==u?(m={parent:u,cache:u},r.memoizedState=m,r.lanes===0&&(r.memoizedState=r.updateQueue.baseState=m),Zi(r,Ns,u)):(u=p.cache,Zi(r,Ns,u),u!==m.cache&&Hh(r,[Ns],o,!0))),Os(t,r,r.pendingProps.children,o),r.child;case 29:throw r.pendingProps}throw Error(a(156,r.tag))}function Ci(t){t.flags|=4}function oy(t,r){if(r.type!=="stylesheet"||(r.state.loading&4)!==0)t.flags&=-16777217;else if(t.flags|=16777216,!gx(r)){if(r=Jn.current,r!==null&&((Tt&4194048)===Tt?qr!==null:(Tt&62914560)!==Tt&&(Tt&536870912)===0||r!==qr))throw Xl=Kh,Hp;t.flags|=8192}}function zu(t,r){r!==null&&(t.flags|=4),t.flags&16384&&(r=t.tag!==22?zn():536870912,t.lanes|=r,Jo|=r)}function ac(t,r){if(!kt)switch(t.tailMode){case"hidden":r=t.tail;for(var o=null;r!==null;)r.alternate!==null&&(o=r),r=r.sibling;o===null?t.tail=null:o.sibling=null;break;case"collapsed":o=t.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?r||t.tail===null?t.tail=null:t.tail.sibling=null:u.sibling=null}}function ns(t){var r=t.alternate!==null&&t.alternate.child===t.child,o=0,u=0;if(r)for(var m=t.child;m!==null;)o|=m.lanes|m.childLanes,u|=m.subtreeFlags&65011712,u|=m.flags&65011712,m.return=t,m=m.sibling;else for(m=t.child;m!==null;)o|=m.lanes|m.childLanes,u|=m.subtreeFlags,u|=m.flags,m.return=t,m=m.sibling;return t.subtreeFlags|=u,t.childLanes=o,r}function nN(t,r,o){var u=r.pendingProps;switch(Bh(r),r.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ns(r),null;case 1:return ns(r),null;case 3:return o=r.stateNode,u=null,t!==null&&(u=t.memoizedState.cache),r.memoizedState.cache!==u&&(r.flags|=2048),Ei(Ns),ir(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(t===null||t.child===null)&&(ql(r)?Ci(r):t===null||t.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,Up())),ns(r),null;case 26:return o=r.memoizedState,t===null?(Ci(r),o!==null?(ns(r),oy(r,o)):(ns(r),r.flags&=-16777217)):o?o!==t.memoizedState?(Ci(r),ns(r),oy(r,o)):(ns(r),r.flags&=-16777217):(t.memoizedProps!==u&&Ci(r),ns(r),r.flags&=-16777217),null;case 27:$i(r),o=nn.current;var m=r.type;if(t!==null&&r.stateNode!=null)t.memoizedProps!==u&&Ci(r);else{if(!u){if(r.stateNode===null)throw Error(a(166));return ns(r),null}t=Ht.current,ql(r)?Lp(r):(t=ox(m,u,o),r.stateNode=t,Ci(r))}return ns(r),null;case 5:if($i(r),o=r.type,t!==null&&r.stateNode!=null)t.memoizedProps!==u&&Ci(r);else{if(!u){if(r.stateNode===null)throw Error(a(166));return ns(r),null}if(t=Ht.current,ql(r))Lp(r);else{switch(m=ed(nn.current),t){case 1:t=m.createElementNS("http://www.w3.org/2000/svg",o);break;case 2:t=m.createElementNS("http://www.w3.org/1998/Math/MathML",o);break;default:switch(o){case"svg":t=m.createElementNS("http://www.w3.org/2000/svg",o);break;case"math":t=m.createElementNS("http://www.w3.org/1998/Math/MathML",o);break;case"script":t=m.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild);break;case"select":t=typeof u.is=="string"?m.createElement("select",{is:u.is}):m.createElement("select"),u.multiple?t.multiple=!0:u.size&&(t.size=u.size);break;default:t=typeof u.is=="string"?m.createElement(o,{is:u.is}):m.createElement(o)}}t[ts]=r,t[_s]=u;e:for(m=r.child;m!==null;){if(m.tag===5||m.tag===6)t.appendChild(m.stateNode);else if(m.tag!==4&&m.tag!==27&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===r)break e;for(;m.sibling===null;){if(m.return===null||m.return===r)break e;m=m.return}m.sibling.return=m.return,m=m.sibling}r.stateNode=t;e:switch(Ms(t,o,u),o){case"button":case"input":case"select":case"textarea":t=!!u.autoFocus;break e;case"img":t=!0;break e;default:t=!1}t&&Ci(r)}}return ns(r),r.flags&=-16777217,null;case 6:if(t&&r.stateNode!=null)t.memoizedProps!==u&&Ci(r);else{if(typeof u!="string"&&r.stateNode===null)throw Error(a(166));if(t=nn.current,ql(r)){if(t=r.stateNode,o=r.memoizedProps,u=null,m=sn,m!==null)switch(m.tag){case 27:case 5:u=m.memoizedProps}t[ts]=r,t=!!(t.nodeValue===o||u!==null&&u.suppressHydrationWarning===!0||ex(t.nodeValue,o)),t||eo(r)}else t=ed(t).createTextNode(u),t[ts]=r,r.stateNode=t}return ns(r),null;case 13:if(u=r.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(m=ql(r),u!==null&&u.dehydrated!==null){if(t===null){if(!m)throw Error(a(318));if(m=r.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(a(317));m[ts]=r}else Hl(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;ns(r),m=!1}else m=Up(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=m),m=!0;if(!m)return r.flags&256?(Ti(r),r):(Ti(r),null)}if(Ti(r),(r.flags&128)!==0)return r.lanes=o,r;if(o=u!==null,t=t!==null&&t.memoizedState!==null,o){u=r.child,m=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(m=u.alternate.memoizedState.cachePool.pool);var p=null;u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(p=u.memoizedState.cachePool.pool),p!==m&&(u.flags|=2048)}return o!==t&&o&&(r.child.flags|=8192),zu(r,r.updateQueue),ns(r),null;case 4:return ir(),t===null&&Zf(r.stateNode.containerInfo),ns(r),null;case 10:return Ei(r.type),ns(r),null;case 19:if(xt(Ss),m=r.memoizedState,m===null)return ns(r),null;if(u=(r.flags&128)!==0,p=m.rendering,p===null)if(u)ac(m,!1);else{if(as!==0||t!==null&&(t.flags&128)!==0)for(t=r.child;t!==null;){if(p=Pu(t),p!==null){for(r.flags|=128,ac(m,!1),t=p.updateQueue,r.updateQueue=t,zu(r,t),r.subtreeFlags=0,t=o,o=r.child;o!==null;)Mp(o,t),o=o.sibling;return yt(Ss,Ss.current&1|2),r.child}t=t.sibling}m.tail!==null&&Is()>Hu&&(r.flags|=128,u=!0,ac(m,!1),r.lanes=4194304)}else{if(!u)if(t=Pu(p),t!==null){if(r.flags|=128,u=!0,t=t.updateQueue,r.updateQueue=t,zu(r,t),ac(m,!0),m.tail===null&&m.tailMode==="hidden"&&!p.alternate&&!kt)return ns(r),null}else 2*Is()-m.renderingStartTime>Hu&&o!==536870912&&(r.flags|=128,u=!0,ac(m,!1),r.lanes=4194304);m.isBackwards?(p.sibling=r.child,r.child=p):(t=m.last,t!==null?t.sibling=p:r.child=p,m.last=p)}return m.tail!==null?(r=m.tail,m.rendering=r,m.tail=r.sibling,m.renderingStartTime=Is(),r.sibling=null,t=Ss.current,yt(Ss,u?t&1|2:t&1),r):(ns(r),null);case 22:case 23:return Ti(r),ef(),u=r.memoizedState!==null,t!==null?t.memoizedState!==null!==u&&(r.flags|=8192):u&&(r.flags|=8192),u?(o&536870912)!==0&&(r.flags&128)===0&&(ns(r),r.subtreeFlags&6&&(r.flags|=8192)):ns(r),o=r.updateQueue,o!==null&&zu(r,o.retryQueue),o=null,t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(o=t.memoizedState.cachePool.pool),u=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(u=r.memoizedState.cachePool.pool),u!==o&&(r.flags|=2048),t!==null&&xt(no),null;case 24:return o=null,t!==null&&(o=t.memoizedState.cache),r.memoizedState.cache!==o&&(r.flags|=2048),Ei(Ns),ns(r),null;case 25:return null;case 30:return null}throw Error(a(156,r.tag))}function rN(t,r){switch(Bh(r),r.tag){case 1:return t=r.flags,t&65536?(r.flags=t&-65537|128,r):null;case 3:return Ei(Ns),ir(),t=r.flags,(t&65536)!==0&&(t&128)===0?(r.flags=t&-65537|128,r):null;case 26:case 27:case 5:return $i(r),null;case 13:if(Ti(r),t=r.memoizedState,t!==null&&t.dehydrated!==null){if(r.alternate===null)throw Error(a(340));Hl()}return t=r.flags,t&65536?(r.flags=t&-65537|128,r):null;case 19:return xt(Ss),null;case 4:return ir(),null;case 10:return Ei(r.type),null;case 22:case 23:return Ti(r),ef(),t!==null&&xt(no),t=r.flags,t&65536?(r.flags=t&-65537|128,r):null;case 24:return Ei(Ns),null;case 25:return null;default:return null}}function ly(t,r){switch(Bh(r),r.tag){case 3:Ei(Ns),ir();break;case 26:case 27:case 5:$i(r);break;case 4:ir();break;case 13:Ti(r);break;case 19:xt(Ss);break;case 10:Ei(r.type);break;case 22:case 23:Ti(r),ef(),t!==null&&xt(no);break;case 24:Ei(Ns)}}function oc(t,r){try{var o=r.updateQueue,u=o!==null?o.lastEffect:null;if(u!==null){var m=u.next;o=m;do{if((o.tag&t)===t){u=void 0;var p=o.create,S=o.inst;u=p(),S.destroy=u}o=o.next}while(o!==m)}}catch(P){Gt(r,r.return,P)}}function aa(t,r,o){try{var u=r.updateQueue,m=u!==null?u.lastEffect:null;if(m!==null){var p=m.next;u=p;do{if((u.tag&t)===t){var S=u.inst,P=S.destroy;if(P!==void 0){S.destroy=void 0,m=r;var Z=o,ye=P;try{ye()}catch(Re){Gt(m,Z,Re)}}}u=u.next}while(u!==p)}}catch(Re){Gt(r,r.return,Re)}}function cy(t){var r=t.updateQueue;if(r!==null){var o=t.stateNode;try{Xp(r,o)}catch(u){Gt(t,t.return,u)}}}function uy(t,r,o){o.props=io(t.type,t.memoizedProps),o.state=t.memoizedState;try{o.componentWillUnmount()}catch(u){Gt(t,r,u)}}function lc(t,r){try{var o=t.ref;if(o!==null){switch(t.tag){case 26:case 27:case 5:var u=t.stateNode;break;case 30:u=t.stateNode;break;default:u=t.stateNode}typeof o=="function"?t.refCleanup=o(u):o.current=u}}catch(m){Gt(t,r,m)}}function Hr(t,r){var o=t.ref,u=t.refCleanup;if(o!==null)if(typeof u=="function")try{u()}catch(m){Gt(t,r,m)}finally{t.refCleanup=null,t=t.alternate,t!=null&&(t.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(m){Gt(t,r,m)}else o.current=null}function dy(t){var r=t.type,o=t.memoizedProps,u=t.stateNode;try{e:switch(r){case"button":case"input":case"select":case"textarea":o.autoFocus&&u.focus();break e;case"img":o.src?u.src=o.src:o.srcSet&&(u.srcset=o.srcSet)}}catch(m){Gt(t,t.return,m)}}function Cf(t,r,o){try{var u=t.stateNode;EN(u,t.type,o,r),u[_s]=r}catch(m){Gt(t,t.return,m)}}function hy(t){return t.tag===5||t.tag===3||t.tag===26||t.tag===27&&ma(t.type)||t.tag===4}function If(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||hy(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.tag===27&&ma(t.type)||t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Rf(t,r,o){var u=t.tag;if(u===5||u===6)t=t.stateNode,r?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(t,r):(r=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,r.appendChild(t),o=o._reactRootContainer,o!=null||r.onclick!==null||(r.onclick=Zu));else if(u!==4&&(u===27&&ma(t.type)&&(o=t.stateNode,r=null),t=t.child,t!==null))for(Rf(t,r,o),t=t.sibling;t!==null;)Rf(t,r,o),t=t.sibling}function Fu(t,r,o){var u=t.tag;if(u===5||u===6)t=t.stateNode,r?o.insertBefore(t,r):o.appendChild(t);else if(u!==4&&(u===27&&ma(t.type)&&(o=t.stateNode),t=t.child,t!==null))for(Fu(t,r,o),t=t.sibling;t!==null;)Fu(t,r,o),t=t.sibling}function fy(t){var r=t.stateNode,o=t.memoizedProps;try{for(var u=t.type,m=r.attributes;m.length;)r.removeAttributeNode(m[0]);Ms(r,u,o),r[ts]=t,r[_s]=o}catch(p){Gt(t,t.return,p)}}var Ii=!1,ds=!1,Df=!1,my=typeof WeakSet=="function"?WeakSet:Set,Ts=null;function iN(t,r){if(t=t.containerInfo,sm=ad,t=Ep(t),Ch(t)){if("selectionStart"in t)var o={start:t.selectionStart,end:t.selectionEnd};else e:{o=(o=t.ownerDocument)&&o.defaultView||window;var u=o.getSelection&&o.getSelection();if(u&&u.rangeCount!==0){o=u.anchorNode;var m=u.anchorOffset,p=u.focusNode;u=u.focusOffset;try{o.nodeType,p.nodeType}catch(it){o=null;break e}var S=0,P=-1,Z=-1,ye=0,Re=0,Me=t,be=null;t:for(;;){for(var we;Me!==o||m!==0&&Me.nodeType!==3||(P=S+m),Me!==p||u!==0&&Me.nodeType!==3||(Z=S+u),Me.nodeType===3&&(S+=Me.nodeValue.length),(we=Me.firstChild)!==null;)be=Me,Me=we;for(;;){if(Me===t)break t;if(be===o&&++ye===m&&(P=S),be===p&&++Re===u&&(Z=S),(we=Me.nextSibling)!==null)break;Me=be,be=Me.parentNode}Me=we}o=P===-1||Z===-1?null:{start:P,end:Z}}else o=null}o=o||{start:0,end:0}}else o=null;for(nm={focusedElem:t,selectionRange:o},ad=!1,Ts=r;Ts!==null;)if(r=Ts,t=r.child,(r.subtreeFlags&1024)!==0&&t!==null)t.return=r,Ts=t;else for(;Ts!==null;){switch(r=Ts,p=r.alternate,t=r.flags,r.tag){case 0:break;case 11:case 15:break;case 1:if((t&1024)!==0&&p!==null){t=void 0,o=r,m=p.memoizedProps,p=p.memoizedState,u=o.stateNode;try{var dt=io(o.type,m,o.elementType===o.type);t=u.getSnapshotBeforeUpdate(dt,p),u.__reactInternalSnapshotBeforeUpdate=t}catch(it){Gt(o,o.return,it)}}break;case 3:if((t&1024)!==0){if(t=r.stateNode.containerInfo,o=t.nodeType,o===9)am(t);else if(o===1)switch(t.nodeName){case"HEAD":case"HTML":case"BODY":am(t);break;default:t.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((t&1024)!==0)throw Error(a(163))}if(t=r.sibling,t!==null){t.return=r.return,Ts=t;break}Ts=r.return}}function gy(t,r,o){var u=o.flags;switch(o.tag){case 0:case 11:case 15:oa(t,o),u&4&&oc(5,o);break;case 1:if(oa(t,o),u&4)if(t=o.stateNode,r===null)try{t.componentDidMount()}catch(S){Gt(o,o.return,S)}else{var m=io(o.type,r.memoizedProps);r=r.memoizedState;try{t.componentDidUpdate(m,r,t.__reactInternalSnapshotBeforeUpdate)}catch(S){Gt(o,o.return,S)}}u&64&&cy(o),u&512&&lc(o,o.return);break;case 3:if(oa(t,o),u&64&&(t=o.updateQueue,t!==null)){if(r=null,o.child!==null)switch(o.child.tag){case 27:case 5:r=o.child.stateNode;break;case 1:r=o.child.stateNode}try{Xp(t,r)}catch(S){Gt(o,o.return,S)}}break;case 27:r===null&&u&4&&fy(o);case 26:case 5:oa(t,o),r===null&&u&4&&dy(o),u&512&&lc(o,o.return);break;case 12:oa(t,o);break;case 13:oa(t,o),u&4&&xy(t,o),u&64&&(t=o.memoizedState,t!==null&&(t=t.dehydrated,t!==null&&(o=mN.bind(null,o),DN(t,o))));break;case 22:if(u=o.memoizedState!==null||Ii,!u){r=r!==null&&r.memoizedState!==null||ds,m=Ii;var p=ds;Ii=u,(ds=r)&&!p?la(t,o,(o.subtreeFlags&8772)!==0):oa(t,o),Ii=m,ds=p}break;case 30:break;default:oa(t,o)}}function py(t){var r=t.alternate;r!==null&&(t.alternate=null,py(r)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(r=t.stateNode,r!==null&&di(r)),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}var Jt=null,cn=!1;function Ri(t,r,o){for(o=o.child;o!==null;)yy(t,r,o),o=o.sibling}function yy(t,r,o){if(vs&&typeof vs.onCommitFiberUnmount=="function")try{vs.onCommitFiberUnmount(Un,o)}catch(p){}switch(o.tag){case 26:ds||Hr(o,r),Ri(t,r,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:ds||Hr(o,r);var u=Jt,m=cn;ma(o.type)&&(Jt=o.stateNode,cn=!1),Ri(t,r,o),yc(o.stateNode),Jt=u,cn=m;break;case 5:ds||Hr(o,r);case 6:if(u=Jt,m=cn,Jt=null,Ri(t,r,o),Jt=u,cn=m,Jt!==null)if(cn)try{(Jt.nodeType===9?Jt.body:Jt.nodeName==="HTML"?Jt.ownerDocument.body:Jt).removeChild(o.stateNode)}catch(p){Gt(o,r,p)}else try{Jt.removeChild(o.stateNode)}catch(p){Gt(o,r,p)}break;case 18:Jt!==null&&(cn?(t=Jt,ix(t.nodeType===9?t.body:t.nodeName==="HTML"?t.ownerDocument.body:t,o.stateNode),Ec(t)):ix(Jt,o.stateNode));break;case 4:u=Jt,m=cn,Jt=o.stateNode.containerInfo,cn=!0,Ri(t,r,o),Jt=u,cn=m;break;case 0:case 11:case 14:case 15:ds||aa(2,o,r),ds||aa(4,o,r),Ri(t,r,o);break;case 1:ds||(Hr(o,r),u=o.stateNode,typeof u.componentWillUnmount=="function"&&uy(o,r,u)),Ri(t,r,o);break;case 21:Ri(t,r,o);break;case 22:ds=(u=ds)||o.memoizedState!==null,Ri(t,r,o),ds=u;break;default:Ri(t,r,o)}}function xy(t,r){if(r.memoizedState===null&&(t=r.alternate,t!==null&&(t=t.memoizedState,t!==null&&(t=t.dehydrated,t!==null))))try{Ec(t)}catch(o){Gt(r,r.return,o)}}function aN(t){switch(t.tag){case 13:case 19:var r=t.stateNode;return r===null&&(r=t.stateNode=new my),r;case 22:return t=t.stateNode,r=t._retryCache,r===null&&(r=t._retryCache=new my),r;default:throw Error(a(435,t.tag))}}function Of(t,r){var o=aN(t);r.forEach(function(u){var m=gN.bind(null,t,u);o.has(u)||(o.add(u),u.then(m,m))})}function In(t,r){var o=r.deletions;if(o!==null)for(var u=0;u<o.length;u++){var m=o[u],p=t,S=r,P=S;e:for(;P!==null;){switch(P.tag){case 27:if(ma(P.type)){Jt=P.stateNode,cn=!1;break e}break;case 5:Jt=P.stateNode,cn=!1;break e;case 3:case 4:Jt=P.stateNode.containerInfo,cn=!0;break e}P=P.return}if(Jt===null)throw Error(a(160));yy(p,S,m),Jt=null,cn=!1,p=m.alternate,p!==null&&(p.return=null),m.return=null}if(r.subtreeFlags&13878)for(r=r.child;r!==null;)by(r,t),r=r.sibling}var Sr=null;function by(t,r){var o=t.alternate,u=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:In(r,t),Rn(t),u&4&&(aa(3,t,t.return),oc(3,t),aa(5,t,t.return));break;case 1:In(r,t),Rn(t),u&512&&(ds||o===null||Hr(o,o.return)),u&64&&Ii&&(t=t.updateQueue,t!==null&&(u=t.callbacks,u!==null&&(o=t.shared.hiddenCallbacks,t.shared.hiddenCallbacks=o===null?u:o.concat(u))));break;case 26:var m=Sr;if(In(r,t),Rn(t),u&512&&(ds||o===null||Hr(o,o.return)),u&4){var p=o!==null?o.memoizedState:null;if(u=t.memoizedState,o===null)if(u===null)if(t.stateNode===null){e:{u=t.type,o=t.memoizedProps,m=m.ownerDocument||m;t:switch(u){case"title":p=m.getElementsByTagName("title")[0],(!p||p[Pr]||p[ts]||p.namespaceURI==="http://www.w3.org/2000/svg"||p.hasAttribute("itemprop"))&&(p=m.createElement(u),m.head.insertBefore(p,m.querySelector("head > title"))),Ms(p,u,o),p[ts]=t,ss(p),u=p;break e;case"link":var S=fx("link","href",m).get(u+(o.href||""));if(S){for(var P=0;P<S.length;P++)if(p=S[P],p.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&p.getAttribute("rel")===(o.rel==null?null:o.rel)&&p.getAttribute("title")===(o.title==null?null:o.title)&&p.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){S.splice(P,1);break t}}p=m.createElement(u),Ms(p,u,o),m.head.appendChild(p);break;case"meta":if(S=fx("meta","content",m).get(u+(o.content||""))){for(P=0;P<S.length;P++)if(p=S[P],p.getAttribute("content")===(o.content==null?null:""+o.content)&&p.getAttribute("name")===(o.name==null?null:o.name)&&p.getAttribute("property")===(o.property==null?null:o.property)&&p.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&p.getAttribute("charset")===(o.charSet==null?null:o.charSet)){S.splice(P,1);break t}}p=m.createElement(u),Ms(p,u,o),m.head.appendChild(p);break;default:throw Error(a(468,u))}p[ts]=t,ss(p),u=p}t.stateNode=u}else mx(m,t.type,t.stateNode);else t.stateNode=hx(m,u,t.memoizedProps);else p!==u?(p===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):p.count--,u===null?mx(m,t.type,t.stateNode):hx(m,u,t.memoizedProps)):u===null&&t.stateNode!==null&&Cf(t,t.memoizedProps,o.memoizedProps)}break;case 27:In(r,t),Rn(t),u&512&&(ds||o===null||Hr(o,o.return)),o!==null&&u&4&&Cf(t,t.memoizedProps,o.memoizedProps);break;case 5:if(In(r,t),Rn(t),u&512&&(ds||o===null||Hr(o,o.return)),t.flags&32){m=t.stateNode;try{A(m,"")}catch(we){Gt(t,t.return,we)}}u&4&&t.stateNode!=null&&(m=t.memoizedProps,Cf(t,m,o!==null?o.memoizedProps:m)),u&1024&&(Df=!0);break;case 6:if(In(r,t),Rn(t),u&4){if(t.stateNode===null)throw Error(a(162));u=t.memoizedProps,o=t.stateNode;try{o.nodeValue=u}catch(we){Gt(t,t.return,we)}}break;case 3:if(nd=null,m=Sr,Sr=td(r.containerInfo),In(r,t),Sr=m,Rn(t),u&4&&o!==null&&o.memoizedState.isDehydrated)try{Ec(r.containerInfo)}catch(we){Gt(t,t.return,we)}Df&&(Df=!1,vy(t));break;case 4:u=Sr,Sr=td(t.stateNode.containerInfo),In(r,t),Rn(t),Sr=u;break;case 12:In(r,t),Rn(t);break;case 13:In(r,t),Rn(t),t.child.flags&8192&&t.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(Uf=Is()),u&4&&(u=t.updateQueue,u!==null&&(t.updateQueue=null,Of(t,u)));break;case 22:m=t.memoizedState!==null;var Z=o!==null&&o.memoizedState!==null,ye=Ii,Re=ds;if(Ii=ye||m,ds=Re||Z,In(r,t),ds=Re,Ii=ye,Rn(t),u&8192)e:for(r=t.stateNode,r._visibility=m?r._visibility&-2:r._visibility|1,m&&(o===null||Z||Ii||ds||ao(t)),o=null,r=t;;){if(r.tag===5||r.tag===26){if(o===null){Z=o=r;try{if(p=Z.stateNode,m)S=p.style,typeof S.setProperty=="function"?S.setProperty("display","none","important"):S.display="none";else{P=Z.stateNode;var Me=Z.memoizedProps.style,be=Me!=null&&Me.hasOwnProperty("display")?Me.display:null;P.style.display=be==null||typeof be=="boolean"?"":(""+be).trim()}}catch(we){Gt(Z,Z.return,we)}}}else if(r.tag===6){if(o===null){Z=r;try{Z.stateNode.nodeValue=m?"":Z.memoizedProps}catch(we){Gt(Z,Z.return,we)}}}else if((r.tag!==22&&r.tag!==23||r.memoizedState===null||r===t)&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break e;for(;r.sibling===null;){if(r.return===null||r.return===t)break e;o===r&&(o=null),r=r.return}o===r&&(o=null),r.sibling.return=r.return,r=r.sibling}u&4&&(u=t.updateQueue,u!==null&&(o=u.retryQueue,o!==null&&(u.retryQueue=null,Of(t,o))));break;case 19:In(r,t),Rn(t),u&4&&(u=t.updateQueue,u!==null&&(t.updateQueue=null,Of(t,u)));break;case 30:break;case 21:break;default:In(r,t),Rn(t)}}function Rn(t){var r=t.flags;if(r&2){try{for(var o,u=t.return;u!==null;){if(hy(u)){o=u;break}u=u.return}if(o==null)throw Error(a(160));switch(o.tag){case 27:var m=o.stateNode,p=If(t);Fu(t,p,m);break;case 5:var S=o.stateNode;o.flags&32&&(A(S,""),o.flags&=-33);var P=If(t);Fu(t,P,S);break;case 3:case 4:var Z=o.stateNode.containerInfo,ye=If(t);Rf(t,ye,Z);break;default:throw Error(a(161))}}catch(Re){Gt(t,t.return,Re)}t.flags&=-3}r&4096&&(t.flags&=-4097)}function vy(t){if(t.subtreeFlags&1024)for(t=t.child;t!==null;){var r=t;vy(r),r.tag===5&&r.flags&1024&&r.stateNode.reset(),t=t.sibling}}function oa(t,r){if(r.subtreeFlags&8772)for(r=r.child;r!==null;)gy(t,r.alternate,r),r=r.sibling}function ao(t){for(t=t.child;t!==null;){var r=t;switch(r.tag){case 0:case 11:case 14:case 15:aa(4,r,r.return),ao(r);break;case 1:Hr(r,r.return);var o=r.stateNode;typeof o.componentWillUnmount=="function"&&uy(r,r.return,o),ao(r);break;case 27:yc(r.stateNode);case 26:case 5:Hr(r,r.return),ao(r);break;case 22:r.memoizedState===null&&ao(r);break;case 30:ao(r);break;default:ao(r)}t=t.sibling}}function la(t,r,o){for(o=o&&(r.subtreeFlags&8772)!==0,r=r.child;r!==null;){var u=r.alternate,m=t,p=r,S=p.flags;switch(p.tag){case 0:case 11:case 15:la(m,p,o),oc(4,p);break;case 1:if(la(m,p,o),u=p,m=u.stateNode,typeof m.componentDidMount=="function")try{m.componentDidMount()}catch(ye){Gt(u,u.return,ye)}if(u=p,m=u.updateQueue,m!==null){var P=u.stateNode;try{var Z=m.shared.hiddenCallbacks;if(Z!==null)for(m.shared.hiddenCallbacks=null,m=0;m<Z.length;m++)Yp(Z[m],P)}catch(ye){Gt(u,u.return,ye)}}o&&S&64&&cy(p),lc(p,p.return);break;case 27:fy(p);case 26:case 5:la(m,p,o),o&&u===null&&S&4&&dy(p),lc(p,p.return);break;case 12:la(m,p,o);break;case 13:la(m,p,o),o&&S&4&&xy(m,p);break;case 22:p.memoizedState===null&&la(m,p,o),lc(p,p.return);break;case 30:break;default:la(m,p,o)}r=r.sibling}}function kf(t,r){var o=null;t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(o=t.memoizedState.cachePool.pool),t=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(t=r.memoizedState.cachePool.pool),t!==o&&(t!=null&&t.refCount++,o!=null&&Ql(o))}function Mf(t,r){t=null,r.alternate!==null&&(t=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==t&&(r.refCount++,t!=null&&Ql(t))}function Gr(t,r,o,u){if(r.subtreeFlags&10256)for(r=r.child;r!==null;)_y(t,r,o,u),r=r.sibling}function _y(t,r,o,u){var m=r.flags;switch(r.tag){case 0:case 11:case 15:Gr(t,r,o,u),m&2048&&oc(9,r);break;case 1:Gr(t,r,o,u);break;case 3:Gr(t,r,o,u),m&2048&&(t=null,r.alternate!==null&&(t=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==t&&(r.refCount++,t!=null&&Ql(t)));break;case 12:if(m&2048){Gr(t,r,o,u),t=r.stateNode;try{var p=r.memoizedProps,S=p.id,P=p.onPostCommit;typeof P=="function"&&P(S,r.alternate===null?"mount":"update",t.passiveEffectDuration,-0)}catch(Z){Gt(r,r.return,Z)}}else Gr(t,r,o,u);break;case 13:Gr(t,r,o,u);break;case 23:break;case 22:p=r.stateNode,S=r.alternate,r.memoizedState!==null?p._visibility&2?Gr(t,r,o,u):cc(t,r):p._visibility&2?Gr(t,r,o,u):(p._visibility|=2,Yo(t,r,o,u,(r.subtreeFlags&10256)!==0)),m&2048&&kf(S,r);break;case 24:Gr(t,r,o,u),m&2048&&Mf(r.alternate,r);break;default:Gr(t,r,o,u)}}function Yo(t,r,o,u,m){for(m=m&&(r.subtreeFlags&10256)!==0,r=r.child;r!==null;){var p=t,S=r,P=o,Z=u,ye=S.flags;switch(S.tag){case 0:case 11:case 15:Yo(p,S,P,Z,m),oc(8,S);break;case 23:break;case 22:var Re=S.stateNode;S.memoizedState!==null?Re._visibility&2?Yo(p,S,P,Z,m):cc(p,S):(Re._visibility|=2,Yo(p,S,P,Z,m)),m&&ye&2048&&kf(S.alternate,S);break;case 24:Yo(p,S,P,Z,m),m&&ye&2048&&Mf(S.alternate,S);break;default:Yo(p,S,P,Z,m)}r=r.sibling}}function cc(t,r){if(r.subtreeFlags&10256)for(r=r.child;r!==null;){var o=t,u=r,m=u.flags;switch(u.tag){case 22:cc(o,u),m&2048&&kf(u.alternate,u);break;case 24:cc(o,u),m&2048&&Mf(u.alternate,u);break;default:cc(o,u)}r=r.sibling}}var uc=8192;function Xo(t){if(t.subtreeFlags&uc)for(t=t.child;t!==null;)wy(t),t=t.sibling}function wy(t){switch(t.tag){case 26:Xo(t),t.flags&uc&&t.memoizedState!==null&&GN(Sr,t.memoizedState,t.memoizedProps);break;case 5:Xo(t);break;case 3:case 4:var r=Sr;Sr=td(t.stateNode.containerInfo),Xo(t),Sr=r;break;case 22:t.memoizedState===null&&(r=t.alternate,r!==null&&r.memoizedState!==null?(r=uc,uc=16777216,Xo(t),uc=r):Xo(t));break;default:Xo(t)}}function Ny(t){var r=t.alternate;if(r!==null&&(t=r.child,t!==null)){r.child=null;do r=t.sibling,t.sibling=null,t=r;while(t!==null)}}function dc(t){var r=t.deletions;if((t.flags&16)!==0){if(r!==null)for(var o=0;o<r.length;o++){var u=r[o];Ts=u,Ey(u,t)}Ny(t)}if(t.subtreeFlags&10256)for(t=t.child;t!==null;)Sy(t),t=t.sibling}function Sy(t){switch(t.tag){case 0:case 11:case 15:dc(t),t.flags&2048&&aa(9,t,t.return);break;case 3:dc(t);break;case 12:dc(t);break;case 22:var r=t.stateNode;t.memoizedState!==null&&r._visibility&2&&(t.return===null||t.return.tag!==13)?(r._visibility&=-3,qu(t)):dc(t);break;default:dc(t)}}function qu(t){var r=t.deletions;if((t.flags&16)!==0){if(r!==null)for(var o=0;o<r.length;o++){var u=r[o];Ts=u,Ey(u,t)}Ny(t)}for(t=t.child;t!==null;){switch(r=t,r.tag){case 0:case 11:case 15:aa(8,r,r.return),qu(r);break;case 22:o=r.stateNode,o._visibility&2&&(o._visibility&=-3,qu(r));break;default:qu(r)}t=t.sibling}}function Ey(t,r){for(;Ts!==null;){var o=Ts;switch(o.tag){case 0:case 11:case 15:aa(8,o,r);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var u=o.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:Ql(o.memoizedState.cache)}if(u=o.child,u!==null)u.return=o,Ts=u;else e:for(o=t;Ts!==null;){u=Ts;var m=u.sibling,p=u.return;if(py(u),u===o){Ts=null;break e}if(m!==null){m.return=p,Ts=m;break e}Ts=p}}}var oN={getCacheForType:function(t){var r=zs(Ns),o=r.data.get(t);return o===void 0&&(o=t(),r.data.set(t,o)),o}},lN=typeof WeakMap=="function"?WeakMap:Map,Lt=0,Qt=null,wt=null,Tt=0,Vt=0,Dn=null,ca=!1,Wo=!1,Pf=!1,Di=0,as=0,ua=0,oo=0,Lf=0,Zn=0,Jo=0,hc=null,un=null,Vf=!1,Uf=0,Hu=1/0,Gu=null,da=null,ks=0,ha=null,Zo=null,el=0,Bf=0,zf=null,jy=null,fc=0,Ff=null;function On(){if((Lt&2)!==0&&Tt!==0)return Tt&-Tt;if(Ae.T!==null){var t=zo;return t!==0?t:Yf()}return Ks()}function Ty(){Zn===0&&(Zn=(Tt&536870912)===0||kt?Fa():536870912);var t=Jn.current;return t!==null&&(t.flags|=32),Zn}function kn(t,r,o){(t===Qt&&(Vt===2||Vt===9)||t.cancelPendingCommit!==null)&&(tl(t,0),fa(t,Tt,Zn,!1)),es(t,o),((Lt&2)===0||t!==Qt)&&(t===Qt&&((Lt&2)===0&&(oo|=o),as===4&&fa(t,Tt,Zn,!1)),$r(t))}function Ay(t,r,o){if((Lt&6)!==0)throw Error(a(327));var u=!o&&(r&124)===0&&(r&t.expiredLanes)===0||Bn(t,r),m=u?dN(t,r):Gf(t,r,!0),p=u;do{if(m===0){Wo&&!u&&fa(t,r,0,!1);break}else{if(o=t.current.alternate,p&&!cN(o)){m=Gf(t,r,!1),p=!1;continue}if(m===2){if(p=r,t.errorRecoveryDisabledLanes&p)var S=0;else S=t.pendingLanes&-536870913,S=S!==0?S:S&536870912?536870912:0;if(S!==0){r=S;e:{var P=t;m=hc;var Z=P.current.memoizedState.isDehydrated;if(Z&&(tl(P,S).flags|=256),S=Gf(P,S,!1),S!==2){if(Pf&&!Z){P.errorRecoveryDisabledLanes|=p,oo|=p,m=4;break e}p=un,un=m,p!==null&&(un===null?un=p:un.push.apply(un,p))}m=S}if(p=!1,m!==2)continue}}if(m===1){tl(t,0),fa(t,r,0,!0);break}e:{switch(u=t,p=m,p){case 0:case 1:throw Error(a(345));case 4:if((r&4194048)!==r)break;case 6:fa(u,r,Zn,!ca);break e;case 2:un=null;break;case 3:case 5:break;default:throw Error(a(329))}if((r&62914560)===r&&(m=Uf+300-Is(),10<m)){if(fa(u,r,Zn,!ca),Qs(u,0,!0)!==0)break e;u.timeoutHandle=nx(Cy.bind(null,u,o,un,Gu,Vf,r,Zn,oo,Jo,ca,p,2,-0,0),m);break e}Cy(u,o,un,Gu,Vf,r,Zn,oo,Jo,ca,p,0,-0,0)}}break}while(!0);$r(t)}function Cy(t,r,o,u,m,p,S,P,Z,ye,Re,Me,be,we){if(t.timeoutHandle=-1,Me=r.subtreeFlags,(Me&8192||(Me&16785408)===16785408)&&(vc={stylesheets:null,count:0,unsuspend:HN},wy(r),Me=$N(),Me!==null)){t.cancelPendingCommit=Me(Py.bind(null,t,r,p,o,u,m,S,P,Z,Re,1,be,we)),fa(t,p,S,!ye);return}Py(t,r,p,o,u,m,S,P,Z)}function cN(t){for(var r=t;;){var o=r.tag;if((o===0||o===11||o===15)&&r.flags&16384&&(o=r.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var u=0;u<o.length;u++){var m=o[u],p=m.getSnapshot;m=m.value;try{if(!An(p(),m))return!1}catch(S){return!1}}if(o=r.child,r.subtreeFlags&16384&&o!==null)o.return=r,r=o;else{if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function fa(t,r,o,u){r&=~Lf,r&=~oo,t.suspendedLanes|=r,t.pingedLanes&=~r,u&&(t.warmLanes|=r),u=t.expirationTimes;for(var m=r;0<m;){var p=31-Rs(m),S=1<<p;u[p]=-1,m&=~S}o!==0&&cr(t,o,r)}function $u(){return(Lt&6)===0?(mc(0),!1):!0}function qf(){if(wt!==null){if(Vt===0)var t=wt.return;else t=wt,Si=to=null,af(t),Qo=null,rc=0,t=wt;for(;t!==null;)ly(t.alternate,t),t=t.return;wt=null}}function tl(t,r){var o=t.timeoutHandle;o!==-1&&(t.timeoutHandle=-1,TN(o)),o=t.cancelPendingCommit,o!==null&&(t.cancelPendingCommit=null,o()),qf(),Qt=t,wt=o=_i(t.current,null),Tt=r,Vt=0,Dn=null,ca=!1,Wo=Bn(t,r),Pf=!1,Jo=Zn=Lf=oo=ua=as=0,un=hc=null,Vf=!1,(r&8)!==0&&(r|=r&32);var u=t.entangledLanes;if(u!==0)for(t=t.entanglements,u&=r;0<u;){var m=31-Rs(u),p=1<<m;r|=t[m],u&=~p}return Di=r,mu(),o}function Iy(t,r){vt=null,Ae.H=Ou,r===Yl||r===Nu?(r=Qp(),Vt=3):r===Hp?(r=Qp(),Vt=4):Vt=r===K0?8:r!==null&&typeof r=="object"&&typeof r.then=="function"?6:1,Dn=r,wt===null&&(as=1,Vu(t,Kn(r,t.current)))}function Ry(){var t=Ae.H;return Ae.H=Ou,t===null?Ou:t}function Dy(){var t=Ae.A;return Ae.A=oN,t}function Hf(){as=4,ca||(Tt&4194048)!==Tt&&Jn.current!==null||(Wo=!0),(ua&134217727)===0&&(oo&134217727)===0||Qt===null||fa(Qt,Tt,Zn,!1)}function Gf(t,r,o){var u=Lt;Lt|=2;var m=Ry(),p=Dy();(Qt!==t||Tt!==r)&&(Gu=null,tl(t,r)),r=!1;var S=as;e:do try{if(Vt!==0&&wt!==null){var P=wt,Z=Dn;switch(Vt){case 8:qf(),S=6;break e;case 3:case 2:case 9:case 6:Jn.current===null&&(r=!0);var ye=Vt;if(Vt=0,Dn=null,sl(t,P,Z,ye),o&&Wo){S=0;break e}break;default:ye=Vt,Vt=0,Dn=null,sl(t,P,Z,ye)}}uN(),S=as;break}catch(Re){Iy(t,Re)}while(!0);return r&&t.shellSuspendCounter++,Si=to=null,Lt=u,Ae.H=m,Ae.A=p,wt===null&&(Qt=null,Tt=0,mu()),S}function uN(){for(;wt!==null;)Oy(wt)}function dN(t,r){var o=Lt;Lt|=2;var u=Ry(),m=Dy();Qt!==t||Tt!==r?(Gu=null,Hu=Is()+500,tl(t,r)):Wo=Bn(t,r);e:do try{if(Vt!==0&&wt!==null){r=wt;var p=Dn;t:switch(Vt){case 1:Vt=0,Dn=null,sl(t,r,p,1);break;case 2:case 9:if(Gp(p)){Vt=0,Dn=null,ky(r);break}r=function(){Vt!==2&&Vt!==9||Qt!==t||(Vt=7),$r(t)},p.then(r,r);break e;case 3:Vt=7;break e;case 4:Vt=5;break e;case 7:Gp(p)?(Vt=0,Dn=null,ky(r)):(Vt=0,Dn=null,sl(t,r,p,7));break;case 5:var S=null;switch(wt.tag){case 26:S=wt.memoizedState;case 5:case 27:var P=wt;if(!S||gx(S)){Vt=0,Dn=null;var Z=P.sibling;if(Z!==null)wt=Z;else{var ye=P.return;ye!==null?(wt=ye,Qu(ye)):wt=null}break t}}Vt=0,Dn=null,sl(t,r,p,5);break;case 6:Vt=0,Dn=null,sl(t,r,p,6);break;case 8:qf(),as=6;break e;default:throw Error(a(462))}}hN();break}catch(Re){Iy(t,Re)}while(!0);return Si=to=null,Ae.H=u,Ae.A=m,Lt=o,wt!==null?0:(Qt=null,Tt=0,mu(),as)}function hN(){for(;wt!==null&&!Ml();)Oy(wt)}function Oy(t){var r=ay(t.alternate,t,Di);t.memoizedProps=t.pendingProps,r===null?Qu(t):wt=r}function ky(t){var r=t,o=r.alternate;switch(r.tag){case 15:case 0:r=ey(o,r,r.pendingProps,r.type,void 0,Tt);break;case 11:r=ey(o,r,r.pendingProps,r.type.render,r.ref,Tt);break;case 5:af(r);default:ly(o,r),r=wt=Mp(r,Di),r=ay(o,r,Di)}t.memoizedProps=t.pendingProps,r===null?Qu(t):wt=r}function sl(t,r,o,u){Si=to=null,af(r),Qo=null,rc=0;var m=r.return;try{if(tN(t,m,r,o,Tt)){as=1,Vu(t,Kn(o,t.current)),wt=null;return}}catch(p){if(m!==null)throw wt=m,p;as=1,Vu(t,Kn(o,t.current)),wt=null;return}r.flags&32768?(kt||u===1?t=!0:Wo||(Tt&536870912)!==0?t=!1:(ca=t=!0,(u===2||u===9||u===3||u===6)&&(u=Jn.current,u!==null&&u.tag===13&&(u.flags|=16384))),My(r,t)):Qu(r)}function Qu(t){var r=t;do{if((r.flags&32768)!==0){My(r,ca);return}t=r.return;var o=nN(r.alternate,r,Di);if(o!==null){wt=o;return}if(r=r.sibling,r!==null){wt=r;return}wt=r=t}while(r!==null);as===0&&(as=5)}function My(t,r){do{var o=rN(t.alternate,t);if(o!==null){o.flags&=32767,wt=o;return}if(o=t.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!r&&(t=t.sibling,t!==null)){wt=t;return}wt=t=o}while(t!==null);as=6,wt=null}function Py(t,r,o,u,m,p,S,P,Z){t.cancelPendingCommit=null;do Ku();while(ks!==0);if((Lt&6)!==0)throw Error(a(327));if(r!==null){if(r===t.current)throw Error(a(177));if(p=r.lanes|r.childLanes,p|=kh,qa(t,o,p,S,P,Z),t===Qt&&(wt=Qt=null,Tt=0),Zo=r,ha=t,el=o,Bf=p,zf=m,jy=u,(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?(t.callbackNode=null,t.callbackPriority=0,pN(Vn,function(){return zy(),null})):(t.callbackNode=null,t.callbackPriority=0),u=(r.flags&13878)!==0,(r.subtreeFlags&13878)!==0||u){u=Ae.T,Ae.T=null,m=Ue.p,Ue.p=2,S=Lt,Lt|=4;try{iN(t,r,o)}finally{Lt=S,Ue.p=m,Ae.T=u}}ks=1,Ly(),Vy(),Uy()}}function Ly(){if(ks===1){ks=0;var t=ha,r=Zo,o=(r.flags&13878)!==0;if((r.subtreeFlags&13878)!==0||o){o=Ae.T,Ae.T=null;var u=Ue.p;Ue.p=2;var m=Lt;Lt|=4;try{by(r,t);var p=nm,S=Ep(t.containerInfo),P=p.focusedElem,Z=p.selectionRange;if(S!==P&&P&&P.ownerDocument&&Sp(P.ownerDocument.documentElement,P)){if(Z!==null&&Ch(P)){var ye=Z.start,Re=Z.end;if(Re===void 0&&(Re=ye),"selectionStart"in P)P.selectionStart=ye,P.selectionEnd=Math.min(Re,P.value.length);else{var Me=P.ownerDocument||document,be=Me&&Me.defaultView||window;if(be.getSelection){var we=be.getSelection(),dt=P.textContent.length,it=Math.min(Z.start,dt),qt=Z.end===void 0?it:Math.min(Z.end,dt);!we.extend&&it>qt&&(S=qt,qt=it,it=S);var fe=Np(P,it),de=Np(P,qt);if(fe&&de&&(we.rangeCount!==1||we.anchorNode!==fe.node||we.anchorOffset!==fe.offset||we.focusNode!==de.node||we.focusOffset!==de.offset)){var pe=Me.createRange();pe.setStart(fe.node,fe.offset),we.removeAllRanges(),it>qt?(we.addRange(pe),we.extend(de.node,de.offset)):(pe.setEnd(de.node,de.offset),we.addRange(pe))}}}}for(Me=[],we=P;we=we.parentNode;)we.nodeType===1&&Me.push({element:we,left:we.scrollLeft,top:we.scrollTop});for(typeof P.focus=="function"&&P.focus(),P=0;P<Me.length;P++){var Oe=Me[P];Oe.element.scrollLeft=Oe.left,Oe.element.scrollTop=Oe.top}}ad=!!sm,nm=sm=null}finally{Lt=m,Ue.p=u,Ae.T=o}}t.current=r,ks=2}}function Vy(){if(ks===2){ks=0;var t=ha,r=Zo,o=(r.flags&8772)!==0;if((r.subtreeFlags&8772)!==0||o){o=Ae.T,Ae.T=null;var u=Ue.p;Ue.p=2;var m=Lt;Lt|=4;try{gy(t,r.alternate,r)}finally{Lt=m,Ue.p=u,Ae.T=o}}ks=3}}function Uy(){if(ks===4||ks===3){ks=0,oi();var t=ha,r=Zo,o=el,u=jy;(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?ks=5:(ks=0,Zo=ha=null,By(t,t.pendingLanes));var m=t.pendingLanes;if(m===0&&(da=null),dr(o),r=r.stateNode,vs&&typeof vs.onCommitFiberRoot=="function")try{vs.onCommitFiberRoot(Un,r,void 0,(r.current.flags&128)===128)}catch(Z){}if(u!==null){r=Ae.T,m=Ue.p,Ue.p=2,Ae.T=null;try{for(var p=t.onRecoverableError,S=0;S<u.length;S++){var P=u[S];p(P.value,{componentStack:P.stack})}}finally{Ae.T=r,Ue.p=m}}(el&3)!==0&&Ku(),$r(t),m=t.pendingLanes,(o&4194090)!==0&&(m&42)!==0?t===Ff?fc++:(fc=0,Ff=t):fc=0,mc(0)}}function By(t,r){(t.pooledCacheLanes&=r)===0&&(r=t.pooledCache,r!=null&&(t.pooledCache=null,Ql(r)))}function Ku(t){return Ly(),Vy(),Uy(),zy()}function zy(){if(ks!==5)return!1;var t=ha,r=Bf;Bf=0;var o=dr(el),u=Ae.T,m=Ue.p;try{Ue.p=32>o?32:o,Ae.T=null,o=zf,zf=null;var p=ha,S=el;if(ks=0,Zo=ha=null,el=0,(Lt&6)!==0)throw Error(a(331));var P=Lt;if(Lt|=4,Sy(p.current),_y(p,p.current,S,o),Lt=P,mc(0,!1),vs&&typeof vs.onPostCommitFiberRoot=="function")try{vs.onPostCommitFiberRoot(Un,p)}catch(Z){}return!0}finally{Ue.p=m,Ae.T=u,By(t,r)}}function Fy(t,r,o){r=Kn(o,r),r=vf(t.stateNode,r,2),t=sa(t,r,2),t!==null&&(es(t,2),$r(t))}function Gt(t,r,o){if(t.tag===3)Fy(t,t,o);else for(;r!==null;){if(r.tag===3){Fy(r,t,o);break}else if(r.tag===1){var u=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(da===null||!da.has(u))){t=Kn(o,t),o=$0(2),u=sa(r,o,2),u!==null&&(Q0(o,u,r,t),es(u,2),$r(u));break}}r=r.return}}function $f(t,r,o){var u=t.pingCache;if(u===null){u=t.pingCache=new lN;var m=new Set;u.set(r,m)}else m=u.get(r),m===void 0&&(m=new Set,u.set(r,m));m.has(o)||(Pf=!0,m.add(o),t=fN.bind(null,t,r,o),r.then(t,t))}function fN(t,r,o){var u=t.pingCache;u!==null&&u.delete(r),t.pingedLanes|=t.suspendedLanes&o,t.warmLanes&=~o,Qt===t&&(Tt&o)===o&&(as===4||as===3&&(Tt&62914560)===Tt&&300>Is()-Uf?(Lt&2)===0&&tl(t,0):Lf|=o,Jo===Tt&&(Jo=0)),$r(t)}function qy(t,r){r===0&&(r=zn()),t=Lo(t,r),t!==null&&(es(t,r),$r(t))}function mN(t){var r=t.memoizedState,o=0;r!==null&&(o=r.retryLane),qy(t,o)}function gN(t,r){var o=0;switch(t.tag){case 13:var u=t.stateNode,m=t.memoizedState;m!==null&&(o=m.retryLane);break;case 19:u=t.stateNode;break;case 22:u=t.stateNode._retryCache;break;default:throw Error(a(314))}u!==null&&u.delete(r),qy(t,o)}function pN(t,r){return Ln(t,r)}var Yu=null,nl=null,Qf=!1,Xu=!1,Kf=!1,lo=0;function $r(t){t!==nl&&t.next===null&&(nl===null?Yu=nl=t:nl=nl.next=t),Xu=!0,Qf||(Qf=!0,xN())}function mc(t,r){if(!Kf&&Xu){Kf=!0;do for(var o=!1,u=Yu;u!==null;){if(t!==0){var m=u.pendingLanes;if(m===0)var p=0;else{var S=u.suspendedLanes,P=u.pingedLanes;p=(1<<31-Rs(42|t)+1)-1,p&=m&~(S&~P),p=p&201326741?p&201326741|1:p?p|2:0}p!==0&&(o=!0,Qy(u,p))}else p=Tt,p=Qs(u,u===Qt?p:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),(p&3)===0||Bn(u,p)||(o=!0,Qy(u,p));u=u.next}while(o);Kf=!1}}function yN(){Hy()}function Hy(){Xu=Qf=!1;var t=0;lo!==0&&(jN()&&(t=lo),lo=0);for(var r=Is(),o=null,u=Yu;u!==null;){var m=u.next,p=Gy(u,r);p===0?(u.next=null,o===null?Yu=m:o.next=m,m===null&&(nl=o)):(o=u,(t!==0||(p&3)!==0)&&(Xu=!0)),u=m}mc(t)}function Gy(t,r){for(var o=t.suspendedLanes,u=t.pingedLanes,m=t.expirationTimes,p=t.pendingLanes&-62914561;0<p;){var S=31-Rs(p),P=1<<S,Z=m[S];Z===-1?((P&o)===0||(P&u)!==0)&&(m[S]=li(P,r)):Z<=r&&(t.expiredLanes|=P),p&=~P}if(r=Qt,o=Tt,o=Qs(t,t===r?o:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),u=t.callbackNode,o===0||t===r&&(Vt===2||Vt===9)||t.cancelPendingCommit!==null)return u!==null&&u!==null&&or(u),t.callbackNode=null,t.callbackPriority=0;if((o&3)===0||Bn(t,o)){if(r=o&-o,r===t.callbackPriority)return r;switch(u!==null&&or(u),dr(o)){case 2:case 8:o=ls;break;case 32:o=Vn;break;case 268435456:o=Qi;break;default:o=Vn}return u=$y.bind(null,t),o=Ln(o,u),t.callbackPriority=r,t.callbackNode=o,r}return u!==null&&u!==null&&or(u),t.callbackPriority=2,t.callbackNode=null,2}function $y(t,r){if(ks!==0&&ks!==5)return t.callbackNode=null,t.callbackPriority=0,null;var o=t.callbackNode;if(Ku()&&t.callbackNode!==o)return null;var u=Tt;return u=Qs(t,t===Qt?u:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),u===0?null:(Ay(t,u,r),Gy(t,Is()),t.callbackNode!=null&&t.callbackNode===o?$y.bind(null,t):null)}function Qy(t,r){if(Ku())return null;Ay(t,r,!0)}function xN(){AN(function(){(Lt&6)!==0?Ln(Zt,yN):Hy()})}function Yf(){return lo===0&&(lo=Fa()),lo}function Ky(t){return t==null||typeof t=="symbol"||typeof t=="boolean"?null:typeof t=="function"?t:N(""+t)}function Yy(t,r){var o=r.ownerDocument.createElement("input");return o.name=r.name,o.value=r.value,t.id&&o.setAttribute("form",t.id),r.parentNode.insertBefore(o,r),t=new FormData(t),o.parentNode.removeChild(o),t}function bN(t,r,o,u,m){if(r==="submit"&&o&&o.stateNode===m){var p=Ky((m[_s]||null).action),S=u.submitter;S&&(r=(r=S[_s]||null)?Ky(r.formAction):S.getAttribute("formAction"),r!==null&&(p=r,S=null));var P=new It("action","action",null,u,m);t.push({event:P,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if(lo!==0){var Z=S?Yy(m,S):new FormData(m);gf(o,{pending:!0,data:Z,method:m.method,action:p},null,Z)}}else typeof p=="function"&&(P.preventDefault(),Z=S?Yy(m,S):new FormData(m),gf(o,{pending:!0,data:Z,method:m.method,action:p},p,Z))},currentTarget:m}]})}}for(var Xf=0;Xf<Oh.length;Xf++){var Wf=Oh[Xf],vN=Wf.toLowerCase(),_N=Wf[0].toUpperCase()+Wf.slice(1);Nr(vN,"on"+_N)}Nr(Ap,"onAnimationEnd"),Nr(Cp,"onAnimationIteration"),Nr(Ip,"onAnimationStart"),Nr("dblclick","onDoubleClick"),Nr("focusin","onFocus"),Nr("focusout","onBlur"),Nr(V1,"onTransitionRun"),Nr(U1,"onTransitionStart"),Nr(B1,"onTransitionCancel"),Nr(Rp,"onTransitionEnd"),wn("onMouseEnter",["mouseout","mouseover"]),wn("onMouseLeave",["mouseout","mouseover"]),wn("onPointerEnter",["pointerout","pointerover"]),wn("onPointerLeave",["pointerout","pointerover"]),Hn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Hn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Hn("onBeforeInput",["compositionend","keypress","textInput","paste"]),Hn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Hn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Hn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var gc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),wN=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(gc));function Xy(t,r){r=(r&4)!==0;for(var o=0;o<t.length;o++){var u=t[o],m=u.event;u=u.listeners;e:{var p=void 0;if(r)for(var S=u.length-1;0<=S;S--){var P=u[S],Z=P.instance,ye=P.currentTarget;if(P=P.listener,Z!==p&&m.isPropagationStopped())break e;p=P,m.currentTarget=ye;try{p(m)}catch(Re){Lu(Re)}m.currentTarget=null,p=Z}else for(S=0;S<u.length;S++){if(P=u[S],Z=P.instance,ye=P.currentTarget,P=P.listener,Z!==p&&m.isPropagationStopped())break e;p=P,m.currentTarget=ye;try{p(m)}catch(Re){Lu(Re)}m.currentTarget=null,p=Z}}}}function Nt(t,r){var o=r[ui];o===void 0&&(o=r[ui]=new Set);var u=t+"__bubble";o.has(u)||(Wy(r,t,2,!1),o.add(u))}function Jf(t,r,o){var u=0;r&&(u|=4),Wy(o,t,u,r)}var Wu="_reactListening"+Math.random().toString(36).slice(2);function Zf(t){if(!t[Wu]){t[Wu]=!0,Oo.forEach(function(o){o!=="selectionchange"&&(wN.has(o)||Jf(o,!1,t),Jf(o,!0,t))});var r=t.nodeType===9?t:t.ownerDocument;r===null||r[Wu]||(r[Wu]=!0,Jf("selectionchange",!1,r))}}function Wy(t,r,o,u){switch(_x(r)){case 2:var m=YN;break;case 8:m=XN;break;default:m=fm}o=m.bind(null,r,o,t),m=void 0,!me||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(m=!0),u?m!==void 0?t.addEventListener(r,o,{capture:!0,passive:m}):t.addEventListener(r,o,!0):m!==void 0?t.addEventListener(r,o,{passive:m}):t.addEventListener(r,o,!1)}function em(t,r,o,u,m){var p=u;if((r&1)===0&&(r&2)===0&&u!==null)e:for(;;){if(u===null)return;var S=u.tag;if(S===3||S===4){var P=u.stateNode.containerInfo;if(P===m)break;if(S===4)for(S=u.return;S!==null;){var Z=S.tag;if((Z===3||Z===4)&&S.stateNode.containerInfo===m)return;S=S.return}for(;P!==null;){if(S=Fn(P),S===null)return;if(Z=S.tag,Z===5||Z===6||Z===26||Z===27){u=p=S;continue e}P=P.parentNode}}u=u.return}Te(function(){var ye=p,Re=q(o),Me=[];e:{var be=Dp.get(t);if(be!==void 0){var we=It,dt=t;switch(t){case"keypress":if(Ce(o)===0)break e;case"keydown":case"keyup":we=br;break;case"focusin":dt="focus",we=En;break;case"focusout":dt="blur",we=En;break;case"beforeblur":case"afterblur":we=En;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":we=Zs;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":we=Sn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":we=y;break;case Ap:case Cp:case Ip:we=bi;break;case Rp:we=g;break;case"scroll":case"scrollend":we=Mt;break;case"wheel":we=w;break;case"copy":case"cut":case"paste":we=xr;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":we=tn;break;case"toggle":case"beforetoggle":we=ne}var it=(r&4)!==0,qt=!it&&(t==="scroll"||t==="scrollend"),fe=it?be!==null?be+"Capture":null:be;it=[];for(var de=ye,pe;de!==null;){var Oe=de;if(pe=Oe.stateNode,Oe=Oe.tag,Oe!==5&&Oe!==26&&Oe!==27||pe===null||fe===null||(Oe=se(de,fe),Oe!=null&&it.push(pc(de,Oe,pe))),qt)break;de=de.return}0<it.length&&(be=new we(be,dt,null,o,Re),Me.push({event:be,listeners:it}))}}if((r&7)===0){e:{if(be=t==="mouseover"||t==="pointerover",we=t==="mouseout"||t==="pointerout",be&&o!==C&&(dt=o.relatedTarget||o.fromElement)&&(Fn(dt)||dt[hr]))break e;if((we||be)&&(be=Re.window===Re?Re:(be=Re.ownerDocument)?be.defaultView||be.parentWindow:window,we?(dt=o.relatedTarget||o.toElement,we=ye,dt=dt?Fn(dt):null,dt!==null&&(qt=d(dt),it=dt.tag,dt!==qt||it!==5&&it!==27&&it!==6)&&(dt=null)):(we=null,dt=ye),we!==dt)){if(it=Zs,Oe="onMouseLeave",fe="onMouseEnter",de="mouse",(t==="pointerout"||t==="pointerover")&&(it=tn,Oe="onPointerLeave",fe="onPointerEnter",de="pointer"),qt=we==null?be:fr(we),pe=dt==null?be:fr(dt),be=new it(Oe,de+"leave",we,o,Re),be.target=qt,be.relatedTarget=pe,Oe=null,Fn(Re)===ye&&(it=new it(fe,de+"enter",dt,o,Re),it.target=pe,it.relatedTarget=qt,Oe=it),qt=Oe,we&&dt)t:{for(it=we,fe=dt,de=0,pe=it;pe;pe=rl(pe))de++;for(pe=0,Oe=fe;Oe;Oe=rl(Oe))pe++;for(;0<de-pe;)it=rl(it),de--;for(;0<pe-de;)fe=rl(fe),pe--;for(;de--;){if(it===fe||fe!==null&&it===fe.alternate)break t;it=rl(it),fe=rl(fe)}it=null}else it=null;we!==null&&Jy(Me,be,we,it,!1),dt!==null&&qt!==null&&Jy(Me,qt,dt,it,!0)}}e:{if(be=ye?fr(ye):window,we=be.nodeName&&be.nodeName.toLowerCase(),we==="select"||we==="input"&&be.type==="file")var Qe=yp;else if(gp(be))if(xp)Qe=M1;else{Qe=O1;var _t=D1}else we=be.nodeName,!we||we.toLowerCase()!=="input"||be.type!=="checkbox"&&be.type!=="radio"?ye&&W(ye.elementType)&&(Qe=yp):Qe=k1;if(Qe&&(Qe=Qe(t,ye))){pp(Me,Qe,o,Re);break e}_t&&_t(t,be,ye),t==="focusout"&&ye&&be.type==="number"&&ye.memoizedProps.value!=null&&k(be,"number",be.value)}switch(_t=ye?fr(ye):window,t){case"focusin":(gp(_t)||_t.contentEditable==="true")&&(ko=_t,Ih=ye,Fl=null);break;case"focusout":Fl=Ih=ko=null;break;case"mousedown":Rh=!0;break;case"contextmenu":case"mouseup":case"dragend":Rh=!1,jp(Me,o,Re);break;case"selectionchange":if(L1)break;case"keydown":case"keyup":jp(Me,o,Re)}var tt;if(Xe)e:{switch(t){case"compositionstart":var ot="onCompositionStart";break e;case"compositionend":ot="onCompositionEnd";break e;case"compositionupdate":ot="onCompositionUpdate";break e}ot=void 0}else wr?vr(t,o)&&(ot="onCompositionEnd"):t==="keydown"&&o.keyCode===229&&(ot="onCompositionStart");ot&&(gt&&o.locale!=="ko"&&(wr||ot!=="onCompositionStart"?ot==="onCompositionEnd"&&wr&&(tt=We()):(je=Re,ve="value"in je?je.value:je.textContent,wr=!0)),_t=Ju(ye,ot),0<_t.length&&(ot=new Wi(ot,t,null,o,Re),Me.push({event:ot,listeners:_t}),tt?ot.data=tt:(tt=_r(o),tt!==null&&(ot.data=tt)))),(tt=st?Vl(t,o):C1(t,o))&&(ot=Ju(ye,"onBeforeInput"),0<ot.length&&(_t=new Wi("onBeforeInput","beforeinput",null,o,Re),Me.push({event:_t,listeners:ot}),_t.data=tt)),bN(Me,t,ye,o,Re)}Xy(Me,r)})}function pc(t,r,o){return{instance:t,listener:r,currentTarget:o}}function Ju(t,r){for(var o=r+"Capture",u=[];t!==null;){var m=t,p=m.stateNode;if(m=m.tag,m!==5&&m!==26&&m!==27||p===null||(m=se(t,o),m!=null&&u.unshift(pc(t,m,p)),m=se(t,r),m!=null&&u.push(pc(t,m,p))),t.tag===3)return u;t=t.return}return[]}function rl(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5&&t.tag!==27);return t||null}function Jy(t,r,o,u,m){for(var p=r._reactName,S=[];o!==null&&o!==u;){var P=o,Z=P.alternate,ye=P.stateNode;if(P=P.tag,Z!==null&&Z===u)break;P!==5&&P!==26&&P!==27||ye===null||(Z=ye,m?(ye=se(o,p),ye!=null&&S.unshift(pc(o,ye,Z))):m||(ye=se(o,p),ye!=null&&S.push(pc(o,ye,Z)))),o=o.return}S.length!==0&&t.push({event:r,listeners:S})}var NN=/\r\n?/g,SN=/\u0000|\uFFFD/g;function Zy(t){return(typeof t=="string"?t:""+t).replace(NN,`
`).replace(SN,"")}function ex(t,r){return r=Zy(r),Zy(t)===r}function Zu(){}function Ft(t,r,o,u,m,p){switch(o){case"children":typeof u=="string"?r==="body"||r==="textarea"&&u===""||A(t,u):(typeof u=="number"||typeof u=="bigint")&&r!=="body"&&A(t,""+u);break;case"className":Lr(t,"class",u);break;case"tabIndex":Lr(t,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":Lr(t,o,u);break;case"style":$(t,u,p);break;case"data":if(r!=="object"){Lr(t,"data",u);break}case"src":case"href":if(u===""&&(r!=="a"||o!=="href")){t.removeAttribute(o);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){t.removeAttribute(o);break}u=N(""+u),t.setAttribute(o,u);break;case"action":case"formAction":if(typeof u=="function"){t.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof p=="function"&&(o==="formAction"?(r!=="input"&&Ft(t,r,"name",m.name,m,null),Ft(t,r,"formEncType",m.formEncType,m,null),Ft(t,r,"formMethod",m.formMethod,m,null),Ft(t,r,"formTarget",m.formTarget,m,null)):(Ft(t,r,"encType",m.encType,m,null),Ft(t,r,"method",m.method,m,null),Ft(t,r,"target",m.target,m,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){t.removeAttribute(o);break}u=N(""+u),t.setAttribute(o,u);break;case"onClick":u!=null&&(t.onclick=Zu);break;case"onScroll":u!=null&&Nt("scroll",t);break;case"onScrollEnd":u!=null&&Nt("scrollend",t);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(a(61));if(o=u.__html,o!=null){if(m.children!=null)throw Error(a(60));t.innerHTML=o}}break;case"multiple":t.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":t.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){t.removeAttribute("xlink:href");break}o=N(""+u),t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?t.setAttribute(o,""+u):t.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?t.setAttribute(o,""):t.removeAttribute(o);break;case"capture":case"download":u===!0?t.setAttribute(o,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?t.setAttribute(o,u):t.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?t.setAttribute(o,u):t.removeAttribute(o);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?t.removeAttribute(o):t.setAttribute(o,u);break;case"popover":Nt("beforetoggle",t),Nt("toggle",t),mi(t,"popover",u);break;case"xlinkActuate":Ys(t,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":Ys(t,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":Ys(t,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":Ys(t,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":Ys(t,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":Ys(t,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":Ys(t,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":Ys(t,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":Ys(t,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":mi(t,"is",u);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=F.get(o)||o,mi(t,o,u))}}function tm(t,r,o,u,m,p){switch(o){case"style":$(t,u,p);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(a(61));if(o=u.__html,o!=null){if(m.children!=null)throw Error(a(60));t.innerHTML=o}}break;case"children":typeof u=="string"?A(t,u):(typeof u=="number"||typeof u=="bigint")&&A(t,""+u);break;case"onScroll":u!=null&&Nt("scroll",t);break;case"onScrollEnd":u!=null&&Nt("scrollend",t);break;case"onClick":u!=null&&(t.onclick=Zu);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!hi.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(m=o.endsWith("Capture"),r=o.slice(2,m?o.length-7:void 0),p=t[_s]||null,p=p!=null?p[o]:null,typeof p=="function"&&t.removeEventListener(r,p,m),typeof u=="function")){typeof p!="function"&&p!==null&&(o in t?t[o]=null:t.hasAttribute(o)&&t.removeAttribute(o)),t.addEventListener(r,u,m);break e}o in t?t[o]=u:u===!0?t.setAttribute(o,""):mi(t,o,u)}}}function Ms(t,r,o){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Nt("error",t),Nt("load",t);var u=!1,m=!1,p;for(p in o)if(o.hasOwnProperty(p)){var S=o[p];if(S!=null)switch(p){case"src":u=!0;break;case"srcSet":m=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,r));default:Ft(t,r,p,S,o,null)}}m&&Ft(t,r,"srcSet",o.srcSet,o,null),u&&Ft(t,r,"src",o.src,o,null);return;case"input":Nt("invalid",t);var P=p=S=m=null,Z=null,ye=null;for(u in o)if(o.hasOwnProperty(u)){var Re=o[u];if(Re!=null)switch(u){case"name":m=Re;break;case"type":S=Re;break;case"checked":Z=Re;break;case"defaultChecked":ye=Re;break;case"value":p=Re;break;case"defaultValue":P=Re;break;case"children":case"dangerouslySetInnerHTML":if(Re!=null)throw Error(a(137,r));break;default:Ft(t,r,u,Re,o,null)}}O(t,p,P,Z,ye,S,m,!1),yr(t);return;case"select":Nt("invalid",t),u=S=p=null;for(m in o)if(o.hasOwnProperty(m)&&(P=o[m],P!=null))switch(m){case"value":p=P;break;case"defaultValue":S=P;break;case"multiple":u=P;default:Ft(t,r,m,P,o,null)}r=p,o=S,t.multiple=!!u,r!=null?I(t,!!u,r,!1):o!=null&&I(t,!!u,o,!0);return;case"textarea":Nt("invalid",t),p=m=u=null;for(S in o)if(o.hasOwnProperty(S)&&(P=o[S],P!=null))switch(S){case"value":u=P;break;case"defaultValue":m=P;break;case"children":p=P;break;case"dangerouslySetInnerHTML":if(P!=null)throw Error(a(91));break;default:Ft(t,r,S,P,o,null)}M(t,u,m,p),yr(t);return;case"option":for(Z in o)if(o.hasOwnProperty(Z)&&(u=o[Z],u!=null))switch(Z){case"selected":t.selected=u&&typeof u!="function"&&typeof u!="symbol";break;default:Ft(t,r,Z,u,o,null)}return;case"dialog":Nt("beforetoggle",t),Nt("toggle",t),Nt("cancel",t),Nt("close",t);break;case"iframe":case"object":Nt("load",t);break;case"video":case"audio":for(u=0;u<gc.length;u++)Nt(gc[u],t);break;case"image":Nt("error",t),Nt("load",t);break;case"details":Nt("toggle",t);break;case"embed":case"source":case"link":Nt("error",t),Nt("load",t);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ye in o)if(o.hasOwnProperty(ye)&&(u=o[ye],u!=null))switch(ye){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,r));default:Ft(t,r,ye,u,o,null)}return;default:if(W(r)){for(Re in o)o.hasOwnProperty(Re)&&(u=o[Re],u!==void 0&&tm(t,r,Re,u,o,void 0));return}}for(P in o)o.hasOwnProperty(P)&&(u=o[P],u!=null&&Ft(t,r,P,u,o,null))}function EN(t,r,o,u){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var m=null,p=null,S=null,P=null,Z=null,ye=null,Re=null;for(we in o){var Me=o[we];if(o.hasOwnProperty(we)&&Me!=null)switch(we){case"checked":break;case"value":break;case"defaultValue":Z=Me;default:u.hasOwnProperty(we)||Ft(t,r,we,null,u,Me)}}for(var be in u){var we=u[be];if(Me=o[be],u.hasOwnProperty(be)&&(we!=null||Me!=null))switch(be){case"type":p=we;break;case"name":m=we;break;case"checked":ye=we;break;case"defaultChecked":Re=we;break;case"value":S=we;break;case"defaultValue":P=we;break;case"children":case"dangerouslySetInnerHTML":if(we!=null)throw Error(a(137,r));break;default:we!==Me&&Ft(t,r,be,we,u,Me)}}T(t,S,P,Z,ye,Re,p,m);return;case"select":we=S=P=be=null;for(p in o)if(Z=o[p],o.hasOwnProperty(p)&&Z!=null)switch(p){case"value":break;case"multiple":we=Z;default:u.hasOwnProperty(p)||Ft(t,r,p,null,u,Z)}for(m in u)if(p=u[m],Z=o[m],u.hasOwnProperty(m)&&(p!=null||Z!=null))switch(m){case"value":be=p;break;case"defaultValue":P=p;break;case"multiple":S=p;default:p!==Z&&Ft(t,r,m,p,u,Z)}r=P,o=S,u=we,be!=null?I(t,!!o,be,!1):!!u!=!!o&&(r!=null?I(t,!!o,r,!0):I(t,!!o,o?[]:"",!1));return;case"textarea":we=be=null;for(P in o)if(m=o[P],o.hasOwnProperty(P)&&m!=null&&!u.hasOwnProperty(P))switch(P){case"value":break;case"children":break;default:Ft(t,r,P,null,u,m)}for(S in u)if(m=u[S],p=o[S],u.hasOwnProperty(S)&&(m!=null||p!=null))switch(S){case"value":be=m;break;case"defaultValue":we=m;break;case"children":break;case"dangerouslySetInnerHTML":if(m!=null)throw Error(a(91));break;default:m!==p&&Ft(t,r,S,m,u,p)}j(t,be,we);return;case"option":for(var dt in o)if(be=o[dt],o.hasOwnProperty(dt)&&be!=null&&!u.hasOwnProperty(dt))switch(dt){case"selected":t.selected=!1;break;default:Ft(t,r,dt,null,u,be)}for(Z in u)if(be=u[Z],we=o[Z],u.hasOwnProperty(Z)&&be!==we&&(be!=null||we!=null))switch(Z){case"selected":t.selected=be&&typeof be!="function"&&typeof be!="symbol";break;default:Ft(t,r,Z,be,u,we)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var it in o)be=o[it],o.hasOwnProperty(it)&&be!=null&&!u.hasOwnProperty(it)&&Ft(t,r,it,null,u,be);for(ye in u)if(be=u[ye],we=o[ye],u.hasOwnProperty(ye)&&be!==we&&(be!=null||we!=null))switch(ye){case"children":case"dangerouslySetInnerHTML":if(be!=null)throw Error(a(137,r));break;default:Ft(t,r,ye,be,u,we)}return;default:if(W(r)){for(var qt in o)be=o[qt],o.hasOwnProperty(qt)&&be!==void 0&&!u.hasOwnProperty(qt)&&tm(t,r,qt,void 0,u,be);for(Re in u)be=u[Re],we=o[Re],!u.hasOwnProperty(Re)||be===we||be===void 0&&we===void 0||tm(t,r,Re,be,u,we);return}}for(var fe in o)be=o[fe],o.hasOwnProperty(fe)&&be!=null&&!u.hasOwnProperty(fe)&&Ft(t,r,fe,null,u,be);for(Me in u)be=u[Me],we=o[Me],!u.hasOwnProperty(Me)||be===we||be==null&&we==null||Ft(t,r,Me,be,u,we)}var sm=null,nm=null;function ed(t){return t.nodeType===9?t:t.ownerDocument}function tx(t){switch(t){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function sx(t,r){if(t===0)switch(r){case"svg":return 1;case"math":return 2;default:return 0}return t===1&&r==="foreignObject"?0:t}function rm(t,r){return t==="textarea"||t==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.children=="bigint"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var im=null;function jN(){var t=window.event;return t&&t.type==="popstate"?t===im?!1:(im=t,!0):(im=null,!1)}var nx=typeof setTimeout=="function"?setTimeout:void 0,TN=typeof clearTimeout=="function"?clearTimeout:void 0,rx=typeof Promise=="function"?Promise:void 0,AN=typeof queueMicrotask=="function"?queueMicrotask:typeof rx!="undefined"?function(t){return rx.resolve(null).then(t).catch(CN)}:nx;function CN(t){setTimeout(function(){throw t})}function ma(t){return t==="head"}function ix(t,r){var o=r,u=0,m=0;do{var p=o.nextSibling;if(t.removeChild(o),p&&p.nodeType===8)if(o=p.data,o==="/$"){if(0<u&&8>u){o=u;var S=t.ownerDocument;if(o&1&&yc(S.documentElement),o&2&&yc(S.body),o&4)for(o=S.head,yc(o),S=o.firstChild;S;){var P=S.nextSibling,Z=S.nodeName;S[Pr]||Z==="SCRIPT"||Z==="STYLE"||Z==="LINK"&&S.rel.toLowerCase()==="stylesheet"||o.removeChild(S),S=P}}if(m===0){t.removeChild(p),Ec(r);return}m--}else o==="$"||o==="$?"||o==="$!"?m++:u=o.charCodeAt(0)-48;else u=0;o=p}while(o);Ec(r)}function am(t){var r=t.firstChild;for(r&&r.nodeType===10&&(r=r.nextSibling);r;){var o=r;switch(r=r.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":am(o),di(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}t.removeChild(o)}}function IN(t,r,o,u){for(;t.nodeType===1;){var m=o;if(t.nodeName.toLowerCase()!==r.toLowerCase()){if(!u&&(t.nodeName!=="INPUT"||t.type!=="hidden"))break}else if(u){if(!t[Pr])switch(r){case"meta":if(!t.hasAttribute("itemprop"))break;return t;case"link":if(p=t.getAttribute("rel"),p==="stylesheet"&&t.hasAttribute("data-precedence"))break;if(p!==m.rel||t.getAttribute("href")!==(m.href==null||m.href===""?null:m.href)||t.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin)||t.getAttribute("title")!==(m.title==null?null:m.title))break;return t;case"style":if(t.hasAttribute("data-precedence"))break;return t;case"script":if(p=t.getAttribute("src"),(p!==(m.src==null?null:m.src)||t.getAttribute("type")!==(m.type==null?null:m.type)||t.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin))&&p&&t.hasAttribute("async")&&!t.hasAttribute("itemprop"))break;return t;default:return t}}else if(r==="input"&&t.type==="hidden"){var p=m.name==null?null:""+m.name;if(m.type==="hidden"&&t.getAttribute("name")===p)return t}else return t;if(t=Er(t.nextSibling),t===null)break}return null}function RN(t,r,o){if(r==="")return null;for(;t.nodeType!==3;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!o||(t=Er(t.nextSibling),t===null))return null;return t}function om(t){return t.data==="$!"||t.data==="$?"&&t.ownerDocument.readyState==="complete"}function DN(t,r){var o=t.ownerDocument;if(t.data!=="$?"||o.readyState==="complete")r();else{var u=function(){r(),o.removeEventListener("DOMContentLoaded",u)};o.addEventListener("DOMContentLoaded",u),t._reactRetry=u}}function Er(t){for(;t!=null;t=t.nextSibling){var r=t.nodeType;if(r===1||r===3)break;if(r===8){if(r=t.data,r==="$"||r==="$!"||r==="$?"||r==="F!"||r==="F")break;if(r==="/$")return null}}return t}var lm=null;function ax(t){t=t.previousSibling;for(var r=0;t;){if(t.nodeType===8){var o=t.data;if(o==="$"||o==="$!"||o==="$?"){if(r===0)return t;r--}else o==="/$"&&r++}t=t.previousSibling}return null}function ox(t,r,o){switch(r=ed(o),t){case"html":if(t=r.documentElement,!t)throw Error(a(452));return t;case"head":if(t=r.head,!t)throw Error(a(453));return t;case"body":if(t=r.body,!t)throw Error(a(454));return t;default:throw Error(a(451))}}function yc(t){for(var r=t.attributes;r.length;)t.removeAttributeNode(r[0]);di(t)}var er=new Map,lx=new Set;function td(t){return typeof t.getRootNode=="function"?t.getRootNode():t.nodeType===9?t:t.ownerDocument}var Oi=Ue.d;Ue.d={f:ON,r:kN,D:MN,C:PN,L:LN,m:VN,X:BN,S:UN,M:zN};function ON(){var t=Oi.f(),r=$u();return t||r}function kN(t){var r=qn(t);r!==null&&r.tag===5&&r.type==="form"?A0(r):Oi.r(t)}var il=typeof document=="undefined"?null:document;function cx(t,r,o){var u=il;if(u&&typeof r=="string"&&r){var m=ee(r);m='link[rel="'+t+'"][href="'+m+'"]',typeof o=="string"&&(m+='[crossorigin="'+o+'"]'),lx.has(m)||(lx.add(m),t={rel:t,crossOrigin:o,href:r},u.querySelector(m)===null&&(r=u.createElement("link"),Ms(r,"link",t),ss(r),u.head.appendChild(r)))}}function MN(t){Oi.D(t),cx("dns-prefetch",t,null)}function PN(t,r){Oi.C(t,r),cx("preconnect",t,r)}function LN(t,r,o){Oi.L(t,r,o);var u=il;if(u&&t&&r){var m='link[rel="preload"][as="'+ee(r)+'"]';r==="image"&&o&&o.imageSrcSet?(m+='[imagesrcset="'+ee(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(m+='[imagesizes="'+ee(o.imageSizes)+'"]')):m+='[href="'+ee(t)+'"]';var p=m;switch(r){case"style":p=al(t);break;case"script":p=ol(t)}er.has(p)||(t=E({rel:"preload",href:r==="image"&&o&&o.imageSrcSet?void 0:t,as:r},o),er.set(p,t),u.querySelector(m)!==null||r==="style"&&u.querySelector(xc(p))||r==="script"&&u.querySelector(bc(p))||(r=u.createElement("link"),Ms(r,"link",t),ss(r),u.head.appendChild(r)))}}function VN(t,r){Oi.m(t,r);var o=il;if(o&&t){var u=r&&typeof r.as=="string"?r.as:"script",m='link[rel="modulepreload"][as="'+ee(u)+'"][href="'+ee(t)+'"]',p=m;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":p=ol(t)}if(!er.has(p)&&(t=E({rel:"modulepreload",href:t},r),er.set(p,t),o.querySelector(m)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(bc(p)))return}u=o.createElement("link"),Ms(u,"link",t),ss(u),o.head.appendChild(u)}}}function UN(t,r,o){Oi.S(t,r,o);var u=il;if(u&&t){var m=mr(u).hoistableStyles,p=al(t);r=r||"default";var S=m.get(p);if(!S){var P={loading:0,preload:null};if(S=u.querySelector(xc(p)))P.loading=5;else{t=E({rel:"stylesheet",href:t,"data-precedence":r},o),(o=er.get(p))&&cm(t,o);var Z=S=u.createElement("link");ss(Z),Ms(Z,"link",t),Z._p=new Promise(function(ye,Re){Z.onload=ye,Z.onerror=Re}),Z.addEventListener("load",function(){P.loading|=1}),Z.addEventListener("error",function(){P.loading|=2}),P.loading|=4,sd(S,r,u)}S={type:"stylesheet",instance:S,count:1,state:P},m.set(p,S)}}}function BN(t,r){Oi.X(t,r);var o=il;if(o&&t){var u=mr(o).hoistableScripts,m=ol(t),p=u.get(m);p||(p=o.querySelector(bc(m)),p||(t=E({src:t,async:!0},r),(r=er.get(m))&&um(t,r),p=o.createElement("script"),ss(p),Ms(p,"link",t),o.head.appendChild(p)),p={type:"script",instance:p,count:1,state:null},u.set(m,p))}}function zN(t,r){Oi.M(t,r);var o=il;if(o&&t){var u=mr(o).hoistableScripts,m=ol(t),p=u.get(m);p||(p=o.querySelector(bc(m)),p||(t=E({src:t,async:!0,type:"module"},r),(r=er.get(m))&&um(t,r),p=o.createElement("script"),ss(p),Ms(p,"link",t),o.head.appendChild(p)),p={type:"script",instance:p,count:1,state:null},u.set(m,p))}}function ux(t,r,o,u){var m=(m=nn.current)?td(m):null;if(!m)throw Error(a(446));switch(t){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(r=al(o.href),o=mr(m).hoistableStyles,u=o.get(r),u||(u={type:"style",instance:null,count:0,state:null},o.set(r,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){t=al(o.href);var p=mr(m).hoistableStyles,S=p.get(t);if(S||(m=m.ownerDocument||m,S={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},p.set(t,S),(p=m.querySelector(xc(t)))&&!p._p&&(S.instance=p,S.state.loading=5),er.has(t)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},er.set(t,o),p||FN(m,t,o,S.state))),r&&u===null)throw Error(a(528,""));return S}if(r&&u!==null)throw Error(a(529,""));return null;case"script":return r=o.async,o=o.src,typeof o=="string"&&r&&typeof r!="function"&&typeof r!="symbol"?(r=ol(o),o=mr(m).hoistableScripts,u=o.get(r),u||(u={type:"script",instance:null,count:0,state:null},o.set(r,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,t))}}function al(t){return'href="'+ee(t)+'"'}function xc(t){return'link[rel="stylesheet"]['+t+"]"}function dx(t){return E({},t,{"data-precedence":t.precedence,precedence:null})}function FN(t,r,o,u){t.querySelector('link[rel="preload"][as="style"]['+r+"]")?u.loading=1:(r=t.createElement("link"),u.preload=r,r.addEventListener("load",function(){return u.loading|=1}),r.addEventListener("error",function(){return u.loading|=2}),Ms(r,"link",o),ss(r),t.head.appendChild(r))}function ol(t){return'[src="'+ee(t)+'"]'}function bc(t){return"script[async]"+t}function hx(t,r,o){if(r.count++,r.instance===null)switch(r.type){case"style":var u=t.querySelector('style[data-href~="'+ee(o.href)+'"]');if(u)return r.instance=u,ss(u),u;var m=E({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return u=(t.ownerDocument||t).createElement("style"),ss(u),Ms(u,"style",m),sd(u,o.precedence,t),r.instance=u;case"stylesheet":m=al(o.href);var p=t.querySelector(xc(m));if(p)return r.state.loading|=4,r.instance=p,ss(p),p;u=dx(o),(m=er.get(m))&&cm(u,m),p=(t.ownerDocument||t).createElement("link"),ss(p);var S=p;return S._p=new Promise(function(P,Z){S.onload=P,S.onerror=Z}),Ms(p,"link",u),r.state.loading|=4,sd(p,o.precedence,t),r.instance=p;case"script":return p=ol(o.src),(m=t.querySelector(bc(p)))?(r.instance=m,ss(m),m):(u=o,(m=er.get(p))&&(u=E({},o),um(u,m)),t=t.ownerDocument||t,m=t.createElement("script"),ss(m),Ms(m,"link",u),t.head.appendChild(m),r.instance=m);case"void":return null;default:throw Error(a(443,r.type))}else r.type==="stylesheet"&&(r.state.loading&4)===0&&(u=r.instance,r.state.loading|=4,sd(u,o.precedence,t));return r.instance}function sd(t,r,o){for(var u=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),m=u.length?u[u.length-1]:null,p=m,S=0;S<u.length;S++){var P=u[S];if(P.dataset.precedence===r)p=P;else if(p!==m)break}p?p.parentNode.insertBefore(t,p.nextSibling):(r=o.nodeType===9?o.head:o,r.insertBefore(t,r.firstChild))}function cm(t,r){t.crossOrigin==null&&(t.crossOrigin=r.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=r.referrerPolicy),t.title==null&&(t.title=r.title)}function um(t,r){t.crossOrigin==null&&(t.crossOrigin=r.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=r.referrerPolicy),t.integrity==null&&(t.integrity=r.integrity)}var nd=null;function fx(t,r,o){if(nd===null){var u=new Map,m=nd=new Map;m.set(o,u)}else m=nd,u=m.get(o),u||(u=new Map,m.set(o,u));if(u.has(t))return u;for(u.set(t,null),o=o.getElementsByTagName(t),m=0;m<o.length;m++){var p=o[m];if(!(p[Pr]||p[ts]||t==="link"&&p.getAttribute("rel")==="stylesheet")&&p.namespaceURI!=="http://www.w3.org/2000/svg"){var S=p.getAttribute(r)||"";S=t+S;var P=u.get(S);P?P.push(p):u.set(S,[p])}}return u}function mx(t,r,o){t=t.ownerDocument||t,t.head.insertBefore(o,r==="title"?t.querySelector("head > title"):null)}function qN(t,r,o){if(o===1||r.itemProp!=null)return!1;switch(t){case"meta":case"title":return!0;case"style":if(typeof r.precedence!="string"||typeof r.href!="string"||r.href==="")break;return!0;case"link":if(typeof r.rel!="string"||typeof r.href!="string"||r.href===""||r.onLoad||r.onError)break;switch(r.rel){case"stylesheet":return t=r.disabled,typeof r.precedence=="string"&&t==null;default:return!0}case"script":if(r.async&&typeof r.async!="function"&&typeof r.async!="symbol"&&!r.onLoad&&!r.onError&&r.src&&typeof r.src=="string")return!0}return!1}function gx(t){return!(t.type==="stylesheet"&&(t.state.loading&3)===0)}var vc=null;function HN(){}function GN(t,r,o){if(vc===null)throw Error(a(475));var u=vc;if(r.type==="stylesheet"&&(typeof o.media!="string"||matchMedia(o.media).matches!==!1)&&(r.state.loading&4)===0){if(r.instance===null){var m=al(o.href),p=t.querySelector(xc(m));if(p){t=p._p,t!==null&&typeof t=="object"&&typeof t.then=="function"&&(u.count++,u=rd.bind(u),t.then(u,u)),r.state.loading|=4,r.instance=p,ss(p);return}p=t.ownerDocument||t,o=dx(o),(m=er.get(m))&&cm(o,m),p=p.createElement("link"),ss(p);var S=p;S._p=new Promise(function(P,Z){S.onload=P,S.onerror=Z}),Ms(p,"link",o),r.instance=p}u.stylesheets===null&&(u.stylesheets=new Map),u.stylesheets.set(r,t),(t=r.state.preload)&&(r.state.loading&3)===0&&(u.count++,r=rd.bind(u),t.addEventListener("load",r),t.addEventListener("error",r))}}function $N(){if(vc===null)throw Error(a(475));var t=vc;return t.stylesheets&&t.count===0&&dm(t,t.stylesheets),0<t.count?function(r){var o=setTimeout(function(){if(t.stylesheets&&dm(t,t.stylesheets),t.unsuspend){var u=t.unsuspend;t.unsuspend=null,u()}},6e4);return t.unsuspend=r,function(){t.unsuspend=null,clearTimeout(o)}}:null}function rd(){if(this.count--,this.count===0){if(this.stylesheets)dm(this,this.stylesheets);else if(this.unsuspend){var t=this.unsuspend;this.unsuspend=null,t()}}}var id=null;function dm(t,r){t.stylesheets=null,t.unsuspend!==null&&(t.count++,id=new Map,r.forEach(QN,t),id=null,rd.call(t))}function QN(t,r){if(!(r.state.loading&4)){var o=id.get(t);if(o)var u=o.get(null);else{o=new Map,id.set(t,o);for(var m=t.querySelectorAll("link[data-precedence],style[data-precedence]"),p=0;p<m.length;p++){var S=m[p];(S.nodeName==="LINK"||S.getAttribute("media")!=="not all")&&(o.set(S.dataset.precedence,S),u=S)}u&&o.set(null,u)}m=r.instance,S=m.getAttribute("data-precedence"),p=o.get(S)||u,p===u&&o.set(null,m),o.set(S,m),this.count++,u=rd.bind(this),m.addEventListener("load",u),m.addEventListener("error",u),p?p.parentNode.insertBefore(m,p.nextSibling):(t=t.nodeType===9?t.head:t,t.insertBefore(m,t.firstChild)),r.state.loading|=4}}var _c={$$typeof:xe,Provider:null,Consumer:null,_currentValue:et,_currentValue2:et,_threadCount:0};function KN(t,r,o,u,m,p,S,P){this.tag=1,this.containerInfo=t,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Yi(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Yi(0),this.hiddenUpdates=Yi(null),this.identifierPrefix=u,this.onUncaughtError=m,this.onCaughtError=p,this.onRecoverableError=S,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=P,this.incompleteTransitions=new Map}function px(t,r,o,u,m,p,S,P,Z,ye,Re,Me){return t=new KN(t,r,o,S,P,Z,ye,Me),r=1,p===!0&&(r|=24),p=Cn(3,null,null,r),t.current=p,p.stateNode=t,r=Gh(),r.refCount++,t.pooledCache=r,r.refCount++,p.memoizedState={element:u,isDehydrated:o,cache:r},Yh(p),t}function yx(t){return t?(t=Vo,t):Vo}function xx(t,r,o,u,m,p){m=yx(m),u.context===null?u.context=m:u.pendingContext=m,u=ta(r),u.payload={element:o},p=p===void 0?null:p,p!==null&&(u.callback=p),o=sa(t,u,r),o!==null&&(kn(o,t,r),Wl(o,t,r))}function bx(t,r){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var o=t.retryLane;t.retryLane=o!==0&&o<r?o:r}}function hm(t,r){bx(t,r),(t=t.alternate)&&bx(t,r)}function vx(t){if(t.tag===13){var r=Lo(t,67108864);r!==null&&kn(r,t,67108864),hm(t,67108864)}}var ad=!0;function YN(t,r,o,u){var m=Ae.T;Ae.T=null;var p=Ue.p;try{Ue.p=2,fm(t,r,o,u)}finally{Ue.p=p,Ae.T=m}}function XN(t,r,o,u){var m=Ae.T;Ae.T=null;var p=Ue.p;try{Ue.p=8,fm(t,r,o,u)}finally{Ue.p=p,Ae.T=m}}function fm(t,r,o,u){if(ad){var m=mm(u);if(m===null)em(t,r,u,od,o),wx(t,u);else if(JN(m,t,r,o,u))u.stopPropagation();else if(wx(t,u),r&4&&-1<WN.indexOf(t)){for(;m!==null;){var p=qn(m);if(p!==null)switch(p.tag){case 3:if(p=p.stateNode,p.current.memoizedState.isDehydrated){var S=vn(p.pendingLanes);if(S!==0){var P=p;for(P.pendingLanes|=2,P.entangledLanes|=2;S;){var Z=1<<31-Rs(S);P.entanglements[1]|=Z,S&=~Z}$r(p),(Lt&6)===0&&(Hu=Is()+500,mc(0))}}break;case 13:P=Lo(p,2),P!==null&&kn(P,p,2),$u(),hm(p,2)}if(p=mm(u),p===null&&em(t,r,u,od,o),p===m)break;m=p}m!==null&&u.stopPropagation()}else em(t,r,u,null,o)}}function mm(t){return t=q(t),gm(t)}var od=null;function gm(t){if(od=null,t=Fn(t),t!==null){var r=d(t);if(r===null)t=null;else{var o=r.tag;if(o===13){if(t=h(r),t!==null)return t;t=null}else if(o===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;t=null}else r!==t&&(t=null)}}return od=t,null}function _x(t){switch(t){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ba()){case Zt:return 2;case ls:return 8;case Vn:case za:return 32;case Qi:return 268435456;default:return 32}default:return 32}}var pm=!1,ga=null,pa=null,ya=null,wc=new Map,Nc=new Map,xa=[],WN="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function wx(t,r){switch(t){case"focusin":case"focusout":ga=null;break;case"dragenter":case"dragleave":pa=null;break;case"mouseover":case"mouseout":ya=null;break;case"pointerover":case"pointerout":wc.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":Nc.delete(r.pointerId)}}function Sc(t,r,o,u,m,p){return t===null||t.nativeEvent!==p?(t={blockedOn:r,domEventName:o,eventSystemFlags:u,nativeEvent:p,targetContainers:[m]},r!==null&&(r=qn(r),r!==null&&vx(r)),t):(t.eventSystemFlags|=u,r=t.targetContainers,m!==null&&r.indexOf(m)===-1&&r.push(m),t)}function JN(t,r,o,u,m){switch(r){case"focusin":return ga=Sc(ga,t,r,o,u,m),!0;case"dragenter":return pa=Sc(pa,t,r,o,u,m),!0;case"mouseover":return ya=Sc(ya,t,r,o,u,m),!0;case"pointerover":var p=m.pointerId;return wc.set(p,Sc(wc.get(p)||null,t,r,o,u,m)),!0;case"gotpointercapture":return p=m.pointerId,Nc.set(p,Sc(Nc.get(p)||null,t,r,o,u,m)),!0}return!1}function Nx(t){var r=Fn(t.target);if(r!==null){var o=d(r);if(o!==null){if(r=o.tag,r===13){if(r=h(o),r!==null){t.blockedOn=r,Ha(t.priority,function(){if(o.tag===13){var u=On();u=ci(u);var m=Lo(o,u);m!==null&&kn(m,o,u),hm(o,u)}});return}}else if(r===3&&o.stateNode.current.memoizedState.isDehydrated){t.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}t.blockedOn=null}function ld(t){if(t.blockedOn!==null)return!1;for(var r=t.targetContainers;0<r.length;){var o=mm(t.nativeEvent);if(o===null){o=t.nativeEvent;var u=new o.constructor(o.type,o);C=u,o.target.dispatchEvent(u),C=null}else return r=qn(o),r!==null&&vx(r),t.blockedOn=o,!1;r.shift()}return!0}function Sx(t,r,o){ld(t)&&o.delete(r)}function ZN(){pm=!1,ga!==null&&ld(ga)&&(ga=null),pa!==null&&ld(pa)&&(pa=null),ya!==null&&ld(ya)&&(ya=null),wc.forEach(Sx),Nc.forEach(Sx)}function cd(t,r){t.blockedOn===r&&(t.blockedOn=null,pm||(pm=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,ZN)))}var ud=null;function Ex(t){ud!==t&&(ud=t,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){ud===t&&(ud=null);for(var r=0;r<t.length;r+=3){var o=t[r],u=t[r+1],m=t[r+2];if(typeof u!="function"){if(gm(u||o)===null)continue;break}var p=qn(o);p!==null&&(t.splice(r,3),r-=3,gf(p,{pending:!0,data:m,method:o.method,action:u},u,m))}}))}function Ec(t){function r(Z){return cd(Z,t)}ga!==null&&cd(ga,t),pa!==null&&cd(pa,t),ya!==null&&cd(ya,t),wc.forEach(r),Nc.forEach(r);for(var o=0;o<xa.length;o++){var u=xa[o];u.blockedOn===t&&(u.blockedOn=null)}for(;0<xa.length&&(o=xa[0],o.blockedOn===null);)Nx(o),o.blockedOn===null&&xa.shift();if(o=(t.ownerDocument||t).$$reactFormReplay,o!=null)for(u=0;u<o.length;u+=3){var m=o[u],p=o[u+1],S=m[_s]||null;if(typeof p=="function")S||Ex(o);else if(S){var P=null;if(p&&p.hasAttribute("formAction")){if(m=p,S=p[_s]||null)P=S.formAction;else if(gm(m)!==null)continue}else P=S.action;typeof P=="function"?o[u+1]=P:(o.splice(u,3),u-=3),Ex(o)}}}function ym(t){this._internalRoot=t}dd.prototype.render=ym.prototype.render=function(t){var r=this._internalRoot;if(r===null)throw Error(a(409));var o=r.current,u=On();xx(o,u,t,r,null,null)},dd.prototype.unmount=ym.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var r=t.containerInfo;xx(t.current,2,null,t,null,null),$u(),r[hr]=null}};function dd(t){this._internalRoot=t}dd.prototype.unstable_scheduleHydration=function(t){if(t){var r=Ks();t={blockedOn:null,target:t,priority:r};for(var o=0;o<xa.length&&r!==0&&r<xa[o].priority;o++);xa.splice(o,0,t),o===0&&Nx(t)}};var jx=e.version;if(jx!=="19.1.1")throw Error(a(527,jx,"19.1.1"));Ue.findDOMNode=function(t){var r=t._reactInternals;if(r===void 0)throw typeof t.render=="function"?Error(a(188)):(t=Object.keys(t).join(","),Error(a(268,t)));return t=b(r),t=t!==null?v(t):null,t=t===null?null:t.stateNode,t};var eS={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:Ae,reconcilerVersion:"19.1.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__!="undefined"){var hd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!hd.isDisabled&&hd.supportsFiber)try{Un=hd.inject(eS),vs=hd}catch(t){}}return Tc.createRoot=function(t,r){if(!l(t))throw Error(a(299));var o=!1,u="",m=F0,p=q0,S=H0,P=null;return r!=null&&(r.unstable_strictMode===!0&&(o=!0),r.identifierPrefix!==void 0&&(u=r.identifierPrefix),r.onUncaughtError!==void 0&&(m=r.onUncaughtError),r.onCaughtError!==void 0&&(p=r.onCaughtError),r.onRecoverableError!==void 0&&(S=r.onRecoverableError),r.unstable_transitionCallbacks!==void 0&&(P=r.unstable_transitionCallbacks)),r=px(t,1,!1,null,null,o,u,m,p,S,P,null),t[hr]=r.current,Zf(t),new ym(r)},Tc.hydrateRoot=function(t,r,o){if(!l(t))throw Error(a(299));var u=!1,m="",p=F0,S=q0,P=H0,Z=null,ye=null;return o!=null&&(o.unstable_strictMode===!0&&(u=!0),o.identifierPrefix!==void 0&&(m=o.identifierPrefix),o.onUncaughtError!==void 0&&(p=o.onUncaughtError),o.onCaughtError!==void 0&&(S=o.onCaughtError),o.onRecoverableError!==void 0&&(P=o.onRecoverableError),o.unstable_transitionCallbacks!==void 0&&(Z=o.unstable_transitionCallbacks),o.formState!==void 0&&(ye=o.formState)),r=px(t,1,!0,r,o!=null?o:null,u,m,p,S,P,Z,ye),r.context=yx(null),o=r.current,u=On(),u=ci(u),m=ta(u),m.callback=null,sa(o,m,u),o=u,r.current.lanes=o,es(r,o),$r(r),t[hr]=r.current,Zf(t),new dd(r)},Tc.version="19.1.1",Tc}var zx;function PS(){if(zx)return bm.exports;zx=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__=="undefined"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),bm.exports=MS(),bm.exports}var bg=PS();const LS=IS(bg);var rt=(n=>(n.Doctor="Doctor",n.Nurse="Nurse",n.PhysicalTherapist="Physical Therapist",n.SocialWorker="Social Worker",n.Driver="Driver",n))(rt||{});const Uv=n=>{if(!n)return{level:"gray",label:"No Data"};const e=new Date(n),a=Math.abs(new Date().getTime()-e.getTime()),d=Math.ceil(a/(1e3*60*60*24))/7;return d>=8?{level:"red",label:"8+ weeks"}:d>=6?{level:"yellow",label:"6-8 weeks"}:{level:"green",label:"< 6 weeks"}},VS={red:"bg-red-100 text-red-800 border-red-300",yellow:"bg-yellow-100 text-yellow-800 border-yellow-300",green:"bg-green-100 text-green-800 border-green-300",gray:"bg-gray-100 text-gray-800 border-gray-300"};var gd={},wm,Fx;function US(){if(Fx)return wm;Fx=1;var n=Object.create,e=Object.defineProperty,s=Object.getOwnPropertyDescriptor,a=Object.getOwnPropertyNames,l=Object.getPrototypeOf,d=Object.prototype.hasOwnProperty,h=(ee,T,O)=>T in ee?e(ee,T,{enumerable:!0,configurable:!0,writable:!0,value:O}):ee[T]=O,f=(ee,T)=>e(ee,"name",{value:T,configurable:!0}),b=(ee,T)=>()=>(ee&&(T=ee(ee=0)),T),v=(ee,T)=>()=>(T||ee((T={exports:{}}).exports,T),T.exports),E=(ee,T)=>{for(var O in T)e(ee,O,{get:T[O],enumerable:!0})},D=(ee,T,O,k)=>{if(T&&typeof T=="object"||typeof T=="function")for(let I of a(T))!d.call(ee,I)&&I!==O&&e(ee,I,{get:()=>T[I],enumerable:!(k=s(T,I))||k.enumerable});return ee},_=(ee,T,O)=>(O=ee!=null?n(l(ee)):{},D(T||!ee||!ee.__esModule?e(O,"default",{value:ee,enumerable:!0}):O,ee)),R=ee=>D(e({},"__esModule",{value:!0}),ee),U=(ee,T,O)=>h(ee,typeof T!="symbol"?T+"":T,O),ie=v(ee=>{G(),ee.byteLength=B,ee.toByteArray=$,ee.fromByteArray=te;var T=[],O=[],k=typeof Uint8Array<"u"?Uint8Array:Array,I="ABCDEFGHIJKLMNO	PQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(j=0,M=I.length;j<M;++j)T[j]=I[j],O[I.charCodeAt(j)]=j;var j,M;O[45]=62,O[95]=63;function A(N){var C=N.length;if(C%4>0)throw new Error("Invalid string. Length must be a multip	le of 4");var q=N.indexOf("=");q===-1&&(q=C);var ae=q===C?0:4-q%4;return[q,ae]}f(A,"getLens");function B(N){var C=A(N),q=C[0],ae=C[1];return(q+ae)*3/4-ae}f(B,"byte	Length");function re(N,C,q){return(C+q)*3/4-q}f(re,"_byteLength");function $(N){var C,q=A(N),ae=q[0],le=q[1],ue=new k(re(N,ae,le)),Ee=0,Te=le>0?ae-4:ae,se;for(se=0;se<Te;se+=4)C=O[N.charCodeAt(se)]<<18|O[N.charCodeAt(se+1)]<<12|O[N.charCodeAt(se+2)]<<6|O[N.charCodeAt(se+3)],ue[Ee++]=C>>16&255,ue[Ee++]=C>>8&255,ue[Ee++]=C&255;return le===2&&(C=O[N.charCodeAt(se)]<<2|O[N.charCodeAt(se+1)]>>4,ue[Ee++]=C&255),le===1&&(C=O[N.charCodeAt(se)]<<10|O[N.charCodeAt(se+1)]<<4|O[N.charCodeAt(se+2)]>>2,ue[Ee++]=C>>8&255,ue[Ee++]=C&255),ue}f($,"toByteArray");function W(N){return T[N>>18&63]+T[N>>12&63]+T[N>>6&63]+T[N&63]}f(W,"tripletToBase64");function F(N,C,q){for(var ae,le=[],ue=C;ue<q;ue+=3)ae=(N[ue]<<16&16711680)+(N[ue+1]<<8&65280)+(N[ue+2]&255),le.push(W(ae));return le.join("")}f(F,"encodeChunk");function te(N){for(var C,q=N.length,ae=q%3,le=[],ue=16383,Ee=0,Te=q-ae;Ee<Te;Ee+=ue)le.push(F(N,Ee,Ee+ue>Te?Te:Ee+ue));return ae===1?(C=N[q-1],le.push(T[C>>2]+T[C<<4&63]+"==")):ae===2&&(C=(N[q-2]<<8)+N[q-1],le.push(T[C>>10]+T[C>>4&63]+T[C<<2&63]+"=")),le.join("")}f(te,"fromByteArray")}),he=v(ee=>{G(),ee.read=function(T,O,k,I,j){var M,A,B=j*8-I-1,re=(1<<B)-1,$=re>>1,W=-7,F=k?j-1:0,te=k?-1:1,N=T[O+F];for(F+=te,M=N&(1<<-W)-1,N>>=-W,W+=B;W>0;M=M*256+T[O+F],F+=te,W-=8);for(A=M&(1<<-W)-1,M>>=-W,W+=I;W>0;A=A*256+T[O+F],F+=te,W-=8);if(M===0)M=1-$;else{if(M===re)return A?NaN:(N?-1:1)*(1/0);A=A+Math.pow(2,I),M=M-$}return(N?-1:1)*A*Math.pow(2,M-I)},ee.write=function(T,O,k,I,j,M){var A,B,re,$=M*8-j-1,W=(1<<$)-1,F=W>>1,te=j===23?Math.pow(2,-24)-Math.pow(2,-77):0,N=I?0:M-1,C=I?1:-1,q=O<0||O===0&&1/O<0?1:0;for(O=Math.abs(O),isNaN(O)||O===1/0?(B=isNaN(O)?1:0,A=W):(A=Math.floor(Math.log(O)/Math.LN2),O*(re=Math.pow(2,-A))<1&&(A--,re*=2),A+F>=1?O+=te/re:O+=te*Math.pow(2,1-F),O*re>=2&&(A++,re/=2),A+F>=W?(B=0,A=W):A+F>=1?(B=(O*re-1)*Math.pow(2,j),A=A+F):(B=O*Math.pow(2,F-1)*Math.pow(2,j),A=0));j>=8;T[k+N]=B&255,N+=C,B/=256,j-=8);for(A=A<<j|B,$+=j;$>0;T[k+N]=A&255,N+=C,A/=256,$-=8);T[k+N-C]|=q*128}}),Se=v(ee=>{G();var T=ie(),O=he(),k=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;ee.Buffer=A,ee.SlowBuffer=le,ee.INSPECT_MAX_BYTES=50;var I=2147483647;ee.kMaxLength=I,A.TYPED_ARRAY_SUPPORT=j(),!A.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) su	pport which is required by `buffer` v5.x. Use `buffer` v4.x if you require old b	rowser support.");function j(){try{let y=new Uint8Array(1),c={foo:f(function(){return 42},"foo")};return Object.setPrototypeOf(c,Uint8Array.prototype),Object.setPrototypeOf(y,c),y.foo()===42}catch(y){return!1}}f(j,"typedArraySupport"),Object.defineProperty(A.prototype,"parent",{enumerable:!0,get:f(function(){if(A.isBuffer(this))return this.buffer},"get")}),Object.defineProperty(A.prototype,"offset",{enumerable:!0,get:f(function(){if(A.isBuffer(this))return this.byteOffset},"get")});function M(y){if(y>I)throw new RangeError('The value "'+y+'" is invalid for option "size"');let c=new Uint8Array(y);return Object.setPrototypeOf(c,A.prototype),c}f(M,"createBuffer");function A(y,c,g){if(typeof y=="number"){if(typeof c=="string")throw new TypeError('The "string" a	rgument must be of type string. Received type number');return W(y)}return B(y,c,g)}f(A,"Buffer"),A.poolSize=8192;function B(y,c,g){if(typeof y=="string")return F(y,c);if(ArrayBuffer.isView(y))return N(y);if(y==null)throw new TypeError("The f	irst argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-l	ike Object. Received type "+typeof y);if(Bs(y,ArrayBuffer)||y&&Bs(y.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(Bs(y,SharedArrayBuffer)||y&&Bs(y.buffer,SharedArrayBuffer)))return C(y,c,g);if(typeof y=="number")throw new TypeError('The "value" argument	 must not be of type number. Received type number');let x=y.valueOf&&y.valueOf();if(x!=null&&x!==y)return A.from(x,c,g);let w=q(y);if(w)return w;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof y[Symbol.toPrimitive]=="function")return A.from(y[Symbol.toPrimitive]("string"),c,g);throw new TypeError("The first argumen	t must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. 	Received type "+typeof y)}f(B,"from"),A.from=function(y,c,g){return B(y,c,g)},Object.setPrototypeOf(A.prototype,Uint8Array.prototype),Object.setPrototypeOf(A,Uint8Array);function re(y){if(typeof y!="number")throw new TypeError('"size" arg	ument must be of type number');if(y<0)throw new RangeError('The value "'+y+'" is	 invalid for option "size"')}f(re,"assertSize");function $(y,c,g){return re(y),y<=0?M(y):c!==void 0?typeof g=="string"?M(y).fill(c,g):M(y).fill(c):M(y)}f($,"alloc"),A.alloc=function(y,c,g){return $(y,c,g)};function W(y){return re(y),M(y<0?0:ae(y)|0)}f(W,"allocUnsafe"),A.allocUnsafe=function(y){return W(y)},A.allocUnsafeSlow=function(y){return W(y)};function F(y,c){if((typeof c!="string"||c==="")&&(c="	utf8"),!A.isEncoding(c))throw new TypeError("Unknown encoding: "+c);let g=ue(y,c)|0,x=M(g),w=x.write(y,c);return w!==g&&(x=x.slice(0,w)),x}f(F,"fromString");function te(y){let c=y.length<0?0:ae(y.length)|0,g=M(c);for(let x=0;x<c;x+=1)g[x]=y[x]&255;return g}f(te,"fromArrayLike");function N(y){if(Bs(y,Uint8Array)){let c=new Uint8Array(y);return C(c.buffer,c.byteOffset,c.byteLength)}return te(y)}f(N,"fromArrayView");function C(y,c,g){if(c<0||y.byteLength<c)throw new RangeError('"offset" is outs	ide of buffer bounds');if(y.byteLength<c+(g||0))throw new RangeError('"length" i	s outside of buffer bounds');let x;return c===void 0&&g===void 0?x=new Uint8Array(y):g===void 0?x=new Uint8Array(y,c):x=new Uint8Array(y,c,g),Object.setPrototypeOf(x,A.prototype),x}f(C,"fromArrayBuffer");function q(y){if(A.isBuffer(y)){let c=ae(y.length)|0,g=M(c);return g.length===0||y.copy(g,0,0,c),g}if(y.length!==void 0)return typeof y.length!="number"||br(y.length)?M(0):te(y);if(y.type==="Buffer"&&Array.isArray(y.data))return te(y.data)}f(q,"fromObject");function ae(y){if(y>=I)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+I.toString(16)+" bytes");return y|0}f(ae,"checked");function le(y){return+y!=y&&(y=0),A.alloc(+y)}f(le,"SlowBuffer"),A.isBuffer=f(function(y){return y!=null&&y._isBuffer===!0&&y!==A.prototype},"isBuffer"),A.compare=f(function(y,c){if(Bs(y,Uint8Array)&&(y=A.from(y,y.offset,y.byteLength)),Bs(c,Uint8Array)&&(c=A.from(c,c.offset,c.byteLength)),!A.isBuffer(y)||!A.isBuffer(c))throw new TypeError('The "buf1", "buf2" arguments	 must be one of type Buffer or Uint8Array');if(y===c)return 0;let g=y.length,x=c.length;for(let w=0,H=Math.min(g,x);w<H;++w)if(y[w]!==c[w]){g=y[w],x=c[w];break}return g<x?-1:x<g?1:0},"compare"),A.isEncoding=f(function(y){switch(String(y).toLowerCase()){case"	hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"	ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},"isEn	coding"),A.concat=f(function(y,c){if(!Array.isArray(y))throw new TypeError('"lis	t" argument must be an Array of Buffers');if(y.length===0)return A.alloc(0);let g;if(c===void 0)for(c=0,g=0;g<y.length;++g)c+=y[g].length;let x=A.allocUnsafe(c),w=0;for(g=0;g<y.length;++g){let H=y[g];if(Bs(H,Uint8Array))w+H.length>x.length?(A.isBuffer(H)||(H=A.from(H)),H.copy(x,w)):Uint8Array.prototype.set.call(x,H,w);else if(A.isBuffer(H))H.copy(x,w);else throw new TypeError('"list" argument must be an Array of Buf	fers');w+=H.length}return x},"concat");function ue(y,c){if(A.isBuffer(y))return y.length;if(ArrayBuffer.isView(y)||Bs(y,ArrayBuffer))return y.byteLength;if(typeof y!="string")throw new TypeError('The "string" argument must be one of type string, 	Buffer, or ArrayBuffer. Received type '+typeof y);let g=y.length,x=arguments.length>2&&arguments[2]===!0;if(!x&&g===0)return 0;let w=!1;for(;;)switch(c){case"ascii":case"	latin1":case"binary":return g;case"utf8":case"utf-8":return vi(y).length;case"uc	s2":case"ucs-2":case"utf16le":case"utf-16le":return g*2;case"hex":return g>>>1;case"	base64":return Ji(y).length;default:if(w)return x?-1:vi(y).length;c=(""+c).toLowerCase(),w=!0}}f(ue,"byteLength"),A.byteLength=ue;function Ee(y,c,g){let x=!1;if((c===void 0||c<0)&&(c=0),c>this.length||((g===void 0||g>this.length)&&(g=this.length),g<=0)||(g>>>=0,c>>>=0,g<=c))return"";for(y||(y="utf8");;)switch(y){case"hex":return It(this,c,g);case"utf8":case"utf-8":return Ce(this,c,g);case"ascii":return Ye(this,c,g);case"latin1":case"binary":return ut(this,c,g);case"base64":return We(this,c,g);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Js(this,c,g);default:if(x)throw new TypeError("Unknown encoding: "+y);y=(y+"").toLowerCase(),x=!0}}f(Ee,"slowToString"),A.prototype._isBuffer=!0;function Te(y,c,g){let x=y[c];y[c]=y[g],y[g]=x}f(Te,"swap"),A.prototype.swap16=f(function(){let y=this.length;if(y%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let c=0;c<y;c+=2)Te(this,c,c+1);return this},"swap16"),A.prototype.swap32=f(function(){let y=this.length;if(y%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bit	s");for(let c=0;c<y;c+=4)Te(this,c,c+3),Te(this,c+1,c+2);return this},"swap32"),A.prototype.swap64=f(function(){let y=this.length;if(y%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let c=0;c<y;c+=8)Te(this,c,c+7),Te(this,c+1,c+6),Te(this,c+2,c+5),Te(this,c+3,c+4);return this},"swap64"),A.prototype.toString=f(function(){let y=this.length;return y===0?"":arguments.length===0?Ce(this,0,y):Ee.apply(this,arguments)},"toString"),A.prototype.toLocaleString=A.prototype.toString,A.prototype.equals=f(function(y){if(!A.isBuffer(y))throw new TypeError("Argument must be a Buffer");return this===y?!0:A.compare(this,y)===0},"equals"),A.prototype.inspect=f(function(){let y="",c=ee.INSPECT_MAX_BYTES;return y=this.toString("hex",0,c).replace(/(.{2})/g,"$1 ").trim(),this.length>c&&(y+=" ... "),"<Buffer "+y+">"},"inspect"),k&&(A.prototype[k]=A.prototype.inspect),A.prototype.compare=f(function(y,c,g,x,w){if(Bs(y,Uint8Array)&&(y=A.from(y,y.offset,y.byteLength)),!A.isBuffer(y))throw new TypeError('The "target" argument must be one of type Buffe	r or Uint8Array. Received type '+typeof y);if(c===void 0&&(c=0),g===void 0&&(g=y?y.length:0),x===void 0&&(x=0),w===void 0&&(w=this.length),c<0||g>y.length||x<0||w>this.length)throw new RangeError("out of range index");if(x>=w&&c>=g)return 0;if(x>=w)return-1;if(c>=g)return 1;if(c>>>=0,g>>>=0,x>>>=0,w>>>=0,this===y)return 0;let H=w-x,ne=g-c,Ve=Math.min(H,ne),Xe=this.slice(x,w),at=y.slice(c,g);for(let st=0;st<Ve;++st)if(Xe[st]!==at[st]){H=Xe[st],ne=at[st];break}return H<ne?-1:ne<H?1:0},"compare");function se(y,c,g,x,w){if(y.length===0)return-1;if(typeof g=="string"?(x=g,g=0):g>2147483647?g=2147483647:g<-2147483648&&(g=-2147483648),g=+g,br(g)&&(g=w?0:y.length-1),g<0&&(g=y.length+g),g>=y.length){if(w)return-1;g=y.length-1}else if(g<0)if(w)g=0;else return-1;if(typeof c=="string"&&(c=A.from(c,x)),A.isBuffer(c))return c.length===0?-1:ge(y,c,g,x,w);if(typeof c=="number")return c=c&255,typeof Uint8Array.prototype.indexOf=="function"?w?Uint8Array.prototype.indexOf.call(y,c,g):Uint8Array.prototype.lastIndexOf.call(y,c,g):ge(y,[c],g,x,w);throw new TypeError("val must be string, number or Buffer")}f(se,"bid	irectionalIndexOf");function ge(y,c,g,x,w){let H=1,ne=y.length,Ve=c.length;if(x!==void 0&&(x=String(x).toLowerCase(),x==="ucs2"||x==="ucs-2"||x==="utf16le"||x==="	utf-16le")){if(y.length<2||c.length<2)return-1;H=2,ne/=2,Ve/=2,g/=2}function Xe(st,gt){return H===1?st[gt]:st.readUInt16BE(gt*H)}f(Xe,"read");let at;if(w){let st=-1;for(at=g;at<ne;at++)if(Xe(y,at)===Xe(c,st===-1?0:at-st)){if(st===-1&&(st=at),at-st+1===Ve)return st*H}else st!==-1&&(at-=at-st),st=-1}else for(g+Ve>ne&&(g=ne-Ve),at=g;at>=0;at--){let st=!0;for(let gt=0;gt<Ve;gt++)if(Xe(y,at+gt)!==Xe(c,gt)){st=!1;break}if(st)return at}return-1}f(ge,"arrayIndexOf"),A.prototype.includes=f(function(y,c,g){return this.indexOf(y,c,g)!==-1},"includes"),A.prototype.indexOf=f(function(y,c,g){return se(this,y,c,g,!0)},"indexOf"),A.prototype.lastIndexOf=f(function(y,c,g){return se(this,y,c,g,!1)},"lastIndexOf");function me(y,c,g,x){g=Number(g)||0;let w=y.length-g;x?(x=Number(x),x>w&&(x=w)):x=w;let H=c.length;x>H/2&&(x=H/2);let ne;for(ne=0;ne<x;++ne){let Ve=parseInt(c.substr(ne*2,2),16);if(br(Ve))return ne;y[g+ne]=Ve}return ne}f(me,"hexWrite");function ce(y,c,g,x){return Qn(vi(c,y.length-g),y,g,x)}f(ce,"utf8Write");function je(y,c,g,x){return Qn($n(c),y,g,x)}f(je,"asciiWrite");function ve(y,c,g,x){return Qn(Ji(c),y,g,x)}f(ve,"base64Write");function $e(y,c,g,x){return Qn($a(c,y.length-g),y,g,x)}f($e,"ucs2Write"),A.prototype.write=f(function(y,c,g,x){if(c===void 0)x="utf8",g=this.length,c=0;else if(g===void 0&&typeof c=="string")x=c,g=this.length,c=0;else if(isFinite(c))c=c>>>0,isFinite(g)?(g=g>>>0,x===void 0&&(x="utf8")):(x=g,g=void 0);else throw new Error("Buffer.wri	te(string, encoding, offset[, length]) is no longer supported");let w=this.length-c;if((g===void 0||g>w)&&(g=w),y.length>0&&(g<0||c<0)||c>this.length)throw new RangeError("Attempt to write outside buffer bounds");x||(x="utf8");let H=!1;for(;;)switch(x){case"	hex":return me(this,y,c,g);case"utf8":case"utf-8":return ce(this,y,c,g);case"asc	ii":case"latin1":case"binary":return je(this,y,c,g);case"base64":return ve(this,y,c,g);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return $e(this,y,c,g);default:if(H)throw new TypeError("Unknown encoding: "+x);x=(""+x).toLowerCase(),H=!0}},"	write"),A.prototype.toJSON=f(function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},"toJSON");function We(y,c,g){return c===0&&g===y.length?T.fromByteArray(y):T.fromByteArray(y.slice(c,g))}f(We,"base64Slice");function Ce(y,c,g){g=Math.min(y.length,g);let x=[],w=c;for(;w<g;){let H=y[w],ne=null,Ve=H>239?4:H>223?3:H>191?2:1;if(w+Ve<=g){let Xe,at,st,gt;switch(Ve){case 1:H<128&&(ne=H);break;case 2:Xe=y[w+1],(Xe&192)===128&&(gt=(H&31)<<6|Xe&63,gt>127&&(ne=gt));break;case 3:Xe=y[w+1],at=y[w+2],(Xe&192)===128&&(at&192)===128&&(gt=(H&15)<<12|(Xe&63)<<6|at&63,gt>2047&&(gt<55296||gt>57343)&&(ne=gt));break;case 4:Xe=y[w+1],at=y[w+2],st=y[w+3],(Xe&192)===128&&(at&192)===128&&(st&192)===128&&(gt=(H&15)<<18|(Xe&63)<<12|(at&63)<<6|st&63,gt>65535&&gt<1114112&&(ne=gt))}}ne===null?(ne=65533,Ve=1):ne>65535&&(ne-=65536,x.push(ne>>>10&1023|55296),ne=56320|ne&1023),x.push(ne),w+=Ve}return Ze(x)}f(Ce,"utf8Slice");var Fe=4096;function Ze(y){let c=y.length;if(c<=Fe)return String.fromCharCode.apply(String,y);let g="",x=0;for(;x<c;)g+=String.fromCharCode.apply(String,y.slice(x,x+=Fe));return g}f(Ze,"d	ecodeCodePointsArray");function Ye(y,c,g){let x="";g=Math.min(y.length,g);for(let w=c;w<g;++w)x+=String.fromCharCode(y[w]&127);return x}f(Ye,"asciiSlice");function ut(y,c,g){let x="";g=Math.min(y.length,g);for(let w=c;w<g;++w)x+=String.fromCharCode(y[w]);return x}f(ut,"latin1Slice");function It(y,c,g){let x=y.length;(!c||c<0)&&(c=0),(!g||g<0||g>x)&&(g=x);let w="";for(let H=c;H<g;++H)w+=Ds[y[H]];return w}f(It,"he	xSlice");function Js(y,c,g){let x=y.slice(c,g),w="";for(let H=0;H<x.length-1;H+=2)w+=String.fromCharCode(x[H]+x[H+1]*256);return w}f(Js,"utf16leSlice"),A.prototype.slice=f(function(y,c){let g=this.length;y=~~y,c=c===void 0?g:~~c,y<0?(y+=g,y<0&&(y=0)):y>g&&(y=g),c<0?(c+=g,c<0&&(c=0)):c>g&&(c=g),c<y&&(c=y);let x=this.subarray(y,c);return Object.setPrototypeOf(x,A.prototype),x},"slice");function Mt(y,c,g){if(y%1!==0||y<0)throw new RangeError("offset is not uint");if(y+c>g)throw new RangeError("Trying to access beyond buffer length")}f(Mt,"checkOffset"),A.prototype.readUintLE=A.prototype.readUIntLE=f(function(y,c,g){y=y>>>0,c=c>>>0,g||Mt(y,c,this.length);let x=this[y],w=1,H=0;for(;++H<c&&(w*=256);)x+=this[y+H]*w;return x},"readUIntLE"),A.prototype.readUintBE=A.prototype.readUIntBE=f(function(y,c,g){y=y>>>0,c=c>>>0,g||Mt(y,c,this.length);let x=this[y+--c],w=1;for(;c>0&&(w*=256);)x+=this[y+--c]*w;return x},"re	adUIntBE"),A.prototype.readUint8=A.prototype.readUInt8=f(function(y,c){return y=y>>>0,c||Mt(y,1,this.length),this[y]},"readUInt8"),A.prototype.readUint16LE=A.prototype.readUInt16LE=f(function(y,c){return y=y>>>0,c||Mt(y,2,this.length),this[y]|this[y+1]<<8},"readUInt16LE"),A.prototype.readUint16BE=A.prototype.readUInt16BE=f(function(y,c){return y=y>>>0,c||Mt(y,2,this.length),this[y]<<8|this[y+1]},"readUInt16BE"),A.prototype.readUint32LE=A.prototype.readUInt32LE=f(function(y,c){return y=y>>>0,c||Mt(y,4,this.length),(this[y]|this[y+1]<<8|this[y+2]<<16)+this[y+3]*16777216},"readUInt32LE"),A.prototype.readUint32BE=A.prototype.readUInt32BE=f(function(y,c){return y=y>>>0,c||Mt(y,4,this.length),this[y]*16777216+(this[y+1]<<16|this[y+2]<<8|this[y+3])},"	readUInt32BE"),A.prototype.readBigUInt64LE=tn(f(function(y){y=y>>>0,jn(y,"offset");let c=this[y],g=this[y+7];(c===void 0||g===void 0)&&xr(y,this.length-8);let x=c+this[++y]*Kt(2,8)+this[++y]*Kt(2,16)+this[++y]*Kt(2,24),w=this[++y]+this[++y]*Kt(2,8)+this[++y]*Kt(2,16)+g*Kt(2,24);return BigInt(x)+(BigInt(w)<<BigInt(32))},"readBigUInt64LE")),A.prototype.readBigUInt64BE=tn(f(function(y){y=y>>>0,jn(y,"offset");let c=this[y],g=this[y+7];(c===void 0||g===void 0)&&xr(y,this.length-8);let x=c*Kt(2,24)+this[++y]*Kt(2,16)+this[++y]*Kt(2,8)+this[++y],w=this[++y]*Kt(2,24)+this[++y]*Kt(2,16)+this[++y]*Kt(2,8)+g;return(BigInt(x)<<BigInt(32))+BigInt(w)},"readBigUInt64BE")),A.prototype.readIntLE=f(function(y,c,g){y=y>>>0,c=c>>>0,g||Mt(y,c,this.length);let x=this[y],w=1,H=0;for(;++H<c&&(w*=256);)x+=this[y+H]*w;return w*=128,x>=w&&(x-=Math.pow(2,8*c)),x},"readIntLE"),A.prototype.readIntBE=f(function(y,c,g){y=y>>>0,c=c>>>0,g||Mt(y,c,this.length);let x=c,w=1,H=this[y+--x];for(;x>0&&(w*=256);)H+=this[y+--x]*w;return w*=128,H>=w&&(H-=Math.pow(2,8*c)),H},"readIntBE"),A.prototype.readInt8=f(function(y,c){return y=y>>>0,c||Mt(y,1,this.length),this[y]&128?(255-this[y]+1)*-1:this[y]},"readInt8"),A.prototype.readInt16LE=f(function(y,c){y=y>>>0,c||Mt(y,2,this.length);let g=this[y]|this[y+1]<<8;return g&32768?g|4294901760:g},"readInt16LE"),A.prototype.readInt16BE=f(function(y,c){y=y>>>0,c||Mt(y,2,this.length);let g=this[y+1]|this[y]<<8;return g&32768?g|4294901760:g},"readInt16BE"),A.prototype.readInt32LE=f(function(y,c){return y=y>>>0,c||Mt(y,4,this.length),this[y]|this[y+1]<<8|this[y+2]<<16|this[y+3]<<24},"readInt32LE"),A.prototype.readInt32BE=f(function(y,c){return y=y>>>0,c||Mt(y,4,this.length),this[y]<<24|this[y+1]<<16|this[y+2]<<8|this[y+3]},"readInt32BE"),A.prototype.readBigInt64LE=tn(f(function(y){y=y>>>0,jn(y,"offset");let c=this[y],g=this[y+7];(c===void 0||g===void 0)&&xr(y,this.length-8);let x=this[y+4]+this[y+5]*Kt(2,8)+this[y+6]*Kt(2,16)+(g<<24);return(BigInt(x)<<BigInt(32))+BigInt(c+this[++y]*Kt(2,8)+this[++y]*Kt(2,16)+this[++y]*Kt(2,24))},"readB	igInt64LE")),A.prototype.readBigInt64BE=tn(f(function(y){y=y>>>0,jn(y,"offset");let c=this[y],g=this[y+7];(c===void 0||g===void 0)&&xr(y,this.length-8);let x=(c<<24)+this[++y]*Kt(2,16)+this[++y]*Kt(2,8)+this[++y];return(BigInt(x)<<BigInt(32))+BigInt(this[++y]*Kt(2,24)+this[++y]*Kt(2,16)+this[++y]*Kt(2,8)+g)},"readBigInt64BE")),A.prototype.readFloatLE=f(function(y,c){return y=y>>>0,c||Mt(y,4,this.length),O.read(this,y,!0,23,4)},"readFloatLE"),A.prototype.readFloatBE=f(function(y,c){return y=y>>>0,c||Mt(y,4,this.length),O.read(this,y,!1,23,4)},"readFloatBE"),A.prototype.readDoubleLE=f(function(y,c){return y=y>>>0,c||Mt(y,8,this.length),O.read(this,y,!0,52,8)},"r	eadDoubleLE"),A.prototype.readDoubleBE=f(function(y,c){return y=y>>>0,c||Mt(y,8,this.length),O.read(this,y,!1,52,8)},"readDoubleBE");function Ot(y,c,g,x,w,H){if(!A.isBuffer(y))throw new TypeError('"buffer" argument must be a Buffer instance');if(c>w||c<H)throw new RangeError('"value" argument is out of bounds');if(g+x>y.length)throw new RangeError("Index out of range")}f(Ot,"checkInt"),A.prototype.writeUintLE=A.prototype.writeUIntLE=f(function(y,c,g,x){if(y=+y,c=c>>>0,g=g>>>0,!x){let ne=Math.pow(2,8*g)-1;Ot(this,y,c,g,ne,0)}let w=1,H=0;for(this[c]=y&255;++H<g&&(w*=256);)this[c+H]=y/w&255;return c+g},"writeUIntLE"),A.prototype.writeUintBE=A.prototype.writeUIntBE=f(function(y,c,g,x){if(y=+y,c=c>>>0,g=g>>>0,!x){let ne=Math.pow(2,8*g)-1;Ot(this,y,c,g,ne,0)}let w=g-1,H=1;for(this[c+w]=y&255;--w>=0&&(H*=256);)this[c+w]=y/H&255;return c+g},"writeUI	ntBE"),A.prototype.writeUint8=A.prototype.writeUInt8=f(function(y,c,g){return y=+y,c=c>>>0,g||Ot(this,y,c,1,255,0),this[c]=y&255,c+1},"writeUInt8"),A.prototype.writeUint16LE=A.prototype.writeUInt16LE=f(function(y,c,g){return y=+y,c=c>>>0,g||Ot(this,y,c,2,65535,0),this[c]=y&255,this[c+1]=y>>>8,c+2},"writeUInt16LE"),A.prototype.writeUint16BE=A.prototype.writeUInt16BE=f(function(y,c,g){return y=+y,c=c>>>0,g||Ot(this,y,c,2,65535,0),this[c]=y>>>8,this[c+1]=y&255,c+2},"writeUInt16BE"),A.prototype.writeUint32LE=A.prototype.writeUInt32LE=f(function(y,c,g){return y=+y,c=c>>>0,g||Ot(this,y,c,4,4294967295,0),this[c+3]=y>>>24,this[c+2]=y>>>16,this[c+1]=y>>>8,this[c]=y&255,c+4},"writeUInt32LE"),A.prototype.writeUint32BE=A.prototype.writeUInt32BE=f(function(y,c,g){return y=+y,c=c>>>0,g||Ot(this,y,c,4,4294967295,0),this[c]=y>>>24,this[c+1]=y>>>16,this[c+2]=y>>>8,this[c+3]=y&255,c+4},"writeUInt32BE");function $t(y,c,g,x,w){bi(c,x,w,y,g,7);let H=Number(c&BigInt(4294967295));y[g++]=H,H=H>>8,y[g++]=H,H=H>>8,y[g++]=H,H=H>>8,y[g++]=H;let ne=Number(c>>BigInt(32)&BigInt(4294967295));return y[g++]=ne,ne=ne>>8,y[g++]=ne,ne=ne>>8,y[g++]=ne,ne=ne>>8,y[g++]=ne,g}f($t,"wrtBigUInt64LE");function cs(y,c,g,x,w){bi(c,x,w,y,g,7);let H=Number(c&BigInt(4294967295));y[g+7]=H,H=H>>8,y[g+6]=H,H=H>>8,y[g+5]=H,H=H>>8,y[g+4]=H;let ne=Number(c>>BigInt(32)&BigInt(4294967295));return y[g+3]=ne,ne=ne>>8,y[g+2]=ne,ne=ne>>8,y[g+1]=ne,ne=ne>>8,y[g]=ne,g+8}f(cs,"wrtBigUInt64BE"),A.prototype.writeBigUInt64LE=tn(f(function(y,c=0){return $t(this,y,c,BigInt(0),BigInt("0xffffffffffffffff"))},"writeBigUInt64LE")),A.prototype.writeBigUInt64BE=tn(f(function(y,c=0){return cs(this,y,c,BigInt(0),BigInt("0xffffffffffffffff"))},"writeBigUInt64BE")),A.prototype.writeIntLE=f(function(y,c,g,x){if(y=+y,c=c>>>0,!x){let Ve=Math.pow(2,8*g-1);Ot(this,y,c,g,Ve-1,-Ve)}let w=0,H=1,ne=0;for(this[c]=y&255;++w<g&&(H*=256);)y<0&&ne===0&&this[c+w-1]!==0&&(ne=1),this[c+w]=(y/H>>0)-ne&255;return c+g},"writeIntL	E"),A.prototype.writeIntBE=f(function(y,c,g,x){if(y=+y,c=c>>>0,!x){let Ve=Math.pow(2,8*g-1);Ot(this,y,c,g,Ve-1,-Ve)}let w=g-1,H=1,ne=0;for(this[c+w]=y&255;--w>=0&&(H*=256);)y<0&&ne===0&&this[c+w+1]!==0&&(ne=1),this[c+w]=(y/H>>0)-ne&255;return c+g},"w	riteIntBE"),A.prototype.writeInt8=f(function(y,c,g){return y=+y,c=c>>>0,g||Ot(this,y,c,1,127,-128),y<0&&(y=255+y+1),this[c]=y&255,c+1},"writeInt8"),A.prototype.writeInt16LE=f(function(y,c,g){return y=+y,c=c>>>0,g||Ot(this,y,c,2,32767,-32768),this[c]=y&255,this[c+1]=y>>>8,c+2},"writeInt16LE"),A.prototype.writeInt16BE=f(function(y,c,g){return y=+y,c=c>>>0,g||Ot(this,y,c,2,32767,-32768),this[c]=y>>>8,this[c+1]=y&255,c+2},"writeInt16BE"),A.prototype.writeInt32LE=f(function(y,c,g){return y=+y,c=c>>>0,g||Ot(this,y,c,4,2147483647,-2147483648),this[c]=y&255,this[c+1]=y>>>8,this[c+2]=y>>>16,this[c+3]=y>>>24,c+4},"writeInt32LE"),A.prototype.writeInt32BE=f(function(y,c,g){return y=+y,c=c>>>0,g||Ot(this,y,c,4,2147483647,-2147483648),y<0&&(y=4294967295+y+1),this[c]=y>>>24,this[c+1]=y>>>16,this[c+2]=y>>>8,this[c+3]=y&255,c+4},"writeIn	t32BE"),A.prototype.writeBigInt64LE=tn(f(function(y,c=0){return $t(this,y,c,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))},"writeBigInt64LE")),A.prototype.writeBigInt64BE=tn(f(function(y,c=0){return cs(this,y,c,-BigInt("0x8000000000000	000"),BigInt("0x7fffffffffffffff"))},"writeBigInt64BE"));function ws(y,c,g,x,w,H){if(g+x>y.length)throw new RangeError("Index out of range");if(g<0)throw new RangeError("Index out of range")}f(ws,"checkIEEE754");function Zs(y,c,g,x,w){return c=+c,g=g>>>0,w||ws(y,c,g,4),O.write(y,c,g,x,23,4),g+4}f(Zs,"writeFloat"),A.prototype.writeFloatLE=f(function(y,c,g){return Zs(this,y,c,!0,g)},"writeFloatLE"),A.prototype.writeFloatBE=f(function(y,c,g){return Zs(this,y,c,!1,g)},"writeFloatBE");function xi(y,c,g,x,w){return c=+c,g=g>>>0,w||ws(y,c,g,8),O.write(y,c,g,x,52,8),g+8}f(xi,"writeDouble"),A.prototype.writeDoubleLE=f(function(y,c,g){return xi(this,y,c,!0,g)},"writeDoubleLE"),A.prototype.writeDoubleBE=f(function(y,c,g){return xi(this,y,c,!1,g)},"writeDoubleBE"),A.prototype.copy=f(function(y,c,g,x){if(!A.isBuffer(y))throw new TypeError("argument should be a Buffer");if(g||(g=0),!x&&x!==0&&(x=this.length),c>=y.length&&(c=y.length),c||(c=0),x>0&&x<g&&(x=g),x===g||y.length===0||this.length===0)return 0;if(c<0)throw new RangeError("targetStart out of boun	ds");if(g<0||g>=this.length)throw new RangeError("Index out of range");if(x<0)throw new RangeError("sourceEnd out of bounds");x>this.length&&(x=this.length),y.length-c<x-g&&(x=y.length-c+g);let w=x-g;return this===y&&typeof Uint8Array.prototype.copyWithin=="functio	n"?this.copyWithin(c,g,x):Uint8Array.prototype.set.call(y,this.subarray(g,x),c),w},"copy"),A.prototype.fill=f(function(y,c,g,x){if(typeof y=="string"){if(typeof c=="string"?(x=c,c=0,g=this.length):typeof g=="string"&&(x=g,g=this.length),x!==void 0&&typeof x!="string")throw new TypeError("encoding must be a string");if(typeof x=="string"&&!A.isEncoding(x))throw new TypeError("Unknown encoding: "+x);if(y.length===1){let H=y.charCodeAt(0);(x==="utf8"&&H<128||x==="latin1")&&(y=H)}}else typeof y=="number"?y=y&255:typeof y=="boolean"&&(y=Number(y));if(c<0||this.length<c||this.length<g)throw new RangeError("Out of range index");if(g<=c)return this;c=c>>>0,g=g===void 0?this.length:g>>>0,y||(y=0);let w;if(typeof y=="number")for(w=c;w<g;++w)this[w]=y;else{let H=A.isBuffer(y)?y:A.from(y,x),ne=H.length;if(ne===0)throw new TypeError('The value "'+y+'" is invalid for argument "value"');for(w=0;w<g-c;++w)this[w+c]=H[w%ne]}return this},"fill");var Sn={};function en(y,c,g){var x;Sn[y]=(x=class extends g{constructor(){super(),Object.defineProperty(this,"message",{value:c.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${y}]`,this.stack,delete this.name}get code(){return y}set code(w){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:w,writable:!0})}toString(){return`${this.name} [${y}]: ${this.message}`}},f(x,"NodeError"),x)}f(en,"E"),en("ERR_BUFFER_OUT_OF_BOUNDS",function(y){return y?`${y} is outside of buffer bounds`:"Attempt to access memory outside buffer boun	ds"},RangeError),en("ERR_INVALID_ARG_TYPE",function(y,c){return`The "${y}" argument must be of type number. Received type ${typeof c}`},TypeError),en("ERR_OUT_O	F_RANGE",function(y,c,g){let x=`The value of "${y}" is out of range.`,w=g;return Number.isInteger(g)&&Math.abs(g)>Kt(2,32)?w=En(String(g)):typeof g=="bigint"&&(w=String(g),(g>Kt(BigInt(2),BigInt(32))||g<-Kt(BigInt(2),BigInt(32)))&&(w=En(w)),w+="n"),x+=` It must be ${c}. Received ${w}`,x},RangeError);function En(y){let c="",g=y.length,x=y[0]==="-"?1:0;for(;g>=x+4;g-=3)c=`_${y.slice(g-3,g)}${c}`;return`${y.slice(0,g)}${c}`}f(En,"addNumericalSeparator");function Br(y,c,g){jn(c,"offset"),(y[c]===void 0||y[c+g]===void 0)&&xr(c,y.length-(g+1))}f(Br,"checkBounds");function bi(y,c,g,x,w,H){if(y>g||y<c){let ne=typeof c=="bigint"?"n":"",Ve;throw H>3?c===0||c===BigInt(0)?Ve=`>= 0${ne} and < 2${ne} ** ${(H+1)*8}${ne}`:Ve=`>= -(2${ne} ** ${(H+1)*8-1}${ne}) and < 2 ** ${(H+1)*8-1}${ne}`:Ve=`>= ${c}${ne} and <= ${g}${ne}`,new Sn.ERR_OUT_OF_RANGE("value",Ve,y)}Br(x,w,H)}f(bi,"checkIntBI");function jn(y,c){if(typeof y!="number")throw new Sn.ERR_INVALID_ARG_TYPE(c,"number",y)}f(jn,"validateNumber");function xr(y,c,g){throw Math.floor(y)!==y?(jn(y,g),new Sn.ERR_OUT_OF_RANGE(g||"offset","an integer",y)):c<0?new Sn.ERR_BUFFER_OUT_OF_BOUNDS:new Sn.ERR_OUT_OF_RANGE(g||"offset",`>= ${g?1:0} and <= ${c}`,y)}f(xr,"boundsError");var Xi=/[^+/0-9A-Za-z-_]/g;function Wi(y){if(y=y.split("=")[0],y=y.trim().replace(Xi,""),y.length<2)return"";for(;y.length%4!==0;)y=y+"=";return y}f(Wi,"base64clean");function vi(y,c){c=c||1/0;let g,x=y.length,w=null,H=[];for(let ne=0;ne<x;++ne){if(g=y.charCodeAt(ne),g>55295&&g<57344){if(!w){if(g>56319){(c-=3)>-1&&H.push(239,191,189);continue}else if(ne+1===x){(c-=3)>-1&&H.push(239,191,189);continue}w=g;continue}if(g<56320){(c-=3)>-1&&H.push(239,191,189),w=g;continue}g=(w-55296<<10|g-56320)+65536}else w&&(c-=3)>-1&&H.push(239,191,189);if(w=null,g<128){if((c-=1)<0)break;H.push(g)}else if(g<2048){if((c-=2)<0)break;H.push(g>>6|192,g&63|128)}else if(g<65536){if((c-=3)<0)break;H.push(g>>12|224,g>>6&63|128,g&63|128)}else if(g<1114112){if((c-=4)<0)break;H.push(g>>18|240,g>>12&63|128,g>>6&63|128,g&63|128)}else throw new Error("Invalid code point")}return H}f(vi,"utf8ToBytes");function $n(y){let c=[];for(let g=0;g<y.length;++g)c.push(y.charCodeAt(g)&255);return c}f($n,"asciiToBytes");function $a(y,c){let g,x,w,H=[];for(let ne=0;ne<y.length&&!((c-=2)<0);++ne)g=y.charCodeAt(ne),x=g>>8,w=g%256,H.push(w),H.push(x);return H}f($a,"utf16leToBytes");function Ji(y){return T.toByteArray(Wi(y))}f(Ji,"base64T	oBytes");function Qn(y,c,g,x){let w;for(w=0;w<x&&!(w+g>=c.length||w>=y.length);++w)c[w+g]=y[w];return w}f(Qn,"blitBuffer");function Bs(y,c){return y instanceof c||y!=null&&y.constructor!=null&&y.constructor.name!=null&&y.constructor.name===c.name}f(Bs,"isInstance");function br(y){return y!==y}f(br,"numberIsNaN");var Ds=(function(){let y="0123456789abcdef",c=new Array(256);for(let g=0;g<16;++g){let x=g*16;for(let w=0;w<16;++w)c[x+w]=y[g]+y[w]}return c})();function tn(y){return typeof BigInt>"u"?Qa:y}f(tn,"defineBigIntMethod");function Qa(){throw new Error("BigInt not supported")}f(Qa,"BufferBigIntNotDefined")}),Be,xe,_e,Ne,De,G=b(()=>{var ee,T,O,k,I;Be=globalThis,xe=(ee=globalThis.setImmediate)!=null?ee:(j=>setTimeout(j,0)),_e=(T=globalThis.crypto)!=null?T:{},(O=_e.subtle)!=null||(_e.subtle={}),Ne=typeof globalThis.Buffer=="function"&&typeof globalThis.Buffer.allocUnsafe=="function"?globalThis.Buffer:Se().Buffer,De=(k=globalThis.process)!=null?k:{},(I=De.env)!=null||(De.env={});try{De.nextTick(()=>{})}catch(j){let M=Promise.resolve();De.nextTick=M.then.bind(M)}}),V=v((ee,T)=>{G();var O=typeof Reflect=="object"?Reflect:null,k=O&&typeof O.apply=="function"?O.apply:f(function(se,ge,me){return Function.prototype.apply.call(se,ge,me)},"ReflectApply"),I;O&&typeof O.ownKeys=="function"?I=O.ownKeys:Object.getOwnPropertySymbols?I=f(function(se){return Object.getOwnPropertyNames(se).concat(Object.getOwnPropertySymbols(se))},"ReflectOwnKeys"):I=f(function(se){return Object.getOwnPropertyNames(se)},"ReflectOwnKeys");function j(se){console&&console.warn&&console.warn(se)}f(j,"ProcessEmitWarning");var M=Number.isNaN||f(function(se){return se!==se},"NumberIsNaN");function A(){A.init.call(this)}f(A,"EventEmitter"),T.exports=A,T.exports.once=ue,A.EventEmitter=A,A.prototype._events=void 0,A.prototype._eventsCount=0,A.prototype._maxListeners=void 0;var B=10;function re(se){if(typeof se!="functi	on")throw new TypeError('The "listener" argument must be of type Function. Recei	ved type '+typeof se)}f(re,"checkListener"),Object.defineProperty(A,"defaultMaxLi	steners",{enumerable:!0,get:f(function(){return B},"get"),set:f(function(se){if(typeof se!="number"||se<0||M(se))throw new RangeError('The value of "defaultMaxListeners" is	 out of range. It must be a non-negative number. Received '+se+".");B=se},"set")}),A.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},A.prototype.setMaxListeners=f(function(se){if(typeof se!="number"||se<0||M(se))throw new RangeError('The value of "n" is out of range. It 	must be a non-negative number. Received '+se+".");return this._maxListeners=se,this},"setMaxListeners");function $(se){return se._maxListeners===void 0?A.defaultMaxListeners:se._maxListeners}f($,"_getMaxListeners"),A.prototype.getMaxListeners=f(function(){return $(this)},"getMaxListeners"),A.prototype.emit=f(function(se){for(var ge=[],me=1;me<arguments.length;me++)ge.push(arguments[me]);var ce=se==="error",je=this._events;if(je!==void 0)ce=ce&&je.error===void 0;else if(!ce)return!1;if(ce){var ve;if(ge.length>0&&(ve=ge[0]),ve instanceof Error)throw ve;var $e=new Error("Unhandled error."+(ve?" ("+ve.message+")":""));throw $e.context=ve,$e}var We=je[se];if(We===void 0)return!1;if(typeof We=="function")k(We,this,ge);else for(var Ce=We.length,Fe=q(We,Ce),me=0;me<Ce;++me)k(Fe[me],this,ge);return!0},"emit");function W(se,ge,me,ce){var je,ve,$e;if(re(me),ve=se._events,ve===void 0?(ve=se._events=Object.create(null),se._eventsCount=0):(ve.newListener!==void 0&&(se.emit("newListener",ge,me.listener?me.listener:me),ve=se._events),$e=ve[ge]),$e===void 0)$e=ve[ge]=me,++se._eventsCount;else if(typeof $e=="function"?$e=ve[ge]=ce?[me,$e]:[$e,me]:ce?$e.unshift(me):$e.push(me),je=$(se),je>0&&$e.length>je&&!$e.warned){$e.warned=!0;var We=new Error("Po	ssible EventEmitter memory leak detected. "+$e.length+" "+String(ge)+" listeners a	dded. Use emitter.setMaxListeners() to increase limit");We.name="MaxListenersExce	ededWarning",We.emitter=se,We.type=ge,We.count=$e.length,j(We)}return se}f(W,"_addList	ener"),A.prototype.addListener=f(function(se,ge){return W(this,se,ge,!1)},"addListe	ner"),A.prototype.on=A.prototype.addListener,A.prototype.prependListener=f(function(se,ge){return W(this,se,ge,!0)},"prependListener");function F(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}f(F,"onceWrapper");function te(se,ge,me){var ce={fired:!1,wrapFn:void 0,target:se,type:ge,listener:me},je=F.bind(ce);return je.listener=me,ce.wrapFn=je,je}f(te,"_onceWrap"),A.prototype.once=f(function(se,ge){return re(ge),this.on(se,te(this,se,ge)),this},"once"),A.prototype.prependOnceListener=f(function(se,ge){return re(ge),this.prependListener(se,te(this,se,ge)),this},"prependOnceListener"),A.prototype.removeListener=f(function(se,ge){var me,ce,je,ve,$e;if(re(ge),ce=this._events,ce===void 0)return this;if(me=ce[se],me===void 0)return this;if(me===ge||me.listener===ge)--this._eventsCount===0?this._events=Object.create(null):(delete ce[se],ce.removeListener&&this.emit("removeListener",se,me.listener||ge));else if(typeof me!="function"){for(je=-1,ve=me.length-1;ve>=0;ve--)if(me[ve]===ge||me[ve].listener===ge){$e=me[ve].listener,je=ve;break}if(je<0)return this;je===0?me.shift():ae(me,je),me.length===1&&(ce[se]=me[0]),ce.removeListener!==void 0&&this.emit("removeListener",se,$e||ge)}return this},"removeListener"),A.prototype.off=A.prototype.removeListener,A.prototype.removeAllListeners=f(function(se){var ge,me,ce;if(me=this._events,me===void 0)return this;if(me.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):me[se]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete me[se]),this;if(arguments.length===0){var je=Object.keys(me),ve;for(ce=0;ce<je.length;++ce)ve=je[ce],ve!=="removeListener"&&this.removeAllListeners(ve);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(ge=me[se],typeof ge=="function")this.removeListener(se,ge);else if(ge!==void 0)for(ce=ge.length-1;ce>=0;ce--)this.removeListener(se,ge[ce]);return this},"removeAllListeners");function N(se,ge,me){var ce=se._events;if(ce===void 0)return[];var je=ce[ge];return je===void 0?[]:typeof je=="function"?me?[je.listener||je]:[je]:me?le(je):q(je,je.length)}f(N,"_listeners"),A.prototype.listeners=f(function(se){return N(this,se,!0)},"listeners"),A.prototype.rawListeners=f(function(se){return N(this,se,!1)},"rawListeners"),A.listenerCount=function(se,ge){return typeof se.listenerCount=="function"?se.listenerCount(ge):C.call(se,ge)},A.prototype.listenerCount=C;function C(se){var ge=this._events;if(ge!==void 0){var me=ge[se];if(typeof me=="function")return 1;if(me!==void 0)return me.length}return 0}f(C,"listenerCount"),A.prototype.eventNames=f(function(){return this._eventsCount>0?I(this._events):[]},"eventNames");function q(se,ge){for(var me=new Array(ge),ce=0;ce<ge;++ce)me[ce]=se[ce];return me}f(q,"arrayClone");function ae(se,ge){for(;ge+1<se.length;ge++)se[ge]=se[ge+1];se.pop()}f(ae,"spliceOne");function le(se){for(var ge=new Array(se.length),me=0;me<ge.length;++me)ge[me]=se[me].listener||se[me];return ge}f(le,"unwrapListeners");function ue(se,ge){return new Promise(function(me,ce){function je($e){se.removeListener(ge,ve),ce($e)}f(je,"errorListener");function ve(){typeof se.removeListener=="function"&&se.removeListener("error",je),me([].slice.call(arguments))}f(ve,"resolver"),Te(se,ge,ve,{once:!0}),ge!=="error"&&Ee(se,je,{once:!0})})}f(ue,"once");function Ee(se,ge,me){typeof se.on=="function"&&Te(se,"error",ge,me)}f(Ee,"addErrorHandlerIfEventEmitter");function Te(se,ge,me,ce){if(typeof se.on=="function")ce.once?se.once(ge,me):se.on(ge,me);else if(typeof se.addEventListener=="function")se.addEventListener(ge,f(function je(ve){ce.once&&se.removeEventListener(ge,je),me(ve)},"wrapListener"));else throw new TypeError('The "emitter" argument must be of type EventEmitter. Receiv	ed type '+typeof se)}f(Te,"eventTargetAgnosticAddListener")}),L={};E(L,{default:()=>z});var z,Q=b(()=>{G(),z={}});function Y(ee){let T=1779033703,O=3144134277,k=1013904242,I=2773480762,j=1359893119,M=2600822924,A=528734635,B=1541459225,re=0,$=0,W=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],F=f((le,ue)=>le>>>ue|le<<32-ue,"rrot"),te=new Uint32Array(64),N=new Uint8Array(64),C=f(()=>{for(let je=0,ve=0;je<16;je++,ve+=4)te[je]=N[ve]<<24|N[ve+1]<<16|N[ve+2]<<8|N[ve+3];for(let je=16;je<64;je++){let ve=F(te[je-15],7)^F(te[je-15],18)^te[je-15]>>>3,$e=F(te[je-2],17)^F(te[je-2],19)^te[je-2]>>>10;te[je]=te[je-16]+ve+te[je-7]+$e|0}let le=T,ue=O,Ee=k,Te=I,se=j,ge=M,me=A,ce=B;for(let je=0;je<64;je++){let ve=F(se,6)^F(se,11)^F(se,25),$e=se&ge^~se&me,We=ce+ve+$e+W[je]+te[je]|0,Ce=F(le,2)^F(le,13)^F(le,22),Fe=le&ue^le&Ee^ue&Ee,Ze=Ce+Fe|0;ce=me,me=ge,ge=se,se=Te+We|0,Te=Ee,Ee=ue,ue=le,le=We+Ze|0}T=T+le|0,O=O+ue|0,k=k+Ee|0,I=I+Te|0,j=j+se|0,M=M+ge|0,A=A+me|0,B=B+ce|0,$=0},"process"),q=f(le=>{typeof le=="string"&&(le=new TextEncoder().encode(le));for(let ue=0;ue<le.length;ue++)N[$++]=le[ue],$===64&&C();re+=le.length},"add"),ae=f(()=>{if(N[$++]=128,$==64&&C(),$+8>64){for(;$<64;)N[$++]=0;C()}for(;$<58;)N[$++]=0;let le=re*8;N[$++]=le/1099511627776&255,N[$++]=le/4294967296&255,N[$++]=le>>>24,N[$++]=le>>>16&255,N[$++]=le>>>8&255,N[$++]=le&255,C();let ue=new Uint8Array(32);return ue[0]=T>>>24,ue[1]=T>>>16&255,ue[2]=T>>>8&255,ue[3]=T&255,ue[4]=O>>>24,ue[5]=O>>>16&255,ue[6]=O>>>8&255,ue[7]=O&255,ue[8]=k>>>24,ue[9]=k>>>16&255,ue[10]=k>>>8&255,ue[11]=k&255,ue[12]=I>>>24,ue[13]=I>>>16&255,ue[14]=I>>>8&255,ue[15]=I&255,ue[16]=j>>>24,ue[17]=j>>>16&255,ue[18]=j>>>8&255,ue[19]=j&255,ue[20]=M>>>24,ue[21]=M>>>16&255,ue[22]=M>>>8&255,ue[23]=M&255,ue[24]=A>>>24,ue[25]=A>>>16&255,ue[26]=A>>>8&255,ue[27]=A&255,ue[28]=B>>>24,ue[29]=B>>>16&255,ue[30]=B>>>8&255,ue[31]=B&255,ue},"digest");return ee===void 0?{add:q,digest:ae}:(q(ee),ae())}var J=b(()=>{G(),f(Y,"sha256")}),pt,Ct,Ae=b(()=>{G(),pt=class tr{constructor(){U(this,"_dataLength",0),U(this,"_bufferLength",0),U(this,"_state",new Int32Array(4)),U(this,"_buffer",new ArrayBuffer(68)),U(this,"_buffer8"),U(this,"_buffer32"),this._buffer8=new Uint8Array(this._buffer,0,68),this._buffer32=new Uint32Array(this._buffer,0,17),this.start()}static hashByteArray(T,O=!1){return this.onePassHasher.start().appendByteArray(T).end(O)}static hashStr(T,O=!1){return this.onePassHasher.start().appendStr(T).end(O)}static hashAsciiStr(T,O=!1){return this.onePassHasher.start().appendAsciiStr(T).end(O)}static _hex(T){let O=tr.hexChars,k=tr.hexOut,I,j,M,A;for(A=0;A<4;A+=1)for(j=A*8,I=T[A],M=0;M<8;M+=2)k[j+1+M]=O.charAt(I&15),I>>>=4,k[j+0+M]=O.charAt(I&15),I>>>=4;return k.join("")}static _md5cycle(T,O){let k=T[0],I=T[1],j=T[2],M=T[3];k+=(I&j|~I&M)+O[0]-680876936|0,k=(k<<7|k>>>25)+I|0,M+=(k&I|~k&j)+O[1]-389564586|0,M=(M<<12|M>>>20)+k|0,j+=(M&k|~M&I)+O[2]+606105819|0,j=(j<<17|j>>>15)+M|0,I+=(j&M|~j&k)+O[3]-1044525330|0,I=(I<<22|I>>>10)+j|0,k+=(I&j|~I&M)+O[4]-176418897|0,k=(k<<7|k>>>25)+I|0,M+=(k&I|~k&j)+O[5]+1200080426|0,M=(M<<12|M>>>20)+k|0,j+=(M&k|~M&I)+O[6]-1473231341|0,j=(j<<17|j>>>15)+M|0,I+=(j&M|~j&k)+O[7]-45705983|0,I=(I<<22|I>>>10)+j|0,k+=(I&j|~I&M)+O[8]+1770035416|0,k=(k<<7|k>>>25)+I|0,M+=(k&I|~k&j)+O[9]-1958414417|0,M=(M<<12|M>>>20)+k|0,j+=(M&k|~M&I)+O[10]-42063|0,j=(j<<17|j>>>15)+M|0,I+=(j&M|~j&k)+O[11]-1990404162|0,I=(I<<22|I>>>10)+j|0,k+=(I&j|~I&M)+O[12]+1804603682|0,k=(k<<7|k>>>25)+I|0,M+=(k&I|~k&j)+O[13]-40341101|0,M=(M<<12|M>>>20)+k|0,j+=(M&k|~M&I)+O[14]-1502002290|0,j=(j<<17|j>>>15)+M|0,I+=(j&M|~j&k)+O[15]+1236535329|0,I=(I<<22|I>>>10)+j|0,k+=(I&M|j&~M)+O[1]-165796510|0,k=(k<<5|k>>>27)+I|0,M+=(k&j|I&~j)+O[6]-1069501632|0,M=(M<<9|M>>>23)+k|0,j+=(M&I|k&~I)+O[11]+643717713|0,j=(j<<14|j>>>18)+M|0,I+=(j&k|M&~k)+O[0]-373897302|0,I=(I<<20|I>>>12)+j|0,k+=(I&M|j&~M)+O[5]-701558691|0,k=(k<<5|k>>>27)+I|0,M+=(k&j|I&~j)+O[10]+38016083|0,M=(M<<9|M>>>23)+k|0,j+=(M&I|k&~I)+O[15]-660478335|0,j=(j<<14|j>>>18)+M|0,I+=(j&k|M&~k)+O[4]-405537848|0,I=(I<<20|I>>>12)+j|0,k+=(I&M|j&~M)+O[9]+568446438|0,k=(k<<5|k>>>27)+I|0,M+=(k&j|I&~j)+O[14]-1019803690|0,M=(M<<9|M>>>23)+k|0,j+=(M&I|k&~I)+O[3]-187363961|0,j=(j<<14|j>>>18)+M|0,I+=(j&k|M&~k)+O[8]+1163531501|0,I=(I<<20|I>>>12)+j|0,k+=(I&M|j&~M)+O[13]-1444681467|0,k=(k<<5|k>>>27)+I|0,M+=(k&j|I&~j)+O[2]-51403784|0,M=(M<<9|M>>>23)+k|0,j+=(M&I|k&~I)+O[7]+1735328473|0,j=(j<<14|j>>>18)+M|0,I+=(j&k|M&~k)+O[12]-1926607734|0,I=(I<<20|I>>>12)+j|0,k+=(I^j^M)+O[5]-378558|0,k=(k<<4|k>>>28)+I|0,M+=(k^I^j)+O[8]-2022574463|0,M=(M<<11|M>>>21)+k|0,j+=(M^k^I)+O[11]+1839030562|0,j=(j<<16|j>>>16)+M|0,I+=(j^M^k)+O[14]-35309556|0,I=(I<<23|I>>>9)+j|0,k+=(I^j^M)+O[1]-1530992060|0,k=(k<<4|k>>>28)+I|0,M+=(k^I^j)+O[4]+1272893353|0,M=(M<<11|M>>>21)+k|0,j+=(M^k^I)+O[7]-155497632|0,j=(j<<16|j>>>16)+M|0,I+=(j^M^k)+O[10]-1094730640|0,I=(I<<23|I>>>9)+j|0,k+=(I^j^M)+O[13]+681279174|0,k=(k<<4|k>>>28)+I|0,M+=(k^I^j)+O[0]-358537222|0,M=(M<<11|M>>>21)+k|0,j+=(M^k^I)+O[3]-722521979|0,j=(j<<16|j>>>16)+M|0,I+=(j^M^k)+O[6]+76029189|0,I=(I<<23|I>>>9)+j|0,k+=(I^j^M)+O[9]-640364487|0,k=(k<<4|k>>>28)+I|0,M+=(k^I^j)+O[12]-421815835|0,M=(M<<11|M>>>21)+k|0,j+=(M^k^I)+O[15]+530742520|0,j=(j<<16|j>>>16)+M|0,I+=(j^M^k)+O[2]-995338651|0,I=(I<<23|I>>>9)+j|0,k+=(j^(I|~M))+O[0]-198630844|0,k=(k<<6|k>>>26)+I|0,M+=(I^(k|~j))+O[7]+1126891415|0,M=(M<<10|M>>>22)+k|0,j+=(k^(M|~I))+O[14]-1416354905|0,j=(j<<15|j>>>17)+M|0,I+=(M^(j|~k))+O[5]-57434055|0,I=(I<<21|I>>>11)+j|0,k+=(j^(I|~M))+O[12]+1700485571|0,k=(k<<6|k>>>26)+I|0,M+=(I^(k|~j))+O[3]-1894986606|0,M=(M<<10|M>>>22)+k|0,j+=(k^(M|~I))+O[10]-1051523|0,j=(j<<15|j>>>17)+M|0,I+=(M^(j|~k))+O[1]-2054922799|0,I=(I<<21|I>>>11)+j|0,k+=(j^(I|~M))+O[8]+1873313359|0,k=(k<<6|k>>>26)+I|0,M+=(I^(k|~j))+O[15]-30611744|0,M=(M<<10|M>>>22)+k|0,j+=(k^(M|~I))+O[6]-1560198380|0,j=(j<<15|j>>>17)+M|0,I+=(M^(j|~k))+O[13]+1309151649|0,I=(I<<21|I>>>11)+j|0,k+=(j^(I|~M))+O[4]-145523070|0,k=(k<<6|k>>>26)+I|0,M+=(I^(k|~j))+O[11]-1120210379|0,M=(M<<10|M>>>22)+k|0,j+=(k^(M|~I))+O[2]+718787259|0,j=(j<<15|j>>>17)+M|0,I+=(M^(j|~k))+O[9]-343485551|0,I=(I<<21|I>>>11)+j|0,T[0]=k+T[0]|0,T[1]=I+T[1]|0,T[2]=j+T[2]|0,T[3]=M+T[3]|0}start(){return this._dataLength=0,this._bufferLength=0,this._state.set(tr.stateIdentity),this}appendStr(T){let O=this._buffer8,k=this._buffer32,I=this._bufferLength,j,M;for(M=0;M<T.length;M+=1){if(j=T.charCodeAt(M),j<128)O[I++]=j;else if(j<2048)O[I++]=(j>>>6)+192,O[I++]=j&63|128;else if(j<55296||j>56319)O[I++]=(j>>>12)+224,O[I++]=j>>>6&63|128,O[I++]=j&63|128;else{if(j=(j-55296)*1024+(T.charCodeAt(++M)-56320)+65536,j>1114111)throw new Error("Unicode standard	 supports code points up to U+10FFFF");O[I++]=(j>>>18)+240,O[I++]=j>>>12&63|128,O[I++]=j>>>6&63|128,O[I++]=j&63|128}I>=64&&(this._dataLength+=64,tr._md5cycle(this._state,k),I-=64,k[0]=k[16])}return this._bufferLength=I,this}appendAsciiStr(T){let O=this._buffer8,k=this._buffer32,I=this._bufferLength,j,M=0;for(;;){for(j=Math.min(T.length-M,64-I);j--;)O[I++]=T.charCodeAt(M++);if(I<64)break;this._dataLength+=64,tr._md5cycle(this._state,k),I=0}return this._bufferLength=I,this}appendByteArray(T){let O=this._buffer8,k=this._buffer32,I=this._bufferLength,j,M=0;for(;;){for(j=Math.min(T.length-M,64-I);j--;)O[I++]=T[M++];if(I<64)break;this._dataLength+=64,tr._md5cycle(this._state,k),I=0}return this._bufferLength=I,this}getState(){let T=this._state;return{buffer:String.fromCharCode.apply(null,Array.from(this._buffer8)),buflen:this._bufferLength,length:this._dataLength,state:[T[0],T[1],T[2],T[3]]}}setState(T){let O=T.buffer,k=T.state,I=this._state,j;for(this._dataLength=T.length,this._bufferLength=T.buflen,I[0]=k[0],I[1]=k[1],I[2]=k[2],I[3]=k[3],j=0;j<O.length;j+=1)this._buffer8[j]=O.charCodeAt(j)}end(T=!1){let O=this._bufferLength,k=this._buffer8,I=this._buffer32,j=(O>>2)+1;this._dataLength+=O;let M=this._dataLength*8;if(k[O]=128,k[O+1]=k[O+2]=k[O+3]=0,I.set(tr.buffer32Identity.subarray(j),j),O>55&&(tr._md5cycle(this._state,I),I.set(tr.buffer32Identity)),M<=4294967295)I[14]=M;else{let A=M.toString(16).match(/(.*?)(.{0,8})$/);if(A===null)return;let B=parseInt(A[2],16),re=parseInt(A[1],16)||0;I[14]=B,I[15]=re}return tr._md5cycle(this._state,I),T?this._state:tr._hex(this._state)}},f(pt,"Md5"),U(pt,"stateIdentity",new Int32Array([1732584193,-271733879,-1732584194,271733878])),U(pt,"buffer32Identity",new Int32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),U(pt,"hexChars","0123456789abcdef"),U(pt,"hexO	ut",[]),U(pt,"onePassHasher",new pt),Ct=pt}),Ue={};E(Ue,{createHash:()=>Ie,createHmac:()=>Ge,randomBytes:()=>et});function et(ee){return _e.getRandomValues(Ne.alloc(ee))}function Ie(ee){if(ee==="sha256")return{update:f(function(T){return{digest:f(function(){return Ne.from(Y(T))},"digest")}},"update")};if(ee==="md5")return{update:f(function(T){return{digest:f(function(){return typeof T=="string"?Ct.hashStr(T):Ct.hashByteArray(T)},"digest")}},"update")};throw new Error(`Hash type '${ee}' not supported`)}function Ge(ee,T){if(ee!=="sha256")throw new Error(`Only sha256 is supported (requested: '${ee}')`);return{update:f(function(O){return{digest:f(function(){typeof T=="string"&&(T=new TextEncoder().encode(T)),typeof O=="string"&&(O=new TextEncoder().encode(O));let k=T.length;if(k>64)T=Y(T);else if(k<64){let B=new Uint8Array(64);B.set(T),T=B}let I=new Uint8Array(64),j=new Uint8Array(64);for(let B=0;B<64;B++)I[B]=54^T[B],j[B]=92^T[B];let M=new Uint8Array(O.length+64);M.set(I,0),M.set(O,64);let A=new Uint8Array(96);return A.set(j,0),A.set(Y(M),64),Ne.from(Y(A))},"digest")}},"update")}}var bt=b(()=>{G(),J(),Ae(),f(et,"randomBytes"),f(Ie,"createHash"),f(Ge,"createHmac")}),xt=v(ee=>{G(),ee.parse=function(I,j){return new O(I,j).parse()};var T=class Bv{constructor(j,M){this.source=j,this.transform=M||k,this.position=0,this.entries=[],this.recorded=[],this.dimension=0}isEof(){return this.position>=this.source.length}nextCharacter(){var j=this.source[this.position++];return j==="\\"?{value:this.source[this.position++],escaped:!0}:{value:j,escaped:!1}}record(j){this.recorded.push(j)}newEntry(j){var M;(this.recorded.length>0||j)&&(M=this.recorded.join(""),M==="NULL"&&!j&&(M=null),M!==null&&(M=this.transform(M)),this.entries.push(M),this.recorded=[])}consumeDimensions(){if(this.source[0]==="[")for(;!this.isEof();){var j=this.nextCharacter();if(j.value==="=")break}}parse(j){var M,A,B;for(this.consumeDimensions();!this.isEof();)if(M=this.nextCharacter(),M.value==="{"&&!B)this.dimension++,this.dimension>1&&(A=new Bv(this.source.substr(this.position-1),this.transform),this.entries.push(A.parse(!0)),this.position+=A.position-2);else if(M.value==="}"&&!B){if(this.dimension--,!this.dimension&&(this.newEntry(),j))return this.entries}else M.value==='"'&&!M.escaped?(B&&this.newEntry(!0),B=!B):M.value===","&&!B?this.newEntry():this.record(M.value);if(this.dimension!==0)throw new Error("array dimension not balanced");return this.entries}};f(T,"ArrayParser");var O=T;function k(I){return I}f(k,"identity")}),yt=v((ee,T)=>{G();var O=xt();T.exports={create:f(function(k,I){return{parse:f(function(){return O.parse(k,I)},"parse")}},"create")}}),Ht=v((ee,T)=>{G();var O=/(\d{1,})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2})(\.\d{1,})?.*?( BC)?$/,k=/^(\d{1,})-(\d{2})-(\d{2})( BC)?$/,I=/([Z+-])(\d{2})?:?(\d{2})?:?(\d{2})?/,j=/^-?infinity$/;T.exports=f(function($){if(j.test($))return Number($.replace("i","I"));var W=O.exec($);if(!W)return M($)||null;var F=!!W[8],te=parseInt(W[1],10);F&&(te=B(te));var N=parseInt(W[2],10)-1,C=W[3],q=parseInt(W[4],10),ae=parseInt(W[5],10),le=parseInt(W[6],10),ue=W[7];ue=ue?1e3*parseFloat(ue):0;var Ee,Te=A($);return Te!=null?(Ee=new Date(Date.UTC(te,N,C,q,ae,le,ue)),re(te)&&Ee.setUTCFullYear(te),Te!==0&&Ee.setTime(Ee.getTime()-Te)):(Ee=new Date(te,N,C,q,ae,le,ue),re(te)&&Ee.setFullYear(te)),Ee},"parseDate");function M($){var W=k.exec($);if(W){var F=parseInt(W[1],10),te=!!W[4];te&&(F=B(F));var N=parseInt(W[2],10)-1,C=W[3],q=new Date(F,N,C);return re(F)&&q.setFullYear(F),q}}f(M,"getDate");function A($){if($.endsWith("+00"))return 0;var W=I.exec($.split(" ")[1]);if(W){var F=W[1];if(F==="Z")return 0;var te=F==="-"?-1:1,N=parseInt(W[2],10)*3600+parseInt(W[3]||0,10)*60+parseInt(W[4]||0,10);return N*te*1e3}}f(A,"timeZoneOffset");function B($){return-($-1)}f(B,"bcYearToNegativeYear");function re($){return $>=0&&$<100}f(re,"is0To99")}),Us=v((ee,T)=>{G(),T.exports=k;var O=Object.prototype.hasOwnProperty;function k(I){for(var j=1;j<arguments.length;j++){var M=arguments[j];for(var A in M)O.call(M,A)&&(I[A]=M[A])}return I}f(k,"extend")}),nn=v((ee,T)=>{G();var O=Us();T.exports=k;function k(le){if(!(this instanceof k))return new k(le);O(this,ae(le))}f(k,"PostgresInterval");var I=["seconds","	minutes","hours","days","months","years"];k.prototype.toPostgres=function(){var le=I.filter(this.hasOwnProperty,this);return this.milliseconds&&le.indexOf("seconds")<0&&le.push("seconds"),le.length===0?"0":le.map(function(ue){var Ee=this[ue]||0;return ue==="seconds"&&this.milliseconds&&(Ee=(Ee+this.milliseconds/1e3).toFixed(6).replace(/\.?0+$/,"")),Ee+" "+ue},this).join(" ")};var j={years:"Y",months:"M",days:"D",hours:"H",minutes:"	M",seconds:"S"},M=["years","months","days"],A=["hours","minutes","seconds"];k.prototype.toISOString=k.prototype.toISO=function(){var le=M.map(Ee,this).join(""),ue=A.map(Ee,this).join("");return"P"+le+"T"+ue;function Ee(Te){var se=this[Te]||0;return Te==="seconds"&&this.milliseconds&&(se=(se+this.milliseconds/1e3).toFixed(6).replace(/0+$/,"")),se+j[Te]}};var B="([+-]?\\d+)",re=B+"\\s+years?",$=B+"\\s+mons?",W=B+"	\\s+days?",F="([+-])?([\\d]*):(\\d\\d):(\\d\\d)\\.?(\\d{1,6})?",te=new RegExp([re,$,W,F].map(function(le){return"("+le+")?"}).join("\\s*")),N={years:2,months:4,days:6,hours:9,minutes:10,seconds:11,milliseconds:12},C=["hours","minutes","sec	onds","milliseconds"];function q(le){var ue=le+"000000".slice(le.length);return parseInt(ue,10)/1e3}f(q,"parseMilliseconds");function ae(le){if(!le)return{};var ue=te.exec(le),Ee=ue[8]==="-";return Object.keys(N).reduce(function(Te,se){var ge=N[se],me=ue[ge];return!me||(me=se==="milliseconds"?q(me):parseInt(me,10),!me)||(Ee&&~C.indexOf(se)&&(me*=-1),Te[se]=me),Te},{})}f(ae,"parse")}),Dr=v((ee,T)=>{G(),T.exports=f(function(O){if(/^\\x/.test(O))return new Ne(O.substr(2),"hex");for(var k="",I=0;I<O.length;)if(O[I]!=="\\")k+=O[I],++I;else if(/[0-7]{3}/.test(O.substr(I+1,3)))k+=String.fromCharCode(parseInt(O.substr(I+1,3),8)),I+=4;else{for(var j=1;I+j<O.length&&O[I+j]==="\\";)j++;for(var M=0;M<Math.floor(j/2);++M)k+="\\";I+=Math.floor(j/2)*2}return new Ne(k,"binary")},"parseBytea")}),Or=v((ee,T)=>{G();var O=xt(),k=yt(),I=Ht(),j=nn(),M=Dr();function A(ce){return f(function(je){return je===null?je:ce(je)},"nullAllowed")}f(A,"allowNull");function B(ce){return ce===null?ce:ce==="TRUE"||ce==="t"||ce==="true"||ce==="y"||ce==="yes"||ce==="on"||ce==="1"}f(B,"parseBool");function re(ce){return ce?O.parse(ce,B):null}f(re,"pars	eBoolArray");function $(ce){return parseInt(ce,10)}f($,"parseBaseTenInt");function W(ce){return ce?O.parse(ce,A($)):null}f(W,"parseIntegerArray");function F(ce){return ce?O.parse(ce,A(function(je){return Ee(je).trim()})):null}f(F,"parseBigIntegerArray");var te=f(function(ce){if(!ce)return null;var je=k.create(ce,function(ve){return ve!==null&&(ve=se(ve)),ve});return je.parse()},"parsePointArray"),N=f(function(ce){if(!ce)return null;var je=k.create(ce,function(ve){return ve!==null&&(ve=parseFloat(ve)),ve});return je.parse()},"parseFloatArray"),C=f(function(ce){if(!ce)return null;var je=k.create(ce);return je.parse()},"parseStringArray"),q=f(function(ce){if(!ce)return null;var je=k.create(ce,function(ve){return ve!==null&&(ve=I(ve)),ve});return je.parse()},"	parseDateArray"),ae=f(function(ce){if(!ce)return null;var je=k.create(ce,function(ve){return ve!==null&&(ve=j(ve)),ve});return je.parse()},"parseIntervalArray"),le=f(function(ce){return ce?O.parse(ce,A(M)):null},"parseByteAArray"),ue=f(function(ce){return parseInt(ce,10)},"parseInteger"),Ee=f(function(ce){var je=String(ce);return/^\d+$/.test(je)?je:ce},"parseBigInteger"),Te=f(function(ce){return ce?O.parse(ce,A(JSON.parse)):null},"parseJsonArray"),se=f(function(ce){return ce[0]!=="("?null:(ce=ce.substring(1,ce.length-1).split(","),{x:parseFloat(ce[0]),y:parseFloat(ce[1])})},"parsePoint"),ge=f(function(ce){if(ce[0]!=="<"&&ce[1]!=="(")return null;for(var je="(",ve="",$e=!1,We=2;We<ce.length-1;We++){if($e||(je+=ce[We]),ce[We]===")"){$e=!0;continue}else if(!$e)continue;ce[We]!==","&&(ve+=ce[We])}var Ce=se(je);return Ce.radius=parseFloat(ve),Ce},"parseCircle"),me=f(function(ce){ce(20,Ee),ce(21,ue),ce(23,ue),ce(26,ue),ce(700,parseFloat),ce(701,parseFloat),ce(16,B),ce(1082,I),ce(1114,I),ce(1184,I),ce(600,se),ce(651,C),ce(718,ge),ce(1e3,re),ce(1001,le),ce(1005,W),ce(1007,W),ce(1028,W),ce(1016,F),ce(1017,te),ce(1021,N),ce(1022,N),ce(1231,N),ce(1014,C),ce(1015,C),ce(1008,C),ce(1009,C),ce(1040,C),ce(1041,C),ce(1115,q),ce(1182,q),ce(1185,q),ce(1186,j),ce(1187,ae),ce(17,M),ce(114,JSON.parse.bind(JSON)),ce(3802,JSON.parse.bind(JSON)),ce(199,Te),ce(3807,Te),ce(3907,C),ce(2951,C),ce(791,C),ce(1183,C),ce(1270,C)},"init");T.exports={init:me}}),ir=v((ee,T)=>{G();var O=1e6;function k(I){var j=I.readInt32BE(0),M=I.readUInt32BE(4),A="";j<0&&(j=~j+(M===0),M=~M+1>>>0,A="-");var B="",re,$,W,F,te,N;{if(re=j%O,j=j/O>>>0,$=4294967296*re+M,M=$/O>>>0,W=""+($-O*M),M===0&&j===0)return A+W+B;for(F="",te=6-W.length,N=0;N<te;N++)F+="0";B=F+W+B}{if(re=j%O,j=j/O>>>0,$=4294967296*re+M,M=$/O>>>0,W=""+($-O*M),M===0&&j===0)return A+W+B;for(F="",te=6-W.length,N=0;N<te;N++)F+="0";B=F+W+B}{if(re=j%O,j=j/O>>>0,$=4294967296*re+M,M=$/O>>>0,W=""+($-O*M),M===0&&j===0)return A+W+B;for(F="",te=6-W.length,N=0;N<te;N++)F+="0";B=F+W+B}return re=j%O,$=4294967296*re+M,W=""+$%O,A+W+B}f(k,"readInt8"),T.exports=k}),Ua=v((ee,T)=>{G();var O=ir(),k=f(function(C,q,ae,le,ue){ae=ae||0,le=le||!1,ue=ue||function($e,We,Ce){return $e*Math.pow(2,Ce)+We};var Ee=ae>>3,Te=f(function($e){return le?~$e&255:$e},"inv"),se=255,ge=8-ae%8;q<ge&&(se=255<<8-q&255,ge=q),ae&&(se=se>>ae%8);var me=0;ae%8+q>=8&&(me=ue(0,Te(C[Ee])&se,ge));for(var ce=q+ae>>3,je=Ee+1;je<ce;je++)me=ue(me,Te(C[je]),8);var ve=(q+ae)%8;return ve>0&&(me=ue(me,Te(C[ce])>>8-ve,ve)),me},"parseBits"),I=f(function(C,q,ae){var le=Math.pow(2,ae-1)-1,ue=k(C,1),Ee=k(C,ae,1);if(Ee===0)return 0;var Te=1,se=f(function(me,ce,je){me===0&&(me=1);for(var ve=1;ve<=je;ve++)Te/=2,(ce&1<<je-ve)>0&&(me+=Te);return me},"parsePrecisionBits"),ge=k(C,q,ae+1,!1,se);return Ee==Math.pow(2,ae+1)-1?ge===0?ue===0?1/0:-1/0:NaN:(ue===0?1:-1)*Math.pow(2,Ee-le)*ge},"parseFloatFromBits"),j=f(function(C){return k(C,1)==1?-1*(k(C,15,1,!0)+1):k(C,15,1)},"parseInt16"),M=f(function(C){return k(C,1)==1?-1*(k(C,31,1,!0)+1):k(C,31,1)},"parseInt32"),A=f(function(C){return I(C,23,8)},"pars	eFloat32"),B=f(function(C){return I(C,52,11)},"parseFloat64"),re=f(function(C){var q=k(C,16,32);if(q==49152)return NaN;for(var ae=Math.pow(1e4,k(C,16,16)),le=0,ue=[],Ee=k(C,16),Te=0;Te<Ee;Te++)le+=k(C,16,64+16*Te)*ae,ae/=1e4;var se=Math.pow(10,k(C,16,48));return(q===0?1:-1)*Math.round(le*se)/se},"parseNumeric"),$=f(function(C,q){var ae=k(q,1),le=k(q,63,1),ue=new Date((ae===0?1:-1)*le/1e3+9466848e5);return C||ue.setTime(ue.getTime()+ue.getTimezoneOffset()*6e4),ue.usec=le%1e3,ue.getMicroSeconds=function(){return this.usec},ue.setMicroSeconds=function(Ee){this.usec=Ee},ue.getUTCMicroSeconds=function(){return this.usec},ue},"parseDate"),W=f(function(C){for(var q=k(C,32),ae=k(C,32,32),le=k(C,32,64),ue=96,Ee=[],Te=0;Te<q;Te++)Ee[Te]=k(C,32,ue),ue+=32,ue+=32;var se=f(function(me){var ce=k(C,32,ue);if(ue+=32,ce==4294967295)return null;var je;if(me==23||me==20)return je=k(C,ce*8,ue),ue+=ce*8,je;if(me==25)return je=C.toString(this.encoding,ue>>3,(ue+=ce<<3)>>3),je;console.log("ERROR: ElementType not implemented: "+me)},"parseElement"),ge=f(function(me,ce){var je=[],ve;if(me.length>1){var $e=me.shift();for(ve=0;ve<$e;ve++)je[ve]=ge(me,ce);me.unshift($e)}else for(ve=0;ve<me[0];ve++)je[ve]=se(ce);return je},"parse");return ge(Ee,le)},"parseArr	ay"),F=f(function(C){return C.toString("utf8")},"parseText"),te=f(function(C){return C===null?null:k(C,8)>0},"parseBool"),N=f(function(C){C(20,O),C(21,j),C(23,M),C(26,M),C(1700,re),C(700,A),C(701,B),C(16,te),C(1114,$.bind(null,!1)),C(1184,$.bind(null,!0)),C(1e3,W),C(1007,W),C(1016,W),C(1008,W),C(1009,W),C(25,F)},"init");T.exports={init:N}}),$i=v((ee,T)=>{G(),T.exports={BOOL:16,BYTEA:17,CHAR:18,INT8:20,INT2:21,INT4:23,REGPROC:24,TEXT:25,OID:26,TID:27,XID:28,CID:29,JSON:114,XML:142,PG_NODE_TREE:194,SMGR:210,PATH:602,POLYGON:604,CIDR:650,FLOAT4:700,FLOAT8:701,ABSTIME:702,RELTIME:703,TINTERVAL:704,CIRCLE:718,MACADDR8:774,MONEY:790,MACADDR:829,INET:869,ACLITEM:1033,BPCHAR:1042,VARCHAR:1043,DATE:1082,TIME:1083,TIMESTAMP:1114,TIMESTAMPTZ:1184,INTERVAL:1186,TIMETZ:1266,BIT:1560,VARBIT:1562,NUMERIC:1700,REFCURSOR:1790,REGPROCEDURE:2202,REGOPER:2203,REGOPERATOR:2204,REGCLASS:2205,REGTYPE:2206,UUID:2950,TXID_SNAPSHOT:2970,PG_LSN:3220,PG_NDISTINCT:3361,PG_DEPENDENCIES:3402,TSVECTOR:3614,TSQUERY:3615,GTSVECTOR:3642,REGCONFIG:3734,REGDICTIONARY:3769,JSONB:3802,REGNAMESPACE:4089,REGROLE:4096}}),ar=v(ee=>{G();var T=Or(),O=Ua(),k=yt(),I=$i();ee.getTypeParser=A,ee.setTypeParser=B,ee.arrayParser=k,ee.builtins=I;var j={text:{},binary:{}};function M(re){return String(re)}f(M,"noParse");function A(re,$){return $=$||"text",j[$]&&j[$][re]||M}f(A,"getTypeParser");function B(re,$,W){typeof $=="function"&&(W=$,$="text"),j[$][re]=W}f(B,"setTypeParser"),T.init(function(re,$){j.text[re]=$}),O.init(function(re,$){j.binary[re]=$})}),Ln=v((ee,T)=>{G(),T.exports={host:"localhost",user:De.platform==="win32"?De.env.USERNAME:De.env.USER,database:void 0,password:null,connectionString:void 0,port:5432,rows:0,binary:!1,max:10,idleTimeoutMillis:3e4,client_encoding:"",ssl:!1,application_name:void 0,fallback_application_name:void 0,options:void 0,parseInputDatesAsUTC:!1,statement_timeout:!1,lock_timeout:!1,idle_in_transaction_session_timeout:!1,query_timeout:!1,connect_timeout:0,keepalives:1,keepalives_idle:0};var O=ar(),k=O.getTypeParser(20,"text"),I=O.getTypeParser(1016,"text");T.exports.__defineSetter__("parseIn	t8",function(j){O.setTypeParser(20,"text",j?O.getTypeParser(23,"text"):k),O.setTypeParser(1016,"text",j?O.getTypeParser(1007,"text"):I)})}),or=v((ee,T)=>{G();var O=(bt(),R(Ue)),k=Ln();function I(N){var C=N.replace(/\\/g,"\\\\").replace(/"/g,'\\"');return'"'+C+'"'}f(I,"escapeElement");function j(N){for(var C="{",q=0;q<N.length;q++)q>0&&(C=C+","),N[q]===null||typeof N[q]>"u"?C=C+"NULL":Array.isArray(N[q])?C=C+j(N[q]):N[q]instanceof Ne?C+="\\\\x"+N[q].toString("hex"):C+=I(M(N[q]));return C=C+"}",C}f(j,"arrayString");var M=f(function(N,C){if(N==null)return null;if(N instanceof Ne)return N;if(ArrayBuffer.isView(N)){var q=Ne.from(N.buffer,N.byteOffset,N.byteLength);return q.length===N.byteLength?q:q.slice(N.byteOffset,N.byteOffset+N.byteLength)}return N instanceof Date?k.parseInputDatesAsUTC?$(N):re(N):Array.isArray(N)?j(N):typeof N=="object"?A(N,C):N.toString()},"pre	pareValue");function A(N,C){if(N&&typeof N.toPostgres=="function"){if(C=C||[],C.indexOf(N)!==-1)throw new Error('circular reference detected while preparing "'+N+'" for query');return C.push(N),M(N.toPostgres(M),C)}return JSON.stringify(N)}f(A,"prepareObject");function B(N,C){for(N=""+N;N.length<C;)N="0"+N;return N}f(B,"pad");function re(N){var C=-N.getTimezoneOffset(),q=N.getFullYear(),ae=q<1;ae&&(q=Math.abs(q)+1);var le=B(q,4)+"-"+B(N.getMonth()+1,2)+"-"+B(N.getDate(),2)+"T"+B(N.getHours(),2)+":"+B(N.getMinutes(),2)+":"+B(N.getSeconds(),2)+"."+B(N.getMilliseconds(),3);return C<0?(le+="-",C*=-1):le+="+",le+=B(Math.floor(C/60),2)+":"+B(C%60,2),ae&&(le+=" BC"),le}f(re,"dateToString");function $(N){var C=N.getUTCFullYear(),q=C<1;q&&(C=Math.abs(C)+1);var ae=B(C,4)+"-"+B(N.getUTCMonth()+1,2)+"-"+B(N.getUTCDate(),2)+"	T"+B(N.getUTCHours(),2)+":"+B(N.getUTCMinutes(),2)+":"+B(N.getUTCSeconds(),2)+"."+B(N.getUTCMilliseconds(),3);return ae+="+00:00",q&&(ae+=" BC"),ae}f($,"dateToStrin	gUTC");function W(N,C,q){return N=typeof N=="string"?{text:N}:N,C&&(typeof C=="	function"?N.callback=C:N.values=C),q&&(N.callback=q),N}f(W,"normalizeQueryConfi	g");var F=f(function(N){return O.createHash("md5").update(N,"utf-8").digest("h	ex")},"md5"),te=f(function(N,C,q){var ae=F(C+N),le=F(Ne.concat([Ne.from(ae),q]));return"	md5"+le},"postgresMd5PasswordHash");T.exports={prepareValue:f(function(N){return M(N)},"prepareValueWrapper"),normalizeQueryConfig:W,postgresMd5PasswordHash:te,md5:F}}),Ml=v((ee,T)=>{G();var O=(bt(),R(Ue));function k(C){if(C.indexOf("SCRAM-SHA-256")===-1)throw new Error("SASL: Only mechanism SCRAM-SHA-256 is cur	rently supported");let q=O.randomBytes(18).toString("base64");return{mechanism:"	SCRAM-SHA-256",clientNonce:q,response:"n,,n=*,r="+q,message:"SASLInitialResponse"}}f(k,"startSession");function I(C,q,ae){if(C.message!=="SASLInitialResponse")throw new Error("SASL: Last message was not SASLInitialResponse");if(typeof q!="string")throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: client password must be a string");if(typeof ae!="string")throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: serverData must be a	 string");let le=re(ae);if(le.nonce.startsWith(C.clientNonce)){if(le.nonce.length===C.clientNonce.length)throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server n	once is too short")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: serv	er nonce does not start with client nonce");var ue=Ne.from(le.salt,"base64"),Ee=N(q,ue,le.iteration),Te=te(Ee,"Client Key"),se=F(Te),ge="n=*,r="+C.clientNonce,me="r="+le.nonce+",s="+le.salt+",i="+le.iteration,ce="c=biws,r="+le.nonce,je=ge+","+me+","+ce,ve=te(se,je),$e=W(Te,ve),We=$e.toString("base64"),Ce=te(Ee,"Server Key"),Fe=te(Ce,je);C.message="SASLRespon	se",C.serverSignature=Fe.toString("base64"),C.response=ce+",p="+We}f(I,"continueSe	ssion");function j(C,q){if(C.message!=="SASLResponse")throw new Error("SASL: La	st message was not SASLResponse");if(typeof q!="string")throw new Error("SASL: S	CRAM-SERVER-FINAL-MESSAGE: serverData must be a string");let{serverSignature:ae}=$(q);if(ae!==C.serverSignature)throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: s	erver signature does not match")}f(j,"finalizeSession");function M(C){if(typeof C!="string")throw new TypeError("SASL: text must be a string");return C.split("").map((q,ae)=>C.charCodeAt(ae)).every(q=>q>=33&&q<=43||q>=45&&q<=126)}f(M,"isPrintableC	hars");function A(C){return/^(?:[a-zA-Z0-9+/]{4})*(?:[a-zA-Z0-9+/]{2}==|[a-zA-Z0-9+/]{3}=)?$/.test(C)}f(A,"isBase64");function B(C){if(typeof C!="string")throw new TypeError("SASL: attribute pairs text must be a string");return new Map(C.split(",").map(q=>{if(!/^.=/.test(q))throw new Error("SASL: Invalid attribute pair entry");let ae=q[0],le=q.substring(2);return[ae,le]}))}f(B,"parseAttributePairs");function re(C){let q=B(C),ae=q.get("r");if(ae){if(!M(ae))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAG	E: nonce must only contain printable characters")}else throw new Error("SASL: SC	RAM-SERVER-FIRST-MESSAGE: nonce missing");let le=q.get("s");if(le){if(!A(le))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt must be base64")}else throw new Error("S	ASL: SCRAM-SERVER-FIRST-MESSAGE: salt missing");let ue=q.get("i");if(ue){if(!/^[1-9][0-9]*$/.test(ue))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: invalid iteration cou	nt")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: iteration missing");let Ee=parseInt(ue,10);return{nonce:ae,salt:le,iteration:Ee}}f(re,"parseServerFirstMe	ssage");function $(C){let q=B(C).get("v");if(q){if(!A(q))throw new Error("SAS	L: SCRAM-SERVER-FINAL-MESSAGE: server signature must be base64")}else throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature is missing");return{serverSignature:q}}f($,"parseServerFinalMessage");function W(C,q){if(!Ne.isBuffer(C))throw new TypeError("first argument must be a Buffer");if(!Ne.isBuffer(q))throw new TypeError("second	 argument must be a Buffer");if(C.length!==q.length)throw new Error("Buffer leng	ths must match");if(C.length===0)throw new Error("Buffers cannot be empty");return Ne.from(C.map((ae,le)=>C[le]^q[le]))}f(W,"xorBuffers");function F(C){return O.createHash("sha256").update(C).digest()}f(F,"sha256");function te(C,q){return O.createHmac("sha256",C).update(q).digest()}f(te,"hmacSha256");function N(C,q,ae){for(var le=te(C,Ne.concat([q,Ne.from([0,0,0,1])])),ue=le,Ee=0;Ee<ae-1;Ee++)le=te(C,le),ue=W(ue,le);return ue}f(N,"Hi"),T.exports={startSession:k,continueSession:I,finalizeSession:j}}),oi={};E(oi,{join:()=>Is});function Is(...ee){return ee.join("/")}var Ba=b(()=>{G(),f(Is,"join")}),Zt={};E(Zt,{stat:()=>ls});function ls(ee,T){T(new Error("No filesystem"))}var Vn=b(()=>{G(),f(ls,"stat")}),za={};E(za,{default:()=>Qi});var Qi,Io=b(()=>{G(),Qi={}}),kr={};E(kr,{StringDecoder:()=>vs});var Un,vs,rn=b(()=>{G(),Un=class{constructor(T){U(this,"td"),this.td=new TextDecoder(T)}write(T){return this.td.decode(T,{stream:!0})}end(T){return this.td.decode(T)}},f(Un,"StringDecoder"),vs=Un}),Rs=v((ee,T)=>{G();var{Transform:O}=(Io(),R(za)),{StringDecoder:k}=(rn(),R(kr)),I=Symbol("last"),j=Symbol("decoder");function M(W,F,te){let N;if(this.overflow){if(N=this[j].write(W).split(this.matcher),N.length===1)return te();N.shift(),this.overflow=!1}else this[I]+=this[j].write(W),N=this[I].split(this.matcher);this[I]=N.pop();for(let C=0;C<N.length;C++)try{B(this,this.mapper(N[C]))}catch(q){return te(q)}if(this.overflow=this[I].length>this.maxLength,this.overflow&&!this.skipOverflow){te(new Error("maximum buffer reached"));return}te()}f(M,"transform");function A(W){if(this[I]+=this[j].end(),this[I])try{B(this,this.mapper(this[I]))}catch(F){return W(F)}W()}f(A,"flush");function B(W,F){F!==void 0&&W.push(F)}f(B,"push");function re(W){return W}f(re,"noop");function $(W,F,te){switch(W=W||/\r?\n/,F=F||re,te=te||{},arguments.length){case 1:typeof W=="function"?(F=W,W=/\r?\n/):typeof W=="object"&&!(W instanceof RegExp)&&!W[Symbol.split]&&(te=W,W=/\r?\n/);break;case 2:typeof W=="function"?(te=F,F=W,W=/\r?\n/):typeof F=="object"&&(te=F,F=re)}te=Object.assign({},te),te.autoDestroy=!0,te.transform=M,te.flush=A,te.readableObjectMode=!0;let N=new O(te);return N[I]="",N[j]=new k("utf8"),N.matcher=W,N.mapper=F,N.maxLength=te.maxLength,N.skipOverflow=te.skipOverflow||!1,N.overflow=!1,N._destroy=function(C,q){this._writableState.errorEmitted=!1,q(C)},N}f($,"split"),T.exports=$}),Pl=v((ee,T)=>{G();var O=(Ba(),R(oi)),k=(Io(),R(za)).Stream,I=Rs(),j=(Q(),R(L)),M=5432,A=De.platform==="win32",B=De.stderr,re=56,$=7,W=61440,F=32768;function te(Te){return(Te&W)==F}f(te,"isRegFile");var N=["host","port","database","user","password"],C=N.length,q=N[C-1];function ae(){var Te=B instanceof k&&B.writable===!0;if(Te){var se=Array.prototype.slice.call(arguments).concat(`
`);B.write(j.format.apply(j,se))}}f(ae,"warn"),Object.defineProperty(T.exports,"isWin",{get:f(function(){return A},"get"),set:f(function(Te){A=Te},"set")}),T.exports.warnTo=function(Te){var se=B;return B=Te,se},T.exports.getFileName=function(Te){var se=Te||De.env,ge=se.PGPASSFILE||(A?O.join(se.APPDATA||"./","postgresql","pgpass.	conf"):O.join(se.HOME||"./",".pgpass"));return ge},T.exports.usePgPass=function(Te,se){return Object.prototype.hasOwnProperty.call(De.env,"PGPASSWORD")?!1:A?!0:(se=se||"	<unkn>",te(Te.mode)?Te.mode&(re|$)?(ae('WARNING: password file "%s" has group or 	world access; permissions should be u=rw (0600) or less',se),!1):!0:(ae('WARNING:	 password file "%s" is not a plain file',se),!1))};var le=T.exports.match=function(Te,se){return N.slice(0,-1).reduce(function(ge,me,ce){return ce==1&&Number(Te[me]||M)===Number(se[me])?ge&&!0:ge&&(se[me]==="*"||se[me]===Te[me])},!0)};T.exports.getPassword=function(Te,se,ge){var me,ce=se.pipe(I());function je(We){var Ce=ue(We);Ce&&Ee(Ce)&&le(Te,Ce)&&(me=Ce[q],ce.end())}f(je,"onLine");var ve=f(function(){se.destroy(),ge(me)},"onEnd"),$e=f(function(We){se.destroy(),ae("WARNING: error on reading file: %s",We),ge(void 0)},"onErr");se.on("error",$e),ce.on("data",je).on("end",ve).on("error",$e)};var ue=T.exports.parseLine=function(Te){if(Te.length<11||Te.match(/^\s+#/))return null;for(var se="",ge="",me=0,ce=0,je=0,ve={},$e=!1,We=f(function(Fe,Ze,Ye){var ut=Te.substring(Ze,Ye);Object.hasOwnProperty.call(De.env,"PGPASS_NO_DEESCAPE")||(ut=ut.replace(/\\([:\\])/g,"$1")),ve[N[Fe]]=ut},"addToObj"),Ce=0;Ce<Te.length-1;Ce+=1){if(se=Te.charAt(Ce+1),ge=Te.charAt(Ce),$e=me==C-1,$e){We(me,ce);break}Ce>=0&&se==":"&&ge!=="\\"&&(We(me,ce,Ce+1),ce=Ce+2,me+=1)}return ve=Object.keys(ve).length===C?ve:null,ve},Ee=T.exports.isValidEntry=function(Te){for(var se={0:function(ve){return ve.length>0},1:function(ve){return ve==="*"?!0:(ve=Number(ve),isFinite(ve)&&ve>0&&ve<9007199254740992&&Math.floor(ve)===ve)},2:function(ve){return ve.length>0},3:function(ve){return ve.length>0},4:function(ve){return ve.length>0}},ge=0;ge<N.length;ge+=1){var me=se[ge],ce=Te[N[ge]]||"",je=me(ce);if(!je)return!1}return!0}}),Ro=v((ee,T)=>{G(),Ba(),R(oi);var O=(Vn(),R(Zt)),k=Pl();T.exports=function(I,j){var M=k.getFileName();O.stat(M,function(A,B){if(A||!k.usePgPass(B,M))return j(void 0);var re=O.createReadStream(M);k.getPassword(I,re,j)})},T.exports.warnTo=k.warnTo}),Ki=v((ee,T)=>{G();var O=ar();function k(I){this._types=I||O,this.text={},this.binary={}}f(k,"TypeOverrides"),k.prototype.getOverrides=function(I){switch(I){case"text":return this.text;case"binary":return this.binary;default:return{}}},k.prototype.setTypeParser=function(I,j,M){typeof j=="function"&&(M=j,j="text"),this.getOverrides(j)[I]=M},k.prototype.getTypeParser=function(I,j){return j=j||"text",this.getOverrides(j)[I]||this._types.getTypeParser(I,j)},T.exports=k}),bn={};E(bn,{default:()=>lr});var lr,vn=b(()=>{G(),lr={}}),Qs={};E(Qs,{parse:()=>Bn});function Bn(ee,T=!1){let{protocol:O}=new URL(ee),k="	http:"+ee.substring(O.length),{username:I,password:j,host:M,hostname:A,port:B,pathname:re,search:$,searchParams:W,hash:F}=new URL(k);j=decodeURIComponent(j),I=decodeURIComponent(I),re=decodeURIComponent(re);let te=I+":"+j,N=T?Object.fromEntries(W.entries()):$;return{href:ee,protocol:O,auth:te,username:I,password:j,host:M,hostname:A,port:B,pathname:re,search:$,query:N,hash:F}}var li=b(()=>{G(),f(Bn,"parse")}),Fa=v((ee,T)=>{G();var O=(li(),R(Qs)),k=(Vn(),R(Zt));function I(j){if(j.charAt(0)==="/"){var A=j.split(" ");return{host:A[0],database:A[1]}}var M=O.parse(/ |%[^a-f0-9]|%[a-f0-9][^a-f0-9]/i.test(j)?encodeURI(j).replace(/\%25(\d\d)/g,"%$1"):j,!0),A=M.query;for(var B in A)Array.isArray(A[B])&&(A[B]=A[B][A[B].length-1]);var re=(M.auth||":").split(":");if(A.user=re[0],A.password=re.splice(1).join(":"),A.port=M.port,M.protocol=="socket:")return A.host=decodeURI(M.pathname),A.database=M.query.db,A.client_encoding=M.query.encoding,A;A.host||(A.host=M.hostname);var $=M.pathname;if(!A.host&&$&&/^%2f/i.test($)){var W=$.split("/");A.host=decodeURIComponent(W[0]),$=W.splice(1).join("/")}switch($&&$.charAt(0)==="/"&&($=$.slice(1)||null),A.database=$&&decodeURI($),(A.ssl==="true"||A.ssl==="1")&&(A.ssl=!0),A.ssl==="0"&&(A.ssl=!1),(A.sslcert||A.sslkey||A.sslrootcert||A.sslmode)&&(A.ssl={}),A.sslcert&&(A.ssl.cert=k.readFileSync(A.sslcert).toString()),A.sslkey&&(A.ssl.key=k.readFileSync(A.sslkey).toString()),A.sslrootcert&&(A.ssl.ca=k.readFileSync(A.sslrootcert).toString()),A.sslmode){case"disable":{A.ssl=!1;break}case"prefer":case"require":case"verify-	ca":case"verify-full":break;case"no-verify":{A.ssl.rejectUnauthorized=!1;break}}return A}f(I,"parse"),T.exports=I,I.parse=I}),zn=v((ee,T)=>{G();var O=(vn(),R(bn)),k=Ln(),I=Fa().parse,j=f(function(W,F,te){return te===void 0?te=De.env["PG"+W.toUpperCase()]:te===!1||(te=De.env[te]),F[W]||te||k[W]},"val"),M=f(function(){switch(De.env.PGSSLMODE){case"disable":return!1;case"	prefer":case"require":case"verify-ca":case"verify-full":return!0;case"no-verify":return{rejectUnauthorized:!1}}return k.ssl},"readSSLConfigFromEnvironment"),A=f(function(W){return"'"+(""+W).replace(/\\/g,"\\\\").replace(/'/g,"\\'")+"'"},"quo	teParamValue"),B=f(function(W,F,te){var N=F[te];N!=null&&W.push(te+"="+A(N))},"ad	d"),re=class{constructor(F){F=typeof F=="string"?I(F):F||{},F.connectionString&&(F=Object.assign({},F,I(F.connectionString))),this.user=j("user",F),this.database=j("database",F),this.database===void 0&&(this.database=this.user),this.port=parseInt(j("port",F),10),this.host=j("host",F),Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:j("password",F)}),this.binary=j("binary",F),this.options=j("options",F),this.ssl=typeof F.ssl>"u"?M():F.ssl,typeof this.ssl=="st	ring"&&this.ssl==="true"&&(this.ssl=!0),this.ssl==="no-verify"&&(this.ssl={rejectUnauthorized:!1}),this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this.client_encoding=j("client_encoding",F),this.replication=j("replication",F),this.isDomainSocket=!(this.host||"").indexOf("/"),this.application_name=j("applicatio	n_name",F,"PGAPPNAME"),this.fallback_application_name=j("fallback_application_na	me",F,!1),this.statement_timeout=j("statement_timeout",F,!1),this.lock_timeout=j("lock_timeout",F,!1),this.idle_in_transaction_session_timeout=j("idle_in_transac	tion_session_timeout",F,!1),this.query_timeout=j("query_timeout",F,!1),F.connectionTimeoutMillis===void 0?this.connect_timeout=De.env.PGCONNECT_TIMEOUT||0:this.connect_timeout=Math.floor(F.connectionTimeoutMillis/1e3),F.keepAlive===!1?this.keepalives=0:F.keepAlive===!0&&(this.keepalives=1),typeof F.keepAliveInitialDelayMillis=="number"&&(this.keepalives_idle=Math.floor(F.keepAliveInitialDelayMillis/1e3))}getLibpqConnectionString(F){var te=[];B(te,this,"user"),B(te,this,"password"),B(te,this,"port"),B(te,this,"application	_name"),B(te,this,"fallback_application_name"),B(te,this,"connect_timeout"),B(te,this,"options");var N=typeof this.ssl=="object"?this.ssl:this.ssl?{sslmode:this.ssl}:{};if(B(te,N,"sslmode"),B(te,N,"sslca"),B(te,N,"sslkey"),B(te,N,"sslcert"),B(te,N,"sslrootcert"),this.database&&te.push("dbname="+A(this.database)),this.replication&&te.push("replication="+A(this.replication)),this.host&&te.push("host="+A(this.host)),this.isDomainSocket)return F(null,te.join(" "));this.client_encoding&&te.push("cli	ent_encoding="+A(this.client_encoding)),O.lookup(this.host,function(C,q){return C?F(C,null):(te.push("hostaddr="+A(q)),F(null,te.join(" ")))})}};f(re,"ConnectionPa	rameters");var $=re;T.exports=$}),Yi=v((ee,T)=>{G();var O=ar(),k=/^([A-Za-z]+)(?: (\d+))?(?: (\d+))?/,I=class{constructor(A,B){this.command=null,this.rowCount=null,this.oid=null,this.rows=[],this.fields=[],this._parsers=void 0,this._types=B,this.RowCtor=null,this.rowAsArray=A==="array",this.rowAsArray&&(this.parseRow=this._parseRowAsArray)}addCommandComplete(A){var B;A.text?B=k.exec(A.text):B=k.exec(A.command),B&&(this.command=B[1],B[3]?(this.oid=parseInt(B[2],10),this.rowCount=parseInt(B[3],10)):B[2]&&(this.rowCount=parseInt(B[2],10)))}_parseRowAsArray(A){for(var B=new Array(A.length),re=0,$=A.length;re<$;re++){var W=A[re];W!==null?B[re]=this._parsers[re](W):B[re]=null}return B}parseRow(A){for(var B={},re=0,$=A.length;re<$;re++){var W=A[re],F=this.fields[re].name;W!==null?B[F]=this._parsers[re](W):B[F]=null}return B}addRow(A){this.rows.push(A)}addFields(A){this.fields=A,this.fields.length&&(this._parsers=new Array(A.length));for(var B=0;B<A.length;B++){var re=A[B];this._types?this._parsers[B]=this._types.getTypeParser(re.dataTypeID,re.format||"t	ext"):this._parsers[B]=O.getTypeParser(re.dataTypeID,re.format||"text")}}};f(I,"	Result");var j=I;T.exports=j}),es=v((ee,T)=>{G();var{EventEmitter:O}=V(),k=Yi(),I=or(),j=class extends O{constructor(B,re,$){super(),B=I.normalizeQueryConfig(B,re,$),this.text=B.text,this.values=B.values,this.rows=B.rows,this.types=B.types,this.name=B.name,this.binary=B.binary,this.portal=B.portal||"",this.callback=B.callback,this._rowMode=B.rowMode,De.domain&&B.callback&&(this.callback=De.domain.bind(B.callback)),this._result=new k(this._rowMode,this.types),this._results=this._result,this.isPreparedStatement=!1,this._canceledDueToError=!1,this._promise=null}requiresPreparation(){return this.name||this.rows?!0:!this.text||!this.values?!1:this.values.length>0}_checkForMultirow(){this._result.command&&(Array.isArray(this._results)||(this._results=[this._result]),this._result=new k(this._rowMode,this.types),this._results.push(this._result))}handleRowDescription(B){this._checkForMultirow(),this._result.addFields(B.fields),this._accumulateRows=this.callback||!this.listeners("row").length}handleDataRow(B){let re;if(!this._canceledDueToError){try{re=this._result.parseRow(B.fields)}catch($){this._canceledDueToError=$;return}this.emit("row",re,this._result),this._accumulateRows&&this._result.addRow(re)}}handleCommandComplete(B,re){this._checkForMultirow(),this._result.addCommandComplete(B),this.rows&&re.sync()}handleEmptyQuery(B){this.rows&&B.sync()}handleError(B,re){if(this._canceledDueToError&&(B=this._canceledDueToError,this._canceledDueToError=!1),this.callback)return this.callback(B);this.emit("er	ror",B)}handleReadyForQuery(B){if(this._canceledDueToError)return this.handleError(this._canceledDueToError,B);if(this.callback)try{this.callback(null,this._results)}catch(re){De.nextTick(()=>{throw re})}this.emit("end",this._results)}submit(B){if(typeof this.text!="string"&&typeof this.name!="string")return new Error("A query must have e	ither text or a name. Supplying neither is unsupported.");let re=B.parsedStatements[this.name];return this.text&&re&&this.text!==re?new Error(`Prepared statements must be unique - '${this.name}' was used for a different statement`):this.values&&!Array.isArray(this.values)?new Error("Query values must be an array"):(this.requiresPreparation()?this.prepare(B):B.query(this.text),null)}hasBeenParsed(B){return this.name&&B.parsedStatements[this.name]}handlePortalSuspended(B){this._getRows(B,this.rows)}_getRows(B,re){B.execute({portal:this.portal,rows:re}),re?B.flush():B.sync()}prepare(B){this.isPreparedStatement=!0,this.hasBeenParsed(B)||B.parse({text:this.text,name:this.name,types:this.types});try{B.bind({portal:this.portal,statement:this.name,values:this.values,binary:this.binary,valueMapper:I.prepareValue})}catch(re){this.handleError(re,B);return}B.describe({type:"P",name:this.portal||""}),this._getRows(B,this.rows)}handleCopyInResponse(B){B.sendCopyFail("No source stream defined")}handleCopyData(B,re){}};f(j,"Query");var M=j;T.exports=M}),qa={};E(qa,{Socket:()=>Ks,isIP:()=>cr});function cr(ee){return 0}var ur,ci,dr,Ks,Ha=b(()=>{G(),ur=_(V(),1),f(cr,"isIP"),ci=/^[^.]+\./,dr=class lt extends ur.EventEmitter{constructor(){super(...arguments),U(this,"opts",{}),U(this,"connecting",!1),U(this,"pending",!0),U(this,"writable",!0),U(this,"encrypted",!1),U(this,"authorized",!1),U(this,"des	troyed",!1),U(this,"ws",null),U(this,"writeBuffer"),U(this,"tlsState",0),U(this,"tlsRead"),U(this,"tlsWrite")}static get poolQueryViaFetch(){var T;return(T=lt.opts.poolQueryViaFetch)!=null?T:lt.defaults.poolQueryViaFetch}static set poolQueryViaFetch(T){lt.opts.poolQueryViaFetch=T}static get fetchEndpoint(){var T;return(T=lt.opts.fetchEndpoint)!=null?T:lt.defaults.fetchEndpoint}static set fetchEndpoint(T){lt.opts.fetchEndpoint=T}static get fetchConnectionCache(){return!0}static set fetchConnectionCache(T){console.warn("The `fetchConnectionCache` option is deprecated (now always `true`	)")}static get fetchFunction(){var T;return(T=lt.opts.fetchFunction)!=null?T:lt.defaults.fetchFunction}static set fetchFunction(T){lt.opts.fetchFunction=T}static get webSocketConstructor(){var T;return(T=lt.opts.webSocketConstructor)!=null?T:lt.defaults.webSocketConstructor}static set webSocketConstructor(T){lt.opts.webSocketConstructor=T}get webSocketConstructor(){var T;return(T=this.opts.webSocketConstructor)!=null?T:lt.webSocketConstructor}set webSocketConstructor(T){this.opts.webSocketConstructor=T}static get wsProxy(){var T;return(T=lt.opts.wsProxy)!=null?T:lt.defaults.wsProxy}static set wsProxy(T){lt.opts.wsProxy=T}get wsProxy(){var T;return(T=this.opts.wsProxy)!=null?T:lt.wsProxy}set wsProxy(T){this.opts.wsProxy=T}static get coalesceWrites(){var T;return(T=lt.opts.coalesceWrites)!=null?T:lt.defaults.coalesceWrites}static set coalesceWrites(T){lt.opts.coalesceWrites=T}get coalesceWrites(){var T;return(T=this.opts.coalesceWrites)!=null?T:lt.coalesceWrites}set coalesceWrites(T){this.opts.coalesceWrites=T}static get useSecureWebSocket(){var T;return(T=lt.opts.useSecureWebSocket)!=null?T:lt.defaults.useSecureWebSocket}static set useSecureWebSocket(T){lt.opts.useSecureWebSocket=T}get useSecureWebSocket(){var T;return(T=this.opts.useSecureWebSocket)!=null?T:lt.useSecureWebSocket}set useSecureWebSocket(T){this.opts.useSecureWebSocket=T}static get forceDisablePgSSL(){var T;return(T=lt.opts.forceDisablePgSSL)!=null?T:lt.defaults.forceDisablePgSSL}static set forceDisablePgSSL(T){lt.opts.forceDisablePgSSL=T}get forceDisablePgSSL(){var T;return(T=this.opts.forceDisablePgSSL)!=null?T:lt.forceDisablePgSSL}set forceDisablePgSSL(T){this.opts.forceDisablePgSSL=T}static get disableSNI(){var T;return(T=lt.opts.disableSNI)!=null?T:lt.defaults.disableSNI}static set disableSNI(T){lt.opts.disableSNI=T}get disableSNI(){var T;return(T=this.opts.disableSNI)!=null?T:lt.disableSNI}set disableSNI(T){this.opts.disableSNI=T}static get pipelineConnect(){var T;return(T=lt.opts.pipelineConnect)!=null?T:lt.defaults.pipelineConnect}static set pipelineConnect(T){lt.opts.pipelineConnect=T}get pipelineConnect(){var T;return(T=this.opts.pipelineConnect)!=null?T:lt.pipelineConnect}set pipelineConnect(T){this.opts.pipelineConnect=T}static get subtls(){var T;return(T=lt.opts.subtls)!=null?T:lt.defaults.subtls}static set subtls(T){lt.opts.subtls=T}get subtls(){var T;return(T=this.opts.subtls)!=null?T:lt.subtls}set subtls(T){this.opts.subtls=T}static get pipelineTLS(){var T;return(T=lt.opts.pipelineTLS)!=null?T:lt.defaults.pipelineTLS}static set pipelineTLS(T){lt.opts.pipelineTLS=T}get pipelineTLS(){var T;return(T=this.opts.pipelineTLS)!=null?T:lt.pipelineTLS}set pipelineTLS(T){this.opts.pipelineTLS=T}static get rootCerts(){var T;return(T=lt.opts.rootCerts)!=null?T:lt.defaults.rootCerts}static set rootCerts(T){lt.opts.rootCerts=T}get rootCerts(){var T;return(T=this.opts.rootCerts)!=null?T:lt.rootCerts}set rootCerts(T){this.opts.rootCerts=T}wsProxyAddrForHost(T,O){let k=this.wsProxy;if(k===void 0)throw new Error("No WebSocket proxy is configur	ed. Please see https://github.com/neondatabase/serverless/blob/main/CONFIG.md#ws	proxy-string--host-string-port-number--string--string");return typeof k=="functi	on"?k(T,O):`${k}?address=${T}:${O}`}setNoDelay(){return this}setKeepAlive(){return this}ref(){return this}unref(){return this}connect(T,O,k){this.connecting=!0,k&&this.once("	connect",k);let I=f(()=>{this.connecting=!1,this.pending=!1,this.emit("connect"),this.emit("ready")},"handleWebSocketOpen"),j=f((A,B=!1)=>{A.binaryType="arraybuf	fer",A.addEventListener("error",re=>{this.emit("error",re),this.emit("close")}),A.addEventListener("message",re=>{if(this.tlsState===0){let $=Ne.from(re.data);this.emit("data",$)}}),A.addEventListener("close",()=>{this.emit("close")}),B?I():A.addEventListener("open",I)},"configureWebSocket"),M;try{M=this.wsProxyAddrForHost(O,typeof T=="st	ring"?parseInt(T,10):T)}catch(A){this.emit("error",A),this.emit("close");return}try{let A=(this.useSecureWebSocket?"wss:":"ws:")+"//"+M;if(this.webSocketConstructor!==void 0)this.ws=new this.webSocketConstructor(A),j(this.ws);else try{this.ws=new WebSocket(A),j(this.ws)}catch(B){this.ws=new __unstable_WebSocket(A),j(this.ws)}}catch(A){let B=(this.useSecureWebSocket?"https:":"http:")+"//"+M;fetch(B,{headers:{Upgrade:"websocket"}}).then(re=>{if(this.ws=re.webSocket,this.ws==null)throw A;this.ws.accept(),j(this.ws,!0)}).catch(re=>{this.emit("error",new Error(`All attempts to open a WebSocket to connect to the database failed. Please refer to https://github.com/neondatabase/serverless/blob/main/CONFIG.md#websocketconstructor-typeof-websocket--undefined. Details: ${re.message}`)),this.emit("close")})}}startTls(T){return K(this,null,function*(){if(this.subtls===void 0)throw new Error("For Postgres SSL connections, you must set `neonConfig.s	ubtls` to the subtls library. See https://github.com/neondatabase/serverless/blo	b/main/CONFIG.md for more information.");this.tlsState=1;let O=this.subtls.TrustedCert.fromPEM(this.rootCerts),k=new this.subtls.WebSocketReadQueue(this.ws),I=k.read.bind(k),j=this.rawWrite.bind(this),[M,A]=yield this.subtls.startTls(T,O,I,j,{useSNI:!this.disableSNI,expectPreData:this.pipelineTLS?new Uint8Array([83]):void 0});this.tlsRead=M,this.tlsWrite=A,this.tlsState=2,this.encrypted=!0,this.authorized=!0,this.emit("secureConnection",this),this.tlsReadLoop()})}tlsReadLoop(){return K(this,null,function*(){for(;;){let T=yield this.tlsRead();if(T===void 0)break;{let O=Ne.from(T);this.emit("data",O)}}})}rawWrite(T){if(!this.coalesceWrites){this.ws.send(T);return}if(this.writeBuffer===void 0)this.writeBuffer=T,setTimeout(()=>{this.ws.send(this.writeBuffer),this.writeBuffer=void 0},0);else{let O=new Uint8Array(this.writeBuffer.length+T.length);O.set(this.writeBuffer),O.set(T,this.writeBuffer.length),this.writeBuffer=O}}write(T,O="utf8",k=I=>{}){return T.length===0?(k(),!0):(typeof T=="string"&&(T=Ne.from(T,O)),this.tlsState===0?(this.rawWrite(T),k()):this.tlsState===1?this.once("secureConnection",()=>{this.write(T,O,k)}):(this.tlsWrite(T),k()),!0)}end(T=Ne.alloc(0),O="utf8",k=()=>{}){return this.write(T,O,()=>{this.ws.close(),k()}),this}destroy(){return this.destroyed=!0,this.end()}},f(dr,"Socket"),U(dr,"defaults",{poolQueryViaFetch:!1,fetchEndpoint:f((ee,T,O)=>{let k;return O!=null&&O.jwtAuth?k=ee.replace(ci,"apiauth."):k=ee.replace(ci,"api."),"https	://"+k+"/sql"},"fetchEndpoint"),fetchConnectionCache:!0,fetchFunction:void 0,webSocketConstructor:void 0,wsProxy:f(ee=>ee+"/v2","wsProxy"),useSecureWebSocket:!0,forceDisablePgSSL:!0,coalesceWrites:!0,pipelineConnect:"password",subtls:void 0,rootCerts:"",pipelineTLS:!1,disableSNI:!1}),U(dr,"opts",{}),Ks=dr}),_n=v(ee=>{G(),Object.defineProperty(ee,"__esModule",{value:!0}),ee.NoticeMessage=ee.DataRowMessage=ee.CommandCompleteMessage=ee.ReadyForQueryMessage=ee.NotificationResponseMessage=ee.BackendKeyDataMessage=ee.AuthenticationMD5Password=ee.ParameterStatusMessage=ee.ParameterDescriptionMessage=ee.RowDescriptionMessage=ee.Field=ee.CopyResponse=ee.CopyDataMessage=ee.DatabaseError=ee.copyDone=ee.emptyQuery=ee.replicationStart=ee.portalSuspended=ee.noData=ee.closeComplete=ee.bindComplete=ee.parseComplete=void 0,ee.parseComplete={name:"parseComplete",length:5},ee.bindComplete={name:"bin	dComplete",length:5},ee.closeComplete={name:"closeComplete",length:5},ee.noData={name:"	noData",length:5},ee.portalSuspended={name:"portalSuspended",length:5},ee.replicationStart={name:"replicationStart",length:4},ee.emptyQuery={name:"emptyQuery",length:4},ee.copyDone={name:"copyDone",length:4};var T=class extends Error{constructor(Ce,Fe,Ze){super(Ce),this.length=Fe,this.name=Ze}};f(T,"DatabaseError");var O=T;ee.DatabaseError=O;var k=class{constructor(Ce,Fe){this.length=Ce,this.chunk=Fe,this.name="copyData"}};f(k,"CopyDataMessage");var I=k;ee.CopyDataMessage=I;var j=class{constructor(Ce,Fe,Ze,Ye){this.length=Ce,this.name=Fe,this.binary=Ze,this.columnTypes=new Array(Ye)}};f(j,"Co	pyResponse");var M=j;ee.CopyResponse=M;var A=class{constructor(Ce,Fe,Ze,Ye,ut,It,Js){this.name=Ce,this.tableID=Fe,this.columnID=Ze,this.dataTypeID=Ye,this.dataTypeSize=ut,this.dataTypeModifier=It,this.format=Js}};f(A,"Field");var B=A;ee.Field=B;var re=class{constructor(Ce,Fe){this.length=Ce,this.fieldCount=Fe,this.name="rowDescription",this.fields=new Array(this.fieldCount)}};f(re,"RowDescriptionMessage");var $=re;ee.RowDescriptionMessage=$;var W=class{constructor(Ce,Fe){this.length=Ce,this.parameterCount=Fe,this.name="parameterDescription",this.dataTypeIDs=new Array(this.parameterCount)}};f(W,"P	arameterDescriptionMessage");var F=W;ee.ParameterDescriptionMessage=F;var te=class{constructor(Ce,Fe,Ze){this.length=Ce,this.parameterName=Fe,this.parameterValue=Ze,this.name="parameterSta	tus"}};f(te,"ParameterStatusMessage");var N=te;ee.ParameterStatusMessage=N;var C=class{constructor(Ce,Fe){this.length=Ce,this.salt=Fe,this.name="authenticationMD5Password"}};f(C,"Authenti	cationMD5Password");var q=C;ee.AuthenticationMD5Password=q;var ae=class{constructor(Ce,Fe,Ze){this.length=Ce,this.processID=Fe,this.secretKey=Ze,this.name="backendKeyData"}};f(ae,"BackendKeyDataMessage");var le=ae;ee.BackendKeyDataMessage=le;var ue=class{constructor(Ce,Fe,Ze,Ye){this.length=Ce,this.processId=Fe,this.channel=Ze,this.payload=Ye,this.name="notifica	tion"}};f(ue,"NotificationResponseMessage");var Ee=ue;ee.NotificationResponseMessage=Ee;var Te=class{constructor(Ce,Fe){this.length=Ce,this.status=Fe,this.name="ready	ForQuery"}};f(Te,"ReadyForQueryMessage");var se=Te;ee.ReadyForQueryMessage=se;var ge=class{constructor(Ce,Fe){this.length=Ce,this.text=Fe,this.name="commandComplete"}};f(ge,"CommandCompleteMes	sage");var me=ge;ee.CommandCompleteMessage=me;var ce=class{constructor(Ce,Fe){this.length=Ce,this.fields=Fe,this.name="dataRow",this.fieldCount=Fe.length}};f(ce,"Data	RowMessage");var je=ce;ee.DataRowMessage=je;var ve=class{constructor(Ce,Fe){this.length=Ce,this.message=Fe,this.name="notice"}};f(ve,"NoticeMessage");var $e=ve;ee.NoticeMessage=$e}),ts=v(ee=>{G(),Object.defineProperty(ee,"__esModule",{value:!0}),ee.Writer=void 0;var T=class{constructor(I=256){this.size=I,this.offset=5,this.headerPosition=0,this.buffer=Ne.allocUnsafe(I)}ensure(I){var j=this.buffer.length-this.offset;if(j<I){var M=this.buffer,A=M.length+(M.length>>1)+I;this.buffer=Ne.allocUnsafe(A),M.copy(this.buffer)}}addInt32(I){return this.ensure(4),this.buffer[this.offset++]=I>>>24&255,this.buffer[this.offset++]=I>>>16&255,this.buffer[this.offset++]=I>>>8&255,this.buffer[this.offset++]=I>>>0&255,this}addInt16(I){return this.ensure(2),this.buffer[this.offset++]=I>>>8&255,this.buffer[this.offset++]=I>>>0&255,this}addCString(I){if(!I)this.ensure(1);else{var j=Ne.byteLength(I);this.ensure(j+1),this.buffer.write(I,this.offset,"utf-8"),this.offset+=j}return this.buffer[this.offset++]=0,this}addString(I=""){var j=Ne.byteLength(I);return this.ensure(j),this.buffer.write(I,this.offset),this.offset+=j,this}add(I){return this.ensure(I.length),I.copy(this.buffer,this.offset),this.offset+=I.length,this}join(I){if(I){this.buffer[this.headerPosition]=I;let j=this.offset-(this.headerPosition+1);this.buffer.writeInt32BE(j,this.headerPosition+1)}return this.buffer.slice(I?0:5,this.offset)}flush(I){var j=this.join(I);return this.offset=5,this.headerPosition=0,this.buffer=Ne.allocUnsafe(this.size),j}};f(T,"Wr	iter");var O=T;ee.Writer=O}),_s=v(ee=>{G(),Object.defineProperty(ee,"__esModule",{value:!0}),ee.serialize=void 0;var T=ts(),O=new T.Writer,k=f(Ce=>{O.addInt16(3).addInt16(0);for(let Ye of Object.keys(Ce))O.addCString(Ye).addCString(Ce[Ye]);O.addCString("cl	ient_encoding").addCString("UTF8");var Fe=O.addCString("").flush(),Ze=Fe.length+4;return new T.Writer().addInt32(Ze).add(Fe).flush()},"startup"),I=f(()=>{let Ce=Ne.allocUnsafe(8);return Ce.writeInt32BE(8,0),Ce.writeInt32BE(80877103,4),Ce},"requestSsl"),j=f(Ce=>O.addCString(Ce).flush(112),"password"),M=f(function(Ce,Fe){return O.addCString(Ce).addInt32(Ne.byteLength(Fe)).addString(Fe),O.flush(112)},"sendSASLInitialResponseMessage"),A=f(function(Ce){return O.addString(Ce).flush(112)},"sendSCRAMClientFinalMessage"),B=f(Ce=>O.addCString(Ce).flush(81),"query"),re=[],$=f(Ce=>{let Fe=Ce.name||"";Fe.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",Fe,Fe.length),console.error("This can cause c	onflicts and silent errors executing queries"));let Ze=Ce.types||re;for(var Ye=Ze.length,ut=O.addCString(Fe).addCString(Ce.text).addInt16(Ye),It=0;It<Ye;It++)ut.addInt32(Ze[It]);return O.flush(80)},"parse"),W=new T.Writer,F=f(function(Ce,Fe){for(let Ze=0;Ze<Ce.length;Ze++){let Ye=Fe?Fe(Ce[Ze],Ze):Ce[Ze];Ye==null?(O.addInt16(0),W.addInt32(-1)):Ye instanceof Ne?(O.addInt16(1),W.addInt32(Ye.length),W.add(Ye)):(O.addInt16(0),W.addInt32(Ne.byteLength(Ye)),W.addString(Ye))}},"writeValues"),te=f((Ce={})=>{let Fe=Ce.portal||"",Ze=Ce.statement||"",Ye=Ce.binary||!1,ut=Ce.values||re,It=ut.length;return O.addCString(Fe).addCString(Ze),O.addInt16(It),F(ut,Ce.valueMapper),O.addInt16(It),O.add(W.flush()),O.addInt16(Ye?1:0),O.flush(66)},"bind"),N=Ne.from([69,0,0,0,9,0,0,0,0,0]),C=f(Ce=>{if(!Ce||!Ce.portal&&!Ce.rows)return N;let Fe=Ce.portal||"",Ze=Ce.rows||0,Ye=Ne.byteLength(Fe),ut=4+Ye+1+4,It=Ne.allocUnsafe(1+ut);return It[0]=69,It.writeInt32BE(ut,1),It.write(Fe,5,"utf-8"),It[Ye+5]=0,It.writeUInt32BE(Ze,It.length-4),It},"execute"),q=f((Ce,Fe)=>{let Ze=Ne.allocUnsafe(16);return Ze.writeInt32BE(16,0),Ze.writeInt16BE(1234,4),Ze.writeInt16BE(5678,6),Ze.writeInt32BE(Ce,8),Ze.writeInt32BE(Fe,12),Ze},"cancel"),ae=f((Ce,Fe)=>{let Ze=4+Ne.byteLength(Fe)+1,Ye=Ne.allocUnsafe(1+Ze);return Ye[0]=Ce,Ye.writeInt32BE(Ze,1),Ye.write(Fe,5,"utf-8"),Ye[Ze]=0,Ye},"cstringMessage"),le=O.addCString("P").flush(68),ue=O.addCString("S").flush(68),Ee=f(Ce=>Ce.name?ae(68,`${Ce.type}${Ce.name||""}`):Ce.type==="P"?le:ue,"describe"),Te=f(Ce=>{let Fe=`${Ce.type}${Ce.name||""}`;return ae(67,Fe)},"close"),se=f(Ce=>O.add(Ce).flush(100),"copyData"),ge=f(Ce=>ae(102,Ce),"copyFail"),me=f(Ce=>Ne.from([Ce,0,0,0,4]),"code	OnlyBuffer"),ce=me(72),je=me(83),ve=me(88),$e=me(99),We={startup:k,password:j,requestSsl:I,sendSASLInitialResponseMessage:M,sendSCRAMClientFinalMessage:A,query:B,parse:$,bind:te,execute:C,describe:Ee,close:Te,flush:f(()=>ce,"flush"),sync:f(()=>je,"sync"),end:f(()=>ve,"end"),copyData:se,copyDone:f(()=>$e,"copyDone"),copyFail:ge,cancel:q};ee.serialize=We}),hr=v(ee=>{G(),Object.defineProperty(ee,"__esModule",{value:!0}),ee.BufferReader=void 0;var T=Ne.allocUnsafe(0),O=class{constructor(j=0){this.offset=j,this.buffer=T,this.encoding="utf-8"}setBuffer(j,M){this.offset=j,this.buffer=M}int16(){let j=this.buffer.readInt16BE(this.offset);return this.offset+=2,j}byte(){let j=this.buffer[this.offset];return this.offset++,j}int32(){let j=this.buffer.readInt32BE(this.offset);return this.offset+=4,j}string(j){let M=this.buffer.toString(this.encoding,this.offset,this.offset+j);return this.offset+=j,M}cstring(){let j=this.offset,M=j;for(;this.buffer[M++]!==0;);return this.offset=M,this.buffer.toString(this.encoding,j,M-1)}bytes(j){let M=this.buffer.slice(this.offset,this.offset+j);return this.offset+=j,M}};f(O,"BufferReader");var k=O;ee.BufferReader=k}),ui=v(ee=>{G(),Object.defineProperty(ee,"__esModule",{value:!0}),ee.Parser=void 0;var T=_n(),O=hr(),k=1,I=4,j=k+I,M=Ne.allocUnsafe(0),A=class{constructor($){if(this.buffer=M,this.bufferLength=0,this.bufferOffset=0,this.reader=new O.BufferReader,($==null?void 0:$.mode)==="binary")throw new Error("Binary mode not supported yet");this.mode=($==null?void 0:$.mode)||"text"}parse($,W){this.mergeBuffer($);let F=this.bufferOffset+this.bufferLength,te=this.bufferOffset;for(;te+j<=F;){let N=this.buffer[te],C=this.buffer.readUInt32BE(te+k),q=k+C;if(q+te<=F){let ae=this.handlePacket(te+j,N,C,this.buffer);W(ae),te+=q}else break}te===F?(this.buffer=M,this.bufferLength=0,this.bufferOffset=0):(this.bufferLength=F-te,this.bufferOffset=te)}mergeBuffer($){if(this.bufferLength>0){let W=this.bufferLength+$.byteLength;if(W+this.bufferOffset>this.buffer.byteLength){let F;if(W<=this.buffer.byteLength&&this.bufferOffset>=this.bufferLength)F=this.buffer;else{let te=this.buffer.byteLength*2;for(;W>=te;)te*=2;F=Ne.allocUnsafe(te)}this.buffer.copy(F,0,this.bufferOffset,this.bufferOffset+this.bufferLength),this.buffer=F,this.bufferOffset=0}$.copy(this.buffer,this.bufferOffset+this.bufferLength),this.bufferLength=W}else this.buffer=$,this.bufferOffset=0,this.bufferLength=$.byteLength}handlePacket($,W,F,te){switch(W){case 50:return T.bindComplete;case 49:return T.parseComplete;case 51:return T.closeComplete;case 110:return T.noData;case 115:return T.portalSuspended;case 99:return T.copyDone;case 87:return T.replicationStart;case 73:return T.emptyQuery;case 68:return this.parseDataRowMessage($,F,te);case 67:return this.parseCommandCompleteMessage($,F,te);case 90:return this.parseReadyForQueryMessage($,F,te);case 65:return this.parseNotificationMessage($,F,te);case 82:return this.parseAuthenticationResponse($,F,te);case 83:return this.parseParameterStatusMessage($,F,te);case 75:return this.parseBackendKeyData($,F,te);case 69:return this.parseErrorMessage($,F,te,"error");case 78:return this.parseErrorMessage($,F,te,"notice");case 84:return this.parseRowDescriptionMessage($,F,te);case 116:return this.parseParameterDescriptionMessage($,F,te);case 71:return this.parseCopyInMessage($,F,te);case 72:return this.parseCopyOutMessage($,F,te);case 100:return this.parseCopyData($,F,te);default:return new T.DatabaseError("received invalid response: "+W.toString(16),F,"error")}}parseReadyForQueryMessage($,W,F){this.reader.setBuffer($,F);let te=this.reader.string(1);return new T.ReadyForQueryMessage(W,te)}parseCommandCompleteMessage($,W,F){this.reader.setBuffer($,F);let te=this.reader.cstring();return new T.CommandCompleteMessage(W,te)}parseCopyData($,W,F){let te=F.slice($,$+(W-4));return new T.CopyDataMessage(W,te)}parseCopyInMessage($,W,F){return this.parseCopyMessage($,W,F,"copyInRespons	e")}parseCopyOutMessage($,W,F){return this.parseCopyMessage($,W,F,"copyOutRespon	se")}parseCopyMessage($,W,F,te){this.reader.setBuffer($,F);let N=this.reader.byte()!==0,C=this.reader.int16(),q=new T.CopyResponse(W,te,N,C);for(let ae=0;ae<C;ae++)q.columnTypes[ae]=this.reader.int16();return q}parseNotificationMessage($,W,F){this.reader.setBuffer($,F);let te=this.reader.int32(),N=this.reader.cstring(),C=this.reader.cstring();return new T.NotificationResponseMessage(W,te,N,C)}parseRowDescriptionMessage($,W,F){this.reader.setBuffer($,F);let te=this.reader.int16(),N=new T.RowDescriptionMessage(W,te);for(let C=0;C<te;C++)N.fields[C]=this.parseField();return N}parseField(){let $=this.reader.cstring(),W=this.reader.int32(),F=this.reader.int16(),te=this.reader.int32(),N=this.reader.int16(),C=this.reader.int32(),q=this.reader.int16()===0?"text":"binary";return new T.Field($,W,F,te,N,C,q)}parseParameterDescriptionMessage($,W,F){this.reader.setBuffer($,F);let te=this.reader.int16(),N=new T.ParameterDescriptionMessage(W,te);for(let C=0;C<te;C++)N.dataTypeIDs[C]=this.reader.int32();return N}parseDataRowMessage($,W,F){this.reader.setBuffer($,F);let te=this.reader.int16(),N=new Array(te);for(let C=0;C<te;C++){let q=this.reader.int32();N[C]=q===-1?null:this.reader.string(q)}return new T.DataRowMessage(W,N)}parseParameterStatusMessage($,W,F){this.reader.setBuffer($,F);let te=this.reader.cstring(),N=this.reader.cstring();return new T.ParameterStatusMessage(W,te,N)}parseBackendKeyData($,W,F){this.reader.setBuffer($,F);let te=this.reader.int32(),N=this.reader.int32();return new T.BackendKeyDataMessage(W,te,N)}parseAuthenticationResponse($,W,F){this.reader.setBuffer($,F);let te=this.reader.int32(),N={name:"authenticationOk",length:W};switch(te){case 0:break;case 3:N.length===8&&(N.name="authenticationCleartextPassword");break;case 5:if(N.length===12){N.name="authenticationMD5Password";let q=this.reader.bytes(4);return new T.AuthenticationMD5Password(W,q)}break;case 10:N.name="authentication	SASL",N.mechanisms=[];let C;do C=this.reader.cstring(),C&&N.mechanisms.push(C);while(C);break;case 11:N.name="authenticationSASLContinue",N.data=this.reader.string(W-8);break;case 12:N.name="authenticationSASLFinal",N.data=this.reader.string(W-8);break;default:throw new Error("Unknown authenticationOk message type "+te)}return N}parseErrorMessage($,W,F,te){this.reader.setBuffer($,F);let N={},C=this.reader.string(1);for(;C!=="\0";)N[C]=this.reader.cstring(),C=this.reader.string(1);let q=N.M,ae=te==="notice"?new T.NoticeMessage(W,q):new T.DatabaseError(q,W,te);return ae.severity=N.S,ae.code=N.C,ae.detail=N.D,ae.hint=N.H,ae.position=N.P,ae.internalPosition=N.p,ae.internalQuery=N.q,ae.where=N.W,ae.schema=N.s,ae.table=N.t,ae.column=N.c,ae.dataType=N.d,ae.constraint=N.n,ae.file=N.F,ae.line=N.L,ae.routine=N.R,ae}};f(A,"Parser");var B=A;ee.Parser=B}),Mr=v(ee=>{G(),Object.defineProperty(ee,"__esModule",{value:!0}),ee.DatabaseError=ee.serialize=ee.parse=void 0;var T=_n();Object.defineProperty(ee,"DatabaseError",{enumerable:!0,get:f(function(){return T.DatabaseError},"get")});var O=_s();Object.defineProperty(ee,"serialize",{enumerable:!0,get:f(function(){return O.serialize},"get")});var k=ui();function I(j,M){let A=new k.Parser;return j.on("data",B=>A.parse(B,M)),new Promise(B=>j.on("end",()=>B()))}f(I,"parse"),ee.parse=I}),Do={};E(Do,{connect:()=>an});function an({socket:ee,servername:T}){return ee.startTls(T),ee}var Pr=b(()=>{G(),f(an,"connect")}),di=v((ee,T)=>{G();var O=(Ha(),R(qa)),k=V().EventEmitter,{parse:I,serialize:j}=Mr(),M=j.flush(),A=j.sync(),B=j.end(),re=class extends k{constructor(F){super(),F=F||{},this.stream=F.stream||new O.Socket,this._keepAlive=F.keepAlive,this._keepAliveInitialDelayMillis=F.keepAliveInitialDelayMillis,this.lastBuffer=!1,this.parsedStatements={},this.ssl=F.ssl||!1,this._ending=!1,this._emitMessage=!1;var te=this;this.on("newListener",function(N){N==="message"&&(te._emitMessage=!0)})}connect(F,te){var N=this;this._connecting=!0,this.stream.setNoDelay(!0),this.stream.connect(F,te),this.stream.once("connect",function(){N._keepAlive&&N.stream.setKeepAlive(!0,N._keepAliveInitialDelayMillis),N.emit("connect")});let C=f(function(q){N._ending&&(q.code==="ECONNRESET"||q.code==="EPIPE")||N.emit("error",q)},"reportStreamError");if(this.stream.on("error",C),this.stream.on("close",function(){N.emit("end")}),!this.ssl)return this.attachListeners(this.stream);this.stream.once("data",function(q){var ae=q.toString("utf8");switch(ae){case"S":break;case"N":return N.stream.end(),N.emit("error",new Error("The server does not support SSL connections"));default:return N.stream.end(),N.emit("error",new Error("There was an error establishing an SSL co	nnection"))}var le=(Pr(),R(Do));let ue={socket:N.stream};N.ssl!==!0&&(Object.assign(ue,N.ssl),"key"in N.ssl&&(ue.key=N.ssl.key)),O.isIP(te)===0&&(ue.servername=te);try{N.stream=le.connect(ue)}catch(Ee){return N.emit("error",Ee)}N.attachListeners(N.stream),N.stream.on("error",C),N.emit("sslconnect")})}attachListeners(F){F.on("end",()=>{this.emit("end")}),I(F,te=>{var N=te.name==="error"?"errorMessage":te.name;this._emitMessage&&this.emit("message",te),this.emit(N,te)})}requestSsl(){this.stream.write(j.requestSsl())}startup(F){this.stream.write(j.startup(F))}cancel(F,te){this._send(j.cancel(F,te))}password(F){this._send(j.password(F))}sendSASLInitialResponseMessage(F,te){this._send(j.sendSASLInitialResponseMessage(F,te))}sendSCRAMClientFinalMessage(F){this._send(j.sendSCRAMClientFinalMessage(F))}_send(F){return this.stream.writable?this.stream.write(F):!1}query(F){this._send(j.query(F))}parse(F){this._send(j.parse(F))}bind(F){this._send(j.bind(F))}execute(F){this._send(j.execute(F))}flush(){this.stream.writable&&this.stream.write(M)}sync(){this._ending=!0,this._send(M),this._send(A)}ref(){this.stream.ref()}unref(){this.stream.unref()}end(){if(this._ending=!0,!this._connecting||!this.stream.writable){this.stream.end();return}return this.stream.write(B,()=>{this.stream.end()})}close(F){this._send(j.close(F))}describe(F){this._send(j.describe(F))}sendCopyFromChunk(F){this._send(j.copyData(F))}endCopyFrom(){this._send(j.copyDone())}sendCopyFail(F){this._send(j.copyFail(F))}};f(re,"Connection");var $=re;T.exports=$}),Fn=v((ee,T)=>{G();var O=V().EventEmitter;Q(),R(L);var k=or(),I=Ml(),j=Ro(),M=Ki(),A=zn(),B=es(),re=Ln(),$=di(),W=class extends O{constructor(N){super(),this.connectionParameters=new A(N),this.user=this.connectionParameters.user,this.database=this.connectionParameters.database,this.port=this.connectionParameters.port,this.host=this.connectionParameters.host,Object.defineProperty(this,"passwo	rd",{configurable:!0,enumerable:!1,writable:!0,value:this.connectionParameters.password}),this.replication=this.connectionParameters.replication;var C=N||{};this._Promise=C.Promise||Be.Promise,this._types=new M(C.types),this._ending=!1,this._connecting=!1,this._connected=!1,this._connectionError=!1,this._queryable=!0,this.connection=C.connection||new $({stream:C.stream,ssl:this.connectionParameters.ssl,keepAlive:C.keepAlive||!1,keepAliveInitialDelayMillis:C.keepAliveInitialDelayMillis||0,encoding:this.connectionParameters.client_encoding||"utf8"}),this.queryQueue=[],this.binary=C.binary||re.binary,this.processID=null,this.secretKey=null,this.ssl=this.connectionParameters.ssl||!1,this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this._connectionTimeoutMillis=C.connectionTimeoutMillis||0}_errorAllQueries(N){let C=f(q=>{De.nextTick(()=>{q.handleError(N,this.connection)})},"enqueueError");this.activeQuery&&(C(this.activeQuery),this.activeQuery=null),this.queryQueue.forEach(C),this.queryQueue.length=0}_connect(N){var C=this,q=this.connection;if(this._connectionCallback=N,this._connecting||this._connected){let ae=new Error("Client has already been conn	ected. You cannot reuse a client.");De.nextTick(()=>{N(ae)});return}this._connecting=!0,this.connectionTimeoutHandle,this._connectionTimeoutMillis>0&&(this.connectionTimeoutHandle=setTimeout(()=>{q._ending=!0,q.stream.destroy(new Error("timeout expired"))},this._connectionTimeoutMillis)),this.host&&this.host.indexOf("/")===0?q.connect(this.host+"/.s.PGSQL."+this.port):q.connect(this.port,this.host),q.on("connect",function(){C.ssl?q.requestSsl():q.startup(C.getStartupConf())}),q.on("sslconnect",function(){q.startup(C.getStartupConf())}),this._attachListeners(q),q.once("end",()=>{let ae=this._ending?new Error("Connection terminated"):new Error("Connection terminated unex	pectedly");clearTimeout(this.connectionTimeoutHandle),this._errorAllQueries(ae),this._ending||(this._connecting&&!this._connectionError?this._connectionCallback?this._connectionCallback(ae):this._handleErrorEvent(ae):this._connectionError||this._handleErrorEvent(ae)),De.nextTick(()=>{this.emit("end")})})}connect(N){if(N){this._connect(N);return}return new this._Promise((C,q)=>{this._connect(ae=>{ae?q(ae):C()})})}_attachListeners(N){N.on("authenticationCleartextPassword",this._handleAuthCleartextPassword.bind(this)),N.on("authenticationMD5Password",this._handleAuthMD5Password.bind(this)),N.on("a	uthenticationSASL",this._handleAuthSASL.bind(this)),N.on("authenticationSASLCont	inue",this._handleAuthSASLContinue.bind(this)),N.on("authenticationSASLFinal",this._handleAuthSASLFinal.bind(this)),N.on("backendKeyData",this._handleBackendKeyData.bind(this)),N.on("error",this._handleErrorEvent.bind(this)),N.on("errorMessage",this._handleErrorMessage.bind(this)),N.on("readyForQuery",this._handleReadyForQuery.bind(this)),N.on("notice",this._handleNotice.bind(this)),N.on("rowDescription",this._handleRowDescription.bind(this)),N.on("dataRow",this._handleDataRow.bind(this)),N.on("portalSuspended",this._handlePortalSuspended.bind(this)),N.on("emptyQuery",this._handleEmptyQuery.bind(this)),N.on("commandComplete",this._handleCommandComplete.bind(this)),N.on("parseComplete",this._handleParseComplete.bind(this)),N.on("cop	yInResponse",this._handleCopyInResponse.bind(this)),N.on("copyData",this._handleCopyData.bind(this)),N.on("notification",this._handleNotification.bind(this))}_checkPgPass(N){let C=this.connection;typeof this.password=="function"?this._Promise.resolve().then(()=>this.password()).then(q=>{if(q!==void 0){if(typeof q!="string"){C.emit("erro	r",new TypeError("Password must be a string"));return}this.connectionParameters.password=this.password=q}else this.connectionParameters.password=this.password=null;N()}).catch(q=>{C.emit("error",q)}):this.password!==null?N():j(this.connectionParameters,q=>{q!==void 0&&(this.connectionParameters.password=this.password=q),N()})}_handleAuthCleartextPassword(N){this._checkPgPass(()=>{this.connection.password(this.password)})}_handleAuthMD5Password(N){this._checkPgPass(()=>{let C=k.postgresMd5PasswordHash(this.user,this.password,N.salt);this.connection.password(C)})}_handleAuthSASL(N){this._checkPgPass(()=>{this.saslSession=I.startSession(N.mechanisms),this.connection.sendSASLInitialResponseMessage(this.saslSession.mechanism,this.saslSession.response)})}_handleAuthSASLContinue(N){I.continueSession(this.saslSession,this.password,N.data),this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)}_handleAuthSASLFinal(N){I.finalizeSession(this.saslSession,N.data),this.saslSession=null}_handleBackendKeyData(N){this.processID=N.processID,this.secretKey=N.secretKey}_handleReadyForQuery(N){this._connecting&&(this._connecting=!1,this._connected=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback&&(this._connectionCallback(null,this),this._connectionCallback=null),this.emit("c	onnect"));let{activeQuery:C}=this;this.activeQuery=null,this.readyForQuery=!0,C&&C.handleReadyForQuery(this.connection),this._pulseQueryQueue()}_handleErrorWhileConnecting(N){if(!this._connectionError){if(this._connectionError=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback)return this._connectionCallback(N);this.emit("error",N)}}_handleErrorEvent(N){if(this._connecting)return this._handleErrorWhileConnecting(N);this._queryable=!1,this._errorAllQueries(N),this.emit("error",N)}_handleErrorMessage(N){if(this._connecting)return this._handleErrorWhileConnecting(N);let C=this.activeQuery;if(!C){this._handleErrorEvent(N);return}this.activeQuery=null,C.handleError(N,this.connection)}_handleRowDescription(N){this.activeQuery.handleRowDescription(N)}_handleDataRow(N){this.activeQuery.handleDataRow(N)}_handlePortalSuspended(N){this.activeQuery.handlePortalSuspended(this.connection)}_handleEmptyQuery(N){this.activeQuery.handleEmptyQuery(this.connection)}_handleCommandComplete(N){this.activeQuery.handleCommandComplete(N,this.connection)}_handleParseComplete(N){this.activeQuery.name&&(this.connection.parsedStatements[this.activeQuery.name]=this.activeQuery.text)}_handleCopyInResponse(N){this.activeQuery.handleCopyInResponse(this.connection)}_handleCopyData(N){this.activeQuery.handleCopyData(N,this.connection)}_handleNotification(N){this.emit("notification",N)}_handleNotice(N){this.emit("notice",N)}getStartupConf(){var N=this.connectionParameters,C={user:N.user,database:N.database},q=N.application_name||N.fallback_application_name;return q&&(C.application_name=q),N.replication&&(C.replication=""+N.replication),N.statement_timeout&&(C.statement_timeout=String(parseInt(N.statement_timeout,10))),N.lock_timeout&&(C.lock_timeout=String(parseInt(N.lock_timeout,10))),N.idle_in_transaction_session_timeout&&(C.idle_in_transaction_session_timeout=String(parseInt(N.idle_in_transaction_session_timeout,10))),N.options&&(C.options=N.options),C}cancel(N,C){if(N.activeQuery===C){var q=this.connection;this.host&&this.host.indexOf("/")===0?q.connect(this.host+"/.s.PGSQL."+this.port):q.connect(this.port,this.host),q.on("connect",function(){q.cancel(N.processID,N.secretKey)})}else N.queryQueue.indexOf(C)!==-1&&N.queryQueue.splice(N.queryQueue.indexOf(C),1)}setTypeParser(N,C,q){return this._types.setTypeParser(N,C,q)}getTypeParser(N,C){return this._types.getTypeParser(N,C)}escapeIdentifier(N){return'"'+N.replace(/"/g,'""')+'"'}escapeLiteral(N){for(var C=!1,q="'",ae=0;ae<N.length;ae++){var le=N[ae];le==="'"?q+=le+le:le==="\\"?(q+=le+le,C=!0):q+=le}return q+="'",C===!0&&(q=" E"+q),q}_pulseQueryQueue(){if(this.readyForQuery===!0)if(this.activeQuery=this.queryQueue.shift(),this.activeQuery){this.readyForQuery=!1,this.hasExecuted=!0;let N=this.activeQuery.submit(this.connection);N&&De.nextTick(()=>{this.activeQuery.handleError(N,this.connection),this.readyForQuery=!0,this._pulseQueryQueue()})}else this.hasExecuted&&(this.activeQuery=null,this.emit("drain"))}query(N,C,q){var ae,le,ue,Ee,Te;if(N==null)throw new TypeError("Client	 was passed a null or undefined query");return typeof N.submit=="function"?(ue=N.query_timeout||this.connectionParameters.query_timeout,le=ae=N,typeof C=="function"&&(ae.callback=ae.callback||C)):(ue=this.connectionParameters.query_timeout,ae=new B(N,C,q),ae.callback||(le=new this._Promise((se,ge)=>{ae.callback=(me,ce)=>me?ge(me):se(ce)}))),ue&&(Te=ae.callback,Ee=setTimeout(()=>{var se=new Error("Query read timeout");De.nextTick(()=>{ae.handleError(se,this.connection)}),Te(se),ae.callback=()=>{};var ge=this.queryQueue.indexOf(ae);ge>-1&&this.queryQueue.splice(ge,1),this._pulseQueryQueue()},ue),ae.callback=(se,ge)=>{clearTimeout(Ee),Te(se,ge)}),this.binary&&!ae.binary&&(ae.binary=!0),ae._result&&!ae._result._types&&(ae._result._types=this._types),this._queryable?this._ending?(De.nextTick(()=>{ae.handleError(new Error("Client was closed and is not queryable"),this.connection)}),le):(this.queryQueue.push(ae),this._pulseQueryQueue(),le):(De.nextTick(()=>{ae.handleError(new Error("Client has encountered a connection error and is n	ot queryable"),this.connection)}),le)}ref(){this.connection.ref()}unref(){this.connection.unref()}end(N){if(this._ending=!0,!this.connection._connecting)if(N)N();else return this._Promise.resolve();if(this.activeQuery||!this._queryable?this.connection.stream.destroy():this.connection.end(),N)this.connection.once("end",N);else return new this._Promise(C=>{this.connection.once("end",C)})}};f(W,"Client");var F=W;F.Query=B,T.exports=F}),qn=v((ee,T)=>{G();var O=V().EventEmitter,k=f(function(){},"	NOOP"),I=f((N,C)=>{let q=N.findIndex(C);return q===-1?void 0:N.splice(q,1)[0]},"removeWhere"),j=class{constructor(C,q,ae){this.client=C,this.idleListener=q,this.timeoutId=ae}};f(j,"IdleItem");var M=j,A=class{constructor(C){this.callback=C}};f(A,"PendingItem");var B=A;function re(){throw new Error("Release called 	on client which has already been released to the pool.")}f(re,"throwOnDoubleRele	ase");function $(N,C){if(C)return{callback:C,result:void 0};let q,ae,le=f(function(Ee,Te){Ee?q(Ee):ae(Te)},"cb"),ue=new N(function(Ee,Te){ae=Ee,q=Te}).catch(Ee=>{throw Error.captureStackTrace(Ee),Ee});return{callback:le,result:ue}}f($,"promisify");function W(N,C){return f(function q(ae){ae.client=C,C.removeListener("error",q),C.on("error",()=>{N.log("additional clien	t error after disconnection due to error",ae)}),N._remove(C),N.emit("error",ae,C)},"idleListener")}f(W,"makeIdleListener");var F=class extends O{constructor(C,q){super(),this.options=Object.assign({},C),C!=null&&"password"in C&&Object.defineProperty(this.options,"password",{configurable:!0,enumerable:!1,writable:!0,value:C.password}),C!=null&&C.ssl&&C.ssl.key&&Object.defineProperty(this.options.ssl,"key",{enumerable:!1}),this.options.max=this.options.max||this.options.poolSize||10,this.options.maxUses=this.options.maxUses||1/0,this.options.allowExitOnIdle=this.options.allowExitOnIdle||!1,this.options.maxLifetimeSeconds=this.options.maxLifetimeSeconds||0,this.log=this.options.log||function(){},this.Client=this.options.Client||q||gr().Client,this.Promise=this.options.Promise||Be.Promise,typeof this.options.idleTimeoutMillis>"u"&&(this.options.idleTimeoutMillis=1e4),this._clients=[],this._idle=[],this._expired=new WeakSet,this._pendingQueue=[],this._endCallback=void 0,this.ending=!1,this.ended=!1}_isFull(){return this._clients.length>=this.options.max}_pulseQueue(){if(this.log("pulse q	ueue"),this.ended){this.log("pulse queue ended");return}if(this.ending){this.log("pulse queue on ending"),this._idle.length&&this._idle.slice().map(q=>{this._remove(q.client)}),this._clients.length||(this.ended=!0,this._endCallback());return}if(!this._pendingQueue.length){this.log("no queued requests");return}if(!this._idle.length&&this._isFull())return;let C=this._pendingQueue.shift();if(this._idle.length){let q=this._idle.pop();clearTimeout(q.timeoutId);let ae=q.client;ae.ref&&ae.ref();let le=q.idleListener;return this._acquireClient(ae,C,le,!1)}if(!this._isFull())return this.newClient(C);throw new Error("unexpected condition")}_remove(C){let q=I(this._idle,ae=>ae.client===C);q!==void 0&&clearTimeout(q.timeoutId),this._clients=this._clients.filter(ae=>ae!==C),C.end(),this.emit("remove",C)}connect(C){if(this.ending){let le=new Error("Can	not use a pool after calling end on the pool");return C?C(le):this.Promise.reject(le)}let q=$(this.Promise,C),ae=q.result;if(this._isFull()||this._idle.length){if(this._idle.length&&De.nextTick(()=>this._pulseQueue()),!this.options.connectionTimeoutMillis)return this._pendingQueue.push(new B(q.callback)),ae;let le=f((Te,se,ge)=>{clearTimeout(Ee),q.callback(Te,se,ge)},"queueCallback"),ue=new B(le),Ee=setTimeout(()=>{I(this._pendingQueue,Te=>Te.callback===le),ue.timedOut=!0,q.callback(new Error("timeout exceeded when try	ing to connect"))},this.options.connectionTimeoutMillis);return this._pendingQueue.push(ue),ae}return this.newClient(new B(q.callback)),ae}newClient(C){let q=new this.Client(this.options);this._clients.push(q);let ae=W(this,q);this.log("checking c	lient timeout");let le,ue=!1;this.options.connectionTimeoutMillis&&(le=setTimeout(()=>{this.log("ending client due to timeout"),ue=!0,q.connection?q.connection.stream.destroy():q.end()},this.options.connectionTimeoutMillis)),this.log("connecting new client"),q.connect(Ee=>{if(le&&clearTimeout(le),q.on("error",ae),Ee)this.log("client failed to	 connect",Ee),this._clients=this._clients.filter(Te=>Te!==q),ue&&(Ee.message="Connect	ion terminated due to connection timeout"),this._pulseQueue(),C.timedOut||C.callback(Ee,void 0,k);else{if(this.log("new client connected"),this.options.maxLifetimeSeconds!==0){let Te=setTimeout(()=>{this.log("ending client due to expired lifetime"),this._expired.add(q),this._idle.findIndex(se=>se.client===q)!==-1&&this._acquireClient(q,new B((se,ge,me)=>me()),ae,!1)},this.options.maxLifetimeSeconds*1e3);Te.unref(),q.once("end",()=>clearTimeout(Te))}return this._acquireClient(q,C,ae,!0)}})}_acquireClient(C,q,ae,le){le&&this.emit("connect",C),this.emit("acquire",C),C.release=this._releaseOnce(C,ae),C.removeListener("error",ae),q.timedOut?le&&this.options.verify?this.options.verify(C,C.release):C.release():le&&this.options.verify?this.options.verify(C,ue=>{if(ue)return C.release(ue),q.callback(ue,void 0,k);q.callback(void 0,C,C.release)}):q.callback(void 0,C,C.release)}_releaseOnce(C,q){let ae=!1;return le=>{ae&&re(),ae=!0,this._release(C,q,le)}}_release(C,q,ae){if(C.on("error",q),C._poolUseCount=(C._poolUseCount||0)+1,this.emit("release",ae,C),ae||this.ending||!C._queryable||C._ending||C._poolUseCount>=this.options.maxUses){C._poolUseCount>=this.options.maxUses&&this.log("remove ex	pended client"),this._remove(C),this._pulseQueue();return}if(this._expired.has(C)){this.log("remove expired client"),this._expired.delete(C),this._remove(C),this._pulseQueue();return}let le;this.options.idleTimeoutMillis&&(le=setTimeout(()=>{this.log("remove	 idle client"),this._remove(C)},this.options.idleTimeoutMillis),this.options.allowExitOnIdle&&le.unref()),this.options.allowExitOnIdle&&C.unref(),this._idle.push(new M(C,q,le)),this._pulseQueue()}query(C,q,ae){if(typeof C=="function"){let ue=$(this.Promise,C);return xe(function(){return ue.callback(new Error("Passing a function as the first	 parameter to pool.query is not supported"))}),ue.result}typeof q=="function"&&(ae=q,q=void 0);let le=$(this.Promise,ae);return ae=le.callback,this.connect((ue,Ee)=>{if(ue)return ae(ue);let Te=!1,se=f(ge=>{Te||(Te=!0,Ee.release(ge),ae(ge))},"onError");Ee.once("err	or",se),this.log("dispatching query");try{Ee.query(C,q,(ge,me)=>{if(this.log("query 	dispatched"),Ee.removeListener("error",se),!Te)return Te=!0,Ee.release(ge),ge?ae(ge):ae(void 0,me)})}catch(ge){return Ee.release(ge),ae(ge)}}),le.result}end(C){if(this.log("ending"),this.ending){let ae=new Error("Called end on pool more than once");return C?C(ae):this.Promise.reject(ae)}this.ending=!0;let q=$(this.Promise,C);return this._endCallback=q.callback,this._pulseQueue(),q.result}get waitingCount(){return this._pendingQueue.length}get idleCount(){return this._idle.length}get expiredCount(){return this._clients.reduce((C,q)=>C+(this._expired.has(q)?1:0),0)}get totalCount(){return this._clients.length}};f(F,"Pool");var te=F;T.exports=te}),fr={};E(fr,{default:()=>mr});var mr,ss=b(()=>{G(),mr={}}),Oo=v((ee,T)=>{T.exports={name:"pg",version:"8.8.0",description:"PostgreSQL	 client - pure javascript & libpq with the same API",keywords:["database","libpq","pg","postgre","postgres","postgresql","rdbms"],homepage:"https://github.com/bri	anc/node-postgres",repository:{type:"git",url:"git://github.com/brianc/node-post	gres.git",directory:"packages/pg"},author:"Brian Carlson <brian.m.carlson@gmail.	com>",main:"./lib",dependencies:{"buffer-writer":"2.0.0","packet-reader":"1.0.0","pg-connection-string":"^2.5.0","pg-pool":"^3.5.2","pg-protocol":"^1.5.0","pg-ty	pes":"^2.1.0",pgpass:"1.x"},devDependencies:{async:"2.6.4",bluebird:"3.5.2",co:"	4.6.0","pg-copy-streams":"0.3.0"},peerDependencies:{"pg-native":">=3.0.1"},peerDependenciesMeta:{"pg-native":{optional:!0}},scripts:{test:"make test-all"},files:["lib","SPONSORS	.md"],license:"MIT",engines:{node:">= 8.0.0"},gitHead:"c99fb2c127ddf8d712500db2c	7b9a5491a178655"}}),hi=v((ee,T)=>{G();var O=V().EventEmitter,k=(Q(),R(L)),I=or(),j=T.exports=function(A,B,re){O.call(this),A=I.normalizeQueryConfig(A,B,re),this.text=A.text,this.values=A.values,this.name=A.name,this.callback=A.callback,this.state="new",this._arrayMode=A.rowMode==="array",this._emitRowEvents=!1,this.on("	newListener",function($){$==="row"&&(this._emitRowEvents=!0)}.bind(this))};k.inherits(j,O);var M={sqlState:"code",statementPosition:"position",messagePrimary:"mess	age",context:"where",schemaName:"schema",tableName:"table",columnName:"column",dataTypeName:"	dataType",constraintName:"constraint",sourceFile:"file",sourceLine:"line",sourceFunction:"	routine"};j.prototype.handleError=function(A){var B=this.native.pq.resultErrorFields();if(B)for(var re in B){var $=M[re]||re;A[$]=B[re]}this.callback?this.callback(A):this.emit("error",A),this.state="error"},j.prototype.then=function(A,B){return this._getPromise().then(A,B)},j.prototype.catch=function(A){return this._getPromise().catch(A)},j.prototype._getPromise=function(){return this._promise?this._promise:(this._promise=new Promise(function(A,B){this._once("end",A),this._once("error",B)}.bind(this)),this._promise)},j.prototype.submit=function(A){this.state="runn	ing";var B=this;this.native=A.native,A.native.arrayMode=this._arrayMode;var re=f(function(F,te,N){if(A.native.arrayMode=!1,xe(function(){B.emit("_done")}),F)return B.handleError(F);B._emitRowEvents&&(N.length>1?te.forEach((C,q)=>{C.forEach(ae=>{B.emit("row",ae,N[q])})}):te.forEach(function(C){B.emit("row",C,N)})),B.state="end",B.emit("end",N),B.callback&&B.callback(null,N)},"after");if(De.domain&&(re=De.domain.bind(re)),this.name){this.name.length>63&&(console.error("Warning! Postgres only suppo	rts 63 characters for query names."),console.error("You supplied %s (%s)",this.name,this.name.length),console.error("This can cause conflicts and silent errors exec	uting queries"));var $=(this.values||[]).map(I.prepareValue);if(A.namedQueries[this.name]){if(this.text&&A.namedQueries[this.name]!==this.text){let F=new Error(`Prepared statements must be unique - '${this.name}' was used for a different statement`);return re(F)}return A.native.execute(this.name,$,re)}return A.native.prepare(this.name,this.text,$.length,function(F){return F?re(F):(A.namedQueries[B.name]=B.text,B.native.execute(B.name,$,re))})}else if(this.values){if(!Array.isArray(this.values)){let F=new Error("Query values must be an array");return re(F)}var W=this.values.map(I.prepareValue);A.native.query(this.text,W,re)}else A.native.query(this.text,re)}}),Hn=v((ee,T)=>{G();var O=(ss(),R(fr)),k=Ki();Oo();var I=V().EventEmitter,j=(Q(),R(L)),M=zn(),A=hi(),B=T.exports=function(re){I.call(this),re=re||{},this._Promise=re.Promise||Be.Promise,this._types=new k(re.types),this.native=new O({types:this._types}),this._queryQueue=[],this._ending=!1,this._connecting=!1,this._connected=!1,this._queryable=!0;var $=this.connectionParameters=new M(re);this.user=$.user,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:$.password}),this.database=$.database,this.host=$.host,this.port=$.port,this.namedQueries={}};B.Query=A,j.inherits(B,I),B.prototype._errorAllQueries=function(re){let $=f(W=>{De.nextTick(()=>{W.native=this.native,W.handleError(re)})},"enqueueError");this._hasActiveQuery()&&($(this._activeQuery),this._activeQuery=null),this._queryQueue.forEach($),this._queryQueue.length=0},B.prototype._connect=function(re){var $=this;if(this._connecting){De.nextTick(()=>re(new Error("Client h	as already been connected. You cannot reuse a client.")));return}this._connecting=!0,this.connectionParameters.getLibpqConnectionString(function(W,F){if(W)return re(W);$.native.connect(F,function(te){if(te)return $.native.end(),re(te);$._connected=!0,$.native.on("error",function(N){$._queryable=!1,$._errorAllQueries(N),$.emit("er	ror",N)}),$.native.on("notification",function(N){$.emit("notification",{channel:N.relname,payload:N.extra})}),$.emit("connect"),$._pulseQueryQueue(!0),re()})})},B.prototype.connect=function(re){if(re){this._connect(re);return}return new this._Promise(($,W)=>{this._connect(F=>{F?W(F):$()})})},B.prototype.query=function(re,$,W){var F,te,N,C,q;if(re==null)throw new TypeError("Client was passed a null or undefined qu	ery");if(typeof re.submit=="function")N=re.query_timeout||this.connectionParameters.query_timeout,te=F=re,typeof $=="function"&&(re.callback=$);else if(N=this.connectionParameters.query_timeout,F=new A(re,$,W),!F.callback){let ae,le;te=new this._Promise((ue,Ee)=>{ae=ue,le=Ee}),F.callback=(ue,Ee)=>ue?le(ue):ae(Ee)}return N&&(q=F.callback,C=setTimeout(()=>{var ae=new Error("Query read timeout");De.nextTick(()=>{F.handleError(ae,this.connection)}),q(ae),F.callback=()=>{};var le=this._queryQueue.indexOf(F);le>-1&&this._queryQueue.splice(le,1),this._pulseQueryQueue()},N),F.callback=(ae,le)=>{clearTimeout(C),q(ae,le)}),this._queryable?this._ending?(F.native=this.native,De.nextTick(()=>{F.handleError(new Error("Client was closed and is not queryable"))}),te):(this._queryQueue.push(F),this._pulseQueryQueue(),te):(F.native=this.native,De.nextTick(()=>{F.handleError(new Error("Client has encountered a connection error and is not queryable"))}),te)},B.prototype.end=function(re){var $=this;this._ending=!0,this._connected||this.once("connect",this.end.bind(this,re));var W;return re||(W=new this._Promise(function(F,te){re=f(N=>N?te(N):F(),"cb")})),this.native.end(function(){$._errorAllQueries(new Error("Connection terminated")),De.nextTick(()=>{$.emit("end"),re&&re()})}),W},B.prototype._hasActiveQuery=function(){return this._activeQuery&&this._activeQuery.state!=="	error"&&this._activeQuery.state!=="end"},B.prototype._pulseQueryQueue=function(re){if(this._connected&&!this._hasActiveQuery()){var $=this._queryQueue.shift();if(!$){re||this.emit("drain");return}this._activeQuery=$,$.submit(this);var W=this;$.once("_done",function(){W._pulseQueryQueue()})}},B.prototype.cancel=function(re){this._activeQuery===re?this.native.cancel(function(){}):this._queryQueue.indexOf(re)!==-1&&this._queryQueue.splice(this._queryQueue.indexOf(re),1)},B.prototype.ref=function(){},B.prototype.unref=function(){},B.prototype.setTypeParser=function(re,$,W){return this._types.setTypeParser(re,$,W)},B.prototype.getTypeParser=function(re,$){return this._types.getTypeParser(re,$)}}),wn=v((ee,T)=>{G(),T.exports=Hn()}),gr=v((ee,T)=>{G();var O=Fn(),k=Ln(),I=di(),j=qn(),{DatabaseError:M}=Mr(),A=f(re=>{var $;return $=class extends j{constructor(W){super(W,re)}},f($,"BoundP	ool"),$},"poolFactory"),B=f(function(re){this.defaults=k,this.Client=re,this.Query=this.Client.Query,this.Pool=A(this.Client),this._pools=[],this.Connection=I,this.types=ar(),this.DatabaseError=M},"PG");typeof De.env.NODE_PG_FORCE_NATIVE<"u"?T.exports=new B(wn()):(T.exports=new B(O),Object.defineProperty(T.exports,"na	tive",{configurable:!0,enumerable:!1,get(){var re=null;try{re=new B(wn())}catch($){if($.code!=="MODULE_NOT_FOUND")throw $}return Object.defineProperty(T.exports,"	native",{value:re}),re}}))}),Nn={};E(Nn,{Client:()=>yr,ClientBase:()=>Ws.ClientBase,Connection:()=>Ws.Connection,DatabaseError:()=>Ws.DatabaseError,NeonDbError:()=>Xs,Pool:()=>yi,Query:()=>Ws.Query,defaults:()=>Ws.defaults,neon:()=>Vr,neonConfig:()=>Ks,types:()=>Ws.types}),wm=R(Nn),G();var fi=_(gr());Ha(),G(),Ha(),li();var Ll=_(or()),mi=_(Ki());function Lr(ee){return ee instanceof Ne?"\\x"+ee.toString("hex"):ee}f(Lr,"encodeBuffe	rsAsBytea");var Ys=class zv extends Error{constructor(T){super(T),U(this,"name","NeonDbError"),U(this,"severity"),U(this,"code"),U(this,"detail"),U(this,"hint"),U(this,"position"),U(this,"internalPosition"),U(this,"internalQuery"),U(this,"wh	ere"),U(this,"schema"),U(this,"table"),U(this,"column"),U(this,"dataType"),U(this,"constraint"),U(this,"file"),U(this,"line"),U(this,"routine"),U(this,"sourceErro	r"),"captureStackTrace"in Error&&typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,zv)}};f(Ys,"NeonDbError");var Xs=Ys,gi="transaction() exp	ects an array of queries, or a function returning an array of queries",pr=["seve	rity","code","detail","hint","position","internalPosition","internalQuery","wher	e","schema","table","column","dataType","constraint","file","line","routine"];function Vr(ee,{arrayMode:T,fullResults:O,fetchOptions:k,isolationLevel:I,readOnly:j,deferrable:M,queryCallback:A,resultCallback:B,authToken:re}={}){if(!ee)throw new Error("No data	base connection string was provided to `neon()`. Perhaps an environment variable	 has not been set?");let $;try{$=Bn(ee)}catch(le){throw new Error("Database connectio	n string provided to `neon()` is not a valid URL. Connection string: "+String(ee))}let{protocol:W,username:F,hostname:te,port:N,pathname:C}=$;if(W!=="postgres:"&&W!=="postgresql:"||!F||!te||!C)throw new Error("Database connection string format for	 `neon()` should be: postgresql://user:password@host.tld/dbname?option=value");function q(le,...ue){var ge;let Ee,Te;if(typeof le=="string")Ee=le,Te=ue[1],ue=(ge=ue[0])!=null?ge:[];else{Ee="";for(let me=0;me<le.length;me++)Ee+=le[me],me<ue.length&&(Ee+="$"+(me+1))}ue=ue.map(me=>Lr((0,Ll.prepareValue)(me)));let se={query:Ee,params:ue};return A&&A(se),pi(ae,se,Te)}f(q,"resolve"),q.transaction=(le,ue)=>K(null,null,function*(){if(typeof le=="function"&&(le=le(q)),!Array.isArray(le))throw new Error(gi);le.forEach(se=>{if(se[Symbol.toStringTag]!=="NeonQueryPromise")throw new Error(gi)});let Ee=le.map(se=>se.parameterizedQuery),Te=le.map(se=>{var ge;return(ge=se.opts)!=null?ge:{}});return ae(Ee,Te,ue)});function ae(le,ue,Ee){return K(this,null,function*(){var It,Js,Mt;let{fetchEndpoint:Te,fetchFunction:se}=Ks,ge=Array.isArray(le)?{queries:le}:le,me=k!=null?k:{},ce=T!=null?T:!1,je=O!=null?O:!1,ve=I,$e=j,We=M;Ee!==void 0&&(Ee.fetchOptions!==void 0&&(me=X(X({},me),Ee.fetchOptions)),Ee.arrayMode!==void 0&&(ce=Ee.arrayMode),Ee.fullResults!==void 0&&(je=Ee.fullResults),Ee.isolationLevel!==void 0&&(ve=Ee.isolationLevel),Ee.readOnly!==void 0&&($e=Ee.readOnly),Ee.deferrable!==void 0&&(We=Ee.deferrable)),ue!==void 0&&!Array.isArray(ue)&&ue.fetchOptions!==void 0&&(me=X(X({},me),ue.fetchOptions));let Ce=re;!Array.isArray(ue)&&(ue==null?void 0:ue.authToken)!==void 0&&(Ce=ue.authToken);let Fe=typeof Te=="function"?Te(te,N,{jwtAuth:Ce!==void 0}):Te,Ze={"Neon-Connection-String":ee,"Neon-Raw-Text-Output":"true","Neon-Ar	ray-Mode":"true"},Ye=yield on(Ce);Ye&&(Ze.Authorization=`Bearer ${Ye}`),Array.isArray(le)&&(ve!==void 0&&(Ze["Neon-Batch-Isolation-Level"]=ve),$e!==void 0&&(Ze["Neon-Bat	ch-Read-Only"]=String($e)),We!==void 0&&(Ze["Neon-Batch-Deferrable"]=String(We)));let ut;try{ut=yield(se!=null?se:fetch)(Fe,X({method:"POST",body:JSON.stringify(ge),headers:Ze},me))}catch(Ot){let $t=new Xs(`Error connecting to database: ${Ot.message}`);throw $t.sourceError=Ot,$t}if(ut.ok){let Ot=yield ut.json();if(Array.isArray(le)){let $t=Ot.results;if(!Array.isArray($t))throw new Xs("Neon internal error: unexpected result format");return $t.map((cs,ws)=>{var en,En,Br;let Zs=(en=ue[ws])!=null?en:{},xi=(En=Zs.arrayMode)!=null?En:ce,Sn=(Br=Zs.fullResults)!=null?Br:je;return Ga(cs,{arrayMode:xi,fullResults:Sn,parameterizedQuery:le[ws],resultCallback:B,types:Zs.types})})}else{let $t=ue!=null?ue:{},cs=(It=$t.arrayMode)!=null?It:ce,ws=(Js=$t.fullResults)!=null?Js:je;return Ga(Ot,{arrayMode:cs,fullResults:ws,parameterizedQuery:le,resultCallback:B,types:$t.types})}}else{let{status:Ot}=ut;if(Ot===400){let $t=yield ut.json(),cs=new Xs($t.message);for(let ws of pr)cs[ws]=(Mt=$t[ws])!=null?Mt:void 0;throw cs}else{let $t=yield ut.text();throw new Xs(`Server error (HTTP status ${Ot}): ${$t}`)}}})}return f(ae,"execute"),q}f(Vr,"neon");function pi(ee,T,O){return{[Symbol.toStringTag]:"NeonQueryPromise",parameterizedQuery:T,opts:O,then:f((k,I)=>ee(T,O).then(k,I),"then"),catch:f(k=>ee(T,O).catch(k),"catch"),finally:f(k=>ee(T,O).finally(k),"finally")}}f(pi,"createNeonQueryPromise");function Ga(ee,{arrayMode:T,fullResults:O,parameterizedQuery:k,resultCallback:I,types:j}){let M=new mi.default(j),A=ee.fields.map($=>$.name),B=ee.fields.map($=>M.getTypeParser($.dataTypeID)),re=T===!0?ee.rows.map($=>$.map((W,F)=>W===null?null:B[F](W))):ee.rows.map($=>Object.fromEntries($.map((W,F)=>[A[F],W===null?null:B[F](W)])));return I&&I(k,ee,re,{arrayMode:T,fullResults:O}),O?(ee.viaNeonFetch=!0,ee.rowAsArray=T,ee.rows=re,ee._parsers=B,ee._types=M,ee):re}f(Ga,"	processQueryResult");function on(ee){return K(this,null,function*(){if(typeof ee=="string")return ee;if(typeof ee=="function")try{return yield Promise.resolve(ee())}catch(T){let O=new Xs("Error ge	tting auth token.");throw T instanceof Error&&(O=new Xs(`Error getting auth token: ${T.message}`)),O}})}f(on,"getAuthToken");var Xt=_(zn()),Ws=_(gr()),Ur=class extends fi.Client{constructor(T){super(T),this.config=T}get neonConfig(){return this.connection.stream}connect(T){var re,$,W;let{neonConfig:O}=this;O.forceDisablePgSSL&&(this.ssl=this.connection.ssl=!1),this.ssl&&O.useSecureWebSocket&&console.warn("	SSL is enabled for both Postgres (e.g. ?sslmode=require in the connection string	 + forceDisablePgSSL = false) and the WebSocket tunnel (useSecureWebSocket = tru	e). Double encryption will increase latency and CPU usage. It may be appropriate	 to disable SSL in the Postgres connection parameters or set forceDisablePgSSL =	 true.");let k=((re=this.config)==null?void 0:re.host)!==void 0||(($=this.config)==null?void 0:$.connectionString)!==void 0||De.env.PGHOST!==void 0,I=(W=De.env.USER)!=null?W:De.env.USERNAME;if(!k&&this.host==="localhost"&&this.user===I&&this.database===I&&this.password===null)throw new Error(`No database host or connection string was set, and key parameters have default values (host: localhost, user: ${I}, db: ${I}, password: null). Is an environment variable missing? Alternatively, if you intended to connect with these parameters, please set the host to 'localhost' explicitly.`);let j=super.connect(T),M=O.pipelineTLS&&this.ssl,A=O.pipelineConnect==="password";if(!M&&!O.pipelineConnect)return j;let B=this.connection;if(M&&B.on("connect",()=>B.stream.emit("data","S")),A){B.removeAllListeners("authenticationCleartextPassword"),B.removeAllListeners("readyForQuery"),B.once("readyForQuery",()=>B.on("readyForQuery",this._handleReadyForQuery.bind(this)));let F=this.ssl?"sslconnect":"connect";B.on(F,()=>{this._handleAuthCleartextPassword(),this._handleReadyForQuery()})}return j}_handleAuthSASLContinue(T){return K(this,null,function*(){let O=this.saslSession,k=this.password,I=T.data;if(O.message!=="SASLInitialResponse"||typeof k!="string"||typeof I!="string")throw new Error("SASL: protocol error");let j=Object.fromEntries(I.split(",").map(Ye=>{if(!/^.=/.test(Ye))throw new Error("SASL: Inva	lid attribute pair entry");let ut=Ye[0],It=Ye.substring(2);return[ut,It]})),M=j.r,A=j.s,B=j.i;if(!M||!/^[!-+--~]+$/.test(M))throw new Error("SASL: SCRAM-SERVER-FIRST-	MESSAGE: nonce missing/unprintable");if(!A||!/^(?:[a-zA-Z0-9+/]{4})*(?:[a-zA-Z0-9+/]{2}==|[a-zA-Z0-9+/]{3}=)?$/.test(A))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt missing/not base	64");if(!B||!/^[1-9][0-9]*$/.test(B))throw new Error("SASL: SCRAM-SERVER-FIRST-M	ESSAGE: missing/invalid iteration count");if(!M.startsWith(O.clientNonce))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce does not start with client nonce");if(M.length===O.clientNonce.length)throw new Error("SASL: SCRAM-SERVER-FIRST-MES	SAGE: server nonce is too short");let re=parseInt(B,10),$=Ne.from(A,"base64"),W=new TextEncoder,F=W.encode(k),te=yield _e.subtle.importKey("raw",F,{name:"HMAC",hash:{name:"SHA-25	6"}},!1,["sign"]),N=new Uint8Array(yield _e.subtle.sign("HMAC",te,Ne.concat([$,Ne.from([0,0,0,1])]))),C=N;for(var q=0;q<re-1;q++)N=new Uint8Array(yield _e.subtle.sign("HMAC",te,N)),C=Ne.from(C.map((Ye,ut)=>C[ut]^N[ut]));let ae=C,le=yield _e.subtle.importKey("raw",ae,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),ue=new Uint8Array(yield _e.subtle.sign("HMAC",le,W.encode("Client Key"))),Ee=yield _e.subtle.digest("SHA-256",ue),Te="n=*,r="+O.clientNonce,se="r="+M+",s="+A+",i="+re,ge="c=biws,r="+M,me=Te+","+se+","+ge,ce=yield _e.subtle.importKey("raw",Ee,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]);var je=new Uint8Array(yield _e.subtle.sign("HMAC",ce,W.encode(me))),ve=Ne.from(ue.map((Ye,ut)=>ue[ut]^je[ut])),$e=ve.toString("base64");let We=yield _e.subtle.importKey("raw",ae,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),Ce=yield _e.subtle.sign("HMAC",We,W.encode("Server Key")),Fe=yield _e.subtle.importKey("raw",Ce,{name:"HM	AC",hash:{name:"SHA-256"}},!1,["sign"]);var Ze=Ne.from(yield _e.subtle.sign("HMAC",Fe,W.encode(me)));O.message="SASLResponse",O.serverSignature=Ze.toString("base64"),O.response=ge+",p="+$e,this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)})}};f(Ur,"NeonClient");var yr=Ur;function Dt(ee,T){if(T)return{callback:T,result:void 0};let O,k,I=f(function(M,A){M?O(M):k(A)},"cb"),j=new ee(function(M,A){k=M,O=A});return{callback:I,result:j}}f(Dt,"promisify");var Gn=class extends fi.Pool{constructor(){super(...arguments),U(this,"Client",yr),U(this,"hasFetchUnsupportedListeners",!1)}on(T,O){return T!=="error"&&(this.hasFetchUnsupportedListeners=!0),super.on(T,O)}query(T,O,k){var j,M,A;if(!Ks.poolQueryViaFetch||this.hasFetchUnsupportedListeners||typeof T=="function")return super.query(T,O,k);typeof O=="function"&&(k=O,O=void 0);let I=Dt(this.Promise,k);k=I.callback;try{let B=new Xt.default(this.options),re=encodeURIComponent,$=encodeURI,W=`postgresql://${re(B.user)}:${re(B.password)}@${re(B.host)}/${$(B.database)}`,F=typeof T=="string"?T:T.text,te=(j=O!=null?O:T.values)!=null?j:[];Vr(W,{fullResults:!0,arrayMode:T.rowMode==="	array"})(F,te,{types:(A=T.types)!=null?A:(M=this.options)==null?void 0:M.types}).then(N=>k(void 0,N)).catch(N=>k(N))}catch(B){k(B)}return I.result}};f(Gn,"NeonPool");var yi=Gn;/*! Bundled license information:

	ieee754/index.js:
	  (*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> *)

	buffer/index.js:
	  (*!
	   * The buffer module from node.js, for the browser.
	   *
	   * @author   Feross Aboukhadijeh <https://feross.org>
	   * @license  MIT
	   *)
	*/return wm}var qx;function BS(){if(qx)return gd;qx=1;var n={};Object.defineProperty(gd,"__esModule",{value:!0}),gd.neon=s;const e=US();function s(a,l){let d,h;if(typeof a=="string"?(d=a,h=l):(d=void 0,h=a),d===void 0&&n.NETLIFY_DATABASE_URL===void 0)throw new Error("[@netlify/neon] Failed to instantiate Neon client: connection string is not provided either as an argument or as an environment variable (`NETLIFY_DATABASE_URL`).\n      \nYou can initialize a Database in Netlify by running the command: `netlify db init`\n\nThe `netlify db init` command will create a new database and add the `NETLIFY_DATABASE_URL` environment variable to your Netlify site.\n\nRead more: https://cli.netlify.com/#db\n");return(0,e.neon)(d!=null?d:n.NETLIFY_DATABASE_URL,h)}return gd}var Fv=BS(),zS={};const FS=zS.DATABASE_URL||"postgresql://neondb_owner:npg_l1ihrQg7wRdv@ep-cold-feather-aecrkjj2-pooler.c-2.us-east-2.aws.neon.tech/neondb?channel_binding=require&sslmode=require",dn=Fv.neon(FS);class uo{static savePdfFile(e){return K(this,null,function*(){var s;try{return{success:!0,pdfId:(s=(yield dn`
        INSERT INTO pdf_files (
          filename, original_filename, file_type, file_size, content,
          patient_id, category, description, uploaded_by
        ) VALUES (
          ${e.filename},
          ${e.originalFilename},
          ${e.fileType},
          ${e.fileSize},
          ${e.content},
          ${e.patientId||null},
          ${e.category},
          ${e.description||null},
          ${e.uploadedBy||null}
        ) RETURNING id
      `)[0])==null?void 0:s.id}}catch(a){throw console.error("Error saving PDF file:",a),a}})}static getPdfFile(e){return K(this,null,function*(){try{return(yield dn`
        SELECT * FROM pdf_files WHERE id = ${e}
      `)[0]||null}catch(s){throw console.error("Error getting PDF file:",s),s}})}static getPdfsByPatient(e){return K(this,null,function*(){try{return yield dn`
        SELECT id, filename, original_filename, file_type, file_size,
               category, description, uploaded_by, uploaded_at
        FROM pdf_files 
        WHERE patient_id = ${e}
        ORDER BY uploaded_at DESC
      `}catch(s){throw console.error("Error getting PDFs by patient:",s),s}})}static getAllPdfs(e=100){return K(this,null,function*(){try{return yield dn`
        SELECT p.id, p.filename, p.original_filename, p.file_type, p.file_size,
               p.category, p.description, p.uploaded_by, p.uploaded_at,
               pt.name_ar as patient_name
        FROM pdf_files p
        LEFT JOIN patients pt ON p.patient_id = pt.national_id
        ORDER BY p.uploaded_at DESC
        LIMIT ${e}
      `}catch(s){throw console.error("Error getting all PDFs:",s),s}})}static deletePdfFile(e){return K(this,null,function*(){try{return yield dn`DELETE FROM pdf_files WHERE id = ${e}`,{success:!0}}catch(s){throw console.error("Error deleting PDF file:",s),s}})}static getPdfTemplates(){return K(this,null,function*(){try{return yield dn`
        SELECT * FROM pdf_templates 
        WHERE is_active = true
        ORDER BY name_ar
      `}catch(e){throw console.error("Error getting PDF templates:",e),e}})}static getPdfTemplate(e){return K(this,null,function*(){try{return(yield dn`
        SELECT * FROM pdf_templates WHERE id = ${e}
      `)[0]||null}catch(s){throw console.error("Error getting PDF template:",s),s}})}static createPdfTemplate(e){return K(this,null,function*(){var s;try{return{success:!0,templateId:(s=(yield dn`
        INSERT INTO pdf_templates (
          name, name_ar, template_type, html_template, css_styles, created_by
        ) VALUES (
          ${e.name},
          ${e.nameAr},
          ${e.templateType},
          ${e.htmlTemplate},
          ${e.cssStyles||null},
          ${e.createdBy||null}
        ) RETURNING id
      `)[0])==null?void 0:s.id}}catch(a){throw console.error("Error creating PDF template:",a),a}})}static generatePdfFromTemplate(l,d){return K(this,arguments,function*(e,s,a={}){try{const h=yield this.getPdfTemplate(e);if(!h)throw new Error("Template not found");const f=this.processTemplate(h.htmlTemplate,s),b=h.cssStyles||"",v=yield this.htmlToPdf(f,b),E=new Date().toISOString().replace(/[:.]/g,"-"),D=`${h.templateType}_${a.patientId||"general"}_${E}.pdf`;yield dn`
        INSERT INTO pdf_generation_history (
          template_id, patient_id, visit_id, assessment_id,
          generated_filename, generation_data, generated_by
        ) VALUES (
          ${e},
          ${a.patientId||null},
          ${a.visitId||null},
          ${a.assessmentId||null},
          ${D},
          ${JSON.stringify(s)},
          ${a.generatedBy||null}
        )
      `;const _={filename:D,originalFilename:D,fileType:"application/pdf",fileSize:v.length,content:v,patientId:a.patientId,category:"report",description:`Generated from template: ${h.nameAr}`,uploadedBy:a.generatedBy};return yield this.savePdfFile(_),{success:!0,pdfContent:v,filename:D}}catch(h){throw console.error("Error generating PDF from template:",h),h}})}static processTemplate(e,s){let a=e;Object.keys(s).forEach(d=>{const h=new RegExp(`{{${d}}}`,"g");a=a.replace(h,s[d]||"")});const l=/{{(\w+)\.(\w+)}}/g;return a=a.replace(l,(d,h,f)=>s[h]&&s[h][f]?s[h][f]:""),a=a.replace(/{{generationDate}}/g,new Date().toLocaleDateString("ar-SA")),a}static htmlToPdf(e,s){return K(this,null,function*(){const a=`
      <!DOCTYPE html>
      <html>
        <head>
          <meta charset="UTF-8">
          <style>${s}</style>
        </head>
        <body>${e}</body>
      </html>
    `;return new TextEncoder().encode(a)})}static getPdfStats(){return K(this,null,function*(){var e,s;try{const[a,l,d,h]=yield Promise.all([dn`SELECT COUNT(*) as count FROM pdf_files`,dn`SELECT SUM(file_size) as total_size FROM pdf_files`,dn`
          SELECT category, COUNT(*) as count, SUM(file_size) as size
          FROM pdf_files 
          GROUP BY category 
          ORDER BY count DESC
        `,dn`
          SELECT id, filename, original_filename, category, uploaded_at, uploaded_by
          FROM pdf_files 
          ORDER BY uploaded_at DESC 
          LIMIT 10
        `]);return{totalPdfs:((e=a[0])==null?void 0:e.count)||0,totalSize:((s=l[0])==null?void 0:s.total_size)||0,pdfsByCategory:d,recentPdfs:h}}catch(a){throw console.error("Error getting PDF stats:",a),a}})}static searchPdfs(e,s,a){return K(this,null,function*(){try{let l=`
        SELECT p.*, pt.name_ar as patient_name
        FROM pdf_files p
        LEFT JOIN patients pt ON p.patient_id = pt.national_id
        WHERE (
          p.filename ILIKE ${"%"+e+"%"} OR
          p.original_filename ILIKE ${"%"+e+"%"} OR
          p.description ILIKE ${"%"+e+"%"} OR
          pt.name_ar ILIKE ${"%"+e+"%"}
        )
      `;const d=[e];return s&&(l+=` AND p.category = $${d.length+1}`,d.push(s)),a&&(l+=` AND p.patient_id = $${d.length+1}`,d.push(a)),l+=" ORDER BY p.uploaded_at DESC LIMIT 50",yield dn.unsafe(l,d)}catch(l){throw console.error("Error searching PDFs:",l),l}})}}var qS={};const HS=qS.DATABASE_URL||"postgresql://neondb_owner:npg_l1ihrQg7wRdv@ep-cold-feather-aecrkjj2-pooler.c-2.us-east-2.aws.neon.tech/neondb?channel_binding=require&sslmode=require",GS=typeof window!="undefined";let qs=null;try{GS||(qs=Fv.neon(HS))}catch(n){console.warn("Could not initialize Neon client:",n)}class Hx{static initializeDatabase(){return K(this,null,function*(){try{const a=(yield(yield fetch("/database/schema.sql")).text()).split(";").filter(l=>l.trim());for(const l of a)l.trim()&&(yield qs`${l}`);return console.log("Database initialized successfully"),{success:!0}}catch(e){throw console.error("Error initializing database:",e),e}})}static savePatient(e){return K(this,null,function*(){var s;try{return{success:!0,nationalId:(s=(yield qs`
        INSERT INTO patients (
          national_id, name_ar, name_en, age, sex, admission_date,
          area_id, phone, address, medical_diagnosis, braden_score,
          status, tags, contact_attempts, assessments
        ) VALUES (
          ${e.nationalId}, ${e.nameAr}, ${e.nameEn||null},
          ${e.age||null}, ${e.sex||null}, ${e.admissionDate||null},
          ${e.areaId||null}, ${e.phone||null}, ${e.address||null},
          ${e.medicalDiagnosis||null}, ${e.bradenScore||null},
          ${e.status||"active"}, ${JSON.stringify(e.tags||[])},
          ${JSON.stringify(e.contactAttempts||[])}, ${JSON.stringify(e.assessments||[])}
        )
        ON CONFLICT (national_id) 
        DO UPDATE SET
          name_ar = EXCLUDED.name_ar,
          name_en = EXCLUDED.name_en,
          age = EXCLUDED.age,
          sex = EXCLUDED.sex,
          admission_date = EXCLUDED.admission_date,
          area_id = EXCLUDED.area_id,
          phone = EXCLUDED.phone,
          address = EXCLUDED.address,
          medical_diagnosis = EXCLUDED.medical_diagnosis,
          braden_score = EXCLUDED.braden_score,
          status = EXCLUDED.status,
          tags = EXCLUDED.tags,
          contact_attempts = EXCLUDED.contact_attempts,
          assessments = EXCLUDED.assessments,
          updated_at = CURRENT_TIMESTAMP
        RETURNING national_id
      `)[0])==null?void 0:s.national_id}}catch(a){throw console.error("Error saving patient:",a),a}})}static getPatient(e){return K(this,null,function*(){try{return(yield qs`
        SELECT * FROM patients WHERE national_id = ${e}
      `)[0]||null}catch(s){throw console.error("Error getting patient:",s),s}})}static getAllPatients(){return K(this,null,function*(){try{if(!qs)throw new Error("Database client not available in browser environment");return yield qs`
        SELECT * FROM patients ORDER BY created_at DESC
      `}catch(e){throw console.error("Error getting all patients:",e),e}})}static getPatientsByArea(e){return K(this,null,function*(){try{return yield qs`
        SELECT * FROM patients WHERE area_id = ${e} ORDER BY name_ar
      `}catch(s){throw console.error("Error getting patients by area:",s),s}})}static saveVisit(e){return K(this,null,function*(){var s;try{return{success:!0,visitId:(s=(yield qs`
        INSERT INTO visits (
          patient_id, team_id, visit_date, status,
          doctor_note, nurse_note, pt_note, sw_note,
          doctor_sign, nurse_sign, pt_sign, sw_sign
        ) VALUES (
          ${e.patientId}, ${e.teamId||null}, ${e.visitDate},
          ${e.status||"Scheduled"}, ${JSON.stringify(e.doctorNote||null)},
          ${JSON.stringify(e.nurseNote||null)}, ${JSON.stringify(e.ptNote||null)},
          ${JSON.stringify(e.swNote||null)}, ${e.doctorSign||null},
          ${e.nurseSign||null}, ${e.ptSign||null}, ${e.swSign||null}
        )
        ON CONFLICT (patient_id, visit_date)
        DO UPDATE SET
          team_id = EXCLUDED.team_id,
          status = EXCLUDED.status,
          doctor_note = EXCLUDED.doctor_note,
          nurse_note = EXCLUDED.nurse_note,
          pt_note = EXCLUDED.pt_note,
          sw_note = EXCLUDED.sw_note,
          doctor_sign = EXCLUDED.doctor_sign,
          nurse_sign = EXCLUDED.nurse_sign,
          pt_sign = EXCLUDED.pt_sign,
          sw_sign = EXCLUDED.sw_sign,
          updated_at = CURRENT_TIMESTAMP
        RETURNING id
      `)[0])==null?void 0:s.id}}catch(a){throw console.error("Error saving visit:",a),a}})}static getVisitsByDateRange(e,s){return K(this,null,function*(){try{return yield qs`
        SELECT v.*, p.name_ar as patient_name
        FROM visits v
        JOIN patients p ON v.patient_id = p.national_id
        WHERE v.visit_date >= ${e} AND v.visit_date <= ${s}
        ORDER BY v.visit_date DESC, p.name_ar
      `}catch(a){throw console.error("Error getting visits by date range:",a),a}})}static getTodayVisits(){return K(this,null,function*(){const e=new Date().toISOString().split("T")[0];return this.getVisitsByDateRange(e,e)})}static saveStaff(e){return K(this,null,function*(){var s;try{return{success:!0,staffId:(s=(yield qs`
        INSERT INTO staff (
          name_ar, name_en, profession_ar, profession_en,
          phone, email, area_id
        ) VALUES (
          ${e.nameAr}, ${e.nameEn||null}, ${e.professionAr||null},
          ${e.professionEn||null}, ${e.phone||null}, ${e.email||null},
          ${e.areaId||null}
        ) RETURNING id
      `)[0])==null?void 0:s.id}}catch(a){throw console.error("Error saving staff:",a),a}})}static getAllStaff(){return K(this,null,function*(){try{if(!qs)throw new Error("Database client not available in browser environment");return yield qs`
        SELECT * FROM staff ORDER BY name_ar
      `}catch(e){throw console.error("Error getting all staff:",e),e}})}static saveAssessment(e){return K(this,null,function*(){var s;try{return{success:!0,assessmentId:(s=(yield qs`
        INSERT INTO assessments (
          id, patient_id, role, assessment_data, created_by
        ) VALUES (
          ${e.id}, ${e.patientId}, ${e.role},
          ${JSON.stringify(e)}, ${e.createdBy||null}
        )
        ON CONFLICT (id)
        DO UPDATE SET
          assessment_data = EXCLUDED.assessment_data,
          updated_at = CURRENT_TIMESTAMP
        RETURNING id
      `)[0])==null?void 0:s.id}}catch(a){throw console.error("Error saving assessment:",a),a}})}static getAssessmentsByPatient(e){return K(this,null,function*(){try{return yield qs`
        SELECT * FROM assessments 
        WHERE patient_id = ${e}
        ORDER BY created_at DESC
      `}catch(s){throw console.error("Error getting assessments by patient:",s),s}})}static logActivity(e,s,a,l){return K(this,null,function*(){var d;try{return{success:!0,logId:(d=(yield qs`
        INSERT INTO activity_log (action, details, user_email, user_name)
        VALUES (${e}, ${JSON.stringify(s)}, ${a||null}, ${l||null})
        RETURNING id
      `)[0])==null?void 0:d.id}}catch(h){throw console.error("Error logging activity:",h),h}})}static syncFromFirebase(e){return K(this,null,function*(){var s,a,l;try{if(e.patients)for(const d of e.patients)yield this.savePatient(d);if(e.staff)for(const d of e.staff)yield this.saveStaff(d);if(e.visits)for(const d of e.visits)yield this.saveVisit(d);return yield this.logActivity("sync_from_firebase",{patientsCount:((s=e.patients)==null?void 0:s.length)||0,staffCount:((a=e.staff)==null?void 0:a.length)||0,visitsCount:((l=e.visits)==null?void 0:l.length)||0}),{success:!0}}catch(d){throw console.error("Error syncing from Firebase:",d),d}})}static savePdf(e){return K(this,null,function*(){return uo.savePdfFile(e)})}static getPdfsByPatient(e){return K(this,null,function*(){return uo.getPdfsByPatient(e)})}static getAllPdfs(e=100){return K(this,null,function*(){return uo.getAllPdfs(e)})}static generatePatientCard(e,s){return K(this,null,function*(){const a=yield this.getPatient(e);if(!a)throw new Error("Patient not found");return uo.generatePdfFromTemplate(1,{patient:{nameAr:a.name_ar,nationalId:a.national_id,age:a.age,sex:a.sex==="M"?"":"",phone:a.phone,areaId:a.area_id,admissionDate:a.admission_date,bradenScore:a.braden_score,medicalDiagnosis:a.medical_diagnosis},generationDate:new Date().toLocaleDateString("ar-SA"),generatedBy:s||""},{patientId:e,generatedBy:s})})}static generateVisitReport(e,s,a){return K(this,null,function*(){const[l,d]=yield Promise.all([this.getPatient(e),qs`SELECT * FROM visits WHERE id = ${s}`]);if(!l||!d[0])throw new Error("Patient or visit not found");const h=d[0];return uo.generatePdfFromTemplate(2,{patient:{nameAr:l.name_ar,nationalId:l.national_id},visit:{visitDate:h.visit_date,status:h.status,doctorNote:h.doctor_note?JSON.stringify(h.doctor_note):null,nurseNote:h.nurse_note?JSON.stringify(h.nurse_note):null,doctorSign:h.doctor_sign,nurseSign:h.nurse_sign},generationDate:new Date().toLocaleDateString("ar-SA")},{patientId:e,visitId:s,generatedBy:a})})}static getPdfStats(){return K(this,null,function*(){return uo.getPdfStats()})}static searchPdfs(e,s,a){return K(this,null,function*(){return uo.searchPdfs(e,s,a)})}}let Ac=null,pd=0;const $S=300*1e3,QS=()=>K(null,null,function*(){const n=Date.now();if(Ac&&n-pd<$S)return Ac;try{if(typeof window!="undefined")throw console.log("Browser detected, skipping Netlify DB and using JSON fallback"),new Error("Skipping Netlify DB in browser");console.log("Attempting to load data from Netlify DB...");const e=yield Hx.getAllPatients(),s=yield Hx.getAllStaff();if(e.length>0&&s.length>0){console.log("Successfully loaded data from Netlify DB");const a=KS(e,s);return Ac=a,pd=n,a}}catch(e){console.warn("Netlify DB failed, falling back to JSON bundle:",e)}try{console.log("Loading data from JSON bundle fallback...");const e=yield fetch("/homecare_db_bundle_ar.v3.json");if(!e.ok)throw new Error(`HTTP ${e.status}: ${e.statusText}`);const s=yield e.json();console.log("Successfully loaded data from JSON bundle");const a=YS(s);if(!a||!a.patients||!Array.isArray(a.patients))throw new Error("Invalid processed data structure");return console.log(" Data validation passed:",{patientsCount:a.patients.length,staffCount:a.staff.length,areasCount:a.areas.length}),Ac=a,pd=n,a}catch(e){console.error("Both data sources failed, using minimal fallback:",e);const s={patients:[],staff:[{:".  ",:"",:"doctor@hospital.sa",:"0501234567",_:"1234567890"},{:".  ",:"",:"nurse@hospital.sa",:"0507654321",_:"0987654321"},{:".  ",:" ",:"social@hospital.sa",:"0505555555",_:"5555555555"}],areas:[" "," "," "],criticalCases:{catheter:[],pressureSore:[],tubeFeeding:[],fallRisk:[],ivTherapy:[],ventilation:[]}};return console.log(" Using minimal fallback data structure"),Ac=s,pd=n,s}}),KS=(n,e)=>{const s=n.map((h,f)=>{const b=JSON.parse(h.tags||"[]"),v=JSON.parse(h.assessments||"[]"),E=JSON.parse(h.contact_attempts||"[]"),D=f%3===0?"Female":"Male";return{nationalId:h.national_id,nameAr:h.name_ar,phone:h.phone,areaId:h.area_id,status:h.status,level:"4",bradenScore:h.braden_score,minMonthlyRequired:1,admissionDate:h.admission_date,gmapsUrl:!1,tags:b,sex:D,assessments:v,contactAttempts:E}}),a=e.map(h=>{var f;return{:h.name_ar,:h.profession_ar,:h.email,:h.phone,_:((f=h.id)==null?void 0:f.toString())||h.national_id}}),l=[...new Set(s.map(h=>h.areaId).filter(Boolean))],d={catheter:s.filter(h=>h.tags.includes("Catheter")).map(h=>({nationalId:h.nationalId,hasCatheter:!0})),pressureSore:s.filter(h=>h.tags.includes("Pressure Ulcer")).map(h=>({nationalId:h.nationalId,wounds:{presentCount:1,statusRaw:"Active Wound"}})),tubeFeeding:s.filter(h=>h.tags.includes("Tube Feeding")).map(h=>({nationalId:h.nationalId,ngTube:!0})),fallRisk:s.filter(h=>h.tags.includes("Fall Risk")).map(h=>({nationalId:h.nationalId,fallHighRisk:!0})),ivTherapy:s.filter(h=>h.tags.includes("IV Therapy")).map(h=>({nationalId:h.nationalId,ivTherapy:!0})),ventilation:s.filter(h=>h.tags.includes("Ventilation")).map(h=>({nationalId:h.nationalId,ventSupport:!0}))};return{patients:s,staff:a,areas:l,criticalCases:d}},YS=n=>({patients:n..map((s,a)=>{const l=[];n._._.some(h=>h.nationalId===s.nationalId)&&l.push("Catheter"),n._.__.some(h=>h.nationalId===s.nationalId)&&l.push("Pressure Ulcer"),n._.__.some(h=>h.nationalId===s.nationalId)&&l.push("Tube Feeding"),n._.__.some(h=>h.nationalId===s.nationalId)&&l.push("Fall Risk"),n._.__.some(h=>h.nationalId===s.nationalId)&&l.push("IV Therapy"),n._._.some(h=>h.nationalId===s.nationalId)&&l.push("Ventilation");const d=a%3===0?"Female":"Male";return oe(X({},s),{tags:l,sex:d,status:s.status,assessments:[],contactAttempts:[]})}),staff:n.,areas:n.,criticalCases:{catheter:n._._,pressureSore:n._.__,tubeFeeding:n._.__,fallRisk:n._.__,ivTherapy:n._.__,ventilation:n._._}});let XS=null;const Td=n=>{if(!n)return{patients:[],staff:[],areas:[],criticalCases:{catheter:[],pressureSore:[],tubeFeeding:[],fallRisk:[],ivTherapy:[],ventilation:[]},filters:{search:"",areas:[],tags:[],sex:[],risk:[]},selectedPatientIds:new Set,currentRole:rt.Doctor,visits:[],teams:[],customLists:[]};const e=n.staff.filter(a=>a.===""),s=n.staff.filter(a=>a.==="");return oe(X({},n),{filters:{search:"",areas:[],tags:[],sex:[],risk:[]},selectedPatientIds:new Set,currentRole:rt.Doctor,visits:[],teams:[{id:"team1",name:"Team 1",members:[e[0],s[0],s[1]].filter(Boolean)},{id:"team2",name:"Team 2",members:[e[1],s[2],s[3]].filter(Boolean)},{id:"team3",name:"Team 3",members:[e[2],s[4],s[5]].filter(Boolean)}].filter(a=>a.members.length>0),customLists:[]})},WS=(n,e)=>{switch(e.type){case"SET_SEARCH":return oe(X({},n),{filters:oe(X({},n.filters),{search:e.payload})});case"TOGGLE_AREA_FILTER":const s=n.filters.areas.includes(e.payload)?n.filters.areas.filter(f=>f!==e.payload):[...n.filters.areas,e.payload];return oe(X({},n),{filters:oe(X({},n.filters),{areas:s})});case"TOGGLE_TAG_FILTER":const a=n.filters.tags.includes(e.payload)?n.filters.tags.filter(f=>f!==e.payload):[...n.filters.tags,e.payload];return oe(X({},n),{filters:oe(X({},n.filters),{tags:a})});case"TOGGLE_SEX_FILTER":const l=n.filters.sex.includes(e.payload)?n.filters.sex.filter(f=>f!==e.payload):[...n.filters.sex,e.payload];return oe(X({},n),{filters:oe(X({},n.filters),{sex:l})});case"TOGGLE_RISK_FILTER":const d=n.filters.risk.includes(e.payload)?n.filters.risk.filter(f=>f!==e.payload):[...n.filters.risk,e.payload];return oe(X({},n),{filters:oe(X({},n.filters),{risk:d})});case"CLEAR_FILTERS":return oe(X({},n),{filters:{search:"",areas:[],tags:[],sex:[],risk:[]}});case"TOGGLE_PATIENT_SELECTION":const h=new Set(n.selectedPatientIds);return h.has(e.payload)?h.delete(e.payload):h.add(e.payload),oe(X({},n),{selectedPatientIds:h});case"CLEAR_SELECTIONS":return oe(X({},n),{selectedPatientIds:new Set});case"SELECT_ALL_FILTERED":return oe(X({},n),{selectedPatientIds:new Set(e.payload)});case"SET_ROLE":return oe(X({},n),{currentRole:e.payload});case"ASSIGN_TO_VISITS":{const f=e.payload.patientIds.map(E=>({patientId:E,date:e.payload.date,teamId:e.payload.teamId,status:"Scheduled"})),b=new Set(n.visits.map(E=>`${E.patientId}-${E.date}`)),v=f.filter(E=>!b.has(`${E.patientId}-${E.date}`));return oe(X({},n),{visits:[...n.visits,...v],selectedPatientIds:new Set})}case"SAVE_VISIT_NOTE":{const{visitId:f,role:b,note:v,user:E}=e.payload,[D,_]=f.split("_");return oe(X({},n),{visits:n.visits.map(R=>{if(R.patientId===D&&R.date===_){const U=X({},R);b===rt.Doctor?(U.doctorNote=v,U.doctorSign=E):b===rt.Nurse?(U.nurseNote=v,U.nurseSign=E):b===rt.PhysicalTherapist?(U.ptNote=v,U.ptSign=E):b===rt.SocialWorker&&(U.swNote=v,U.swSign=E);const ie=!!U.doctorNote,he=!!U.nurseNote;let Se="Scheduled";return ie&&he?Se="Completed":ie?Se="DoctorCompleted":he&&(Se="NurseCompleted"),U.status=Se,U}return R})})}case"SAVE_ASSESSMENT":{const{patientId:f,assessment:b}=e.payload;return oe(X({},n),{patients:n.patients.map(v=>{if(v.nationalId===f){const E=[b,...v.assessments||[]];let D=v.bradenScore;return b.role===rt.Nurse&&"bradenScore"in b&&b.bradenScore&&(D=parseInt(String(b.bradenScore),10)),oe(X({},v),{assessments:E,bradenScore:D||v.bradenScore})}return v})})}case"LOG_CONTACT_ATTEMPT":return oe(X({},n),{patients:n.patients.map(f=>f.nationalId===e.payload.patientId?oe(X({},f),{contactAttempts:[e.payload.contactAttempt,...f.contactAttempts||[]]}):f)});case"CANCEL_VISIT":return oe(X({},n),{visits:n.visits.filter(f=>!(f.patientId===e.payload.patientId&&f.date===e.payload.date))});case"IMPORT_STATE":return e.payload&&e.payload.patients&&e.payload.filters?oe(X(X({},Td(null)),e.payload),{selectedPatientIds:new Set(e.payload.selectedPatientIds||[])}):n;case"CREATE_CUSTOM_LIST":{if(n.selectedPatientIds.size===0||!e.payload.name)return n;const f={id:Date.now().toString(),name:e.payload.name,patientIds:Array.from(n.selectedPatientIds)};return oe(X({},n),{customLists:[...n.customLists,f]})}case"DELETE_CUSTOM_LIST":return oe(X({},n),{customLists:n.customLists.filter(f=>f.id!==e.payload.id)});case"APPLY_CUSTOM_LIST":{const f=n.customLists.find(b=>b.id===e.payload.id);return f?oe(X({},n),{selectedPatientIds:new Set(f.patientIds)}):n}default:return n}},qv=Pe.createContext(void 0),JS=({children:n})=>{const[e,s]=Pe.useState(!1),[a,l]=Pe.useReducer(WS,Td(null)),d=Pe.useCallback(_=>{l({type:"TOGGLE_PATIENT_SELECTION",payload:_})},[]),h=Pe.useCallback(()=>{l({type:"CLEAR_SELECTIONS"})},[]),f=Pe.useCallback(_=>{Object.entries(_).forEach(([R,U])=>{switch(R){case"search":l({type:"SET_SEARCH",payload:U});break}})},[]),b=Pe.useCallback(_=>{l({type:"SET_ROLE",payload:_})},[]),v=Pe.useCallback((_,R)=>{l({type:"LOG_CONTACT_ATTEMPT",payload:{patientId:_,contactAttempt:R}})},[]),E=Pe.useMemo(()=>({selectPatient:d,clearSelections:h,updateFilters:f,setRole:b,logContactAttempt:v}),[d,h,f,b,v]);Pe.useEffect(()=>{e||K(null,null,function*(){try{console.log(" Starting to load patient data...");const R=yield QS();if(!R||!R.patients||!Array.isArray(R.patients))throw new Error("Invalid data structure received");console.log(" Patient data loaded:",{patientsCount:R.patients.length,staffCount:R.staff.length,areasCount:R.areas.length}),XS=R;const U=Td(R);l({type:"IMPORT_STATE",payload:U}),s(!0),console.log(" HomeHealthcare context initialized successfully")}catch(R){console.error(" Failed to load patient data:",R);const U=Td(null);l({type:"IMPORT_STATE",payload:U}),s(!0),console.warn(" Using empty state as fallback")}})},[e]);const D=Pe.useMemo(()=>{const{patients:_,filters:R}=a;if(!_||!Array.isArray(_))return console.warn("Patients array is undefined or not an array:",_),[];const{search:U,areas:ie,tags:he,sex:Se,risk:Be}=R,xe=U.toLowerCase();return _.filter(_e=>{if(_e.status==="deceased")return!1;const Ne=Uv(_e.admissionDate).level,De=_e.nameAr.toLowerCase().includes(xe),G=_e.nationalId.includes(U),V=U===""||De||G,L=ie.length===0||_e.areaId&&ie.includes(_e.areaId),z=he.length===0||he.every(J=>_e.tags.includes(J)),Q=Se.length===0||_e.sex&&Se.includes(_e.sex),Y=Be.length===0||Be.includes(Ne);return V&&L&&z&&Q&&Y})},[a.patients,a.filters]);return i.jsx(qv.Provider,{value:{state:a,dispatch:l,filteredPatients:D,actions:E},children:n})},os=()=>{const n=Pe.useContext(qv);if(n===void 0)throw new Error("useHomeHealthcare must be used within a HomeHealthcareProvider");return n},ZS=()=>{};var Gx={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hv=function(n){const e=[];let s=0;for(let a=0;a<n.length;a++){let l=n.charCodeAt(a);l<128?e[s++]=l:l<2048?(e[s++]=l>>6|192,e[s++]=l&63|128):(l&64512)===55296&&a+1<n.length&&(n.charCodeAt(a+1)&64512)===56320?(l=65536+((l&1023)<<10)+(n.charCodeAt(++a)&1023),e[s++]=l>>18|240,e[s++]=l>>12&63|128,e[s++]=l>>6&63|128,e[s++]=l&63|128):(e[s++]=l>>12|224,e[s++]=l>>6&63|128,e[s++]=l&63|128)}return e},e2=function(n){const e=[];let s=0,a=0;for(;s<n.length;){const l=n[s++];if(l<128)e[a++]=String.fromCharCode(l);else if(l>191&&l<224){const d=n[s++];e[a++]=String.fromCharCode((l&31)<<6|d&63)}else if(l>239&&l<365){const d=n[s++],h=n[s++],f=n[s++],b=((l&7)<<18|(d&63)<<12|(h&63)<<6|f&63)-65536;e[a++]=String.fromCharCode(55296+(b>>10)),e[a++]=String.fromCharCode(56320+(b&1023))}else{const d=n[s++],h=n[s++];e[a++]=String.fromCharCode((l&15)<<12|(d&63)<<6|h&63)}}return e.join("")},Gv={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const s=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,a=[];for(let l=0;l<n.length;l+=3){const d=n[l],h=l+1<n.length,f=h?n[l+1]:0,b=l+2<n.length,v=b?n[l+2]:0,E=d>>2,D=(d&3)<<4|f>>4;let _=(f&15)<<2|v>>6,R=v&63;b||(R=64,h||(_=64)),a.push(s[E],s[D],s[_],s[R])}return a.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(Hv(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):e2(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const s=e?this.charToByteMapWebSafe_:this.charToByteMap_,a=[];for(let l=0;l<n.length;){const d=s[n.charAt(l++)],f=l<n.length?s[n.charAt(l)]:0;++l;const v=l<n.length?s[n.charAt(l)]:64;++l;const D=l<n.length?s[n.charAt(l)]:64;if(++l,d==null||f==null||v==null||D==null)throw new t2;const _=d<<2|f>>4;if(a.push(_),v!==64){const R=f<<4&240|v>>2;if(a.push(R),D!==64){const U=v<<6&192|D;a.push(U)}}}return a},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class t2 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const s2=function(n){const e=Hv(n);return Gv.encodeByteArray(e,!0)},Vd=function(n){return s2(n).replace(/\./g,"")},$v=function(n){try{return Gv.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n2(){if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof global!="undefined")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r2=()=>n2().__FIREBASE_DEFAULTS__,i2=()=>{if(typeof process=="undefined"||typeof Gx=="undefined")return;const n=Gx.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},a2=()=>{if(typeof document=="undefined")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(s){return}const e=n&&$v(n[1]);return e&&JSON.parse(e)},oh=()=>{try{return ZS()||r2()||i2()||a2()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Qv=n=>{var e,s;return(s=(e=oh())==null?void 0:e.emulatorHosts)==null?void 0:s[n]},Kv=n=>{const e=Qv(n);if(!e)return;const s=e.lastIndexOf(":");if(s<=0||s+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const a=parseInt(e.substring(s+1),10);return e[0]==="["?[e.substring(1,s-1),a]:[e.substring(0,s),a]},Yv=()=>{var n;return(n=oh())==null?void 0:n.config},Xv=n=>{var e;return(e=oh())==null?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o2{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,s)=>{this.resolve=e,this.reject=s})}wrapCallback(e){return(s,a)=>{s?this.reject(s):this.resolve(a),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(s):e(s,a))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function No(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch(e){return!1}}function vg(n){return K(this,null,function*(){return(yield fetch(n,{credentials:"include"})).ok})}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wv(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const s={alg:"none",type:"JWT"},a=e||"demo-project",l=n.iat||0,d=n.sub||n.user_id;if(!d)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const h=X({iss:`https://securetoken.google.com/${a}`,aud:a,iat:l,exp:l+3600,auth_time:l,sub:d,user_id:d,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Vd(JSON.stringify(s)),Vd(JSON.stringify(h)),""].join(".")}const Pc={};function l2(){const n={prod:[],emulator:[]};for(const e of Object.keys(Pc))Pc[e]?n.emulator.push(e):n.prod.push(e);return n}function c2(n){let e=document.getElementById(n),s=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),s=!0),{created:s,element:e}}let $x=!1;function _g(n,e){if(typeof window=="undefined"||typeof document=="undefined"||!No(window.location.host)||Pc[n]===e||Pc[n]||$x)return;Pc[n]=e;function s(_){return`__firebase__banner__${_}`}const a="__firebase__banner",d=l2().prod.length>0;function h(){const _=document.getElementById(a);_&&_.remove()}function f(_){_.style.display="flex",_.style.background="#7faaf0",_.style.position="fixed",_.style.bottom="5px",_.style.left="5px",_.style.padding=".5em",_.style.borderRadius="5px",_.style.alignItems="center"}function b(_,R){_.setAttribute("width","24"),_.setAttribute("id",R),_.setAttribute("height","24"),_.setAttribute("viewBox","0 0 24 24"),_.setAttribute("fill","none"),_.style.marginLeft="-6px"}function v(){const _=document.createElement("span");return _.style.cursor="pointer",_.style.marginLeft="16px",_.style.fontSize="24px",_.innerHTML=" &times;",_.onclick=()=>{$x=!0,h()},_}function E(_,R){_.setAttribute("id",R),_.innerText="Learn more",_.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",_.setAttribute("target","__blank"),_.style.paddingLeft="5px",_.style.textDecoration="underline"}function D(){const _=c2(a),R=s("text"),U=document.getElementById(R)||document.createElement("span"),ie=s("learnmore"),he=document.getElementById(ie)||document.createElement("a"),Se=s("preprendIcon"),Be=document.getElementById(Se)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(_.created){const xe=_.element;f(xe),E(he,ie);const _e=v();b(Be,Se),xe.append(Be,U,he,_e),document.body.appendChild(xe)}d?(U.innerText="Preview backend disconnected.",Be.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(Be.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,U.innerText="Preview backend running in this workspace."),U.setAttribute("id",R)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",D):D()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $s(){return typeof navigator!="undefined"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function u2(){return typeof window!="undefined"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test($s())}function d2(){var e;const n=(e=oh())==null?void 0:e.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch(s){return!1}}function h2(){return typeof navigator!="undefined"&&navigator.userAgent==="Cloudflare-Workers"}function f2(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function m2(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function g2(){const n=$s();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function p2(){return!d2()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function y2(){try{return typeof indexedDB=="object"}catch(n){return!1}}function x2(){return new Promise((n,e)=>{try{let s=!0;const a="validate-browser-context-for-indexeddb-analytics-module",l=self.indexedDB.open(a);l.onsuccess=()=>{l.result.close(),s||self.indexedDB.deleteDatabase(a),n(!0)},l.onupgradeneeded=()=>{s=!1},l.onerror=()=>{var d;e(((d=l.error)==null?void 0:d.message)||"")}}catch(s){e(s)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b2="FirebaseError";class ii extends Error{constructor(e,s,a){super(s),this.code=e,this.customData=a,this.name=b2,Object.setPrototypeOf(this,ii.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,nu.prototype.create)}}class nu{constructor(e,s,a){this.service=e,this.serviceName=s,this.errors=a}create(e,...s){const a=s[0]||{},l=`${this.service}/${e}`,d=this.errors[e],h=d?v2(d,a):"Error",f=`${this.serviceName}: ${h} (${l}).`;return new ii(l,f,a)}}function v2(n,e){return n.replace(_2,(s,a)=>{const l=e[a];return l!=null?String(l):`<${a}?>`})}const _2=/\{\$([^}]+)}/g;function w2(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function yo(n,e){if(n===e)return!0;const s=Object.keys(n),a=Object.keys(e);for(const l of s){if(!a.includes(l))return!1;const d=n[l],h=e[l];if(Qx(d)&&Qx(h)){if(!yo(d,h))return!1}else if(d!==h)return!1}for(const l of a)if(!s.includes(l))return!1;return!0}function Qx(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ru(n){const e=[];for(const[s,a]of Object.entries(n))Array.isArray(a)?a.forEach(l=>{e.push(encodeURIComponent(s)+"="+encodeURIComponent(l))}):e.push(encodeURIComponent(s)+"="+encodeURIComponent(a));return e.length?"&"+e.join("&"):""}function N2(n,e){const s=new S2(n,e);return s.subscribe.bind(s)}class S2{constructor(e,s){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=s,this.task.then(()=>{e(this)}).catch(a=>{this.error(a)})}next(e){this.forEachObserver(s=>{s.next(e)})}error(e){this.forEachObserver(s=>{s.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,s,a){let l;if(e===void 0&&s===void 0&&a===void 0)throw new Error("Missing Observer.");E2(e,["next","error","complete"])?l=e:l={next:e,error:s,complete:a},l.next===void 0&&(l.next=Nm),l.error===void 0&&(l.error=Nm),l.complete===void 0&&(l.complete=Nm);const d=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?l.error(this.finalError):l.complete()}catch(h){}}),this.observers.push(l),d}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let s=0;s<this.observers.length;s++)this.sendOne(s,e)}sendOne(e,s){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{s(this.observers[e])}catch(a){typeof console!="undefined"&&console.error&&console.error(a)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function E2(n,e){if(typeof n!="object"||n===null)return!1;for(const s of e)if(s in n&&typeof n[s]=="function")return!0;return!1}function Nm(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mn(n){return n&&n._delegate?n._delegate:n}class Da{constructor(e,s,a){this.name=e,this.instanceFactory=s,this.type=a,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ho="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j2{constructor(e,s){this.name=e,this.container=s,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const s=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(s)){const a=new o2;if(this.instancesDeferred.set(s,a),this.isInitialized(s)||this.shouldAutoInitialize())try{const l=this.getOrInitializeService({instanceIdentifier:s});l&&a.resolve(l)}catch(l){}}return this.instancesDeferred.get(s).promise}getImmediate(e){var l;const s=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),a=(l=e==null?void 0:e.optional)!=null?l:!1;if(this.isInitialized(s)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:s})}catch(d){if(a)return null;throw d}else{if(a)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(A2(e))try{this.getOrInitializeService({instanceIdentifier:ho})}catch(s){}for(const[s,a]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(s);try{const d=this.getOrInitializeService({instanceIdentifier:l});a.resolve(d)}catch(d){}}}}clearInstance(e=ho){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return K(this,null,function*(){const e=Array.from(this.instances.values());yield Promise.all([...e.filter(s=>"INTERNAL"in s).map(s=>s.INTERNAL.delete()),...e.filter(s=>"_delete"in s).map(s=>s._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=ho){return this.instances.has(e)}getOptions(e=ho){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:s={}}=e,a=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(a))throw Error(`${this.name}(${a}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const l=this.getOrInitializeService({instanceIdentifier:a,options:s});for(const[d,h]of this.instancesDeferred.entries()){const f=this.normalizeInstanceIdentifier(d);a===f&&h.resolve(l)}return l}onInit(e,s){var h;const a=this.normalizeInstanceIdentifier(s),l=(h=this.onInitCallbacks.get(a))!=null?h:new Set;l.add(e),this.onInitCallbacks.set(a,l);const d=this.instances.get(a);return d&&e(d,a),()=>{l.delete(e)}}invokeOnInitCallbacks(e,s){const a=this.onInitCallbacks.get(s);if(a)for(const l of a)try{l(e,s)}catch(d){}}getOrInitializeService({instanceIdentifier:e,options:s={}}){let a=this.instances.get(e);if(!a&&this.component&&(a=this.component.instanceFactory(this.container,{instanceIdentifier:T2(e),options:s}),this.instances.set(e,a),this.instancesOptions.set(e,s),this.invokeOnInitCallbacks(a,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,a)}catch(l){}return a||null}normalizeInstanceIdentifier(e=ho){return this.component?this.component.multipleInstances?e:ho:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function T2(n){return n===ho?void 0:n}function A2(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C2{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const s=this.getProvider(e.name);if(s.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);s.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const s=new j2(e,this);return this.providers.set(e,s),s}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var St;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(St||(St={}));const I2={debug:St.DEBUG,verbose:St.VERBOSE,info:St.INFO,warn:St.WARN,error:St.ERROR,silent:St.SILENT},R2=St.INFO,D2={[St.DEBUG]:"log",[St.VERBOSE]:"log",[St.INFO]:"info",[St.WARN]:"warn",[St.ERROR]:"error"},O2=(n,e,...s)=>{if(e<n.logLevel)return;const a=new Date().toISOString(),l=D2[e];if(l)console[l](`[${a}]  ${n.name}:`,...s);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class wg{constructor(e){this.name=e,this._logLevel=R2,this._logHandler=O2,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in St))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?I2[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,St.DEBUG,...e),this._logHandler(this,St.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,St.VERBOSE,...e),this._logHandler(this,St.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,St.INFO,...e),this._logHandler(this,St.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,St.WARN,...e),this._logHandler(this,St.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,St.ERROR,...e),this._logHandler(this,St.ERROR,...e)}}const k2=(n,e)=>e.some(s=>n instanceof s);let Kx,Yx;function M2(){return Kx||(Kx=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function P2(){return Yx||(Yx=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Jv=new WeakMap,Fm=new WeakMap,Zv=new WeakMap,Sm=new WeakMap,Ng=new WeakMap;function L2(n){const e=new Promise((s,a)=>{const l=()=>{n.removeEventListener("success",d),n.removeEventListener("error",h)},d=()=>{s(Aa(n.result)),l()},h=()=>{a(n.error),l()};n.addEventListener("success",d),n.addEventListener("error",h)});return e.then(s=>{s instanceof IDBCursor&&Jv.set(s,n)}).catch(()=>{}),Ng.set(e,n),e}function V2(n){if(Fm.has(n))return;const e=new Promise((s,a)=>{const l=()=>{n.removeEventListener("complete",d),n.removeEventListener("error",h),n.removeEventListener("abort",h)},d=()=>{s(),l()},h=()=>{a(n.error||new DOMException("AbortError","AbortError")),l()};n.addEventListener("complete",d),n.addEventListener("error",h),n.addEventListener("abort",h)});Fm.set(n,e)}let qm={get(n,e,s){if(n instanceof IDBTransaction){if(e==="done")return Fm.get(n);if(e==="objectStoreNames")return n.objectStoreNames||Zv.get(n);if(e==="store")return s.objectStoreNames[1]?void 0:s.objectStore(s.objectStoreNames[0])}return Aa(n[e])},set(n,e,s){return n[e]=s,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function U2(n){qm=n(qm)}function B2(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...s){const a=n.call(Em(this),e,...s);return Zv.set(a,e.sort?e.sort():[e]),Aa(a)}:P2().includes(n)?function(...e){return n.apply(Em(this),e),Aa(Jv.get(this))}:function(...e){return Aa(n.apply(Em(this),e))}}function z2(n){return typeof n=="function"?B2(n):(n instanceof IDBTransaction&&V2(n),k2(n,M2())?new Proxy(n,qm):n)}function Aa(n){if(n instanceof IDBRequest)return L2(n);if(Sm.has(n))return Sm.get(n);const e=z2(n);return e!==n&&(Sm.set(n,e),Ng.set(e,n)),e}const Em=n=>Ng.get(n);function F2(n,e,{blocked:s,upgrade:a,blocking:l,terminated:d}={}){const h=indexedDB.open(n,e),f=Aa(h);return a&&h.addEventListener("upgradeneeded",b=>{a(Aa(h.result),b.oldVersion,b.newVersion,Aa(h.transaction),b)}),s&&h.addEventListener("blocked",b=>s(b.oldVersion,b.newVersion,b)),f.then(b=>{d&&b.addEventListener("close",()=>d()),l&&b.addEventListener("versionchange",v=>l(v.oldVersion,v.newVersion,v))}).catch(()=>{}),f}const q2=["get","getKey","getAll","getAllKeys","count"],H2=["put","add","delete","clear"],jm=new Map;function Xx(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(jm.get(e))return jm.get(e);const s=e.replace(/FromIndex$/,""),a=e!==s,l=H2.includes(s);if(!(s in(a?IDBIndex:IDBObjectStore).prototype)||!(l||q2.includes(s)))return;const d=function(h,...f){return K(this,null,function*(){const b=this.transaction(h,l?"readwrite":"readonly");let v=b.store;return a&&(v=v.index(f.shift())),(yield Promise.all([v[s](...f),l&&b.done]))[0]})};return jm.set(e,d),d}U2(n=>oe(X({},n),{get:(e,s,a)=>Xx(e,s)||n.get(e,s,a),has:(e,s)=>!!Xx(e,s)||n.has(e,s)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G2{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(s=>{if($2(s)){const a=s.getImmediate();return`${a.library}/${a.version}`}else return null}).filter(s=>s).join(" ")}}function $2(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Hm="@firebase/app",Wx="0.14.3";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bi=new wg("@firebase/app"),Q2="@firebase/app-compat",K2="@firebase/analytics-compat",Y2="@firebase/analytics",X2="@firebase/app-check-compat",W2="@firebase/app-check",J2="@firebase/auth",Z2="@firebase/auth-compat",eE="@firebase/database",tE="@firebase/data-connect",sE="@firebase/database-compat",nE="@firebase/functions",rE="@firebase/functions-compat",iE="@firebase/installations",aE="@firebase/installations-compat",oE="@firebase/messaging",lE="@firebase/messaging-compat",cE="@firebase/performance",uE="@firebase/performance-compat",dE="@firebase/remote-config",hE="@firebase/remote-config-compat",fE="@firebase/storage",mE="@firebase/storage-compat",gE="@firebase/firestore",pE="@firebase/ai",yE="@firebase/firestore-compat",xE="firebase",bE="12.3.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gm="[DEFAULT]",vE={[Hm]:"fire-core",[Q2]:"fire-core-compat",[Y2]:"fire-analytics",[K2]:"fire-analytics-compat",[W2]:"fire-app-check",[X2]:"fire-app-check-compat",[J2]:"fire-auth",[Z2]:"fire-auth-compat",[eE]:"fire-rtdb",[tE]:"fire-data-connect",[sE]:"fire-rtdb-compat",[nE]:"fire-fn",[rE]:"fire-fn-compat",[iE]:"fire-iid",[aE]:"fire-iid-compat",[oE]:"fire-fcm",[lE]:"fire-fcm-compat",[cE]:"fire-perf",[uE]:"fire-perf-compat",[dE]:"fire-rc",[hE]:"fire-rc-compat",[fE]:"fire-gcs",[mE]:"fire-gcs-compat",[gE]:"fire-fst",[yE]:"fire-fst-compat",[pE]:"fire-vertex","fire-js":"fire-js",[xE]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ud=new Map,_E=new Map,$m=new Map;function Jx(n,e){try{n.container.addComponent(e)}catch(s){Bi.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,s)}}function xo(n){const e=n.name;if($m.has(e))return Bi.debug(`There were multiple attempts to register component ${e}.`),!1;$m.set(e,n);for(const s of Ud.values())Jx(s,n);for(const s of _E.values())Jx(s,n);return!0}function lh(n,e){const s=n.container.getProvider("heartbeat").getImmediate({optional:!0});return s&&s.triggerHeartbeat(),n.container.getProvider(e)}function jr(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wE={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ca=new nu("app","Firebase",wE);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NE{constructor(e,s,a){this._isDeleted=!1,this._options=X({},e),this._config=X({},s),this._name=s.name,this._automaticDataCollectionEnabled=s.automaticDataCollectionEnabled,this._container=a,this.container.addComponent(new Da("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ca.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const So=bE;function e_(n,e={}){let s=n;typeof e!="object"&&(e={name:e});const a=X({name:Gm,automaticDataCollectionEnabled:!0},e),l=a.name;if(typeof l!="string"||!l)throw Ca.create("bad-app-name",{appName:String(l)});if(s||(s=Yv()),!s)throw Ca.create("no-options");const d=Ud.get(l);if(d){if(yo(s,d.options)&&yo(a,d.config))return d;throw Ca.create("duplicate-app",{appName:l})}const h=new C2(l);for(const b of $m.values())h.addComponent(b);const f=new NE(s,a,h);return Ud.set(l,f),f}function Sg(n=Gm){const e=Ud.get(n);if(!e&&n===Gm&&Yv())return e_();if(!e)throw Ca.create("no-app",{appName:n});return e}function Xr(n,e,s){var h;let a=(h=vE[n])!=null?h:n;s&&(a+=`-${s}`);const l=a.match(/\s|\//),d=e.match(/\s|\//);if(l||d){const f=[`Unable to register library "${a}" with version "${e}":`];l&&f.push(`library name "${a}" contains illegal characters (whitespace or "/")`),l&&d&&f.push("and"),d&&f.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Bi.warn(f.join(" "));return}xo(new Da(`${a}-version`,()=>({library:a,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SE="firebase-heartbeat-database",EE=1,$c="firebase-heartbeat-store";let Tm=null;function t_(){return Tm||(Tm=F2(SE,EE,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore($c)}catch(s){console.warn(s)}}}}).catch(n=>{throw Ca.create("idb-open",{originalErrorMessage:n.message})})),Tm}function jE(n){return K(this,null,function*(){try{const s=(yield t_()).transaction($c),a=yield s.objectStore($c).get(s_(n));return yield s.done,a}catch(e){if(e instanceof ii)Bi.warn(e.message);else{const s=Ca.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Bi.warn(s.message)}}})}function Zx(n,e){return K(this,null,function*(){try{const a=(yield t_()).transaction($c,"readwrite");yield a.objectStore($c).put(e,s_(n)),yield a.done}catch(s){if(s instanceof ii)Bi.warn(s.message);else{const a=Ca.create("idb-set",{originalErrorMessage:s==null?void 0:s.message});Bi.warn(a.message)}}})}function s_(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TE=1024,AE=30;class CE{constructor(e){this.container=e,this._heartbeatsCache=null;const s=this.container.getProvider("app").getImmediate();this._storage=new RE(s),this._heartbeatsCachePromise=this._storage.read().then(a=>(this._heartbeatsCache=a,a))}triggerHeartbeat(){return K(this,null,function*(){var e,s;try{const l=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),d=eb();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((s=this._heartbeatsCache)==null?void 0:s.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===d||this._heartbeatsCache.heartbeats.some(h=>h.date===d))return;if(this._heartbeatsCache.heartbeats.push({date:d,agent:l}),this._heartbeatsCache.heartbeats.length>AE){const h=DE(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(h,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(a){Bi.warn(a)}})}getHeartbeatsHeader(){return K(this,null,function*(){var e;try{if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const s=eb(),{heartbeatsToSend:a,unsentEntries:l}=IE(this._heartbeatsCache.heartbeats),d=Vd(JSON.stringify({version:2,heartbeats:a}));return this._heartbeatsCache.lastSentHeartbeatDate=s,l.length>0?(this._heartbeatsCache.heartbeats=l,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),d}catch(s){return Bi.warn(s),""}})}}function eb(){return new Date().toISOString().substring(0,10)}function IE(n,e=TE){const s=[];let a=n.slice();for(const l of n){const d=s.find(h=>h.agent===l.agent);if(d){if(d.dates.push(l.date),tb(s)>e){d.dates.pop();break}}else if(s.push({agent:l.agent,dates:[l.date]}),tb(s)>e){s.pop();break}a=a.slice(1)}return{heartbeatsToSend:s,unsentEntries:a}}class RE{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return K(this,null,function*(){return y2()?x2().then(()=>!0).catch(()=>!1):!1})}read(){return K(this,null,function*(){if(yield this._canUseIndexedDBPromise){const s=yield jE(this.app);return s!=null&&s.heartbeats?s:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return K(this,null,function*(){var a;if(yield this._canUseIndexedDBPromise){const l=yield this.read();return Zx(this.app,{lastSentHeartbeatDate:(a=e.lastSentHeartbeatDate)!=null?a:l.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return K(this,null,function*(){var a;if(yield this._canUseIndexedDBPromise){const l=yield this.read();return Zx(this.app,{lastSentHeartbeatDate:(a=e.lastSentHeartbeatDate)!=null?a:l.lastSentHeartbeatDate,heartbeats:[...l.heartbeats,...e.heartbeats]})}else return})}}function tb(n){return Vd(JSON.stringify({version:2,heartbeats:n})).length}function DE(n){if(n.length===0)return-1;let e=0,s=n[0].date;for(let a=1;a<n.length;a++)n[a].date<s&&(s=n[a].date,e=a);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OE(n){xo(new Da("platform-logger",e=>new G2(e),"PRIVATE")),xo(new Da("heartbeat",e=>new CE(e),"PRIVATE")),Xr(Hm,Wx,n),Xr(Hm,Wx,"esm2020"),Xr("fire-js","")}OE("");var kE="firebase",ME="12.3.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Xr(kE,ME,"app");function n_(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const PE=n_,r_=new nu("auth","Firebase",n_());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bd=new wg("@firebase/auth");function LE(n,...e){Bd.logLevel<=St.WARN&&Bd.warn(`Auth (${So}): ${n}`,...e)}function Ad(n,...e){Bd.logLevel<=St.ERROR&&Bd.error(`Auth (${So}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zi(n,...e){throw Eg(n,...e)}function Wr(n,...e){return Eg(n,...e)}function i_(n,e,s){const a=oe(X({},PE()),{[e]:s});return new nu("auth","Firebase",a).create(e,{appName:n.name})}function go(n){return i_(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Eg(n,...e){if(typeof n!="string"){const s=e[0],a=[...e.slice(1)];return a[0]&&(a[0].appName=n.name),n._errorFactory.create(s,...a)}return r_.create(n,...e)}function ht(n,e,...s){if(!n)throw Eg(e,...s)}function ki(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Ad(e),new Error(e)}function Fi(n,e){n||ki(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qm(){var n;return typeof self!="undefined"&&((n=self.location)==null?void 0:n.href)||""}function VE(){return sb()==="http:"||sb()==="https:"}function sb(){var n;return typeof self!="undefined"&&((n=self.location)==null?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UE(){return typeof navigator!="undefined"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(VE()||f2()||"connection"in navigator)?navigator.onLine:!0}function BE(){if(typeof navigator=="undefined")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iu{constructor(e,s){this.shortDelay=e,this.longDelay=s,Fi(s>e,"Short delay should be less than long delay!"),this.isMobile=u2()||m2()}get(){return UE()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jg(n,e){Fi(n.emulator,"Emulator should always be set here");const{url:s}=n.emulator;return e?`${s}${e.startsWith("/")?e.slice(1):e}`:s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a_{static initialize(e,s,a){this.fetchImpl=e,s&&(this.headersImpl=s),a&&(this.responseImpl=a)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self!="undefined"&&"fetch"in self)return self.fetch;if(typeof globalThis!="undefined"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch!="undefined")return fetch;ki("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self!="undefined"&&"Headers"in self)return self.Headers;if(typeof globalThis!="undefined"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers!="undefined")return Headers;ki("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self!="undefined"&&"Response"in self)return self.Response;if(typeof globalThis!="undefined"&&globalThis.Response)return globalThis.Response;if(typeof Response!="undefined")return Response;ki("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zE={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FE=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],qE=new iu(3e4,6e4);function Tg(n,e){return n.tenantId&&!e.tenantId?oe(X({},e),{tenantId:n.tenantId}):e}function Cl(d,h,f,b){return K(this,arguments,function*(n,e,s,a,l={}){return o_(n,l,()=>K(null,null,function*(){let v={},E={};a&&(e==="GET"?E=a:v={body:JSON.stringify(a)});const D=ru(X({key:n.config.apiKey},E)).slice(1),_=yield n._getAdditionalHeaders();_["Content-Type"]="application/json",n.languageCode&&(_["X-Firebase-Locale"]=n.languageCode);const R=X({method:e,headers:_},v);return h2()||(R.referrerPolicy="no-referrer"),n.emulatorConfig&&No(n.emulatorConfig.host)&&(R.credentials="include"),a_.fetch()(yield l_(n,n.config.apiHost,s,D),R)}))})}function o_(n,e,s){return K(this,null,function*(){n._canInitEmulator=!1;const a=X(X({},zE),e);try{const l=new GE(n),d=yield Promise.race([s(),l.promise]);l.clearNetworkTimeout();const h=yield d.json();if("needConfirmation"in h)throw yd(n,"account-exists-with-different-credential",h);if(d.ok&&!("errorMessage"in h))return h;{const f=d.ok?h.errorMessage:h.error.message,[b,v]=f.split(" : ");if(b==="FEDERATED_USER_ID_ALREADY_LINKED")throw yd(n,"credential-already-in-use",h);if(b==="EMAIL_EXISTS")throw yd(n,"email-already-in-use",h);if(b==="USER_DISABLED")throw yd(n,"user-disabled",h);const E=a[b]||b.toLowerCase().replace(/[_\s]+/g,"-");if(v)throw i_(n,E,v);zi(n,E)}}catch(l){if(l instanceof ii)throw l;zi(n,"network-request-failed",{message:String(l)})}})}function HE(d,h,f,b){return K(this,arguments,function*(n,e,s,a,l={}){const v=yield Cl(n,e,s,a,l);return"mfaPendingCredential"in v&&zi(n,"multi-factor-auth-required",{_serverResponse:v}),v})}function l_(n,e,s,a){return K(this,null,function*(){const l=`${e}${s}?${a}`,d=n,h=d.config.emulator?jg(n.config,l):`${n.config.apiScheme}://${l}`;return FE.includes(s)&&(yield d._persistenceManagerAvailable,d._getPersistenceType()==="COOKIE")?d._getPersistence()._getFinalTarget(h).toString():h})}class GE{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((s,a)=>{this.timer=setTimeout(()=>a(Wr(this.auth,"network-request-failed")),qE.get())})}}function yd(n,e,s){const a={appName:n.name};s.email&&(a.email=s.email),s.phoneNumber&&(a.phoneNumber=s.phoneNumber);const l=Wr(n,e,a);return l.customData._tokenResponse=s,l}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $E(n,e){return K(this,null,function*(){return Cl(n,"POST","/v1/accounts:delete",e)})}function zd(n,e){return K(this,null,function*(){return Cl(n,"POST","/v1/accounts:lookup",e)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lc(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch(e){}}function QE(n,e=!1){return K(this,null,function*(){const s=Mn(n),a=yield s.getIdToken(e),l=Ag(a);ht(l&&l.exp&&l.auth_time&&l.iat,s.auth,"internal-error");const d=typeof l.firebase=="object"?l.firebase:void 0,h=d==null?void 0:d.sign_in_provider;return{claims:l,token:a,authTime:Lc(Am(l.auth_time)),issuedAtTime:Lc(Am(l.iat)),expirationTime:Lc(Am(l.exp)),signInProvider:h||null,signInSecondFactor:(d==null?void 0:d.sign_in_second_factor)||null}})}function Am(n){return Number(n)*1e3}function Ag(n){const[e,s,a]=n.split(".");if(e===void 0||s===void 0||a===void 0)return Ad("JWT malformed, contained fewer than 3 sections"),null;try{const l=$v(s);return l?JSON.parse(l):(Ad("Failed to decode base64 JWT payload"),null)}catch(l){return Ad("Caught error parsing JWT payload as JSON",l==null?void 0:l.toString()),null}}function nb(n){const e=Ag(n);return ht(e,"internal-error"),ht(typeof e.exp!="undefined","internal-error"),ht(typeof e.iat!="undefined","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qc(n,e,s=!1){return K(this,null,function*(){if(s)return e;try{return yield e}catch(a){throw a instanceof ii&&KE(a)&&n.auth.currentUser===n&&(yield n.auth.signOut()),a}})}function KE({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YE{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var s;if(e){const a=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),a}else{this.errorBackoff=3e4;const l=((s=this.user.stsTokenManager.expirationTime)!=null?s:0)-Date.now()-3e5;return Math.max(0,l)}}schedule(e=!1){if(!this.isRunning)return;const s=this.getInterval(e);this.timerId=setTimeout(()=>K(this,null,function*(){yield this.iteration()}),s)}iteration(){return K(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Km{constructor(e,s){this.createdAt=e,this.lastLoginAt=s,this._initializeTime()}_initializeTime(){this.lastSignInTime=Lc(this.lastLoginAt),this.creationTime=Lc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fd(n){return K(this,null,function*(){var D;const e=n.auth,s=yield n.getIdToken(),a=yield Qc(n,zd(e,{idToken:s}));ht(a==null?void 0:a.users.length,e,"internal-error");const l=a.users[0];n._notifyReloadListener(l);const d=(D=l.providerUserInfo)!=null&&D.length?c_(l.providerUserInfo):[],h=WE(n.providerData,d),f=n.isAnonymous,b=!(n.email&&l.passwordHash)&&!(h!=null&&h.length),v=f?b:!1,E={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:h,metadata:new Km(l.createdAt,l.lastLoginAt),isAnonymous:v};Object.assign(n,E)})}function XE(n){return K(this,null,function*(){const e=Mn(n);yield Fd(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function WE(n,e){return[...n.filter(a=>!e.some(l=>l.providerId===a.providerId)),...e]}function c_(n){return n.map(a=>{var l=a,{providerId:e}=l,s=md(l,["providerId"]);return{providerId:e,uid:s.rawId||"",displayName:s.displayName||null,email:s.email||null,phoneNumber:s.phoneNumber||null,photoURL:s.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JE(n,e){return K(this,null,function*(){const s=yield o_(n,{},()=>K(null,null,function*(){const a=ru({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:l,apiKey:d}=n.config,h=yield l_(n,l,"/v1/token",`key=${d}`),f=yield n._getAdditionalHeaders();f["Content-Type"]="application/x-www-form-urlencoded";const b={method:"POST",headers:f,body:a};return n.emulatorConfig&&No(n.emulatorConfig.host)&&(b.credentials="include"),a_.fetch()(h,b)}));return{accessToken:s.access_token,expiresIn:s.expires_in,refreshToken:s.refresh_token}})}function ZE(n,e){return K(this,null,function*(){return Cl(n,"POST","/v2/accounts:revokeToken",Tg(n,e))})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ht(e.idToken,"internal-error"),ht(typeof e.idToken!="undefined","internal-error"),ht(typeof e.refreshToken!="undefined","internal-error");const s="expiresIn"in e&&typeof e.expiresIn!="undefined"?Number(e.expiresIn):nb(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,s)}updateFromIdToken(e){ht(e.length!==0,"internal-error");const s=nb(e);this.updateTokensAndExpiration(e,null,s)}getToken(e,s=!1){return K(this,null,function*(){return!s&&this.accessToken&&!this.isExpired?this.accessToken:(ht(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null)})}clearRefreshToken(){this.refreshToken=null}refresh(e,s){return K(this,null,function*(){const{accessToken:a,refreshToken:l,expiresIn:d}=yield JE(e,s);this.updateTokensAndExpiration(a,l,Number(d))})}updateTokensAndExpiration(e,s,a){this.refreshToken=s||null,this.accessToken=e||null,this.expirationTime=Date.now()+a*1e3}static fromJSON(e,s){const{refreshToken:a,accessToken:l,expirationTime:d}=s,h=new gl;return a&&(ht(typeof a=="string","internal-error",{appName:e}),h.refreshToken=a),l&&(ht(typeof l=="string","internal-error",{appName:e}),h.accessToken=l),d&&(ht(typeof d=="number","internal-error",{appName:e}),h.expirationTime=d),h}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new gl,this.toJSON())}_performRefresh(){return ki("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function va(n,e){ht(typeof n=="string"||typeof n=="undefined","internal-error",{appName:e})}class Tr{constructor(d){var h=d,{uid:e,auth:s,stsTokenManager:a}=h,l=md(h,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new YE(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=s,this.stsTokenManager=a,this.accessToken=a.accessToken,this.displayName=l.displayName||null,this.email=l.email||null,this.emailVerified=l.emailVerified||!1,this.phoneNumber=l.phoneNumber||null,this.photoURL=l.photoURL||null,this.isAnonymous=l.isAnonymous||!1,this.tenantId=l.tenantId||null,this.providerData=l.providerData?[...l.providerData]:[],this.metadata=new Km(l.createdAt||void 0,l.lastLoginAt||void 0)}getIdToken(e){return K(this,null,function*(){const s=yield Qc(this,this.stsTokenManager.getToken(this.auth,e));return ht(s,this.auth,"internal-error"),this.accessToken!==s&&(this.accessToken=s,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),s})}getIdTokenResult(e){return QE(this,e)}reload(){return XE(this)}_assign(e){this!==e&&(ht(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(s=>X({},s)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const s=new Tr(oe(X({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return s.metadata._copy(this.metadata),s}_onReload(e){ht(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,s=!1){return K(this,null,function*(){let a=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),a=!0),s&&(yield Fd(this)),yield this.auth._persistUserIfCurrent(this),a&&this.auth._notifyListenersIfCurrent(this)})}delete(){return K(this,null,function*(){if(jr(this.auth.app))return Promise.reject(go(this.auth));const e=yield this.getIdToken();return yield Qc(this,$E(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return oe(X({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>X({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,s){var Be,xe,_e,Ne,De,G,V,L;const a=(Be=s.displayName)!=null?Be:void 0,l=(xe=s.email)!=null?xe:void 0,d=(_e=s.phoneNumber)!=null?_e:void 0,h=(Ne=s.photoURL)!=null?Ne:void 0,f=(De=s.tenantId)!=null?De:void 0,b=(G=s._redirectEventId)!=null?G:void 0,v=(V=s.createdAt)!=null?V:void 0,E=(L=s.lastLoginAt)!=null?L:void 0,{uid:D,emailVerified:_,isAnonymous:R,providerData:U,stsTokenManager:ie}=s;ht(D&&ie,e,"internal-error");const he=gl.fromJSON(this.name,ie);ht(typeof D=="string",e,"internal-error"),va(a,e.name),va(l,e.name),ht(typeof _=="boolean",e,"internal-error"),ht(typeof R=="boolean",e,"internal-error"),va(d,e.name),va(h,e.name),va(f,e.name),va(b,e.name),va(v,e.name),va(E,e.name);const Se=new Tr({uid:D,auth:e,email:l,emailVerified:_,displayName:a,isAnonymous:R,photoURL:h,phoneNumber:d,tenantId:f,stsTokenManager:he,createdAt:v,lastLoginAt:E});return U&&Array.isArray(U)&&(Se.providerData=U.map(z=>X({},z))),b&&(Se._redirectEventId=b),Se}static _fromIdTokenResponse(e,s,a=!1){return K(this,null,function*(){const l=new gl;l.updateFromServerResponse(s);const d=new Tr({uid:s.localId,auth:e,stsTokenManager:l,isAnonymous:a});return yield Fd(d),d})}static _fromGetAccountInfoResponse(e,s,a){return K(this,null,function*(){const l=s.users[0];ht(l.localId!==void 0,"internal-error");const d=l.providerUserInfo!==void 0?c_(l.providerUserInfo):[],h=!(l.email&&l.passwordHash)&&!(d!=null&&d.length),f=new gl;f.updateFromIdToken(a);const b=new Tr({uid:l.localId,auth:e,stsTokenManager:f,isAnonymous:h}),v={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:d,metadata:new Km(l.createdAt,l.lastLoginAt),isAnonymous:!(l.email&&l.passwordHash)&&!(d!=null&&d.length)};return Object.assign(b,v),b})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rb=new Map;function Mi(n){Fi(n instanceof Function,"Expected a class definition");let e=rb.get(n);return e?(Fi(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,rb.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u_{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return K(this,null,function*(){return!0})}_set(e,s){return K(this,null,function*(){this.storage[e]=s})}_get(e){return K(this,null,function*(){const s=this.storage[e];return s===void 0?null:s})}_remove(e){return K(this,null,function*(){delete this.storage[e]})}_addListener(e,s){}_removeListener(e,s){}}u_.type="NONE";const ib=u_;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cd(n,e,s){return`firebase:${n}:${e}:${s}`}class pl{constructor(e,s,a){this.persistence=e,this.auth=s,this.userKey=a;const{config:l,name:d}=this.auth;this.fullUserKey=Cd(this.userKey,l.apiKey,d),this.fullPersistenceKey=Cd("persistence",l.apiKey,d),this.boundEventHandler=s._onStorageEvent.bind(s),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return K(this,null,function*(){const e=yield this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const s=yield zd(this.auth,{idToken:e}).catch(()=>{});return s?Tr._fromGetAccountInfoResponse(this.auth,s,e):null}return Tr._fromJSON(this.auth,e)})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return K(this,null,function*(){if(this.persistence===e)return;const s=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,s)return this.setCurrentUser(s)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,s,a="authUser"){return K(this,null,function*(){if(!s.length)return new pl(Mi(ib),e,a);const l=(yield Promise.all(s.map(v=>K(null,null,function*(){if(yield v._isAvailable())return v})))).filter(v=>v);let d=l[0]||Mi(ib);const h=Cd(a,e.config.apiKey,e.name);let f=null;for(const v of s)try{const E=yield v._get(h);if(E){let D;if(typeof E=="string"){const _=yield zd(e,{idToken:E}).catch(()=>{});if(!_)break;D=yield Tr._fromGetAccountInfoResponse(e,_,E)}else D=Tr._fromJSON(e,E);v!==d&&(f=D),d=v;break}}catch(E){}const b=l.filter(v=>v._shouldAllowMigration);return!d._shouldAllowMigration||!b.length?new pl(d,e,a):(d=b[0],f&&(yield d._set(h,f.toJSON())),yield Promise.all(s.map(v=>K(null,null,function*(){if(v!==d)try{yield v._remove(h)}catch(E){}}))),new pl(d,e,a))})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ab(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(m_(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(d_(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(p_(e))return"Blackberry";if(y_(e))return"Webos";if(h_(e))return"Safari";if((e.includes("chrome/")||f_(e))&&!e.includes("edge/"))return"Chrome";if(g_(e))return"Android";{const s=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,a=n.match(s);if((a==null?void 0:a.length)===2)return a[1]}return"Other"}function d_(n=$s()){return/firefox\//i.test(n)}function h_(n=$s()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function f_(n=$s()){return/crios\//i.test(n)}function m_(n=$s()){return/iemobile/i.test(n)}function g_(n=$s()){return/android/i.test(n)}function p_(n=$s()){return/blackberry/i.test(n)}function y_(n=$s()){return/webos/i.test(n)}function Cg(n=$s()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function ej(n=$s()){var e;return Cg(n)&&!!((e=window.navigator)!=null&&e.standalone)}function tj(){return g2()&&document.documentMode===10}function x_(n=$s()){return Cg(n)||g_(n)||y_(n)||p_(n)||/windows phone/i.test(n)||m_(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b_(n,e=[]){let s;switch(n){case"Browser":s=ab($s());break;case"Worker":s=`${ab($s())}-${n}`;break;default:s=n}const a=e.length?e.join(","):"FirebaseCore-web";return`${s}/JsCore/${So}/${a}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sj{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,s){const a=d=>new Promise((h,f)=>{try{const b=e(d);h(b)}catch(b){f(b)}});a.onAbort=s,this.queue.push(a);const l=this.queue.length-1;return()=>{this.queue[l]=()=>Promise.resolve()}}runMiddleware(e){return K(this,null,function*(){if(this.auth.currentUser===e)return;const s=[];try{for(const a of this.queue)yield a(e),a.onAbort&&s.push(a.onAbort)}catch(a){s.reverse();for(const l of s)try{l()}catch(d){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:a==null?void 0:a.message})}})}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nj(s){return K(this,arguments,function*(n,e={}){return Cl(n,"GET","/v2/passwordPolicy",Tg(n,e))})}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rj=6;class ij{constructor(e){var a,l,d,h;const s=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(a=s.minPasswordLength)!=null?a:rj,s.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=s.maxPasswordLength),s.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=s.containsLowercaseCharacter),s.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=s.containsUppercaseCharacter),s.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=s.containsNumericCharacter),s.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=s.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(d=(l=e.allowedNonAlphanumericCharacters)==null?void 0:l.join(""))!=null?d:"",this.forceUpgradeOnSignin=(h=e.forceUpgradeOnSignin)!=null?h:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var a,l,d,h,f,b;const s={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,s),this.validatePasswordCharacterOptions(e,s),s.isValid&&(s.isValid=(a=s.meetsMinPasswordLength)!=null?a:!0),s.isValid&&(s.isValid=(l=s.meetsMaxPasswordLength)!=null?l:!0),s.isValid&&(s.isValid=(d=s.containsLowercaseLetter)!=null?d:!0),s.isValid&&(s.isValid=(h=s.containsUppercaseLetter)!=null?h:!0),s.isValid&&(s.isValid=(f=s.containsNumericCharacter)!=null?f:!0),s.isValid&&(s.isValid=(b=s.containsNonAlphanumericCharacter)!=null?b:!0),s}validatePasswordLengthOptions(e,s){const a=this.customStrengthOptions.minPasswordLength,l=this.customStrengthOptions.maxPasswordLength;a&&(s.meetsMinPasswordLength=e.length>=a),l&&(s.meetsMaxPasswordLength=e.length<=l)}validatePasswordCharacterOptions(e,s){this.updatePasswordCharacterOptionsStatuses(s,!1,!1,!1,!1);let a;for(let l=0;l<e.length;l++)a=e.charAt(l),this.updatePasswordCharacterOptionsStatuses(s,a>="a"&&a<="z",a>="A"&&a<="Z",a>="0"&&a<="9",this.allowedNonAlphanumericCharacters.includes(a))}updatePasswordCharacterOptionsStatuses(e,s,a,l,d){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=s)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=a)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=l)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=d))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aj{constructor(e,s,a,l){this.app=e,this.heartbeatServiceProvider=s,this.appCheckServiceProvider=a,this.config=l,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ob(this),this.idTokenSubscription=new ob(this),this.beforeStateQueue=new sj(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=r_,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=l.sdkClientVersion,this._persistenceManagerAvailable=new Promise(d=>this._resolvePersistenceManagerAvailable=d)}_initializeWithPersistence(e,s){return s&&(this._popupRedirectResolver=Mi(s)),this._initializationPromise=this.queue(()=>K(this,null,function*(){var a,l,d;if(!this._deleted&&(this.persistenceManager=yield pl.create(this,e),(a=this._resolvePersistenceManagerAvailable)==null||a.call(this),!this._deleted)){if((l=this._popupRedirectResolver)!=null&&l._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch(h){}yield this.initializeCurrentUser(s),this.lastNotifiedUid=((d=this.currentUser)==null?void 0:d.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return K(this,null,function*(){if(this._deleted)return;const e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUserFromIdToken(e){return K(this,null,function*(){try{const s=yield zd(this,{idToken:e}),a=yield Tr._fromGetAccountInfoResponse(this,s,e);yield this.directlySetCurrentUser(a)}catch(s){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",s),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return K(this,null,function*(){var d;if(jr(this.app)){const h=this.app.settings.authIdToken;return h?new Promise(f=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(h).then(f,f))}):this.directlySetCurrentUser(null)}const s=yield this.assertedPersistence.getCurrentUser();let a=s,l=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();const h=(d=this.redirectUser)==null?void 0:d._redirectEventId,f=a==null?void 0:a._redirectEventId,b=yield this.tryRedirectSignIn(e);(!h||h===f)&&(b!=null&&b.user)&&(a=b.user,l=!0)}if(!a)return this.directlySetCurrentUser(null);if(!a._redirectEventId){if(l)try{yield this.beforeStateQueue.runMiddleware(a)}catch(h){a=s,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(h))}return a?this.reloadAndSetCurrentUserOrClear(a):this.directlySetCurrentUser(null)}return ht(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===a._redirectEventId?this.directlySetCurrentUser(a):this.reloadAndSetCurrentUserOrClear(a)})}tryRedirectSignIn(e){return K(this,null,function*(){let s=null;try{s=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(a){yield this._setRedirectUser(null)}return s})}reloadAndSetCurrentUserOrClear(e){return K(this,null,function*(){try{yield Fd(e)}catch(s){if((s==null?void 0:s.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=BE()}_delete(){return K(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return K(this,null,function*(){if(jr(this.app))return Promise.reject(go(this));const s=e?Mn(e):null;return s&&ht(s.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(s&&s._clone(this))})}_updateCurrentUser(e,s=!1){return K(this,null,function*(){if(!this._deleted)return e&&ht(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),s||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>K(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return K(this,null,function*(){return jr(this.app)?Promise.reject(go(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return jr(this.app)?Promise.reject(go(this)):this.queue(()=>K(this,null,function*(){yield this.assertedPersistence.setPersistence(Mi(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return K(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());const s=this._getPasswordPolicyInternal();return s.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):s.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return K(this,null,function*(){const e=yield nj(this),s=new ij(e);this.tenantId===null?this._projectPasswordPolicy=s:this._tenantPasswordPolicies[this.tenantId]=s})}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new nu("auth","Firebase",e())}onAuthStateChanged(e,s,a){return this.registerStateListener(this.authStateSubscription,e,s,a)}beforeAuthStateChanged(e,s){return this.beforeStateQueue.pushCallback(e,s)}onIdTokenChanged(e,s,a){return this.registerStateListener(this.idTokenSubscription,e,s,a)}authStateReady(){return new Promise((e,s)=>{if(this.currentUser)e();else{const a=this.onAuthStateChanged(()=>{a(),e()},s)}})}revokeAccessToken(e){return K(this,null,function*(){if(this.currentUser){const s=yield this.currentUser.getIdToken(),a={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:s};this.tenantId!=null&&(a.tenantId=this.tenantId),yield ZE(this,a)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}_setRedirectUser(e,s){return K(this,null,function*(){const a=yield this.getOrInitRedirectPersistenceManager(s);return e===null?a.removeCurrentUser():a.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return K(this,null,function*(){if(!this.redirectPersistenceManager){const s=e&&Mi(e)||this._popupRedirectResolver;ht(s,this,"argument-error"),this.redirectPersistenceManager=yield pl.create(this,[Mi(s._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return K(this,null,function*(){var s,a;return this._isInitialized&&(yield this.queue(()=>K(this,null,function*(){}))),((s=this._currentUser)==null?void 0:s._redirectEventId)===e?this._currentUser:((a=this.redirectUser)==null?void 0:a._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return K(this,null,function*(){if(e===this.currentUser)return this.queue(()=>K(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var s,a;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=(a=(s=this.currentUser)==null?void 0:s.uid)!=null?a:null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,s,a,l){if(this._deleted)return()=>{};const d=typeof s=="function"?s:s.next.bind(s);let h=!1;const f=this._isInitialized?Promise.resolve():this._initializationPromise;if(ht(f,this,"internal-error"),f.then(()=>{h||d(this.currentUser)}),typeof s=="function"){const b=e.addObserver(s,a,l);return()=>{h=!0,b()}}else{const b=e.addObserver(s);return()=>{h=!0,b()}}}directlySetCurrentUser(e){return K(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ht(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=b_(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return K(this,null,function*(){var l;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const s=yield(l=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:l.getHeartbeatsHeader();s&&(e["X-Firebase-Client"]=s);const a=yield this._getAppCheckToken();return a&&(e["X-Firebase-AppCheck"]=a),e})}_getAppCheckToken(){return K(this,null,function*(){var s;if(jr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=yield(s=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getToken();return e!=null&&e.error&&LE(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token})}}function Ig(n){return Mn(n)}class ob{constructor(e){this.auth=e,this.observer=null,this.addObserver=N2(s=>this.observer=s)}get next(){return ht(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Rg={loadJS(){return K(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function oj(n){Rg=n}function lj(n){return Rg.loadJS(n)}function cj(){return Rg.gapiScript}function uj(n){return`__${n}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dj(n,e){const s=lh(n,"auth");if(s.isInitialized()){const l=s.getImmediate(),d=s.getOptions();if(yo(d,e!=null?e:{}))return l;zi(l,"already-initialized")}return s.initialize({options:e})}function hj(n,e){const s=(e==null?void 0:e.persistence)||[],a=(Array.isArray(s)?s:[s]).map(Mi);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(a,e==null?void 0:e.popupRedirectResolver)}function fj(n,e,s){const a=Ig(n);ht(/^https?:\/\//.test(e),a,"invalid-emulator-scheme");const l=!1,d=v_(e),{host:h,port:f}=mj(e),b=f===null?"":`:${f}`,v={url:`${d}//${h}${b}/`},E=Object.freeze({host:h,port:f,protocol:d.replace(":",""),options:Object.freeze({disableWarnings:l})});if(!a._canInitEmulator){ht(a.config.emulator&&a.emulatorConfig,a,"emulator-config-failed"),ht(yo(v,a.config.emulator)&&yo(E,a.emulatorConfig),a,"emulator-config-failed");return}a.config.emulator=v,a.emulatorConfig=E,a.settings.appVerificationDisabledForTesting=!0,No(h)?(vg(`${d}//${h}${b}`),_g("Auth",!0)):gj()}function v_(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function mj(n){const e=v_(n),s=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!s)return{host:"",port:null};const a=s[2].split("@").pop()||"",l=/^(\[[^\]]+\])(:|$)/.exec(a);if(l){const d=l[1];return{host:d,port:lb(a.substr(d.length+1))}}else{const[d,h]=a.split(":");return{host:d,port:lb(h)}}}function lb(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function gj(){function n(){const e=document.createElement("p"),s=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",s.position="fixed",s.width="100%",s.backgroundColor="#ffffff",s.border=".1em solid #000000",s.color="#b50000",s.bottom="0px",s.left="0px",s.margin="0px",s.zIndex="10000",s.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console!="undefined"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window!="undefined"&&typeof document!="undefined"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __{constructor(e,s){this.providerId=e,this.signInMethod=s}toJSON(){return ki("not implemented")}_getIdTokenResponse(e){return ki("not implemented")}_linkToIdToken(e,s){return ki("not implemented")}_getReauthenticationResolver(e){return ki("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yl(n,e){return K(this,null,function*(){return HE(n,"POST","/v1/accounts:signInWithIdp",Tg(n,e))})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pj="http://localhost";class bo extends __{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const s=new bo(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(s.idToken=e.idToken),e.accessToken&&(s.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(s.nonce=e.nonce),e.pendingToken&&(s.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(s.accessToken=e.oauthToken,s.secret=e.oauthTokenSecret):zi("argument-error"),s}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const f=typeof e=="string"?JSON.parse(e):e,{providerId:a,signInMethod:l}=f,d=md(f,["providerId","signInMethod"]);if(!a||!l)return null;const h=new bo(a,l);return h.idToken=d.idToken||void 0,h.accessToken=d.accessToken||void 0,h.secret=d.secret,h.nonce=d.nonce,h.pendingToken=d.pendingToken||null,h}_getIdTokenResponse(e){const s=this.buildRequest();return yl(e,s)}_linkToIdToken(e,s){const a=this.buildRequest();return a.idToken=s,yl(e,a)}_getReauthenticationResolver(e){const s=this.buildRequest();return s.autoCreate=!1,yl(e,s)}buildRequest(){const e={requestUri:pj,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const s={};this.idToken&&(s.id_token=this.idToken),this.accessToken&&(s.access_token=this.accessToken),this.secret&&(s.oauth_token_secret=this.secret),s.providerId=this.providerId,this.nonce&&!this.pendingToken&&(s.nonce=this.nonce),e.postBody=ru(s)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w_{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class au extends w_{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wa extends au{constructor(){super("facebook.com")}static credential(e){return bo._fromParams({providerId:wa.PROVIDER_ID,signInMethod:wa.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return wa.credentialFromTaggedObject(e)}static credentialFromError(e){return wa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return wa.credential(e.oauthAccessToken)}catch(s){return null}}}wa.FACEBOOK_SIGN_IN_METHOD="facebook.com";wa.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Na extends au{constructor(){super("google.com"),this.addScope("profile")}static credential(e,s){return bo._fromParams({providerId:Na.PROVIDER_ID,signInMethod:Na.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:s})}static credentialFromResult(e){return Na.credentialFromTaggedObject(e)}static credentialFromError(e){return Na.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:s,oauthAccessToken:a}=e;if(!s&&!a)return null;try{return Na.credential(s,a)}catch(l){return null}}}Na.GOOGLE_SIGN_IN_METHOD="google.com";Na.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sa extends au{constructor(){super("github.com")}static credential(e){return bo._fromParams({providerId:Sa.PROVIDER_ID,signInMethod:Sa.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Sa.credentialFromTaggedObject(e)}static credentialFromError(e){return Sa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Sa.credential(e.oauthAccessToken)}catch(s){return null}}}Sa.GITHUB_SIGN_IN_METHOD="github.com";Sa.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ea extends au{constructor(){super("twitter.com")}static credential(e,s){return bo._fromParams({providerId:Ea.PROVIDER_ID,signInMethod:Ea.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:s})}static credentialFromResult(e){return Ea.credentialFromTaggedObject(e)}static credentialFromError(e){return Ea.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:s,oauthTokenSecret:a}=e;if(!s||!a)return null;try{return Ea.credential(s,a)}catch(l){return null}}}Ea.TWITTER_SIGN_IN_METHOD="twitter.com";Ea.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wl{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,s,a,l=!1){return K(this,null,function*(){const d=yield Tr._fromIdTokenResponse(e,a,l),h=cb(a);return new wl({user:d,providerId:h,_tokenResponse:a,operationType:s})})}static _forOperation(e,s,a){return K(this,null,function*(){yield e._updateTokensIfNecessary(a,!0);const l=cb(a);return new wl({user:e,providerId:l,_tokenResponse:a,operationType:s})})}}function cb(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qd extends ii{constructor(e,s,a,l){var d;super(s.code,s.message),this.operationType=a,this.user=l,Object.setPrototypeOf(this,qd.prototype),this.customData={appName:e.name,tenantId:(d=e.tenantId)!=null?d:void 0,_serverResponse:s.customData._serverResponse,operationType:a}}static _fromErrorAndOperation(e,s,a,l){return new qd(e,s,a,l)}}function N_(n,e,s,a){return(e==="reauthenticate"?s._getReauthenticationResolver(n):s._getIdTokenResponse(n)).catch(d=>{throw d.code==="auth/multi-factor-auth-required"?qd._fromErrorAndOperation(n,d,e,a):d})}function yj(n,e,s=!1){return K(this,null,function*(){const a=yield Qc(n,e._linkToIdToken(n.auth,yield n.getIdToken()),s);return wl._forOperation(n,"link",a)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xj(n,e,s=!1){return K(this,null,function*(){const{auth:a}=n;if(jr(a.app))return Promise.reject(go(a));const l="reauthenticate";try{const d=yield Qc(n,N_(a,l,e,n),s);ht(d.idToken,a,"internal-error");const h=Ag(d.idToken);ht(h,a,"internal-error");const{sub:f}=h;return ht(n.uid===f,a,"user-mismatch"),wl._forOperation(n,l,d)}catch(d){throw(d==null?void 0:d.code)==="auth/user-not-found"&&zi(a,"user-mismatch"),d}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bj(n,e,s=!1){return K(this,null,function*(){if(jr(n.app))return Promise.reject(go(n));const a="signIn",l=yield N_(n,a,e),d=yield wl._fromIdTokenResponse(n,a,l);return s||(yield n._updateCurrentUser(d.user)),d})}function vj(n,e,s,a){return Mn(n).onIdTokenChanged(e,s,a)}function _j(n,e,s){return Mn(n).beforeAuthStateChanged(e,s)}const Hd="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S_{constructor(e,s){this.storageRetriever=e,this.type=s}_isAvailable(){try{return this.storage?(this.storage.setItem(Hd,"1"),this.storage.removeItem(Hd),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,s){return this.storage.setItem(e,JSON.stringify(s)),Promise.resolve()}_get(e){const s=this.storage.getItem(e);return Promise.resolve(s?JSON.parse(s):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wj=1e3,Nj=10;class xl extends S_{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,s)=>this.onStorageEvent(e,s),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=x_(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const s of Object.keys(this.listeners)){const a=this.storage.getItem(s),l=this.localCache[s];a!==l&&e(s,l,a)}}onStorageEvent(e,s=!1){if(!e.key){this.forAllChangedKeys((h,f,b)=>{this.notifyListeners(h,b)});return}const a=e.key;s?this.detachListener():this.stopPolling();const l=()=>{const h=this.storage.getItem(a);!s&&this.localCache[a]===h||this.notifyListeners(a,h)},d=this.storage.getItem(a);tj()&&d!==e.newValue&&e.newValue!==e.oldValue?setTimeout(l,Nj):l()}notifyListeners(e,s){this.localCache[e]=s;const a=this.listeners[e];if(a)for(const l of Array.from(a))l(s&&JSON.parse(s))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,s,a)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:s,newValue:a}),!0)})},wj)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,s){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(s)}_removeListener(e,s){this.listeners[e]&&(this.listeners[e].delete(s),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}_set(e,s){return K(this,null,function*(){yield co(xl.prototype,this,"_set").call(this,e,s),this.localCache[e]=JSON.stringify(s)})}_get(e){return K(this,null,function*(){const s=yield co(xl.prototype,this,"_get").call(this,e);return this.localCache[e]=JSON.stringify(s),s})}_remove(e){return K(this,null,function*(){yield co(xl.prototype,this,"_remove").call(this,e),delete this.localCache[e]})}}xl.type="LOCAL";const Sj=xl;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E_ extends S_{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,s){}_removeListener(e,s){}}E_.type="SESSION";const j_=E_;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ej(n){return Promise.all(n.map(e=>K(null,null,function*(){try{return{fulfilled:!0,value:yield e}}catch(s){return{fulfilled:!1,reason:s}}})))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ch{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const s=this.receivers.find(l=>l.isListeningto(e));if(s)return s;const a=new ch(e);return this.receivers.push(a),a}isListeningto(e){return this.eventTarget===e}handleEvent(e){return K(this,null,function*(){const s=e,{eventId:a,eventType:l,data:d}=s.data,h=this.handlersMap[l];if(!(h!=null&&h.size))return;s.ports[0].postMessage({status:"ack",eventId:a,eventType:l});const f=Array.from(h).map(v=>K(this,null,function*(){return v(s.origin,d)})),b=yield Ej(f);s.ports[0].postMessage({status:"done",eventId:a,eventType:l,response:b})})}_subscribe(e,s){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(s)}_unsubscribe(e,s){this.handlersMap[e]&&s&&this.handlersMap[e].delete(s),(!s||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}ch.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dg(n="",e=10){let s="";for(let a=0;a<e;a++)s+=Math.floor(Math.random()*10);return n+s}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jj{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,s,a=50){return K(this,null,function*(){const l=typeof MessageChannel!="undefined"?new MessageChannel:null;if(!l)throw new Error("connection_unavailable");let d,h;return new Promise((f,b)=>{const v=Dg("",20);l.port1.start();const E=setTimeout(()=>{b(new Error("unsupported_event"))},a);h={messageChannel:l,onMessage(D){const _=D;if(_.data.eventId===v)switch(_.data.status){case"ack":clearTimeout(E),d=setTimeout(()=>{b(new Error("timeout"))},3e3);break;case"done":clearTimeout(d),f(_.data.response);break;default:clearTimeout(E),clearTimeout(d),b(new Error("invalid_response"));break}}},this.handlers.add(h),l.port1.addEventListener("message",h.onMessage),this.target.postMessage({eventType:e,eventId:v,data:s},[l.port2])}).finally(()=>{h&&this.removeMessageHandler(h)})})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jr(){return window}function Tj(n){Jr().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T_(){return typeof Jr().WorkerGlobalScope!="undefined"&&typeof Jr().importScripts=="function"}function Aj(){return K(this,null,function*(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(yield navigator.serviceWorker.ready).active}catch(n){return null}})}function Cj(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)==null?void 0:n.controller)||null}function Ij(){return T_()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A_="firebaseLocalStorageDb",Rj=1,Gd="firebaseLocalStorage",C_="fbase_key";class ou{constructor(e){this.request=e}toPromise(){return new Promise((e,s)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{s(this.request.error)})})}}function uh(n,e){return n.transaction([Gd],e?"readwrite":"readonly").objectStore(Gd)}function Dj(){const n=indexedDB.deleteDatabase(A_);return new ou(n).toPromise()}function Ym(){const n=indexedDB.open(A_,Rj);return new Promise((e,s)=>{n.addEventListener("error",()=>{s(n.error)}),n.addEventListener("upgradeneeded",()=>{const a=n.result;try{a.createObjectStore(Gd,{keyPath:C_})}catch(l){s(l)}}),n.addEventListener("success",()=>K(null,null,function*(){const a=n.result;a.objectStoreNames.contains(Gd)?e(a):(a.close(),yield Dj(),e(yield Ym()))}))})}function ub(n,e,s){return K(this,null,function*(){const a=uh(n,!0).put({[C_]:e,value:s});return new ou(a).toPromise()})}function Oj(n,e){return K(this,null,function*(){const s=uh(n,!1).get(e),a=yield new ou(s).toPromise();return a===void 0?null:a.value})}function db(n,e){const s=uh(n,!0).delete(e);return new ou(s).toPromise()}const kj=800,Mj=3;class I_{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){return K(this,null,function*(){return this.db?this.db:(this.db=yield Ym(),this.db)})}_withRetries(e){return K(this,null,function*(){let s=0;for(;;)try{const a=yield this._openDb();return yield e(a)}catch(a){if(s++>Mj)throw a;this.db&&(this.db.close(),this.db=void 0)}})}initializeServiceWorkerMessaging(){return K(this,null,function*(){return T_()?this.initializeReceiver():this.initializeSender()})}initializeReceiver(){return K(this,null,function*(){this.receiver=ch._getInstance(Ij()),this.receiver._subscribe("keyChanged",(e,s)=>K(this,null,function*(){return{keyProcessed:(yield this._poll()).includes(s.key)}})),this.receiver._subscribe("ping",(e,s)=>K(this,null,function*(){return["keyChanged"]}))})}initializeSender(){return K(this,null,function*(){var s,a;if(this.activeServiceWorker=yield Aj(),!this.activeServiceWorker)return;this.sender=new jj(this.activeServiceWorker);const e=yield this.sender._send("ping",{},800);e&&(s=e[0])!=null&&s.fulfilled&&(a=e[0])!=null&&a.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)})}notifyServiceWorker(e){return K(this,null,function*(){if(!(!this.sender||!this.activeServiceWorker||Cj()!==this.activeServiceWorker))try{yield this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(s){}})}_isAvailable(){return K(this,null,function*(){try{if(!indexedDB)return!1;const e=yield Ym();return yield ub(e,Hd,"1"),yield db(e,Hd),!0}catch(e){}return!1})}_withPendingWrite(e){return K(this,null,function*(){this.pendingWrites++;try{yield e()}finally{this.pendingWrites--}})}_set(e,s){return K(this,null,function*(){return this._withPendingWrite(()=>K(this,null,function*(){return yield this._withRetries(a=>ub(a,e,s)),this.localCache[e]=s,this.notifyServiceWorker(e)}))})}_get(e){return K(this,null,function*(){const s=yield this._withRetries(a=>Oj(a,e));return this.localCache[e]=s,s})}_remove(e){return K(this,null,function*(){return this._withPendingWrite(()=>K(this,null,function*(){return yield this._withRetries(s=>db(s,e)),delete this.localCache[e],this.notifyServiceWorker(e)}))})}_poll(){return K(this,null,function*(){const e=yield this._withRetries(l=>{const d=uh(l,!1).getAll();return new ou(d).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const s=[],a=new Set;if(e.length!==0)for(const{fbase_key:l,value:d}of e)a.add(l),JSON.stringify(this.localCache[l])!==JSON.stringify(d)&&(this.notifyListeners(l,d),s.push(l));for(const l of Object.keys(this.localCache))this.localCache[l]&&!a.has(l)&&(this.notifyListeners(l,null),s.push(l));return s})}notifyListeners(e,s){this.localCache[e]=s;const a=this.listeners[e];if(a)for(const l of Array.from(a))l(s)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>K(this,null,function*(){return this._poll()}),kj)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,s){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(s)}_removeListener(e,s){this.listeners[e]&&(this.listeners[e].delete(s),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}I_.type="LOCAL";const Pj=I_;new iu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lj(n,e){return e?Mi(e):(ht(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Og extends __{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return yl(e,this._buildIdpRequest())}_linkToIdToken(e,s){return yl(e,this._buildIdpRequest(s))}_getReauthenticationResolver(e){return yl(e,this._buildIdpRequest())}_buildIdpRequest(e){const s={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(s.idToken=e),s}}function Vj(n){return bj(n.auth,new Og(n),n.bypassAuthState)}function Uj(n){const{auth:e,user:s}=n;return ht(s,e,"internal-error"),xj(s,new Og(n),n.bypassAuthState)}function Bj(n){return K(this,null,function*(){const{auth:e,user:s}=n;return ht(s,e,"internal-error"),yj(s,new Og(n),n.bypassAuthState)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R_{constructor(e,s,a,l,d=!1){this.auth=e,this.resolver=a,this.user=l,this.bypassAuthState=d,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(s)?s:[s]}execute(){return new Promise((e,s)=>K(this,null,function*(){this.pendingPromise={resolve:e,reject:s};try{this.eventManager=yield this.resolver._initialize(this.auth),yield this.onExecution(),this.eventManager.registerConsumer(this)}catch(a){this.reject(a)}}))}onAuthEvent(e){return K(this,null,function*(){const{urlResponse:s,sessionId:a,postBody:l,tenantId:d,error:h,type:f}=e;if(h){this.reject(h);return}const b={auth:this.auth,requestUri:s,sessionId:a,tenantId:d||void 0,postBody:l||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(yield this.getIdpTask(f)(b))}catch(v){this.reject(v)}})}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Vj;case"linkViaPopup":case"linkViaRedirect":return Bj;case"reauthViaPopup":case"reauthViaRedirect":return Uj;default:zi(this.auth,"internal-error")}}resolve(e){Fi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Fi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zj=new iu(2e3,1e4);class hl extends R_{constructor(e,s,a,l,d){super(e,s,l,d),this.provider=a,this.authWindow=null,this.pollId=null,hl.currentPopupAction&&hl.currentPopupAction.cancel(),hl.currentPopupAction=this}executeNotNull(){return K(this,null,function*(){const e=yield this.execute();return ht(e,this.auth,"internal-error"),e})}onExecution(){return K(this,null,function*(){Fi(this.filter.length===1,"Popup operations only handle one event");const e=Dg();this.authWindow=yield this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(s=>{this.reject(s)}),this.resolver._isIframeWebStorageSupported(this.auth,s=>{s||this.reject(Wr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()})}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(Wr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,hl.currentPopupAction=null}pollUserCancellation(){const e=()=>{var s,a;if((a=(s=this.authWindow)==null?void 0:s.window)!=null&&a.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Wr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,zj.get())};e()}}hl.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fj="pendingRedirect",Id=new Map;class Vc extends R_{constructor(e,s,a=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],s,void 0,a),this.eventId=null}execute(){return K(this,null,function*(){let e=Id.get(this.auth._key());if(!e){try{const a=(yield qj(this.resolver,this.auth))?yield co(Vc.prototype,this,"execute").call(this):null;e=()=>Promise.resolve(a)}catch(s){e=()=>Promise.reject(s)}Id.set(this.auth._key(),e)}return this.bypassAuthState||Id.set(this.auth._key(),()=>Promise.resolve(null)),e()})}onAuthEvent(e){return K(this,null,function*(){if(e.type==="signInViaRedirect")return co(Vc.prototype,this,"onAuthEvent").call(this,e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const s=yield this.auth._redirectUserForId(e.eventId);if(s)return this.user=s,co(Vc.prototype,this,"onAuthEvent").call(this,e);this.resolve(null)}})}onExecution(){return K(this,null,function*(){})}cleanUp(){}}function qj(n,e){return K(this,null,function*(){const s=$j(e),a=Gj(n);if(!(yield a._isAvailable()))return!1;const l=(yield a._get(s))==="true";return yield a._remove(s),l})}function Hj(n,e){Id.set(n._key(),e)}function Gj(n){return Mi(n._redirectPersistence)}function $j(n){return Cd(Fj,n.config.apiKey,n.name)}function Qj(n,e,s=!1){return K(this,null,function*(){if(jr(n.app))return Promise.reject(go(n));const a=Ig(n),l=Lj(a,e),h=yield new Vc(a,l,s).execute();return h&&!s&&(delete h.user._redirectEventId,yield a._persistUserIfCurrent(h.user),yield a._setRedirectUser(null,e)),h})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kj=600*1e3;class Yj{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let s=!1;return this.consumers.forEach(a=>{this.isEventForConsumer(e,a)&&(s=!0,this.sendToConsumer(e,a),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Xj(e)||(this.hasHandledPotentialRedirect=!0,s||(this.queuedRedirectEvent=e,s=!0)),s}sendToConsumer(e,s){var a;if(e.error&&!D_(e)){const l=((a=e.error.code)==null?void 0:a.split("auth/")[1])||"internal-error";s.onError(Wr(this.auth,l))}else s.onAuthEvent(e)}isEventForConsumer(e,s){const a=s.eventId===null||!!e.eventId&&e.eventId===s.eventId;return s.filter.includes(e.type)&&a}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Kj&&this.cachedEventUids.clear(),this.cachedEventUids.has(hb(e))}saveEventToCache(e){this.cachedEventUids.add(hb(e)),this.lastProcessedEventTime=Date.now()}}function hb(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function D_({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function Xj(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return D_(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wj(s){return K(this,arguments,function*(n,e={}){return Cl(n,"GET","/v1/projects",e)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jj=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Zj=/^https?/;function eT(n){return K(this,null,function*(){if(n.config.emulator)return;const{authorizedDomains:e}=yield Wj(n);for(const s of e)try{if(tT(s))return}catch(a){}zi(n,"unauthorized-domain")})}function tT(n){const e=Qm(),{protocol:s,hostname:a}=new URL(e);if(n.startsWith("chrome-extension://")){const h=new URL(n);return h.hostname===""&&a===""?s==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):s==="chrome-extension:"&&h.hostname===a}if(!Zj.test(s))return!1;if(Jj.test(n))return a===n;const l=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+l+"|"+l+")$","i").test(a)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sT=new iu(3e4,6e4);function fb(){const n=Jr().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let s=0;s<n.CP.length;s++)n.CP[s]=null}}function nT(n){return new Promise((e,s)=>{var l,d,h;function a(){fb(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{fb(),s(Wr(n,"network-request-failed"))},timeout:sT.get()})}if((d=(l=Jr().gapi)==null?void 0:l.iframes)!=null&&d.Iframe)e(gapi.iframes.getContext());else if((h=Jr().gapi)!=null&&h.load)a();else{const f=uj("iframefcb");return Jr()[f]=()=>{gapi.load?a():s(Wr(n,"network-request-failed"))},lj(`${cj()}?onload=${f}`).catch(b=>s(b))}}).catch(e=>{throw Rd=null,e})}let Rd=null;function rT(n){return Rd=Rd||nT(n),Rd}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iT=new iu(5e3,15e3),aT="__/auth/iframe",oT="emulator/auth/iframe",lT={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},cT=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function uT(n){const e=n.config;ht(e.authDomain,n,"auth-domain-config-required");const s=e.emulator?jg(e,oT):`https://${n.config.authDomain}/${aT}`,a={apiKey:e.apiKey,appName:n.name,v:So},l=cT.get(n.config.apiHost);l&&(a.eid=l);const d=n._getFrameworks();return d.length&&(a.fw=d.join(",")),`${s}?${ru(a).slice(1)}`}function dT(n){return K(this,null,function*(){const e=yield rT(n),s=Jr().gapi;return ht(s,n,"internal-error"),e.open({where:document.body,url:uT(n),messageHandlersFilter:s.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:lT,dontclear:!0},a=>new Promise((l,d)=>K(null,null,function*(){yield a.restyle({setHideOnLeave:!1});const h=Wr(n,"network-request-failed"),f=Jr().setTimeout(()=>{d(h)},iT.get());function b(){Jr().clearTimeout(f),l(a)}a.ping(b).then(b,()=>{d(h)})})))})}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hT={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},fT=500,mT=600,gT="_blank",pT="http://localhost";class mb{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}function yT(n,e,s,a=fT,l=mT){const d=Math.max((window.screen.availHeight-l)/2,0).toString(),h=Math.max((window.screen.availWidth-a)/2,0).toString();let f="";const b=oe(X({},hT),{width:a.toString(),height:l.toString(),top:d,left:h}),v=$s().toLowerCase();s&&(f=f_(v)?gT:s),d_(v)&&(e=e||pT,b.scrollbars="yes");const E=Object.entries(b).reduce((_,[R,U])=>`${_}${R}=${U},`,"");if(ej(v)&&f!=="_self")return xT(e||"",f),new mb(null);const D=window.open(e||"",f,E);ht(D,n,"popup-blocked");try{D.focus()}catch(_){}return new mb(D)}function xT(n,e){const s=document.createElement("a");s.href=n,s.target=e;const a=document.createEvent("MouseEvent");a.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),s.dispatchEvent(a)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bT="__/auth/handler",vT="emulator/auth/handler",_T=encodeURIComponent("fac");function gb(n,e,s,a,l,d){return K(this,null,function*(){ht(n.config.authDomain,n,"auth-domain-config-required"),ht(n.config.apiKey,n,"invalid-api-key");const h={apiKey:n.config.apiKey,appName:n.name,authType:s,redirectUrl:a,v:So,eventId:l};if(e instanceof w_){e.setDefaultLanguage(n.languageCode),h.providerId=e.providerId||"",w2(e.getCustomParameters())||(h.customParameters=JSON.stringify(e.getCustomParameters()));for(const[E,D]of Object.entries({}))h[E]=D}if(e instanceof au){const E=e.getScopes().filter(D=>D!=="");E.length>0&&(h.scopes=E.join(","))}n.tenantId&&(h.tid=n.tenantId);const f=h;for(const E of Object.keys(f))f[E]===void 0&&delete f[E];const b=yield n._getAppCheckToken(),v=b?`#${_T}=${encodeURIComponent(b)}`:"";return`${wT(n)}?${ru(f).slice(1)}${v}`})}function wT({config:n}){return n.emulator?jg(n,vT):`https://${n.authDomain}/${bT}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cm="webStorageSupport";class NT{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=j_,this._completeRedirectFn=Qj,this._overrideRedirectResult=Hj}_openPopup(e,s,a,l){return K(this,null,function*(){var h;Fi((h=this.eventManagers[e._key()])==null?void 0:h.manager,"_initialize() not called before _openPopup()");const d=yield gb(e,s,a,Qm(),l);return yT(e,d,Dg())})}_openRedirect(e,s,a,l){return K(this,null,function*(){yield this._originValidation(e);const d=yield gb(e,s,a,Qm(),l);return Tj(d),new Promise(()=>{})})}_initialize(e){const s=e._key();if(this.eventManagers[s]){const{manager:l,promise:d}=this.eventManagers[s];return l?Promise.resolve(l):(Fi(d,"If manager is not set, promise should be"),d)}const a=this.initAndGetManager(e);return this.eventManagers[s]={promise:a},a.catch(()=>{delete this.eventManagers[s]}),a}initAndGetManager(e){return K(this,null,function*(){const s=yield dT(e),a=new Yj(e);return s.register("authEvent",l=>(ht(l==null?void 0:l.authEvent,e,"invalid-auth-event"),{status:a.onEvent(l.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:a},this.iframes[e._key()]=s,a})}_isIframeWebStorageSupported(e,s){this.iframes[e._key()].send(Cm,{type:Cm},l=>{var h;const d=(h=l==null?void 0:l[0])==null?void 0:h[Cm];d!==void 0&&s(!!d),zi(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const s=e._key();return this.originValidationPromises[s]||(this.originValidationPromises[s]=eT(e)),this.originValidationPromises[s]}get _shouldInitProactively(){return x_()||h_()||Cg()}}const ST=NT;var pb="@firebase/auth",yb="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ET{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}getToken(e){return K(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const s=this.auth.onIdTokenChanged(a=>{e((a==null?void 0:a.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,s),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const s=this.internalListeners.get(e);s&&(this.internalListeners.delete(e),s(),this.updateProactiveRefresh())}assertAuthConfigured(){ht(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jT(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function TT(n){xo(new Da("auth",(e,{options:s})=>{const a=e.getProvider("app").getImmediate(),l=e.getProvider("heartbeat"),d=e.getProvider("app-check-internal"),{apiKey:h,authDomain:f}=a.options;ht(h&&!h.includes(":"),"invalid-api-key",{appName:a.name});const b={apiKey:h,authDomain:f,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:b_(n)},v=new aj(a,l,d,b);return hj(v,s),v},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,s,a)=>{e.getProvider("auth-internal").initialize()})),xo(new Da("auth-internal",e=>{const s=Ig(e.getProvider("auth").getImmediate());return(a=>new ET(a))(s)},"PRIVATE").setInstantiationMode("EXPLICIT")),Xr(pb,yb,jT(n)),Xr(pb,yb,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AT=300,CT=Xv("authIdTokenMaxAge")||AT;let xb=null;const IT=n=>e=>K(null,null,function*(){const s=e&&(yield e.getIdTokenResult()),a=s&&(new Date().getTime()-Date.parse(s.issuedAtTime))/1e3;if(a&&a>CT)return;const l=s==null?void 0:s.token;xb!==l&&(xb=l,yield fetch(n,{method:l?"POST":"DELETE",headers:l?{Authorization:`Bearer ${l}`}:{}}))});function RT(n=Sg()){const e=lh(n,"auth");if(e.isInitialized())return e.getImmediate();const s=dj(n,{popupRedirectResolver:ST,persistence:[Pj,Sj,j_]}),a=Xv("authTokenSyncURL");if(a&&typeof isSecureContext=="boolean"&&isSecureContext){const d=new URL(a,location.origin);if(location.origin===d.origin){const h=IT(d.toString());_j(s,h,()=>h(s.currentUser)),vj(s,f=>h(f))}}const l=Qv("auth");return l&&fj(s,`http://${l}`),s}function DT(){var n,e;return(e=(n=document.getElementsByTagName("head"))==null?void 0:n[0])!=null?e:document}oj({loadJS(n){return new Promise((e,s)=>{const a=document.createElement("script");a.setAttribute("src",n),a.onload=e,a.onerror=l=>{const d=Wr("internal-error");d.customData=l,s(d)},a.type="text/javascript",a.charset="UTF-8",DT().appendChild(a)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});TT("Browser");var bb=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ia,O_;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(G,V){function L(){}L.prototype=V.prototype,G.F=V.prototype,G.prototype=new L,G.prototype.constructor=G,G.D=function(z,Q,Y){for(var J=Array(arguments.length-2),pt=2;pt<arguments.length;pt++)J[pt-2]=arguments[pt];return V.prototype[Q].apply(z,J)}}function s(){this.blockSize=-1}function a(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(a,s),a.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function l(G,V,L){L||(L=0);const z=Array(16);if(typeof V=="string")for(var Q=0;Q<16;++Q)z[Q]=V.charCodeAt(L++)|V.charCodeAt(L++)<<8|V.charCodeAt(L++)<<16|V.charCodeAt(L++)<<24;else for(Q=0;Q<16;++Q)z[Q]=V[L++]|V[L++]<<8|V[L++]<<16|V[L++]<<24;V=G.g[0],L=G.g[1],Q=G.g[2];let Y=G.g[3],J;J=V+(Y^L&(Q^Y))+z[0]+3614090360&4294967295,V=L+(J<<7&4294967295|J>>>25),J=Y+(Q^V&(L^Q))+z[1]+3905402710&4294967295,Y=V+(J<<12&4294967295|J>>>20),J=Q+(L^Y&(V^L))+z[2]+606105819&4294967295,Q=Y+(J<<17&4294967295|J>>>15),J=L+(V^Q&(Y^V))+z[3]+3250441966&4294967295,L=Q+(J<<22&4294967295|J>>>10),J=V+(Y^L&(Q^Y))+z[4]+4118548399&4294967295,V=L+(J<<7&4294967295|J>>>25),J=Y+(Q^V&(L^Q))+z[5]+1200080426&4294967295,Y=V+(J<<12&4294967295|J>>>20),J=Q+(L^Y&(V^L))+z[6]+2821735955&4294967295,Q=Y+(J<<17&4294967295|J>>>15),J=L+(V^Q&(Y^V))+z[7]+4249261313&4294967295,L=Q+(J<<22&4294967295|J>>>10),J=V+(Y^L&(Q^Y))+z[8]+1770035416&4294967295,V=L+(J<<7&4294967295|J>>>25),J=Y+(Q^V&(L^Q))+z[9]+2336552879&4294967295,Y=V+(J<<12&4294967295|J>>>20),J=Q+(L^Y&(V^L))+z[10]+4294925233&4294967295,Q=Y+(J<<17&4294967295|J>>>15),J=L+(V^Q&(Y^V))+z[11]+2304563134&4294967295,L=Q+(J<<22&4294967295|J>>>10),J=V+(Y^L&(Q^Y))+z[12]+1804603682&4294967295,V=L+(J<<7&4294967295|J>>>25),J=Y+(Q^V&(L^Q))+z[13]+4254626195&4294967295,Y=V+(J<<12&4294967295|J>>>20),J=Q+(L^Y&(V^L))+z[14]+2792965006&4294967295,Q=Y+(J<<17&4294967295|J>>>15),J=L+(V^Q&(Y^V))+z[15]+1236535329&4294967295,L=Q+(J<<22&4294967295|J>>>10),J=V+(Q^Y&(L^Q))+z[1]+4129170786&4294967295,V=L+(J<<5&4294967295|J>>>27),J=Y+(L^Q&(V^L))+z[6]+3225465664&4294967295,Y=V+(J<<9&4294967295|J>>>23),J=Q+(V^L&(Y^V))+z[11]+643717713&4294967295,Q=Y+(J<<14&4294967295|J>>>18),J=L+(Y^V&(Q^Y))+z[0]+3921069994&4294967295,L=Q+(J<<20&4294967295|J>>>12),J=V+(Q^Y&(L^Q))+z[5]+3593408605&4294967295,V=L+(J<<5&4294967295|J>>>27),J=Y+(L^Q&(V^L))+z[10]+38016083&4294967295,Y=V+(J<<9&4294967295|J>>>23),J=Q+(V^L&(Y^V))+z[15]+3634488961&4294967295,Q=Y+(J<<14&4294967295|J>>>18),J=L+(Y^V&(Q^Y))+z[4]+3889429448&4294967295,L=Q+(J<<20&4294967295|J>>>12),J=V+(Q^Y&(L^Q))+z[9]+568446438&4294967295,V=L+(J<<5&4294967295|J>>>27),J=Y+(L^Q&(V^L))+z[14]+3275163606&4294967295,Y=V+(J<<9&4294967295|J>>>23),J=Q+(V^L&(Y^V))+z[3]+4107603335&4294967295,Q=Y+(J<<14&4294967295|J>>>18),J=L+(Y^V&(Q^Y))+z[8]+1163531501&4294967295,L=Q+(J<<20&4294967295|J>>>12),J=V+(Q^Y&(L^Q))+z[13]+2850285829&4294967295,V=L+(J<<5&4294967295|J>>>27),J=Y+(L^Q&(V^L))+z[2]+4243563512&4294967295,Y=V+(J<<9&4294967295|J>>>23),J=Q+(V^L&(Y^V))+z[7]+1735328473&4294967295,Q=Y+(J<<14&4294967295|J>>>18),J=L+(Y^V&(Q^Y))+z[12]+2368359562&4294967295,L=Q+(J<<20&4294967295|J>>>12),J=V+(L^Q^Y)+z[5]+4294588738&4294967295,V=L+(J<<4&4294967295|J>>>28),J=Y+(V^L^Q)+z[8]+2272392833&4294967295,Y=V+(J<<11&4294967295|J>>>21),J=Q+(Y^V^L)+z[11]+1839030562&4294967295,Q=Y+(J<<16&4294967295|J>>>16),J=L+(Q^Y^V)+z[14]+4259657740&4294967295,L=Q+(J<<23&4294967295|J>>>9),J=V+(L^Q^Y)+z[1]+2763975236&4294967295,V=L+(J<<4&4294967295|J>>>28),J=Y+(V^L^Q)+z[4]+1272893353&4294967295,Y=V+(J<<11&4294967295|J>>>21),J=Q+(Y^V^L)+z[7]+4139469664&4294967295,Q=Y+(J<<16&4294967295|J>>>16),J=L+(Q^Y^V)+z[10]+3200236656&4294967295,L=Q+(J<<23&4294967295|J>>>9),J=V+(L^Q^Y)+z[13]+681279174&4294967295,V=L+(J<<4&4294967295|J>>>28),J=Y+(V^L^Q)+z[0]+3936430074&4294967295,Y=V+(J<<11&4294967295|J>>>21),J=Q+(Y^V^L)+z[3]+3572445317&4294967295,Q=Y+(J<<16&4294967295|J>>>16),J=L+(Q^Y^V)+z[6]+76029189&4294967295,L=Q+(J<<23&4294967295|J>>>9),J=V+(L^Q^Y)+z[9]+3654602809&4294967295,V=L+(J<<4&4294967295|J>>>28),J=Y+(V^L^Q)+z[12]+3873151461&4294967295,Y=V+(J<<11&4294967295|J>>>21),J=Q+(Y^V^L)+z[15]+530742520&4294967295,Q=Y+(J<<16&4294967295|J>>>16),J=L+(Q^Y^V)+z[2]+3299628645&4294967295,L=Q+(J<<23&4294967295|J>>>9),J=V+(Q^(L|~Y))+z[0]+4096336452&4294967295,V=L+(J<<6&4294967295|J>>>26),J=Y+(L^(V|~Q))+z[7]+1126891415&4294967295,Y=V+(J<<10&4294967295|J>>>22),J=Q+(V^(Y|~L))+z[14]+2878612391&4294967295,Q=Y+(J<<15&4294967295|J>>>17),J=L+(Y^(Q|~V))+z[5]+4237533241&4294967295,L=Q+(J<<21&4294967295|J>>>11),J=V+(Q^(L|~Y))+z[12]+1700485571&4294967295,V=L+(J<<6&4294967295|J>>>26),J=Y+(L^(V|~Q))+z[3]+2399980690&4294967295,Y=V+(J<<10&4294967295|J>>>22),J=Q+(V^(Y|~L))+z[10]+4293915773&4294967295,Q=Y+(J<<15&4294967295|J>>>17),J=L+(Y^(Q|~V))+z[1]+2240044497&4294967295,L=Q+(J<<21&4294967295|J>>>11),J=V+(Q^(L|~Y))+z[8]+1873313359&4294967295,V=L+(J<<6&4294967295|J>>>26),J=Y+(L^(V|~Q))+z[15]+4264355552&4294967295,Y=V+(J<<10&4294967295|J>>>22),J=Q+(V^(Y|~L))+z[6]+2734768916&4294967295,Q=Y+(J<<15&4294967295|J>>>17),J=L+(Y^(Q|~V))+z[13]+1309151649&4294967295,L=Q+(J<<21&4294967295|J>>>11),J=V+(Q^(L|~Y))+z[4]+4149444226&4294967295,V=L+(J<<6&4294967295|J>>>26),J=Y+(L^(V|~Q))+z[11]+3174756917&4294967295,Y=V+(J<<10&4294967295|J>>>22),J=Q+(V^(Y|~L))+z[2]+718787259&4294967295,Q=Y+(J<<15&4294967295|J>>>17),J=L+(Y^(Q|~V))+z[9]+3951481745&4294967295,G.g[0]=G.g[0]+V&4294967295,G.g[1]=G.g[1]+(Q+(J<<21&4294967295|J>>>11))&4294967295,G.g[2]=G.g[2]+Q&4294967295,G.g[3]=G.g[3]+Y&4294967295}a.prototype.v=function(G,V){V===void 0&&(V=G.length);const L=V-this.blockSize,z=this.C;let Q=this.h,Y=0;for(;Y<V;){if(Q==0)for(;Y<=L;)l(this,G,Y),Y+=this.blockSize;if(typeof G=="string"){for(;Y<V;)if(z[Q++]=G.charCodeAt(Y++),Q==this.blockSize){l(this,z),Q=0;break}}else for(;Y<V;)if(z[Q++]=G[Y++],Q==this.blockSize){l(this,z),Q=0;break}}this.h=Q,this.o+=V},a.prototype.A=function(){var G=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);G[0]=128;for(var V=1;V<G.length-8;++V)G[V]=0;V=this.o*8;for(var L=G.length-8;L<G.length;++L)G[L]=V&255,V/=256;for(this.v(G),G=Array(16),V=0,L=0;L<4;++L)for(let z=0;z<32;z+=8)G[V++]=this.g[L]>>>z&255;return G};function d(G,V){var L=f;return Object.prototype.hasOwnProperty.call(L,G)?L[G]:L[G]=V(G)}function h(G,V){this.h=V;const L=[];let z=!0;for(let Q=G.length-1;Q>=0;Q--){const Y=G[Q]|0;z&&Y==V||(L[Q]=Y,z=!1)}this.g=L}var f={};function b(G){return-128<=G&&G<128?d(G,function(V){return new h([V|0],V<0?-1:0)}):new h([G|0],G<0?-1:0)}function v(G){if(isNaN(G)||!isFinite(G))return D;if(G<0)return he(v(-G));const V=[];let L=1;for(let z=0;G>=L;z++)V[z]=G/L|0,L*=4294967296;return new h(V,0)}function E(G,V){if(G.length==0)throw Error("number format error: empty string");if(V=V||10,V<2||36<V)throw Error("radix out of range: "+V);if(G.charAt(0)=="-")return he(E(G.substring(1),V));if(G.indexOf("-")>=0)throw Error('number format error: interior "-" character');const L=v(Math.pow(V,8));let z=D;for(let Y=0;Y<G.length;Y+=8){var Q=Math.min(8,G.length-Y);const J=parseInt(G.substring(Y,Y+Q),V);Q<8?(Q=v(Math.pow(V,Q)),z=z.j(Q).add(v(J))):(z=z.j(L),z=z.add(v(J)))}return z}var D=b(0),_=b(1),R=b(16777216);n=h.prototype,n.m=function(){if(ie(this))return-he(this).m();let G=0,V=1;for(let L=0;L<this.g.length;L++){const z=this.i(L);G+=(z>=0?z:4294967296+z)*V,V*=4294967296}return G},n.toString=function(G){if(G=G||10,G<2||36<G)throw Error("radix out of range: "+G);if(U(this))return"0";if(ie(this))return"-"+he(this).toString(G);const V=v(Math.pow(G,6));var L=this;let z="";for(;;){const Q=_e(L,V).g;L=Se(L,Q.j(V));let Y=((L.g.length>0?L.g[0]:L.h)>>>0).toString(G);if(L=Q,U(L))return Y+z;for(;Y.length<6;)Y="0"+Y;z=Y+z}},n.i=function(G){return G<0?0:G<this.g.length?this.g[G]:this.h};function U(G){if(G.h!=0)return!1;for(let V=0;V<G.g.length;V++)if(G.g[V]!=0)return!1;return!0}function ie(G){return G.h==-1}n.l=function(G){return G=Se(this,G),ie(G)?-1:U(G)?0:1};function he(G){const V=G.g.length,L=[];for(let z=0;z<V;z++)L[z]=~G.g[z];return new h(L,~G.h).add(_)}n.abs=function(){return ie(this)?he(this):this},n.add=function(G){const V=Math.max(this.g.length,G.g.length),L=[];let z=0;for(let Q=0;Q<=V;Q++){let Y=z+(this.i(Q)&65535)+(G.i(Q)&65535),J=(Y>>>16)+(this.i(Q)>>>16)+(G.i(Q)>>>16);z=J>>>16,Y&=65535,J&=65535,L[Q]=J<<16|Y}return new h(L,L[L.length-1]&-2147483648?-1:0)};function Se(G,V){return G.add(he(V))}n.j=function(G){if(U(this)||U(G))return D;if(ie(this))return ie(G)?he(this).j(he(G)):he(he(this).j(G));if(ie(G))return he(this.j(he(G)));if(this.l(R)<0&&G.l(R)<0)return v(this.m()*G.m());const V=this.g.length+G.g.length,L=[];for(var z=0;z<2*V;z++)L[z]=0;for(z=0;z<this.g.length;z++)for(let Q=0;Q<G.g.length;Q++){const Y=this.i(z)>>>16,J=this.i(z)&65535,pt=G.i(Q)>>>16,Ct=G.i(Q)&65535;L[2*z+2*Q]+=J*Ct,Be(L,2*z+2*Q),L[2*z+2*Q+1]+=Y*Ct,Be(L,2*z+2*Q+1),L[2*z+2*Q+1]+=J*pt,Be(L,2*z+2*Q+1),L[2*z+2*Q+2]+=Y*pt,Be(L,2*z+2*Q+2)}for(G=0;G<V;G++)L[G]=L[2*G+1]<<16|L[2*G];for(G=V;G<2*V;G++)L[G]=0;return new h(L,0)};function Be(G,V){for(;(G[V]&65535)!=G[V];)G[V+1]+=G[V]>>>16,G[V]&=65535,V++}function xe(G,V){this.g=G,this.h=V}function _e(G,V){if(U(V))throw Error("division by zero");if(U(G))return new xe(D,D);if(ie(G))return V=_e(he(G),V),new xe(he(V.g),he(V.h));if(ie(V))return V=_e(G,he(V)),new xe(he(V.g),V.h);if(G.g.length>30){if(ie(G)||ie(V))throw Error("slowDivide_ only works with positive integers.");for(var L=_,z=V;z.l(G)<=0;)L=Ne(L),z=Ne(z);var Q=De(L,1),Y=De(z,1);for(z=De(z,2),L=De(L,2);!U(z);){var J=Y.add(z);J.l(G)<=0&&(Q=Q.add(L),Y=J),z=De(z,1),L=De(L,1)}return V=Se(G,Q.j(V)),new xe(Q,V)}for(Q=D;G.l(V)>=0;){for(L=Math.max(1,Math.floor(G.m()/V.m())),z=Math.ceil(Math.log(L)/Math.LN2),z=z<=48?1:Math.pow(2,z-48),Y=v(L),J=Y.j(V);ie(J)||J.l(G)>0;)L-=z,Y=v(L),J=Y.j(V);U(Y)&&(Y=_),Q=Q.add(Y),G=Se(G,J)}return new xe(Q,G)}n.B=function(G){return _e(this,G).h},n.and=function(G){const V=Math.max(this.g.length,G.g.length),L=[];for(let z=0;z<V;z++)L[z]=this.i(z)&G.i(z);return new h(L,this.h&G.h)},n.or=function(G){const V=Math.max(this.g.length,G.g.length),L=[];for(let z=0;z<V;z++)L[z]=this.i(z)|G.i(z);return new h(L,this.h|G.h)},n.xor=function(G){const V=Math.max(this.g.length,G.g.length),L=[];for(let z=0;z<V;z++)L[z]=this.i(z)^G.i(z);return new h(L,this.h^G.h)};function Ne(G){const V=G.g.length+1,L=[];for(let z=0;z<V;z++)L[z]=G.i(z)<<1|G.i(z-1)>>>31;return new h(L,G.h)}function De(G,V){const L=V>>5;V%=32;const z=G.g.length-L,Q=[];for(let Y=0;Y<z;Y++)Q[Y]=V>0?G.i(Y+L)>>>V|G.i(Y+L+1)<<32-V:G.i(Y+L);return new h(Q,G.h)}a.prototype.digest=a.prototype.A,a.prototype.reset=a.prototype.u,a.prototype.update=a.prototype.v,O_=a,h.prototype.add=h.prototype.add,h.prototype.multiply=h.prototype.j,h.prototype.modulo=h.prototype.B,h.prototype.compare=h.prototype.l,h.prototype.toNumber=h.prototype.m,h.prototype.toString=h.prototype.toString,h.prototype.getBits=h.prototype.i,h.fromNumber=v,h.fromString=E,Ia=h}).apply(typeof bb!="undefined"?bb:typeof self!="undefined"?self:typeof window!="undefined"?window:{});var xd=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var k_,Dc,M_,Dd,Xm,P_,L_,V_;(function(){var n,e=Object.defineProperty;function s(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof xd=="object"&&xd];for(var g=0;g<c.length;++g){var x=c[g];if(x&&x.Math==Math)return x}throw Error("Cannot find global object")}var a=s(this);function l(c,g){if(g)e:{var x=a;c=c.split(".");for(var w=0;w<c.length-1;w++){var H=c[w];if(!(H in x))break e;x=x[H]}c=c[c.length-1],w=x[c],g=g(w),g!=w&&g!=null&&e(x,c,{configurable:!0,writable:!0,value:g})}}l("Symbol.dispose",function(c){return c||Symbol("Symbol.dispose")}),l("Array.prototype.values",function(c){return c||function(){return this[Symbol.iterator]()}}),l("Object.entries",function(c){return c||function(g){var x=[],w;for(w in g)Object.prototype.hasOwnProperty.call(g,w)&&x.push([w,g[w]]);return x}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var d=d||{},h=this||self;function f(c){var g=typeof c;return g=="object"&&c!=null||g=="function"}function b(c,g,x){return c.call.apply(c.bind,arguments)}function v(c,g,x){return v=b,v.apply(null,arguments)}function E(c,g){var x=Array.prototype.slice.call(arguments,1);return function(){var w=x.slice();return w.push.apply(w,arguments),c.apply(this,w)}}function D(c,g){function x(){}x.prototype=g.prototype,c.Z=g.prototype,c.prototype=new x,c.prototype.constructor=c,c.Ob=function(w,H,ne){for(var Ve=Array(arguments.length-2),Xe=2;Xe<arguments.length;Xe++)Ve[Xe-2]=arguments[Xe];return g.prototype[H].apply(w,Ve)}}var _=typeof AsyncContext!="undefined"&&typeof AsyncContext.Snapshot=="function"?c=>c&&AsyncContext.Snapshot.wrap(c):c=>c;function R(c){const g=c.length;if(g>0){const x=Array(g);for(let w=0;w<g;w++)x[w]=c[w];return x}return[]}function U(c,g){for(let w=1;w<arguments.length;w++){const H=arguments[w];var x=typeof H;if(x=x!="object"?x:H?Array.isArray(H)?"array":x:"null",x=="array"||x=="object"&&typeof H.length=="number"){x=c.length||0;const ne=H.length||0;c.length=x+ne;for(let Ve=0;Ve<ne;Ve++)c[x+Ve]=H[Ve]}else c.push(H)}}class ie{constructor(g,x){this.i=g,this.j=x,this.h=0,this.g=null}get(){let g;return this.h>0?(this.h--,g=this.g,this.g=g.next,g.next=null):g=this.i(),g}}function he(c){h.setTimeout(()=>{throw c},0)}function Se(){var c=G;let g=null;return c.g&&(g=c.g,c.g=c.g.next,c.g||(c.h=null),g.next=null),g}class Be{constructor(){this.h=this.g=null}add(g,x){const w=xe.get();w.set(g,x),this.h?this.h.next=w:this.g=w,this.h=w}}var xe=new ie(()=>new _e,c=>c.reset());class _e{constructor(){this.next=this.g=this.h=null}set(g,x){this.h=g,this.g=x,this.next=null}reset(){this.next=this.g=this.h=null}}let Ne,De=!1,G=new Be,V=()=>{const c=Promise.resolve(void 0);Ne=()=>{c.then(L)}};function L(){for(var c;c=Se();){try{c.h.call(c.g)}catch(x){he(x)}var g=xe;g.j(c),g.h<100&&(g.h++,c.next=g.g,g.g=c)}De=!1}function z(){this.u=this.u,this.C=this.C}z.prototype.u=!1,z.prototype.dispose=function(){this.u||(this.u=!0,this.N())},z.prototype[Symbol.dispose]=function(){this.dispose()},z.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Q(c,g){this.type=c,this.g=this.target=g,this.defaultPrevented=!1}Q.prototype.h=function(){this.defaultPrevented=!0};var Y=(function(){if(!h.addEventListener||!Object.defineProperty)return!1;var c=!1,g=Object.defineProperty({},"passive",{get:function(){c=!0}});try{const x=()=>{};h.addEventListener("test",x,g),h.removeEventListener("test",x,g)}catch(x){}return c})();function J(c){return/^[\s\xa0]*$/.test(c)}function pt(c,g){Q.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c&&this.init(c,g)}D(pt,Q),pt.prototype.init=function(c,g){const x=this.type=c.type,w=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;this.target=c.target||c.srcElement,this.g=g,g=c.relatedTarget,g||(x=="mouseover"?g=c.fromElement:x=="mouseout"&&(g=c.toElement)),this.relatedTarget=g,w?(this.clientX=w.clientX!==void 0?w.clientX:w.pageX,this.clientY=w.clientY!==void 0?w.clientY:w.pageY,this.screenX=w.screenX||0,this.screenY=w.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=c.pointerType,this.state=c.state,this.i=c,c.defaultPrevented&&pt.Z.h.call(this)},pt.prototype.h=function(){pt.Z.h.call(this);const c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var Ct="closure_listenable_"+(Math.random()*1e6|0),Ae=0;function Ue(c,g,x,w,H){this.listener=c,this.proxy=null,this.src=g,this.type=x,this.capture=!!w,this.ha=H,this.key=++Ae,this.da=this.fa=!1}function et(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function Ie(c,g,x){for(const w in c)g.call(x,c[w],w,c)}function Ge(c,g){for(const x in c)g.call(void 0,c[x],x,c)}function bt(c){const g={};for(const x in c)g[x]=c[x];return g}const xt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function yt(c,g){let x,w;for(let H=1;H<arguments.length;H++){w=arguments[H];for(x in w)c[x]=w[x];for(let ne=0;ne<xt.length;ne++)x=xt[ne],Object.prototype.hasOwnProperty.call(w,x)&&(c[x]=w[x])}}function Ht(c){this.src=c,this.g={},this.h=0}Ht.prototype.add=function(c,g,x,w,H){const ne=c.toString();c=this.g[ne],c||(c=this.g[ne]=[],this.h++);const Ve=nn(c,g,w,H);return Ve>-1?(g=c[Ve],x||(g.fa=!1)):(g=new Ue(g,this.src,ne,!!w,H),g.fa=x,c.push(g)),g};function Us(c,g){const x=g.type;if(x in c.g){var w=c.g[x],H=Array.prototype.indexOf.call(w,g,void 0),ne;(ne=H>=0)&&Array.prototype.splice.call(w,H,1),ne&&(et(g),c.g[x].length==0&&(delete c.g[x],c.h--))}}function nn(c,g,x,w){for(let H=0;H<c.length;++H){const ne=c[H];if(!ne.da&&ne.listener==g&&ne.capture==!!x&&ne.ha==w)return H}return-1}var Dr="closure_lm_"+(Math.random()*1e6|0),Or={};function ir(c,g,x,w,H){if(Array.isArray(g)){for(let ne=0;ne<g.length;ne++)ir(c,g[ne],x,w,H);return null}return x=Ba(x),c&&c[Ct]?c.J(g,x,f(w)?!!w.capture:!1,H):Ua(c,g,x,!1,w,H)}function Ua(c,g,x,w,H,ne){if(!g)throw Error("Invalid event type");const Ve=f(H)?!!H.capture:!!H;let Xe=oi(c);if(Xe||(c[Dr]=Xe=new Ht(c)),x=Xe.add(g,x,w,Ve,ne),x.proxy)return x;if(w=$i(),x.proxy=w,w.src=c,w.listener=x,c.addEventListener)Y||(H=Ve),H===void 0&&(H=!1),c.addEventListener(g.toString(),w,H);else if(c.attachEvent)c.attachEvent(or(g.toString()),w);else if(c.addListener&&c.removeListener)c.addListener(w);else throw Error("addEventListener and attachEvent are unavailable.");return x}function $i(){function c(x){return g.call(c.src,c.listener,x)}const g=Ml;return c}function ar(c,g,x,w,H){if(Array.isArray(g))for(var ne=0;ne<g.length;ne++)ar(c,g[ne],x,w,H);else w=f(w)?!!w.capture:!!w,x=Ba(x),c&&c[Ct]?(c=c.i,ne=String(g).toString(),ne in c.g&&(g=c.g[ne],x=nn(g,x,w,H),x>-1&&(et(g[x]),Array.prototype.splice.call(g,x,1),g.length==0&&(delete c.g[ne],c.h--)))):c&&(c=oi(c))&&(g=c.g[g.toString()],c=-1,g&&(c=nn(g,x,w,H)),(x=c>-1?g[c]:null)&&Ln(x))}function Ln(c){if(typeof c!="number"&&c&&!c.da){var g=c.src;if(g&&g[Ct])Us(g.i,c);else{var x=c.type,w=c.proxy;g.removeEventListener?g.removeEventListener(x,w,c.capture):g.detachEvent?g.detachEvent(or(x),w):g.addListener&&g.removeListener&&g.removeListener(w),(x=oi(g))?(Us(x,c),x.h==0&&(x.src=null,g[Dr]=null)):et(c)}}}function or(c){return c in Or?Or[c]:Or[c]="on"+c}function Ml(c,g){if(c.da)c=!0;else{g=new pt(g,this);const x=c.listener,w=c.ha||c.src;c.fa&&Ln(c),c=x.call(w,g)}return c}function oi(c){return c=c[Dr],c instanceof Ht?c:null}var Is="__closure_events_fn_"+(Math.random()*1e9>>>0);function Ba(c){return typeof c=="function"?c:(c[Is]||(c[Is]=function(g){return c.handleEvent(g)}),c[Is])}function Zt(){z.call(this),this.i=new Ht(this),this.M=this,this.G=null}D(Zt,z),Zt.prototype[Ct]=!0,Zt.prototype.removeEventListener=function(c,g,x,w){ar(this,c,g,x,w)};function ls(c,g){var x,w=c.G;if(w)for(x=[];w;w=w.G)x.push(w);if(c=c.M,w=g.type||g,typeof g=="string")g=new Q(g,c);else if(g instanceof Q)g.target=g.target||c;else{var H=g;g=new Q(w,c),yt(g,H)}H=!0;let ne,Ve;if(x)for(Ve=x.length-1;Ve>=0;Ve--)ne=g.g=x[Ve],H=Vn(ne,w,!0,g)&&H;if(ne=g.g=c,H=Vn(ne,w,!0,g)&&H,H=Vn(ne,w,!1,g)&&H,x)for(Ve=0;Ve<x.length;Ve++)ne=g.g=x[Ve],H=Vn(ne,w,!1,g)&&H}Zt.prototype.N=function(){if(Zt.Z.N.call(this),this.i){var c=this.i;for(const g in c.g){const x=c.g[g];for(let w=0;w<x.length;w++)et(x[w]);delete c.g[g],c.h--}}this.G=null},Zt.prototype.J=function(c,g,x,w){return this.i.add(String(c),g,!1,x,w)},Zt.prototype.K=function(c,g,x,w){return this.i.add(String(c),g,!0,x,w)};function Vn(c,g,x,w){if(g=c.i.g[String(g)],!g)return!0;g=g.concat();let H=!0;for(let ne=0;ne<g.length;++ne){const Ve=g[ne];if(Ve&&!Ve.da&&Ve.capture==x){const Xe=Ve.listener,at=Ve.ha||Ve.src;Ve.fa&&Us(c.i,Ve),H=Xe.call(at,w)!==!1&&H}}return H&&!w.defaultPrevented}function za(c,g){if(typeof c!="function")if(c&&typeof c.handleEvent=="function")c=v(c.handleEvent,c);else throw Error("Invalid listener argument");return Number(g)>2147483647?-1:h.setTimeout(c,g||0)}function Qi(c){c.g=za(()=>{c.g=null,c.i&&(c.i=!1,Qi(c))},c.l);const g=c.h;c.h=null,c.m.apply(null,g)}class Io extends z{constructor(g,x){super(),this.m=g,this.l=x,this.h=null,this.i=!1,this.g=null}j(g){this.h=arguments,this.g?this.i=!0:Qi(this)}N(){super.N(),this.g&&(h.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function kr(c){z.call(this),this.h=c,this.g={}}D(kr,z);var Un=[];function vs(c){Ie(c.g,function(g,x){this.g.hasOwnProperty(x)&&Ln(g)},c),c.g={}}kr.prototype.N=function(){kr.Z.N.call(this),vs(this)},kr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var rn=h.JSON.stringify,Rs=h.JSON.parse,Pl=class{stringify(c){return h.JSON.stringify(c,void 0)}parse(c){return h.JSON.parse(c,void 0)}};function Ro(){}function Ki(){}var bn={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function lr(){Q.call(this,"d")}D(lr,Q);function vn(){Q.call(this,"c")}D(vn,Q);var Qs={},Bn=null;function li(){return Bn=Bn||new Zt}Qs.Ia="serverreachability";function Fa(c){Q.call(this,Qs.Ia,c)}D(Fa,Q);function zn(c){const g=li();ls(g,new Fa(g))}Qs.STAT_EVENT="statevent";function Yi(c,g){Q.call(this,Qs.STAT_EVENT,c),this.stat=g}D(Yi,Q);function es(c){const g=li();ls(g,new Yi(g,c))}Qs.Ja="timingevent";function qa(c,g){Q.call(this,Qs.Ja,c),this.size=g}D(qa,Q);function cr(c,g){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return h.setTimeout(function(){c()},g)}function ur(){this.g=!0}ur.prototype.ua=function(){this.g=!1};function ci(c,g,x,w,H,ne){c.info(function(){if(c.g)if(ne){var Ve="",Xe=ne.split("&");for(let st=0;st<Xe.length;st++){var at=Xe[st].split("=");if(at.length>1){const gt=at[0];at=at[1];const Tn=gt.split("_");Ve=Tn.length>=2&&Tn[1]=="type"?Ve+(gt+"="+at+"&"):Ve+(gt+"=redacted&")}}}else Ve=null;else Ve=ne;return"XMLHTTP REQ ("+w+") [attempt "+H+"]: "+g+`
`+x+`
`+Ve})}function dr(c,g,x,w,H,ne,Ve){c.info(function(){return"XMLHTTP RESP ("+w+") [ attempt "+H+"]: "+g+`
`+x+`
`+ne+" "+Ve})}function Ks(c,g,x,w){c.info(function(){return"XMLHTTP TEXT ("+g+"): "+_n(c,x)+(w?" "+w:"")})}function Ha(c,g){c.info(function(){return"TIMEOUT: "+g})}ur.prototype.info=function(){};function _n(c,g){if(!c.g)return g;if(!g)return null;try{const ne=JSON.parse(g);if(ne){for(c=0;c<ne.length;c++)if(Array.isArray(ne[c])){var x=ne[c];if(!(x.length<2)){var w=x[1];if(Array.isArray(w)&&!(w.length<1)){var H=w[0];if(H!="noop"&&H!="stop"&&H!="close")for(let Ve=1;Ve<w.length;Ve++)w[Ve]=""}}}}return rn(ne)}catch(ne){return g}}var ts={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},_s={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},hr;function ui(){}D(ui,Ro),ui.prototype.g=function(){return new XMLHttpRequest},hr=new ui;function Mr(c){return encodeURIComponent(String(c))}function Do(c){var g=1;c=c.split(":");const x=[];for(;g>0&&c.length;)x.push(c.shift()),g--;return c.length&&x.push(c.join(":")),x}function an(c,g,x,w){this.j=c,this.i=g,this.l=x,this.S=w||1,this.V=new kr(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Pr}function Pr(){this.i=null,this.g="",this.h=!1}var di={},Fn={};function qn(c,g,x){c.M=1,c.A=Gn(Xt(g)),c.u=x,c.R=!0,fr(c,null)}function fr(c,g){c.F=Date.now(),hi(c),c.B=Xt(c.A);var x=c.B,w=c.S;Array.isArray(w)||(w=[String(w)]),F(x.i,"t",w),c.C=0,x=c.j.L,c.h=new Pr,c.g=Qn(c.j,x?g:null,!c.u),c.P>0&&(c.O=new Io(v(c.Y,c,c.g),c.P)),g=c.V,x=c.g,w=c.ba;var H="readystatechange";Array.isArray(H)||(H&&(Un[0]=H.toString()),H=Un);for(let ne=0;ne<H.length;ne++){const Ve=ir(x,H[ne],w||g.handleEvent,!1,g.h||g);if(!Ve)break;g.g[Ve.key]=Ve}g=c.J?bt(c.J):{},c.u?(c.v||(c.v="POST"),g["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.B,c.v,c.u,g)):(c.v="GET",c.g.ea(c.B,c.v,null,g)),zn(),ci(c.i,c.v,c.B,c.l,c.S,c.u)}an.prototype.ba=function(c){c=c.target;const g=this.O;g&&ut(c)==3?g.j():this.Y(c)},an.prototype.Y=function(c){try{if(c==this.g)e:{const Xe=ut(this.g),at=this.g.ya(),st=this.g.ca();if(!(Xe<3)&&(Xe!=3||this.g&&(this.h.h||this.g.la()||It(this.g)))){this.K||Xe!=4||at==7||(at==8||st<=0?zn(3):zn(2)),wn(this);var g=this.g.ca();this.X=g;var x=mr(this);if(this.o=g==200,dr(this.i,this.v,this.B,this.l,this.S,Xe,g),this.o){if(this.U&&!this.L){t:{if(this.g){var w,H=this.g;if((w=H.g?H.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!J(w)){var ne=w;break t}}ne=null}if(c=ne)Ks(this.i,this.l,c,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,fi(this,c);else{this.o=!1,this.m=3,es(12),Nn(this),gr(this);break e}}if(this.R){c=!0;let gt;for(;!this.K&&this.C<x.length;)if(gt=Oo(this,x),gt==Fn){Xe==4&&(this.m=4,es(14),c=!1),Ks(this.i,this.l,null,"[Incomplete Response]");break}else if(gt==di){this.m=4,es(15),Ks(this.i,this.l,x,"[Invalid Chunk]"),c=!1;break}else Ks(this.i,this.l,gt,null),fi(this,gt);if(ss(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Xe!=4||x.length!=0||this.h.h||(this.m=1,es(16),c=!1),this.o=this.o&&c,!c)Ks(this.i,this.l,x,"[Invalid Chunked Response]"),Nn(this),gr(this);else if(x.length>0&&!this.W){this.W=!0;var Ve=this.j;Ve.g==this&&Ve.aa&&!Ve.P&&(Ve.j.info("Great, no buffering proxy detected. Bytes received: "+x.length),jn(Ve),Ve.P=!0,es(11))}}else Ks(this.i,this.l,x,null),fi(this,x);Xe==4&&Nn(this),this.o&&!this.K&&(Xe==4?Wi(this.j,this):(this.o=!1,hi(this)))}else Js(this.g),g==400&&x.indexOf("Unknown SID")>0?(this.m=3,es(12)):(this.m=0,es(13)),Nn(this),gr(this)}}}catch(Xe){}finally{}};function mr(c){if(!ss(c))return c.g.la();const g=It(c.g);if(g==="")return"";let x="";const w=g.length,H=ut(c.g)==4;if(!c.h.i){if(typeof TextDecoder=="undefined")return Nn(c),gr(c),"";c.h.i=new h.TextDecoder}for(let ne=0;ne<w;ne++)c.h.h=!0,x+=c.h.i.decode(g[ne],{stream:!(H&&ne==w-1)});return g.length=0,c.h.g+=x,c.C=0,c.h.g}function ss(c){return c.g?c.v=="GET"&&c.M!=2&&c.j.Aa:!1}function Oo(c,g){var x=c.C,w=g.indexOf(`
`,x);return w==-1?Fn:(x=Number(g.substring(x,w)),isNaN(x)?di:(w+=1,w+x>g.length?Fn:(g=g.slice(w,w+x),c.C=w+x,g)))}an.prototype.cancel=function(){this.K=!0,Nn(this)};function hi(c){c.T=Date.now()+c.H,Hn(c,c.H)}function Hn(c,g){if(c.D!=null)throw Error("WatchDog timer not null");c.D=cr(v(c.aa,c),g)}function wn(c){c.D&&(h.clearTimeout(c.D),c.D=null)}an.prototype.aa=function(){this.D=null;const c=Date.now();c-this.T>=0?(Ha(this.i,this.B),this.M!=2&&(zn(),es(17)),Nn(this),this.m=2,gr(this)):Hn(this,this.T-c)};function gr(c){c.j.I==0||c.K||Wi(c.j,c)}function Nn(c){wn(c);var g=c.O;g&&typeof g.dispose=="function"&&g.dispose(),c.O=null,vs(c.V),c.g&&(g=c.g,c.g=null,g.abort(),g.dispose())}function fi(c,g){try{var x=c.j;if(x.I!=0&&(x.g==c||Xs(x.h,c))){if(!c.L&&Xs(x.h,c)&&x.I==3){try{var w=x.Ba.g.parse(g)}catch(st){w=null}if(Array.isArray(w)&&w.length==3){var H=w;if(H[0]==0){e:if(!x.v){if(x.g)if(x.g.F+3e3<c.F)Xi(x),cs(x);else break e;bi(x),es(18)}}else x.xa=H[1],0<x.xa-x.K&&H[2]<37500&&x.F&&x.A==0&&!x.C&&(x.C=cr(v(x.Va,x),6e3));Ys(x.h)<=1&&x.ta&&(x.ta=void 0)}else $n(x,11)}else if((c.L||x.g==c)&&Xi(x),!J(g))for(H=x.Ba.g.parse(g),g=0;g<H.length;g++){let st=H[g];const gt=st[0];if(!(gt<=x.K))if(x.K=gt,st=st[1],x.I==2)if(st[0]=="c"){x.M=st[1],x.ba=st[2];const Tn=st[3];Tn!=null&&(x.ka=Tn,x.j.info("VER="+x.ka));const zr=st[4];zr!=null&&(x.za=zr,x.j.info("SVER="+x.za));const vr=st[5];vr!=null&&typeof vr=="number"&&vr>0&&(w=1.5*vr,x.O=w,x.j.info("backChannelRequestTimeoutMs_="+w)),w=x;const _r=c.g;if(_r){const wr=_r.g?_r.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(wr){var ne=w.h;ne.g||wr.indexOf("spdy")==-1&&wr.indexOf("quic")==-1&&wr.indexOf("h2")==-1||(ne.j=ne.l,ne.g=new Set,ne.h&&(gi(ne,ne.h),ne.h=null))}if(w.G){const Vl=_r.g?_r.g.getResponseHeader("X-HTTP-Session-Id"):null;Vl&&(w.wa=Vl,Dt(w.J,w.G,Vl))}}x.I=3,x.l&&x.l.ra(),x.aa&&(x.T=Date.now()-c.F,x.j.info("Handshake RTT: "+x.T+"ms")),w=x;var Ve=c;if(w.na=Ji(w,w.L?w.ba:null,w.W),Ve.L){pr(w.h,Ve);var Xe=Ve,at=w.O;at&&(Xe.H=at),Xe.D&&(wn(Xe),hi(Xe)),w.g=Ve}else Br(w);x.i.length>0&&Zs(x)}else st[0]!="stop"&&st[0]!="close"||$n(x,7);else x.I==3&&(st[0]=="stop"||st[0]=="close"?st[0]=="stop"?$n(x,7):$t(x):st[0]!="noop"&&x.l&&x.l.qa(st),x.A=0)}}zn(4)}catch(st){}}var Ll=class{constructor(c,g){this.g=c,this.map=g}};function mi(c){this.l=c||10,h.PerformanceNavigationTiming?(c=h.performance.getEntriesByType("navigation"),c=c.length>0&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(h.chrome&&h.chrome.loadTimes&&h.chrome.loadTimes()&&h.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Lr(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function Ys(c){return c.h?1:c.g?c.g.size:0}function Xs(c,g){return c.h?c.h==g:c.g?c.g.has(g):!1}function gi(c,g){c.g?c.g.add(g):c.h=g}function pr(c,g){c.h&&c.h==g?c.h=null:c.g&&c.g.has(g)&&c.g.delete(g)}mi.prototype.cancel=function(){if(this.i=Vr(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const c of this.g.values())c.cancel();this.g.clear()}};function Vr(c){if(c.h!=null)return c.i.concat(c.h.G);if(c.g!=null&&c.g.size!==0){let g=c.i;for(const x of c.g.values())g=g.concat(x.G);return g}return R(c.i)}var pi=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ga(c,g){if(c){c=c.split("&");for(let x=0;x<c.length;x++){const w=c[x].indexOf("=");let H,ne=null;w>=0?(H=c[x].substring(0,w),ne=c[x].substring(w+1)):H=c[x],g(H,ne?decodeURIComponent(ne.replace(/\+/g," ")):"")}}}function on(c){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let g;c instanceof on?(this.l=c.l,Ws(this,c.j),this.o=c.o,this.g=c.g,Ur(this,c.u),this.h=c.h,yr(this,te(c.i)),this.m=c.m):c&&(g=String(c).match(pi))?(this.l=!1,Ws(this,g[1]||"",!0),this.o=yi(g[2]||""),this.g=yi(g[3]||"",!0),Ur(this,g[4]),this.h=yi(g[5]||"",!0),yr(this,g[6]||"",!0),this.m=yi(g[7]||"")):(this.l=!1,this.i=new A(null,this.l))}on.prototype.toString=function(){const c=[];var g=this.j;g&&c.push(ee(g,O,!0),":");var x=this.g;return(x||g=="file")&&(c.push("//"),(g=this.o)&&c.push(ee(g,O,!0),"@"),c.push(Mr(x).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),x=this.u,x!=null&&c.push(":",String(x))),(x=this.h)&&(this.g&&x.charAt(0)!="/"&&c.push("/"),c.push(ee(x,x.charAt(0)=="/"?I:k,!0))),(x=this.i.toString())&&c.push("?",x),(x=this.m)&&c.push("#",ee(x,M)),c.join("")},on.prototype.resolve=function(c){const g=Xt(this);let x=!!c.j;x?Ws(g,c.j):x=!!c.o,x?g.o=c.o:x=!!c.g,x?g.g=c.g:x=c.u!=null;var w=c.h;if(x)Ur(g,c.u);else if(x=!!c.h){if(w.charAt(0)!="/")if(this.g&&!this.h)w="/"+w;else{var H=g.h.lastIndexOf("/");H!=-1&&(w=g.h.slice(0,H+1)+w)}if(H=w,H==".."||H==".")w="";else if(H.indexOf("./")!=-1||H.indexOf("/.")!=-1){w=H.lastIndexOf("/",0)==0,H=H.split("/");const ne=[];for(let Ve=0;Ve<H.length;){const Xe=H[Ve++];Xe=="."?w&&Ve==H.length&&ne.push(""):Xe==".."?((ne.length>1||ne.length==1&&ne[0]!="")&&ne.pop(),w&&Ve==H.length&&ne.push("")):(ne.push(Xe),w=!0)}w=ne.join("/")}else w=H}return x?g.h=w:x=c.i.toString()!=="",x?yr(g,te(c.i)):x=!!c.m,x&&(g.m=c.m),g};function Xt(c){return new on(c)}function Ws(c,g,x){c.j=x?yi(g,!0):g,c.j&&(c.j=c.j.replace(/:$/,""))}function Ur(c,g){if(g){if(g=Number(g),isNaN(g)||g<0)throw Error("Bad port number "+g);c.u=g}else c.u=null}function yr(c,g,x){g instanceof A?(c.i=g,C(c.i,c.l)):(x||(g=ee(g,j)),c.i=new A(g,c.l))}function Dt(c,g,x){c.i.set(g,x)}function Gn(c){return Dt(c,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),c}function yi(c,g){return c?g?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function ee(c,g,x){return typeof c=="string"?(c=encodeURI(c).replace(g,T),x&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function T(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var O=/[#\/\?@]/g,k=/[#\?:]/g,I=/[#\?]/g,j=/[#\?@]/g,M=/#/g;function A(c,g){this.h=this.g=null,this.i=c||null,this.j=!!g}function B(c){c.g||(c.g=new Map,c.h=0,c.i&&Ga(c.i,function(g,x){c.add(decodeURIComponent(g.replace(/\+/g," ")),x)}))}n=A.prototype,n.add=function(c,g){B(this),this.i=null,c=N(this,c);let x=this.g.get(c);return x||this.g.set(c,x=[]),x.push(g),this.h+=1,this};function re(c,g){B(c),g=N(c,g),c.g.has(g)&&(c.i=null,c.h-=c.g.get(g).length,c.g.delete(g))}function $(c,g){return B(c),g=N(c,g),c.g.has(g)}n.forEach=function(c,g){B(this),this.g.forEach(function(x,w){x.forEach(function(H){c.call(g,H,w,this)},this)},this)};function W(c,g){B(c);let x=[];if(typeof g=="string")$(c,g)&&(x=x.concat(c.g.get(N(c,g))));else for(c=Array.from(c.g.values()),g=0;g<c.length;g++)x=x.concat(c[g]);return x}n.set=function(c,g){return B(this),this.i=null,c=N(this,c),$(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[g]),this.h+=1,this},n.get=function(c,g){return c?(c=W(this,c),c.length>0?String(c[0]):g):g};function F(c,g,x){re(c,g),x.length>0&&(c.i=null,c.g.set(N(c,g),R(x)),c.h+=x.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const c=[],g=Array.from(this.g.keys());for(let w=0;w<g.length;w++){var x=g[w];const H=Mr(x);x=W(this,x);for(let ne=0;ne<x.length;ne++){let Ve=H;x[ne]!==""&&(Ve+="="+Mr(x[ne])),c.push(Ve)}}return this.i=c.join("&")};function te(c){const g=new A;return g.i=c.i,c.g&&(g.g=new Map(c.g),g.h=c.h),g}function N(c,g){return g=String(g),c.j&&(g=g.toLowerCase()),g}function C(c,g){g&&!c.j&&(B(c),c.i=null,c.g.forEach(function(x,w){const H=w.toLowerCase();w!=H&&(re(this,w),F(this,H,x))},c)),c.j=g}function q(c,g){const x=new ur;if(h.Image){const w=new Image;w.onload=E(le,x,"TestLoadImage: loaded",!0,g,w),w.onerror=E(le,x,"TestLoadImage: error",!1,g,w),w.onabort=E(le,x,"TestLoadImage: abort",!1,g,w),w.ontimeout=E(le,x,"TestLoadImage: timeout",!1,g,w),h.setTimeout(function(){w.ontimeout&&w.ontimeout()},1e4),w.src=c}else g(!1)}function ae(c,g){const x=new ur,w=new AbortController,H=setTimeout(()=>{w.abort(),le(x,"TestPingServer: timeout",!1,g)},1e4);fetch(c,{signal:w.signal}).then(ne=>{clearTimeout(H),ne.ok?le(x,"TestPingServer: ok",!0,g):le(x,"TestPingServer: server error",!1,g)}).catch(()=>{clearTimeout(H),le(x,"TestPingServer: error",!1,g)})}function le(c,g,x,w,H){try{H&&(H.onload=null,H.onerror=null,H.onabort=null,H.ontimeout=null),w(x)}catch(ne){}}function ue(){this.g=new Pl}function Ee(c){this.i=c.Sb||null,this.h=c.ab||!1}D(Ee,Ro),Ee.prototype.g=function(){return new Te(this.i,this.h)};function Te(c,g){Zt.call(this),this.H=c,this.o=g,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}D(Te,Zt),n=Te.prototype,n.open=function(c,g){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=c,this.D=g,this.readyState=1,me(this)},n.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const g={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};c&&(g.body=c),(this.H||h).fetch(new Request(this.D,g)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,ge(this)),this.readyState=0},n.Pa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,me(this)),this.g&&(this.readyState=3,me(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof h.ReadableStream!="undefined"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;se(this)}else c.text().then(this.Oa.bind(this),this.ga.bind(this))};function se(c){c.j.read().then(c.Ma.bind(c)).catch(c.ga.bind(c))}n.Ma=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var g=c.value?c.value:new Uint8Array(0);(g=this.B.decode(g,{stream:!c.done}))&&(this.response=this.responseText+=g)}c.done?ge(this):me(this),this.readyState==3&&se(this)}},n.Oa=function(c){this.g&&(this.response=this.responseText=c,ge(this))},n.Na=function(c){this.g&&(this.response=c,ge(this))},n.ga=function(){this.g&&ge(this)};function ge(c){c.readyState=4,c.l=null,c.j=null,c.B=null,me(c)}n.setRequestHeader=function(c,g){this.A.append(c,g)},n.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const c=[],g=this.h.entries();for(var x=g.next();!x.done;)x=x.value,c.push(x[0]+": "+x[1]),x=g.next();return c.join(`\r
`)};function me(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(Te.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function ce(c){let g="";return Ie(c,function(x,w){g+=w,g+=":",g+=x,g+=`\r
`}),g}function je(c,g,x){e:{for(w in x){var w=!1;break e}w=!0}w||(x=ce(x),typeof c=="string"?x!=null&&Mr(x):Dt(c,g,x))}function ve(c){Zt.call(this),this.headers=new Map,this.L=c||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}D(ve,Zt);var $e=/^https?$/i,We=["POST","PUT"];n=ve.prototype,n.Fa=function(c){this.H=c},n.ea=function(c,g,x,w){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);g=g?g.toUpperCase():"GET",this.D=c,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():hr.g(),this.g.onreadystatechange=_(v(this.Ca,this));try{this.B=!0,this.g.open(g,String(c),!0),this.B=!1}catch(ne){Ce(this,ne);return}if(c=x||"",x=new Map(this.headers),w)if(Object.getPrototypeOf(w)===Object.prototype)for(var H in w)x.set(H,w[H]);else if(typeof w.keys=="function"&&typeof w.get=="function")for(const ne of w.keys())x.set(ne,w.get(ne));else throw Error("Unknown input type for opt_headers: "+String(w));w=Array.from(x.keys()).find(ne=>ne.toLowerCase()=="content-type"),H=h.FormData&&c instanceof h.FormData,!(Array.prototype.indexOf.call(We,g,void 0)>=0)||w||H||x.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ne,Ve]of x)this.g.setRequestHeader(ne,Ve);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(c),this.v=!1}catch(ne){Ce(this,ne)}};function Ce(c,g){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=g,c.o=5,Fe(c),Ye(c)}function Fe(c){c.A||(c.A=!0,ls(c,"complete"),ls(c,"error"))}n.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=c||7,ls(this,"complete"),ls(this,"abort"),Ye(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ye(this,!0)),ve.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Ze(this):this.Xa())},n.Xa=function(){Ze(this)};function Ze(c){if(c.h&&typeof d!="undefined"){if(c.v&&ut(c)==4)setTimeout(c.Ca.bind(c),0);else if(ls(c,"readystatechange"),ut(c)==4){c.h=!1;try{const ne=c.ca();e:switch(ne){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var g=!0;break e;default:g=!1}var x;if(!(x=g)){var w;if(w=ne===0){let Ve=String(c.D).match(pi)[1]||null;!Ve&&h.self&&h.self.location&&(Ve=h.self.location.protocol.slice(0,-1)),w=!$e.test(Ve?Ve.toLowerCase():"")}x=w}if(x)ls(c,"complete"),ls(c,"success");else{c.o=6;try{var H=ut(c)>2?c.g.statusText:""}catch(Ve){H=""}c.l=H+" ["+c.ca()+"]",Fe(c)}}finally{Ye(c)}}}}function Ye(c,g){if(c.g){c.m&&(clearTimeout(c.m),c.m=null);const x=c.g;c.g=null,g||ls(c,"ready");try{x.onreadystatechange=null}catch(w){}}}n.isActive=function(){return!!this.g};function ut(c){return c.g?c.g.readyState:0}n.ca=function(){try{return ut(this)>2?this.g.status:-1}catch(c){return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch(c){return""}},n.La=function(c){if(this.g){var g=this.g.responseText;return c&&g.indexOf(c)==0&&(g=g.substring(c.length)),Rs(g)}};function It(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.F){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch(g){return null}}function Js(c){const g={};c=(c.g&&ut(c)>=2&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let w=0;w<c.length;w++){if(J(c[w]))continue;var x=Do(c[w]);const H=x[0];if(x=x[1],typeof x!="string")continue;x=x.trim();const ne=g[H]||[];g[H]=ne,ne.push(x)}Ge(g,function(w){return w.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Mt(c,g,x){return x&&x.internalChannelParams&&x.internalChannelParams[c]||g}function Ot(c){this.za=0,this.i=[],this.j=new ur,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Mt("failFast",!1,c),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Mt("baseRetryDelayMs",5e3,c),this.Za=Mt("retryDelaySeedMs",1e4,c),this.Ta=Mt("forwardChannelMaxRetries",2,c),this.va=Mt("forwardChannelRequestTimeoutMs",2e4,c),this.ma=c&&c.xmlHttpFactory||void 0,this.Ua=c&&c.Rb||void 0,this.Aa=c&&c.useFetchStreams||!1,this.O=void 0,this.L=c&&c.supportsCrossDomainXhr||!1,this.M="",this.h=new mi(c&&c.concurrentRequestLimit),this.Ba=new ue,this.S=c&&c.fastHandshake||!1,this.R=c&&c.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=c&&c.Pb||!1,c&&c.ua&&this.j.ua(),c&&c.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&c&&c.detectBufferingProxy||!1,this.ia=void 0,c&&c.longPollingTimeout&&c.longPollingTimeout>0&&(this.ia=c.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Ot.prototype,n.ka=8,n.I=1,n.connect=function(c,g,x,w){es(0),this.W=c,this.H=g||{},x&&w!==void 0&&(this.H.OSID=x,this.H.OAID=w),this.F=this.X,this.J=Ji(this,null,this.W),Zs(this)};function $t(c){if(ws(c),c.I==3){var g=c.V++,x=Xt(c.J);if(Dt(x,"SID",c.M),Dt(x,"RID",g),Dt(x,"TYPE","terminate"),en(c,x),g=new an(c,c.j,g),g.M=2,g.A=Gn(Xt(x)),x=!1,h.navigator&&h.navigator.sendBeacon)try{x=h.navigator.sendBeacon(g.A.toString(),"")}catch(w){}!x&&h.Image&&(new Image().src=g.A,x=!0),x||(g.g=Qn(g.j,null),g.g.ea(g.A)),g.F=Date.now(),hi(g)}$a(c)}function cs(c){c.g&&(jn(c),c.g.cancel(),c.g=null)}function ws(c){cs(c),c.v&&(h.clearTimeout(c.v),c.v=null),Xi(c),c.h.cancel(),c.m&&(typeof c.m=="number"&&h.clearTimeout(c.m),c.m=null)}function Zs(c){if(!Lr(c.h)&&!c.m){c.m=!0;var g=c.Ea;Ne||V(),De||(Ne(),De=!0),G.add(g,c),c.D=0}}function xi(c,g){return Ys(c.h)>=c.h.j-(c.m?1:0)?!1:c.m?(c.i=g.G.concat(c.i),!0):c.I==1||c.I==2||c.D>=(c.Sa?0:c.Ta)?!1:(c.m=cr(v(c.Ea,c,g),vi(c,c.D)),c.D++,!0)}n.Ea=function(c){if(this.m)if(this.m=null,this.I==1){if(!c){this.V=Math.floor(Math.random()*1e5),c=this.V++;const H=new an(this,this.j,c);let ne=this.o;if(this.U&&(ne?(ne=bt(ne),yt(ne,this.U)):ne=this.U),this.u!==null||this.R||(H.J=ne,ne=null),this.S)e:{for(var g=0,x=0;x<this.i.length;x++){t:{var w=this.i[x];if("__data__"in w.map&&(w=w.map.__data__,typeof w=="string")){w=w.length;break t}w=void 0}if(w===void 0)break;if(g+=w,g>4096){g=x;break e}if(g===4096||x===this.i.length-1){g=x+1;break e}}g=1e3}else g=1e3;g=En(this,H,g),x=Xt(this.J),Dt(x,"RID",c),Dt(x,"CVER",22),this.G&&Dt(x,"X-HTTP-Session-Id",this.G),en(this,x),ne&&(this.R?g="headers="+Mr(ce(ne))+"&"+g:this.u&&je(x,this.u,ne)),gi(this.h,H),this.Ra&&Dt(x,"TYPE","init"),this.S?(Dt(x,"$req",g),Dt(x,"SID","null"),H.U=!0,qn(H,x,null)):qn(H,x,g),this.I=2}}else this.I==3&&(c?Sn(this,c):this.i.length==0||Lr(this.h)||Sn(this))};function Sn(c,g){var x;g?x=g.l:x=c.V++;const w=Xt(c.J);Dt(w,"SID",c.M),Dt(w,"RID",x),Dt(w,"AID",c.K),en(c,w),c.u&&c.o&&je(w,c.u,c.o),x=new an(c,c.j,x,c.D+1),c.u===null&&(x.J=c.o),g&&(c.i=g.G.concat(c.i)),g=En(c,x,1e3),x.H=Math.round(c.va*.5)+Math.round(c.va*.5*Math.random()),gi(c.h,x),qn(x,w,g)}function en(c,g){c.H&&Ie(c.H,function(x,w){Dt(g,w,x)}),c.l&&Ie({},function(x,w){Dt(g,w,x)})}function En(c,g,x){x=Math.min(c.i.length,x);const w=c.l?v(c.l.Ka,c.l,c):null;e:{var H=c.i;let Xe=-1;for(;;){const at=["count="+x];Xe==-1?x>0?(Xe=H[0].g,at.push("ofs="+Xe)):Xe=0:at.push("ofs="+Xe);let st=!0;for(let gt=0;gt<x;gt++){var ne=H[gt].g;const Tn=H[gt].map;if(ne-=Xe,ne<0)Xe=Math.max(0,H[gt].g-100),st=!1;else try{ne="req"+ne+"_"||"";try{var Ve=Tn instanceof Map?Tn:Object.entries(Tn);for(const[zr,vr]of Ve){let _r=vr;f(vr)&&(_r=rn(vr)),at.push(ne+zr+"="+encodeURIComponent(_r))}}catch(zr){throw at.push(ne+"type="+encodeURIComponent("_badmap")),zr}}catch(zr){w&&w(Tn)}}if(st){Ve=at.join("&");break e}}Ve=void 0}return c=c.i.splice(0,x),g.G=c,Ve}function Br(c){if(!c.g&&!c.v){c.Y=1;var g=c.Da;Ne||V(),De||(Ne(),De=!0),G.add(g,c),c.A=0}}function bi(c){return c.g||c.v||c.A>=3?!1:(c.Y++,c.v=cr(v(c.Da,c),vi(c,c.A)),c.A++,!0)}n.Da=function(){if(this.v=null,xr(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var c=4*this.T;this.j.info("BP detection timer enabled: "+c),this.B=cr(v(this.Wa,this),c)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,es(10),cs(this),xr(this))};function jn(c){c.B!=null&&(h.clearTimeout(c.B),c.B=null)}function xr(c){c.g=new an(c,c.j,"rpc",c.Y),c.u===null&&(c.g.J=c.o),c.g.P=0;var g=Xt(c.na);Dt(g,"RID","rpc"),Dt(g,"SID",c.M),Dt(g,"AID",c.K),Dt(g,"CI",c.F?"0":"1"),!c.F&&c.ia&&Dt(g,"TO",c.ia),Dt(g,"TYPE","xmlhttp"),en(c,g),c.u&&c.o&&je(g,c.u,c.o),c.O&&(c.g.H=c.O);var x=c.g;c=c.ba,x.M=1,x.A=Gn(Xt(g)),x.u=null,x.R=!0,fr(x,c)}n.Va=function(){this.C!=null&&(this.C=null,cs(this),bi(this),es(19))};function Xi(c){c.C!=null&&(h.clearTimeout(c.C),c.C=null)}function Wi(c,g){var x=null;if(c.g==g){Xi(c),jn(c),c.g=null;var w=2}else if(Xs(c.h,g))x=g.G,pr(c.h,g),w=1;else return;if(c.I!=0){if(g.o)if(w==1){x=g.u?g.u.length:0,g=Date.now()-g.F;var H=c.D;w=li(),ls(w,new qa(w,x)),Zs(c)}else Br(c);else if(H=g.m,H==3||H==0&&g.X>0||!(w==1&&xi(c,g)||w==2&&bi(c)))switch(x&&x.length>0&&(g=c.h,g.i=g.i.concat(x)),H){case 1:$n(c,5);break;case 4:$n(c,10);break;case 3:$n(c,6);break;default:$n(c,2)}}}function vi(c,g){let x=c.Qa+Math.floor(Math.random()*c.Za);return c.isActive()||(x*=2),x*g}function $n(c,g){if(c.j.info("Error code "+g),g==2){var x=v(c.bb,c),w=c.Ua;const H=!w;w=new on(w||"//www.google.com/images/cleardot.gif"),h.location&&h.location.protocol=="http"||Ws(w,"https"),Gn(w),H?q(w.toString(),x):ae(w.toString(),x)}else es(2);c.I=0,c.l&&c.l.pa(g),$a(c),ws(c)}n.bb=function(c){c?(this.j.info("Successfully pinged google.com"),es(2)):(this.j.info("Failed to ping google.com"),es(1))};function $a(c){if(c.I=0,c.ja=[],c.l){const g=Vr(c.h);(g.length!=0||c.i.length!=0)&&(U(c.ja,g),U(c.ja,c.i),c.h.i.length=0,R(c.i),c.i.length=0),c.l.oa()}}function Ji(c,g,x){var w=x instanceof on?Xt(x):new on(x);if(w.g!="")g&&(w.g=g+"."+w.g),Ur(w,w.u);else{var H=h.location;w=H.protocol,g=g?g+"."+H.hostname:H.hostname,H=+H.port;const ne=new on(null);w&&Ws(ne,w),g&&(ne.g=g),H&&Ur(ne,H),x&&(ne.h=x),w=ne}return x=c.G,g=c.wa,x&&g&&Dt(w,x,g),Dt(w,"VER",c.ka),en(c,w),w}function Qn(c,g,x){if(g&&!c.L)throw Error("Can't create secondary domain capable XhrIo object.");return g=c.Aa&&!c.ma?new ve(new Ee({ab:x})):new ve(c.ma),g.Fa(c.L),g}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Bs(){}n=Bs.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function br(){}br.prototype.g=function(c,g){return new Ds(c,g)};function Ds(c,g){Zt.call(this),this.g=new Ot(g),this.l=c,this.h=g&&g.messageUrlParams||null,c=g&&g.messageHeaders||null,g&&g.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=g&&g.initMessageHeaders||null,g&&g.messageContentType&&(c?c["X-WebChannel-Content-Type"]=g.messageContentType:c={"X-WebChannel-Content-Type":g.messageContentType}),g&&g.sa&&(c?c["X-WebChannel-Client-Profile"]=g.sa:c={"X-WebChannel-Client-Profile":g.sa}),this.g.U=c,(c=g&&g.Qb)&&!J(c)&&(this.g.u=c),this.A=g&&g.supportsCrossDomainXhr||!1,this.v=g&&g.sendRawJson||!1,(g=g&&g.httpSessionIdParam)&&!J(g)&&(this.g.G=g,c=this.h,c!==null&&g in c&&(c=this.h,g in c&&delete c[g])),this.j=new y(this)}D(Ds,Zt),Ds.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Ds.prototype.close=function(){$t(this.g)},Ds.prototype.o=function(c){var g=this.g;if(typeof c=="string"){var x={};x.__data__=c,c=x}else this.v&&(x={},x.__data__=rn(c),c=x);g.i.push(new Ll(g.Ya++,c)),g.I==3&&Zs(g)},Ds.prototype.N=function(){this.g.l=null,delete this.j,$t(this.g),delete this.g,Ds.Z.N.call(this)};function tn(c){lr.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var g=c.__sm__;if(g){e:{for(const x in g){c=x;break e}c=void 0}(this.i=c)&&(c=this.i,g=g!==null&&c in g?g[c]:void 0),this.data=g}else this.data=c}D(tn,lr);function Qa(){vn.call(this),this.status=1}D(Qa,vn);function y(c){this.g=c}D(y,Bs),y.prototype.ra=function(){ls(this.g,"a")},y.prototype.qa=function(c){ls(this.g,new tn(c))},y.prototype.pa=function(c){ls(this.g,new Qa)},y.prototype.oa=function(){ls(this.g,"b")},br.prototype.createWebChannel=br.prototype.g,Ds.prototype.send=Ds.prototype.o,Ds.prototype.open=Ds.prototype.m,Ds.prototype.close=Ds.prototype.close,V_=function(){return new br},L_=function(){return li()},P_=Qs,Xm={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},ts.NO_ERROR=0,ts.TIMEOUT=8,ts.HTTP_ERROR=6,Dd=ts,_s.COMPLETE="complete",M_=_s,Ki.EventType=bn,bn.OPEN="a",bn.CLOSE="b",bn.ERROR="c",bn.MESSAGE="d",Zt.prototype.listen=Zt.prototype.J,Dc=Ki,ve.prototype.listenOnce=ve.prototype.K,ve.prototype.getLastError=ve.prototype.Ha,ve.prototype.getLastErrorCode=ve.prototype.ya,ve.prototype.getStatus=ve.prototype.ca,ve.prototype.getResponseJson=ve.prototype.La,ve.prototype.getResponseText=ve.prototype.la,ve.prototype.send=ve.prototype.ea,ve.prototype.setWithCredentials=ve.prototype.Fa,k_=ve}).apply(typeof xd!="undefined"?xd:typeof self!="undefined"?self:typeof window!="undefined"?window:{});const vb="@firebase/firestore",_b="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hs{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Hs.UNAUTHENTICATED=new Hs(null),Hs.GOOGLE_CREDENTIALS=new Hs("google-credentials-uid"),Hs.FIRST_PARTY=new Hs("first-party-uid"),Hs.MOCK_USER=new Hs("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Il="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vo=new wg("@firebase/firestore");function ll(){return vo.logLevel}function He(n,...e){if(vo.logLevel<=St.DEBUG){const s=e.map(kg);vo.debug(`Firestore (${Il}): ${n}`,...s)}}function qi(n,...e){if(vo.logLevel<=St.ERROR){const s=e.map(kg);vo.error(`Firestore (${Il}): ${n}`,...s)}}function Nl(n,...e){if(vo.logLevel<=St.WARN){const s=e.map(kg);vo.warn(`Firestore (${Il}): ${n}`,...s)}}function kg(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(s){return JSON.stringify(s)})(n)}catch(e){return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ct(n,e,s){let a="Unexpected state";typeof e=="string"?a=e:s=e,U_(n,a,s)}function U_(n,e,s){let a=`FIRESTORE (${Il}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(s!==void 0)try{a+=" CONTEXT: "+JSON.stringify(s)}catch(l){a+=" CONTEXT: "+s}throw qi(a),new Error(a)}function Pt(n,e,s,a){let l="Unexpected state";typeof s=="string"?l=s:a=s,n||U_(e,l,a)}function mt(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ke={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class qe extends ii{constructor(e,s){super(e,s),this.code=e,this.message=s,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Li{constructor(){this.promise=new Promise(((e,s)=>{this.resolve=e,this.reject=s}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B_{constructor(e,s){this.user=s,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class OT{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,s){e.enqueueRetryable((()=>s(Hs.UNAUTHENTICATED)))}shutdown(){}}class kT{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,s){this.changeListener=s,e.enqueueRetryable((()=>s(this.token.user)))}shutdown(){this.changeListener=null}}class MT{constructor(e){this.t=e,this.currentUser=Hs.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,s){Pt(this.o===void 0,42304);let a=this.i;const l=b=>this.i!==a?(a=this.i,s(b)):Promise.resolve();let d=new Li;this.o=()=>{this.i++,this.currentUser=this.u(),d.resolve(),d=new Li,e.enqueueRetryable((()=>l(this.currentUser)))};const h=()=>{const b=d;e.enqueueRetryable((()=>K(this,null,function*(){yield b.promise,yield l(this.currentUser)})))},f=b=>{He("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=b,this.o&&(this.auth.addAuthTokenListener(this.o),h())};this.t.onInit((b=>f(b))),setTimeout((()=>{if(!this.auth){const b=this.t.getImmediate({optional:!0});b?f(b):(He("FirebaseAuthCredentialsProvider","Auth not yet detected"),d.resolve(),d=new Li)}}),0),h()}getToken(){const e=this.i,s=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(s).then((a=>this.i!==e?(He("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):a?(Pt(typeof a.accessToken=="string",31837,{l:a}),new B_(a.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Pt(e===null||typeof e=="string",2055,{h:e}),new Hs(e)}}class PT{constructor(e,s,a){this.P=e,this.T=s,this.I=a,this.type="FirstParty",this.user=Hs.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class LT{constructor(e,s,a){this.P=e,this.T=s,this.I=a}getToken(){return Promise.resolve(new PT(this.P,this.T,this.I))}start(e,s){e.enqueueRetryable((()=>s(Hs.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class wb{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class VT{constructor(e,s){this.V=s,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,jr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,s){Pt(this.o===void 0,3512);const a=d=>{d.error!=null&&He("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${d.error.message}`);const h=d.token!==this.m;return this.m=d.token,He("FirebaseAppCheckTokenProvider",`Received ${h?"new":"existing"} token.`),h?s(d.token):Promise.resolve()};this.o=d=>{e.enqueueRetryable((()=>a(d)))};const l=d=>{He("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=d,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((d=>l(d))),setTimeout((()=>{if(!this.appCheck){const d=this.V.getImmediate({optional:!0});d?l(d):He("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new wb(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((s=>s?(Pt(typeof s.token=="string",44558,{tokenResult:s}),this.m=s.token,new wb(s.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UT(n){const e=typeof self!="undefined"&&(self.crypto||self.msCrypto),s=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(s);else for(let a=0;a<n;a++)s[a]=Math.floor(256*Math.random());return s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mg{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",s=62*Math.floor(4.129032258064516);let a="";for(;a.length<20;){const l=UT(40);for(let d=0;d<l.length;++d)a.length<20&&l[d]<s&&(a+=e.charAt(l[d]%62))}return a}}function Et(n,e){return n<e?-1:n>e?1:0}function Wm(n,e){const s=Math.min(n.length,e.length);for(let a=0;a<s;a++){const l=n.charAt(a),d=e.charAt(a);if(l!==d)return Im(l)===Im(d)?Et(l,d):Im(l)?1:-1}return Et(n.length,e.length)}const BT=55296,zT=57343;function Im(n){const e=n.charCodeAt(0);return e>=BT&&e<=zT}function Sl(n,e,s){return n.length===e.length&&n.every(((a,l)=>s(a,e[l])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nb="__name__";class Qr{constructor(e,s,a){s===void 0?s=0:s>e.length&&ct(637,{offset:s,range:e.length}),a===void 0?a=e.length-s:a>e.length-s&&ct(1746,{length:a,range:e.length-s}),this.segments=e,this.offset=s,this.len=a}get length(){return this.len}isEqual(e){return Qr.comparator(this,e)===0}child(e){const s=this.segments.slice(this.offset,this.limit());return e instanceof Qr?e.forEach((a=>{s.push(a)})):s.push(e),this.construct(s)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let s=0;s<this.length;s++)if(this.get(s)!==e.get(s))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let s=0;s<this.length;s++)if(this.get(s)!==e.get(s))return!1;return!0}forEach(e){for(let s=this.offset,a=this.limit();s<a;s++)e(this.segments[s])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,s){const a=Math.min(e.length,s.length);for(let l=0;l<a;l++){const d=Qr.compareSegments(e.get(l),s.get(l));if(d!==0)return d}return Et(e.length,s.length)}static compareSegments(e,s){const a=Qr.isNumericId(e),l=Qr.isNumericId(s);return a&&!l?-1:!a&&l?1:a&&l?Qr.extractNumericId(e).compare(Qr.extractNumericId(s)):Wm(e,s)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ia.fromString(e.substring(4,e.length-2))}}class Yt extends Qr{construct(e,s,a){return new Yt(e,s,a)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const s=[];for(const a of e){if(a.indexOf("//")>=0)throw new qe(ke.INVALID_ARGUMENT,`Invalid segment (${a}). Paths must not contain // in them.`);s.push(...a.split("/").filter((l=>l.length>0)))}return new Yt(s)}static emptyPath(){return new Yt([])}}const FT=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ls extends Qr{construct(e,s,a){return new Ls(e,s,a)}static isValidIdentifier(e){return FT.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ls.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Nb}static keyField(){return new Ls([Nb])}static fromServerFormat(e){const s=[];let a="",l=0;const d=()=>{if(a.length===0)throw new qe(ke.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);s.push(a),a=""};let h=!1;for(;l<e.length;){const f=e[l];if(f==="\\"){if(l+1===e.length)throw new qe(ke.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const b=e[l+1];if(b!=="\\"&&b!=="."&&b!=="`")throw new qe(ke.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);a+=b,l+=2}else f==="`"?(h=!h,l++):f!=="."||h?(a+=f,l++):(d(),l++)}if(d(),h)throw new qe(ke.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ls(s)}static emptyPath(){return new Ls([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nt{constructor(e){this.path=e}static fromPath(e){return new nt(Yt.fromString(e))}static fromName(e){return new nt(Yt.fromString(e).popFirst(5))}static empty(){return new nt(Yt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Yt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,s){return Yt.comparator(e.path,s.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new nt(new Yt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z_(n,e,s){if(!s)throw new qe(ke.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function qT(n,e,s,a){if(e===!0&&a===!0)throw new qe(ke.INVALID_ARGUMENT,`${n} and ${s} cannot be used together.`)}function Sb(n){if(!nt.isDocumentKey(n))throw new qe(ke.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Eb(n){if(nt.isDocumentKey(n))throw new qe(ke.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function F_(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function dh(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(a){return a.constructor?a.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":ct(12329,{type:typeof n})}function _o(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new qe(ke.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const s=dh(n);throw new qe(ke.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${s}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xs(n,e){const s={typeString:n};return e&&(s.value=e),s}function lu(n,e){if(!F_(n))throw new qe(ke.INVALID_ARGUMENT,"JSON must be an object");let s;for(const a in e)if(e[a]){const l=e[a].typeString,d="value"in e[a]?{value:e[a].value}:void 0;if(!(a in n)){s=`JSON missing required field: '${a}'`;break}const h=n[a];if(l&&typeof h!==l){s=`JSON field '${a}' must be a ${l}.`;break}if(d!==void 0&&h!==d.value){s=`Expected '${a}' field to equal '${d.value}'`;break}}if(s)throw new qe(ke.INVALID_ARGUMENT,s);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jb=-62135596800,Tb=1e6;class Bt{static now(){return Bt.fromMillis(Date.now())}static fromDate(e){return Bt.fromMillis(e.getTime())}static fromMillis(e){const s=Math.floor(e/1e3),a=Math.floor((e-1e3*s)*Tb);return new Bt(s,a)}constructor(e,s){if(this.seconds=e,this.nanoseconds=s,s<0)throw new qe(ke.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+s);if(s>=1e9)throw new qe(ke.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+s);if(e<jb)throw new qe(ke.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new qe(ke.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Tb}_compareTo(e){return this.seconds===e.seconds?Et(this.nanoseconds,e.nanoseconds):Et(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Bt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(lu(e,Bt._jsonSchema))return new Bt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-jb;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Bt._jsonSchemaVersion="firestore/timestamp/1.0",Bt._jsonSchema={type:xs("string",Bt._jsonSchemaVersion),seconds:xs("number"),nanoseconds:xs("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ft{static fromTimestamp(e){return new ft(e)}static min(){return new ft(new Bt(0,0))}static max(){return new ft(new Bt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kc=-1;function HT(n,e){const s=n.toTimestamp().seconds,a=n.toTimestamp().nanoseconds+1,l=ft.fromTimestamp(a===1e9?new Bt(s+1,0):new Bt(s,a));return new Oa(l,nt.empty(),e)}function GT(n){return new Oa(n.readTime,n.key,Kc)}class Oa{constructor(e,s,a){this.readTime=e,this.documentKey=s,this.largestBatchId=a}static min(){return new Oa(ft.min(),nt.empty(),Kc)}static max(){return new Oa(ft.max(),nt.empty(),Kc)}}function $T(n,e){let s=n.readTime.compareTo(e.readTime);return s!==0?s:(s=nt.comparator(n.documentKey,e.documentKey),s!==0?s:Et(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QT="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class KT{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rl(n){return K(this,null,function*(){if(n.code!==ke.FAILED_PRECONDITION||n.message!==QT)throw n;He("LocalStore","Unexpectedly lost primary lease")})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Le{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((s=>{this.isDone=!0,this.result=s,this.nextCallback&&this.nextCallback(s)}),(s=>{this.isDone=!0,this.error=s,this.catchCallback&&this.catchCallback(s)}))}catch(e){return this.next(void 0,e)}next(e,s){return this.callbackAttached&&ct(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(s,this.error):this.wrapSuccess(e,this.result):new Le(((a,l)=>{this.nextCallback=d=>{this.wrapSuccess(e,d).next(a,l)},this.catchCallback=d=>{this.wrapFailure(s,d).next(a,l)}}))}toPromise(){return new Promise(((e,s)=>{this.next(e,s)}))}wrapUserFunction(e){try{const s=e();return s instanceof Le?s:Le.resolve(s)}catch(s){return Le.reject(s)}}wrapSuccess(e,s){return e?this.wrapUserFunction((()=>e(s))):Le.resolve(s)}wrapFailure(e,s){return e?this.wrapUserFunction((()=>e(s))):Le.reject(s)}static resolve(e){return new Le(((s,a)=>{s(e)}))}static reject(e){return new Le(((s,a)=>{a(e)}))}static waitFor(e){return new Le(((s,a)=>{let l=0,d=0,h=!1;e.forEach((f=>{++l,f.next((()=>{++d,h&&d===l&&s()}),(b=>a(b)))})),h=!0,d===l&&s()}))}static or(e){let s=Le.resolve(!1);for(const a of e)s=s.next((l=>l?Le.resolve(l):a()));return s}static forEach(e,s){const a=[];return e.forEach(((l,d)=>{a.push(s.call(this,l,d))})),this.waitFor(a)}static mapArray(e,s){return new Le(((a,l)=>{const d=e.length,h=new Array(d);let f=0;for(let b=0;b<d;b++){const v=b;s(e[v]).next((E=>{h[v]=E,++f,f===d&&a(h)}),(E=>l(E)))}}))}static doWhile(e,s){return new Le(((a,l)=>{const d=()=>{e()===!0?s().next((()=>{d()}),l):a()};d()}))}}function YT(n){const e=n.match(/Android ([\d.]+)/i),s=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(s)}function Dl(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hh{constructor(e,s){this.previousValue=e,s&&(s.sequenceNumberHandler=a=>this.ae(a),this.ue=a=>s.writeSequenceNumber(a))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}hh.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pg=-1;function fh(n){return n==null}function $d(n){return n===0&&1/n==-1/0}function XT(n){return typeof n=="number"&&Number.isInteger(n)&&!$d(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q_="";function WT(n){let e="";for(let s=0;s<n.length;s++)e.length>0&&(e=Ab(e)),e=JT(n.get(s),e);return Ab(e)}function JT(n,e){let s=e;const a=n.length;for(let l=0;l<a;l++){const d=n.charAt(l);switch(d){case"\0":s+="";break;case q_:s+="";break;default:s+=d}}return s}function Ab(n){return n+q_+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cb(n){let e=0;for(const s in n)Object.prototype.hasOwnProperty.call(n,s)&&e++;return e}function Eo(n,e){for(const s in n)Object.prototype.hasOwnProperty.call(n,s)&&e(s,n[s])}function H_(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rs{constructor(e,s){this.comparator=e,this.root=s||Ps.EMPTY}insert(e,s){return new rs(this.comparator,this.root.insert(e,s,this.comparator).copy(null,null,Ps.BLACK,null,null))}remove(e){return new rs(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ps.BLACK,null,null))}get(e){let s=this.root;for(;!s.isEmpty();){const a=this.comparator(e,s.key);if(a===0)return s.value;a<0?s=s.left:a>0&&(s=s.right)}return null}indexOf(e){let s=0,a=this.root;for(;!a.isEmpty();){const l=this.comparator(e,a.key);if(l===0)return s+a.left.size;l<0?a=a.left:(s+=a.left.size+1,a=a.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((s,a)=>(e(s,a),!1)))}toString(){const e=[];return this.inorderTraversal(((s,a)=>(e.push(`${s}:${a}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new bd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new bd(this.root,e,this.comparator,!1)}getReverseIterator(){return new bd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new bd(this.root,e,this.comparator,!0)}}class bd{constructor(e,s,a,l){this.isReverse=l,this.nodeStack=[];let d=1;for(;!e.isEmpty();)if(d=s?a(e.key,s):1,s&&l&&(d*=-1),d<0)e=this.isReverse?e.left:e.right;else{if(d===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const s={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return s}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ps{constructor(e,s,a,l,d){this.key=e,this.value=s,this.color=a!=null?a:Ps.RED,this.left=l!=null?l:Ps.EMPTY,this.right=d!=null?d:Ps.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,s,a,l,d){return new Ps(e!=null?e:this.key,s!=null?s:this.value,a!=null?a:this.color,l!=null?l:this.left,d!=null?d:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,s,a){let l=this;const d=a(e,l.key);return l=d<0?l.copy(null,null,null,l.left.insert(e,s,a),null):d===0?l.copy(null,s,null,null,null):l.copy(null,null,null,null,l.right.insert(e,s,a)),l.fixUp()}removeMin(){if(this.left.isEmpty())return Ps.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,s){let a,l=this;if(s(e,l.key)<0)l.left.isEmpty()||l.left.isRed()||l.left.left.isRed()||(l=l.moveRedLeft()),l=l.copy(null,null,null,l.left.remove(e,s),null);else{if(l.left.isRed()&&(l=l.rotateRight()),l.right.isEmpty()||l.right.isRed()||l.right.left.isRed()||(l=l.moveRedRight()),s(e,l.key)===0){if(l.right.isEmpty())return Ps.EMPTY;a=l.right.min(),l=l.copy(a.key,a.value,null,null,l.right.removeMin())}l=l.copy(null,null,null,null,l.right.remove(e,s))}return l.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ps.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ps.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),s=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,s)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ct(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ct(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw ct(27949);return e+(this.isRed()?0:1)}}Ps.EMPTY=null,Ps.RED=!0,Ps.BLACK=!1;Ps.EMPTY=new class{constructor(){this.size=0}get key(){throw ct(57766)}get value(){throw ct(16141)}get color(){throw ct(16727)}get left(){throw ct(29726)}get right(){throw ct(36894)}copy(e,s,a,l,d){return this}insert(e,s,a){return new Ps(e,s)}remove(e,s){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Es{constructor(e){this.comparator=e,this.data=new rs(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((s,a)=>(e(s),!1)))}forEachInRange(e,s){const a=this.data.getIteratorFrom(e[0]);for(;a.hasNext();){const l=a.getNext();if(this.comparator(l.key,e[1])>=0)return;s(l.key)}}forEachWhile(e,s){let a;for(a=s!==void 0?this.data.getIteratorFrom(s):this.data.getIterator();a.hasNext();)if(!e(a.getNext().key))return}firstAfterOrEqual(e){const s=this.data.getIteratorFrom(e);return s.hasNext()?s.getNext().key:null}getIterator(){return new Ib(this.data.getIterator())}getIteratorFrom(e){return new Ib(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let s=this;return s.size<e.size&&(s=e,e=this),e.forEach((a=>{s=s.add(a)})),s}isEqual(e){if(!(e instanceof Es)||this.size!==e.size)return!1;const s=this.data.getIterator(),a=e.data.getIterator();for(;s.hasNext();){const l=s.getNext().key,d=a.getNext().key;if(this.comparator(l,d)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((s=>{e.push(s)})),e}toString(){const e=[];return this.forEach((s=>e.push(s))),"SortedSet("+e.toString()+")"}copy(e){const s=new Es(this.comparator);return s.data=e,s}}class Ib{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ar{constructor(e){this.fields=e,e.sort(Ls.comparator)}static empty(){return new Ar([])}unionWith(e){let s=new Es(Ls.comparator);for(const a of this.fields)s=s.add(a);for(const a of e)s=s.add(a);return new Ar(s.toArray())}covers(e){for(const s of this.fields)if(s.isPrefixOf(e))return!0;return!1}isEqual(e){return Sl(this.fields,e.fields,((s,a)=>s.isEqual(a)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G_ extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vs{constructor(e){this.binaryString=e}static fromBase64String(e){const s=(function(l){try{return atob(l)}catch(d){throw typeof DOMException!="undefined"&&d instanceof DOMException?new G_("Invalid base64 string: "+d):d}})(e);return new Vs(s)}static fromUint8Array(e){const s=(function(l){let d="";for(let h=0;h<l.length;++h)d+=String.fromCharCode(l[h]);return d})(e);return new Vs(s)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(s){return btoa(s)})(this.binaryString)}toUint8Array(){return(function(s){const a=new Uint8Array(s.length);for(let l=0;l<s.length;l++)a[l]=s.charCodeAt(l);return a})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Et(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Vs.EMPTY_BYTE_STRING=new Vs("");const ZT=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ka(n){if(Pt(!!n,39018),typeof n=="string"){let e=0;const s=ZT.exec(n);if(Pt(!!s,46558,{timestamp:n}),s[1]){let l=s[1];l=(l+"000000000").substr(0,9),e=Number(l)}const a=new Date(n);return{seconds:Math.floor(a.getTime()/1e3),nanos:e}}return{seconds:hs(n.seconds),nanos:hs(n.nanos)}}function hs(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Ma(n){return typeof n=="string"?Vs.fromBase64String(n):Vs.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $_="server_timestamp",Q_="__type__",K_="__previous_value__",Y_="__local_write_time__";function Lg(n){var s,a;return((a=(((s=n==null?void 0:n.mapValue)==null?void 0:s.fields)||{})[Q_])==null?void 0:a.stringValue)===$_}function mh(n){const e=n.mapValue.fields[K_];return Lg(e)?mh(e):e}function Yc(n){const e=ka(n.mapValue.fields[Y_].timestampValue);return new Bt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eA{constructor(e,s,a,l,d,h,f,b,v,E){this.databaseId=e,this.appId=s,this.persistenceKey=a,this.host=l,this.ssl=d,this.forceLongPolling=h,this.autoDetectLongPolling=f,this.longPollingOptions=b,this.useFetchStreams=v,this.isUsingEmulator=E}}const Qd="(default)";class Xc{constructor(e,s){this.projectId=e,this.database=s||Qd}static empty(){return new Xc("","")}get isDefaultDatabase(){return this.database===Qd}isEqual(e){return e instanceof Xc&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X_="__type__",tA="__max__",vd={mapValue:{}},W_="__vector__",Kd="value";function Pa(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Lg(n)?4:nA(n)?9007199254740991:sA(n)?10:11:ct(28295,{value:n})}function ni(n,e){if(n===e)return!0;const s=Pa(n);if(s!==Pa(e))return!1;switch(s){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Yc(n).isEqual(Yc(e));case 3:return(function(l,d){if(typeof l.timestampValue=="string"&&typeof d.timestampValue=="string"&&l.timestampValue.length===d.timestampValue.length)return l.timestampValue===d.timestampValue;const h=ka(l.timestampValue),f=ka(d.timestampValue);return h.seconds===f.seconds&&h.nanos===f.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(l,d){return Ma(l.bytesValue).isEqual(Ma(d.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(l,d){return hs(l.geoPointValue.latitude)===hs(d.geoPointValue.latitude)&&hs(l.geoPointValue.longitude)===hs(d.geoPointValue.longitude)})(n,e);case 2:return(function(l,d){if("integerValue"in l&&"integerValue"in d)return hs(l.integerValue)===hs(d.integerValue);if("doubleValue"in l&&"doubleValue"in d){const h=hs(l.doubleValue),f=hs(d.doubleValue);return h===f?$d(h)===$d(f):isNaN(h)&&isNaN(f)}return!1})(n,e);case 9:return Sl(n.arrayValue.values||[],e.arrayValue.values||[],ni);case 10:case 11:return(function(l,d){const h=l.mapValue.fields||{},f=d.mapValue.fields||{};if(Cb(h)!==Cb(f))return!1;for(const b in h)if(h.hasOwnProperty(b)&&(f[b]===void 0||!ni(h[b],f[b])))return!1;return!0})(n,e);default:return ct(52216,{left:n})}}function Wc(n,e){return(n.values||[]).find((s=>ni(s,e)))!==void 0}function El(n,e){if(n===e)return 0;const s=Pa(n),a=Pa(e);if(s!==a)return Et(s,a);switch(s){case 0:case 9007199254740991:return 0;case 1:return Et(n.booleanValue,e.booleanValue);case 2:return(function(d,h){const f=hs(d.integerValue||d.doubleValue),b=hs(h.integerValue||h.doubleValue);return f<b?-1:f>b?1:f===b?0:isNaN(f)?isNaN(b)?0:-1:1})(n,e);case 3:return Rb(n.timestampValue,e.timestampValue);case 4:return Rb(Yc(n),Yc(e));case 5:return Wm(n.stringValue,e.stringValue);case 6:return(function(d,h){const f=Ma(d),b=Ma(h);return f.compareTo(b)})(n.bytesValue,e.bytesValue);case 7:return(function(d,h){const f=d.split("/"),b=h.split("/");for(let v=0;v<f.length&&v<b.length;v++){const E=Et(f[v],b[v]);if(E!==0)return E}return Et(f.length,b.length)})(n.referenceValue,e.referenceValue);case 8:return(function(d,h){const f=Et(hs(d.latitude),hs(h.latitude));return f!==0?f:Et(hs(d.longitude),hs(h.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return Db(n.arrayValue,e.arrayValue);case 10:return(function(d,h){var _,R,U,ie;const f=d.fields||{},b=h.fields||{},v=(_=f[Kd])==null?void 0:_.arrayValue,E=(R=b[Kd])==null?void 0:R.arrayValue,D=Et(((U=v==null?void 0:v.values)==null?void 0:U.length)||0,((ie=E==null?void 0:E.values)==null?void 0:ie.length)||0);return D!==0?D:Db(v,E)})(n.mapValue,e.mapValue);case 11:return(function(d,h){if(d===vd.mapValue&&h===vd.mapValue)return 0;if(d===vd.mapValue)return 1;if(h===vd.mapValue)return-1;const f=d.fields||{},b=Object.keys(f),v=h.fields||{},E=Object.keys(v);b.sort(),E.sort();for(let D=0;D<b.length&&D<E.length;++D){const _=Wm(b[D],E[D]);if(_!==0)return _;const R=El(f[b[D]],v[E[D]]);if(R!==0)return R}return Et(b.length,E.length)})(n.mapValue,e.mapValue);default:throw ct(23264,{he:s})}}function Rb(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Et(n,e);const s=ka(n),a=ka(e),l=Et(s.seconds,a.seconds);return l!==0?l:Et(s.nanos,a.nanos)}function Db(n,e){const s=n.values||[],a=e.values||[];for(let l=0;l<s.length&&l<a.length;++l){const d=El(s[l],a[l]);if(d)return d}return Et(s.length,a.length)}function jl(n){return Jm(n)}function Jm(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(s){const a=ka(s);return`time(${a.seconds},${a.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(s){return Ma(s).toBase64()})(n.bytesValue):"referenceValue"in n?(function(s){return nt.fromName(s).toString()})(n.referenceValue):"geoPointValue"in n?(function(s){return`geo(${s.latitude},${s.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(s){let a="[",l=!0;for(const d of s.values||[])l?l=!1:a+=",",a+=Jm(d);return a+"]"})(n.arrayValue):"mapValue"in n?(function(s){const a=Object.keys(s.fields||{}).sort();let l="{",d=!0;for(const h of a)d?d=!1:l+=",",l+=`${h}:${Jm(s.fields[h])}`;return l+"}"})(n.mapValue):ct(61005,{value:n})}function Od(n){switch(Pa(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=mh(n);return e?16+Od(e):16;case 5:return 2*n.stringValue.length;case 6:return Ma(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(a){return(a.values||[]).reduce(((l,d)=>l+Od(d)),0)})(n.arrayValue);case 10:case 11:return(function(a){let l=0;return Eo(a.fields,((d,h)=>{l+=d.length+Od(h)})),l})(n.mapValue);default:throw ct(13486,{value:n})}}function Ob(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Zm(n){return!!n&&"integerValue"in n}function Vg(n){return!!n&&"arrayValue"in n}function kb(n){return!!n&&"nullValue"in n}function Mb(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function kd(n){return!!n&&"mapValue"in n}function sA(n){var s,a;return((a=(((s=n==null?void 0:n.mapValue)==null?void 0:s.fields)||{})[X_])==null?void 0:a.stringValue)===W_}function Uc(n){if(n.geoPointValue)return{geoPointValue:X({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:X({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return Eo(n.mapValue.fields,((s,a)=>e.mapValue.fields[s]=Uc(a))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let s=0;s<(n.arrayValue.values||[]).length;++s)e.arrayValue.values[s]=Uc(n.arrayValue.values[s]);return e}return X({},n)}function nA(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===tA}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sr{constructor(e){this.value=e}static empty(){return new sr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let s=this.value;for(let a=0;a<e.length-1;++a)if(s=(s.mapValue.fields||{})[e.get(a)],!kd(s))return null;return s=(s.mapValue.fields||{})[e.lastSegment()],s||null}}set(e,s){this.getFieldsMap(e.popLast())[e.lastSegment()]=Uc(s)}setAll(e){let s=Ls.emptyPath(),a={},l=[];e.forEach(((h,f)=>{if(!s.isImmediateParentOf(f)){const b=this.getFieldsMap(s);this.applyChanges(b,a,l),a={},l=[],s=f.popLast()}h?a[f.lastSegment()]=Uc(h):l.push(f.lastSegment())}));const d=this.getFieldsMap(s);this.applyChanges(d,a,l)}delete(e){const s=this.field(e.popLast());kd(s)&&s.mapValue.fields&&delete s.mapValue.fields[e.lastSegment()]}isEqual(e){return ni(this.value,e.value)}getFieldsMap(e){let s=this.value;s.mapValue.fields||(s.mapValue={fields:{}});for(let a=0;a<e.length;++a){let l=s.mapValue.fields[e.get(a)];kd(l)&&l.mapValue.fields||(l={mapValue:{fields:{}}},s.mapValue.fields[e.get(a)]=l),s=l}return s.mapValue.fields}applyChanges(e,s,a){Eo(s,((l,d)=>e[l]=d));for(const l of a)delete e[l]}clone(){return new sr(Uc(this.value))}}function J_(n){const e=[];return Eo(n.fields,((s,a)=>{const l=new Ls([s]);if(kd(a)){const d=J_(a.mapValue).fields;if(d.length===0)e.push(l);else for(const h of d)e.push(l.child(h))}else e.push(l)})),new Ar(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gs{constructor(e,s,a,l,d,h,f){this.key=e,this.documentType=s,this.version=a,this.readTime=l,this.createTime=d,this.data=h,this.documentState=f}static newInvalidDocument(e){return new Gs(e,0,ft.min(),ft.min(),ft.min(),sr.empty(),0)}static newFoundDocument(e,s,a,l){return new Gs(e,1,s,ft.min(),a,l,0)}static newNoDocument(e,s){return new Gs(e,2,s,ft.min(),ft.min(),sr.empty(),0)}static newUnknownDocument(e,s){return new Gs(e,3,s,ft.min(),ft.min(),sr.empty(),2)}convertToFoundDocument(e,s){return!this.createTime.isEqual(ft.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=s,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=sr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=sr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ft.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Gs&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Gs(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yd{constructor(e,s){this.position=e,this.inclusive=s}}function Pb(n,e,s){let a=0;for(let l=0;l<n.position.length;l++){const d=e[l],h=n.position[l];if(d.field.isKeyField()?a=nt.comparator(nt.fromName(h.referenceValue),s.key):a=El(h,s.data.field(d.field)),d.dir==="desc"&&(a*=-1),a!==0)break}return a}function Lb(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let s=0;s<n.position.length;s++)if(!ni(n.position[s],e.position[s]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jc{constructor(e,s="asc"){this.field=e,this.dir=s}}function rA(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z_{}class ys extends Z_{constructor(e,s,a){super(),this.field=e,this.op=s,this.value=a}static create(e,s,a){return e.isKeyField()?s==="in"||s==="not-in"?this.createKeyFieldInFilter(e,s,a):new aA(e,s,a):s==="array-contains"?new cA(e,a):s==="in"?new uA(e,a):s==="not-in"?new dA(e,a):s==="array-contains-any"?new hA(e,a):new ys(e,s,a)}static createKeyFieldInFilter(e,s,a){return s==="in"?new oA(e,a):new lA(e,a)}matches(e){const s=e.data.field(this.field);return this.op==="!="?s!==null&&s.nullValue===void 0&&this.matchesComparison(El(s,this.value)):s!==null&&Pa(this.value)===Pa(s)&&this.matchesComparison(El(s,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ct(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Rr extends Z_{constructor(e,s){super(),this.filters=e,this.op=s,this.Pe=null}static create(e,s){return new Rr(e,s)}matches(e){return ew(this)?this.filters.find((s=>!s.matches(e)))===void 0:this.filters.find((s=>s.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,s)=>e.concat(s.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function ew(n){return n.op==="and"}function tw(n){return iA(n)&&ew(n)}function iA(n){for(const e of n.filters)if(e instanceof Rr)return!1;return!0}function eg(n){if(n instanceof ys)return n.field.canonicalString()+n.op.toString()+jl(n.value);if(tw(n))return n.filters.map((e=>eg(e))).join(",");{const e=n.filters.map((s=>eg(s))).join(",");return`${n.op}(${e})`}}function sw(n,e){return n instanceof ys?(function(a,l){return l instanceof ys&&a.op===l.op&&a.field.isEqual(l.field)&&ni(a.value,l.value)})(n,e):n instanceof Rr?(function(a,l){return l instanceof Rr&&a.op===l.op&&a.filters.length===l.filters.length?a.filters.reduce(((d,h,f)=>d&&sw(h,l.filters[f])),!0):!1})(n,e):void ct(19439)}function nw(n){return n instanceof ys?(function(s){return`${s.field.canonicalString()} ${s.op} ${jl(s.value)}`})(n):n instanceof Rr?(function(s){return s.op.toString()+" {"+s.getFilters().map(nw).join(" ,")+"}"})(n):"Filter"}class aA extends ys{constructor(e,s,a){super(e,s,a),this.key=nt.fromName(a.referenceValue)}matches(e){const s=nt.comparator(e.key,this.key);return this.matchesComparison(s)}}class oA extends ys{constructor(e,s){super(e,"in",s),this.keys=rw("in",s)}matches(e){return this.keys.some((s=>s.isEqual(e.key)))}}class lA extends ys{constructor(e,s){super(e,"not-in",s),this.keys=rw("not-in",s)}matches(e){return!this.keys.some((s=>s.isEqual(e.key)))}}function rw(n,e){var s;return(((s=e.arrayValue)==null?void 0:s.values)||[]).map((a=>nt.fromName(a.referenceValue)))}class cA extends ys{constructor(e,s){super(e,"array-contains",s)}matches(e){const s=e.data.field(this.field);return Vg(s)&&Wc(s.arrayValue,this.value)}}class uA extends ys{constructor(e,s){super(e,"in",s)}matches(e){const s=e.data.field(this.field);return s!==null&&Wc(this.value.arrayValue,s)}}class dA extends ys{constructor(e,s){super(e,"not-in",s)}matches(e){if(Wc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const s=e.data.field(this.field);return s!==null&&s.nullValue===void 0&&!Wc(this.value.arrayValue,s)}}class hA extends ys{constructor(e,s){super(e,"array-contains-any",s)}matches(e){const s=e.data.field(this.field);return!(!Vg(s)||!s.arrayValue.values)&&s.arrayValue.values.some((a=>Wc(this.value.arrayValue,a)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fA{constructor(e,s=null,a=[],l=[],d=null,h=null,f=null){this.path=e,this.collectionGroup=s,this.orderBy=a,this.filters=l,this.limit=d,this.startAt=h,this.endAt=f,this.Te=null}}function Vb(n,e=null,s=[],a=[],l=null,d=null,h=null){return new fA(n,e,s,a,l,d,h)}function Ug(n){const e=mt(n);if(e.Te===null){let s=e.path.canonicalString();e.collectionGroup!==null&&(s+="|cg:"+e.collectionGroup),s+="|f:",s+=e.filters.map((a=>eg(a))).join(","),s+="|ob:",s+=e.orderBy.map((a=>(function(d){return d.field.canonicalString()+d.dir})(a))).join(","),fh(e.limit)||(s+="|l:",s+=e.limit),e.startAt&&(s+="|lb:",s+=e.startAt.inclusive?"b:":"a:",s+=e.startAt.position.map((a=>jl(a))).join(",")),e.endAt&&(s+="|ub:",s+=e.endAt.inclusive?"a:":"b:",s+=e.endAt.position.map((a=>jl(a))).join(",")),e.Te=s}return e.Te}function Bg(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let s=0;s<n.orderBy.length;s++)if(!rA(n.orderBy[s],e.orderBy[s]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let s=0;s<n.filters.length;s++)if(!sw(n.filters[s],e.filters[s]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Lb(n.startAt,e.startAt)&&Lb(n.endAt,e.endAt)}function tg(n){return nt.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ol{constructor(e,s=null,a=[],l=[],d=null,h="F",f=null,b=null){this.path=e,this.collectionGroup=s,this.explicitOrderBy=a,this.filters=l,this.limit=d,this.limitType=h,this.startAt=f,this.endAt=b,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function mA(n,e,s,a,l,d,h,f){return new Ol(n,e,s,a,l,d,h,f)}function zg(n){return new Ol(n)}function Ub(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function iw(n){return n.collectionGroup!==null}function Bc(n){const e=mt(n);if(e.Ie===null){e.Ie=[];const s=new Set;for(const d of e.explicitOrderBy)e.Ie.push(d),s.add(d.field.canonicalString());const a=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(h){let f=new Es(Ls.comparator);return h.filters.forEach((b=>{b.getFlattenedFilters().forEach((v=>{v.isInequality()&&(f=f.add(v.field))}))})),f})(e).forEach((d=>{s.has(d.canonicalString())||d.isKeyField()||e.Ie.push(new Jc(d,a))})),s.has(Ls.keyField().canonicalString())||e.Ie.push(new Jc(Ls.keyField(),a))}return e.Ie}function Zr(n){const e=mt(n);return e.Ee||(e.Ee=gA(e,Bc(n))),e.Ee}function gA(n,e){if(n.limitType==="F")return Vb(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((l=>{const d=l.dir==="desc"?"asc":"desc";return new Jc(l.field,d)}));const s=n.endAt?new Yd(n.endAt.position,n.endAt.inclusive):null,a=n.startAt?new Yd(n.startAt.position,n.startAt.inclusive):null;return Vb(n.path,n.collectionGroup,e,n.filters,n.limit,s,a)}}function sg(n,e){const s=n.filters.concat([e]);return new Ol(n.path,n.collectionGroup,n.explicitOrderBy.slice(),s,n.limit,n.limitType,n.startAt,n.endAt)}function ng(n,e,s){return new Ol(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,s,n.startAt,n.endAt)}function gh(n,e){return Bg(Zr(n),Zr(e))&&n.limitType===e.limitType}function aw(n){return`${Ug(Zr(n))}|lt:${n.limitType}`}function cl(n){return`Query(target=${(function(s){let a=s.path.canonicalString();return s.collectionGroup!==null&&(a+=" collectionGroup="+s.collectionGroup),s.filters.length>0&&(a+=`, filters: [${s.filters.map((l=>nw(l))).join(", ")}]`),fh(s.limit)||(a+=", limit: "+s.limit),s.orderBy.length>0&&(a+=`, orderBy: [${s.orderBy.map((l=>(function(h){return`${h.field.canonicalString()} (${h.dir})`})(l))).join(", ")}]`),s.startAt&&(a+=", startAt: ",a+=s.startAt.inclusive?"b:":"a:",a+=s.startAt.position.map((l=>jl(l))).join(",")),s.endAt&&(a+=", endAt: ",a+=s.endAt.inclusive?"a:":"b:",a+=s.endAt.position.map((l=>jl(l))).join(",")),`Target(${a})`})(Zr(n))}; limitType=${n.limitType})`}function ph(n,e){return e.isFoundDocument()&&(function(a,l){const d=l.key.path;return a.collectionGroup!==null?l.key.hasCollectionId(a.collectionGroup)&&a.path.isPrefixOf(d):nt.isDocumentKey(a.path)?a.path.isEqual(d):a.path.isImmediateParentOf(d)})(n,e)&&(function(a,l){for(const d of Bc(a))if(!d.field.isKeyField()&&l.data.field(d.field)===null)return!1;return!0})(n,e)&&(function(a,l){for(const d of a.filters)if(!d.matches(l))return!1;return!0})(n,e)&&(function(a,l){return!(a.startAt&&!(function(h,f,b){const v=Pb(h,f,b);return h.inclusive?v<=0:v<0})(a.startAt,Bc(a),l)||a.endAt&&!(function(h,f,b){const v=Pb(h,f,b);return h.inclusive?v>=0:v>0})(a.endAt,Bc(a),l))})(n,e)}function pA(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function ow(n){return(e,s)=>{let a=!1;for(const l of Bc(n)){const d=yA(l,e,s);if(d!==0)return d;a=a||l.field.isKeyField()}return 0}}function yA(n,e,s){const a=n.field.isKeyField()?nt.comparator(e.key,s.key):(function(d,h,f){const b=h.data.field(d),v=f.data.field(d);return b!==null&&v!==null?El(b,v):ct(42886)})(n.field,e,s);switch(n.dir){case"asc":return a;case"desc":return-1*a;default:return ct(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jo{constructor(e,s){this.mapKeyFn=e,this.equalsFn=s,this.inner={},this.innerSize=0}get(e){const s=this.mapKeyFn(e),a=this.inner[s];if(a!==void 0){for(const[l,d]of a)if(this.equalsFn(l,e))return d}}has(e){return this.get(e)!==void 0}set(e,s){const a=this.mapKeyFn(e),l=this.inner[a];if(l===void 0)return this.inner[a]=[[e,s]],void this.innerSize++;for(let d=0;d<l.length;d++)if(this.equalsFn(l[d][0],e))return void(l[d]=[e,s]);l.push([e,s]),this.innerSize++}delete(e){const s=this.mapKeyFn(e),a=this.inner[s];if(a===void 0)return!1;for(let l=0;l<a.length;l++)if(this.equalsFn(a[l][0],e))return a.length===1?delete this.inner[s]:a.splice(l,1),this.innerSize--,!0;return!1}forEach(e){Eo(this.inner,((s,a)=>{for(const[l,d]of a)e(l,d)}))}isEmpty(){return H_(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xA=new rs(nt.comparator);function Hi(){return xA}const lw=new rs(nt.comparator);function Oc(...n){let e=lw;for(const s of n)e=e.insert(s.key,s);return e}function cw(n){let e=lw;return n.forEach(((s,a)=>e=e.insert(s,a.overlayedDocument))),e}function mo(){return zc()}function uw(){return zc()}function zc(){return new jo((n=>n.toString()),((n,e)=>n.isEqual(e)))}const bA=new rs(nt.comparator),vA=new Es(nt.comparator);function jt(...n){let e=vA;for(const s of n)e=e.add(s);return e}const _A=new Es(Et);function wA(){return _A}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fg(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:$d(e)?"-0":e}}function dw(n){return{integerValue:""+n}}function NA(n,e){return XT(e)?dw(e):Fg(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yh{constructor(){this._=void 0}}function SA(n,e,s){return n instanceof Xd?(function(l,d){const h={fields:{[Q_]:{stringValue:$_},[Y_]:{timestampValue:{seconds:l.seconds,nanos:l.nanoseconds}}}};return d&&Lg(d)&&(d=mh(d)),d&&(h.fields[K_]=d),{mapValue:h}})(s,e):n instanceof Zc?fw(n,e):n instanceof eu?mw(n,e):(function(l,d){const h=hw(l,d),f=Bb(h)+Bb(l.Ae);return Zm(h)&&Zm(l.Ae)?dw(f):Fg(l.serializer,f)})(n,e)}function EA(n,e,s){return n instanceof Zc?fw(n,e):n instanceof eu?mw(n,e):s}function hw(n,e){return n instanceof Wd?(function(a){return Zm(a)||(function(d){return!!d&&"doubleValue"in d})(a)})(e)?e:{integerValue:0}:null}class Xd extends yh{}class Zc extends yh{constructor(e){super(),this.elements=e}}function fw(n,e){const s=gw(e);for(const a of n.elements)s.some((l=>ni(l,a)))||s.push(a);return{arrayValue:{values:s}}}class eu extends yh{constructor(e){super(),this.elements=e}}function mw(n,e){let s=gw(e);for(const a of n.elements)s=s.filter((l=>!ni(l,a)));return{arrayValue:{values:s}}}class Wd extends yh{constructor(e,s){super(),this.serializer=e,this.Ae=s}}function Bb(n){return hs(n.integerValue||n.doubleValue)}function gw(n){return Vg(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function jA(n,e){return n.field.isEqual(e.field)&&(function(a,l){return a instanceof Zc&&l instanceof Zc||a instanceof eu&&l instanceof eu?Sl(a.elements,l.elements,ni):a instanceof Wd&&l instanceof Wd?ni(a.Ae,l.Ae):a instanceof Xd&&l instanceof Xd})(n.transform,e.transform)}class TA{constructor(e,s){this.version=e,this.transformResults=s}}class Vi{constructor(e,s){this.updateTime=e,this.exists=s}static none(){return new Vi}static exists(e){return new Vi(void 0,e)}static updateTime(e){return new Vi(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Md(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class xh{}function pw(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new xw(n.key,Vi.none()):new cu(n.key,n.data,Vi.none());{const s=n.data,a=sr.empty();let l=new Es(Ls.comparator);for(let d of e.fields)if(!l.has(d)){let h=s.field(d);h===null&&d.length>1&&(d=d.popLast(),h=s.field(d)),h===null?a.delete(d):a.set(d,h),l=l.add(d)}return new To(n.key,a,new Ar(l.toArray()),Vi.none())}}function AA(n,e,s){n instanceof cu?(function(l,d,h){const f=l.value.clone(),b=Fb(l.fieldTransforms,d,h.transformResults);f.setAll(b),d.convertToFoundDocument(h.version,f).setHasCommittedMutations()})(n,e,s):n instanceof To?(function(l,d,h){if(!Md(l.precondition,d))return void d.convertToUnknownDocument(h.version);const f=Fb(l.fieldTransforms,d,h.transformResults),b=d.data;b.setAll(yw(l)),b.setAll(f),d.convertToFoundDocument(h.version,b).setHasCommittedMutations()})(n,e,s):(function(l,d,h){d.convertToNoDocument(h.version).setHasCommittedMutations()})(0,e,s)}function Fc(n,e,s,a){return n instanceof cu?(function(d,h,f,b){if(!Md(d.precondition,h))return f;const v=d.value.clone(),E=qb(d.fieldTransforms,b,h);return v.setAll(E),h.convertToFoundDocument(h.version,v).setHasLocalMutations(),null})(n,e,s,a):n instanceof To?(function(d,h,f,b){if(!Md(d.precondition,h))return f;const v=qb(d.fieldTransforms,b,h),E=h.data;return E.setAll(yw(d)),E.setAll(v),h.convertToFoundDocument(h.version,E).setHasLocalMutations(),f===null?null:f.unionWith(d.fieldMask.fields).unionWith(d.fieldTransforms.map((D=>D.field)))})(n,e,s,a):(function(d,h,f){return Md(d.precondition,h)?(h.convertToNoDocument(h.version).setHasLocalMutations(),null):f})(n,e,s)}function CA(n,e){let s=null;for(const a of n.fieldTransforms){const l=e.data.field(a.field),d=hw(a.transform,l||null);d!=null&&(s===null&&(s=sr.empty()),s.set(a.field,d))}return s||null}function zb(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(a,l){return a===void 0&&l===void 0||!(!a||!l)&&Sl(a,l,((d,h)=>jA(d,h)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class cu extends xh{constructor(e,s,a,l=[]){super(),this.key=e,this.value=s,this.precondition=a,this.fieldTransforms=l,this.type=0}getFieldMask(){return null}}class To extends xh{constructor(e,s,a,l,d=[]){super(),this.key=e,this.data=s,this.fieldMask=a,this.precondition=l,this.fieldTransforms=d,this.type=1}getFieldMask(){return this.fieldMask}}function yw(n){const e=new Map;return n.fieldMask.fields.forEach((s=>{if(!s.isEmpty()){const a=n.data.field(s);e.set(s,a)}})),e}function Fb(n,e,s){const a=new Map;Pt(n.length===s.length,32656,{Re:s.length,Ve:n.length});for(let l=0;l<s.length;l++){const d=n[l],h=d.transform,f=e.data.field(d.field);a.set(d.field,EA(h,f,s[l]))}return a}function qb(n,e,s){const a=new Map;for(const l of n){const d=l.transform,h=s.data.field(l.field);a.set(l.field,SA(d,h,e))}return a}class xw extends xh{constructor(e,s){super(),this.key=e,this.precondition=s,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class IA extends xh{constructor(e,s){super(),this.key=e,this.precondition=s,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RA{constructor(e,s,a,l){this.batchId=e,this.localWriteTime=s,this.baseMutations=a,this.mutations=l}applyToRemoteDocument(e,s){const a=s.mutationResults;for(let l=0;l<this.mutations.length;l++){const d=this.mutations[l];d.key.isEqual(e.key)&&AA(d,e,a[l])}}applyToLocalView(e,s){for(const a of this.baseMutations)a.key.isEqual(e.key)&&(s=Fc(a,e,s,this.localWriteTime));for(const a of this.mutations)a.key.isEqual(e.key)&&(s=Fc(a,e,s,this.localWriteTime));return s}applyToLocalDocumentSet(e,s){const a=uw();return this.mutations.forEach((l=>{const d=e.get(l.key),h=d.overlayedDocument;let f=this.applyToLocalView(h,d.mutatedFields);f=s.has(l.key)?null:f;const b=pw(h,f);b!==null&&a.set(l.key,b),h.isValidDocument()||h.convertToNoDocument(ft.min())})),a}keys(){return this.mutations.reduce(((e,s)=>e.add(s.key)),jt())}isEqual(e){return this.batchId===e.batchId&&Sl(this.mutations,e.mutations,((s,a)=>zb(s,a)))&&Sl(this.baseMutations,e.baseMutations,((s,a)=>zb(s,a)))}}class qg{constructor(e,s,a,l){this.batch=e,this.commitVersion=s,this.mutationResults=a,this.docVersions=l}static from(e,s,a){Pt(e.mutations.length===a.length,58842,{me:e.mutations.length,fe:a.length});let l=(function(){return bA})();const d=e.mutations;for(let h=0;h<d.length;h++)l=l.insert(d[h].key,a[h].version);return new qg(e,s,a,l)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DA{constructor(e,s){this.largestBatchId=e,this.mutation=s}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OA{constructor(e,s){this.count=e,this.unchangedNames=s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ps,At;function kA(n){switch(n){case ke.OK:return ct(64938);case ke.CANCELLED:case ke.UNKNOWN:case ke.DEADLINE_EXCEEDED:case ke.RESOURCE_EXHAUSTED:case ke.INTERNAL:case ke.UNAVAILABLE:case ke.UNAUTHENTICATED:return!1;case ke.INVALID_ARGUMENT:case ke.NOT_FOUND:case ke.ALREADY_EXISTS:case ke.PERMISSION_DENIED:case ke.FAILED_PRECONDITION:case ke.ABORTED:case ke.OUT_OF_RANGE:case ke.UNIMPLEMENTED:case ke.DATA_LOSS:return!0;default:return ct(15467,{code:n})}}function bw(n){if(n===void 0)return qi("GRPC error has no .code"),ke.UNKNOWN;switch(n){case ps.OK:return ke.OK;case ps.CANCELLED:return ke.CANCELLED;case ps.UNKNOWN:return ke.UNKNOWN;case ps.DEADLINE_EXCEEDED:return ke.DEADLINE_EXCEEDED;case ps.RESOURCE_EXHAUSTED:return ke.RESOURCE_EXHAUSTED;case ps.INTERNAL:return ke.INTERNAL;case ps.UNAVAILABLE:return ke.UNAVAILABLE;case ps.UNAUTHENTICATED:return ke.UNAUTHENTICATED;case ps.INVALID_ARGUMENT:return ke.INVALID_ARGUMENT;case ps.NOT_FOUND:return ke.NOT_FOUND;case ps.ALREADY_EXISTS:return ke.ALREADY_EXISTS;case ps.PERMISSION_DENIED:return ke.PERMISSION_DENIED;case ps.FAILED_PRECONDITION:return ke.FAILED_PRECONDITION;case ps.ABORTED:return ke.ABORTED;case ps.OUT_OF_RANGE:return ke.OUT_OF_RANGE;case ps.UNIMPLEMENTED:return ke.UNIMPLEMENTED;case ps.DATA_LOSS:return ke.DATA_LOSS;default:return ct(39323,{code:n})}}(At=ps||(ps={}))[At.OK=0]="OK",At[At.CANCELLED=1]="CANCELLED",At[At.UNKNOWN=2]="UNKNOWN",At[At.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",At[At.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",At[At.NOT_FOUND=5]="NOT_FOUND",At[At.ALREADY_EXISTS=6]="ALREADY_EXISTS",At[At.PERMISSION_DENIED=7]="PERMISSION_DENIED",At[At.UNAUTHENTICATED=16]="UNAUTHENTICATED",At[At.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",At[At.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",At[At.ABORTED=10]="ABORTED",At[At.OUT_OF_RANGE=11]="OUT_OF_RANGE",At[At.UNIMPLEMENTED=12]="UNIMPLEMENTED",At[At.INTERNAL=13]="INTERNAL",At[At.UNAVAILABLE=14]="UNAVAILABLE",At[At.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MA(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PA=new Ia([4294967295,4294967295],0);function Hb(n){const e=MA().encode(n),s=new O_;return s.update(e),new Uint8Array(s.digest())}function Gb(n){const e=new DataView(n.buffer),s=e.getUint32(0,!0),a=e.getUint32(4,!0),l=e.getUint32(8,!0),d=e.getUint32(12,!0);return[new Ia([s,a],0),new Ia([l,d],0)]}class Hg{constructor(e,s,a){if(this.bitmap=e,this.padding=s,this.hashCount=a,s<0||s>=8)throw new kc(`Invalid padding: ${s}`);if(a<0)throw new kc(`Invalid hash count: ${a}`);if(e.length>0&&this.hashCount===0)throw new kc(`Invalid hash count: ${a}`);if(e.length===0&&s!==0)throw new kc(`Invalid padding when bitmap length is 0: ${s}`);this.ge=8*e.length-s,this.pe=Ia.fromNumber(this.ge)}ye(e,s,a){let l=e.add(s.multiply(Ia.fromNumber(a)));return l.compare(PA)===1&&(l=new Ia([l.getBits(0),l.getBits(1)],0)),l.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const s=Hb(e),[a,l]=Gb(s);for(let d=0;d<this.hashCount;d++){const h=this.ye(a,l,d);if(!this.we(h))return!1}return!0}static create(e,s,a){const l=e%8==0?0:8-e%8,d=new Uint8Array(Math.ceil(e/8)),h=new Hg(d,l,s);return a.forEach((f=>h.insert(f))),h}insert(e){if(this.ge===0)return;const s=Hb(e),[a,l]=Gb(s);for(let d=0;d<this.hashCount;d++){const h=this.ye(a,l,d);this.Se(h)}}Se(e){const s=Math.floor(e/8),a=e%8;this.bitmap[s]|=1<<a}}class kc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bh{constructor(e,s,a,l,d){this.snapshotVersion=e,this.targetChanges=s,this.targetMismatches=a,this.documentUpdates=l,this.resolvedLimboDocuments=d}static createSynthesizedRemoteEventForCurrentChange(e,s,a){const l=new Map;return l.set(e,uu.createSynthesizedTargetChangeForCurrentChange(e,s,a)),new bh(ft.min(),l,new rs(Et),Hi(),jt())}}class uu{constructor(e,s,a,l,d){this.resumeToken=e,this.current=s,this.addedDocuments=a,this.modifiedDocuments=l,this.removedDocuments=d}static createSynthesizedTargetChangeForCurrentChange(e,s,a){return new uu(a,s,jt(),jt(),jt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pd{constructor(e,s,a,l){this.be=e,this.removedTargetIds=s,this.key=a,this.De=l}}class vw{constructor(e,s){this.targetId=e,this.Ce=s}}class _w{constructor(e,s,a=Vs.EMPTY_BYTE_STRING,l=null){this.state=e,this.targetIds=s,this.resumeToken=a,this.cause=l}}class $b{constructor(){this.ve=0,this.Fe=Qb(),this.Me=Vs.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=jt(),s=jt(),a=jt();return this.Fe.forEach(((l,d)=>{switch(d){case 0:e=e.add(l);break;case 2:s=s.add(l);break;case 1:a=a.add(l);break;default:ct(38017,{changeType:d})}})),new uu(this.Me,this.xe,e,s,a)}qe(){this.Oe=!1,this.Fe=Qb()}Qe(e,s){this.Oe=!0,this.Fe=this.Fe.insert(e,s)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Pt(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class LA{constructor(e){this.Ge=e,this.ze=new Map,this.je=Hi(),this.Je=_d(),this.He=_d(),this.Ye=new rs(Et)}Ze(e){for(const s of e.be)e.De&&e.De.isFoundDocument()?this.Xe(s,e.De):this.et(s,e.key,e.De);for(const s of e.removedTargetIds)this.et(s,e.key,e.De)}tt(e){this.forEachTarget(e,(s=>{const a=this.nt(s);switch(e.state){case 0:this.rt(s)&&a.Le(e.resumeToken);break;case 1:a.Ke(),a.Ne||a.qe(),a.Le(e.resumeToken);break;case 2:a.Ke(),a.Ne||this.removeTarget(s);break;case 3:this.rt(s)&&(a.We(),a.Le(e.resumeToken));break;case 4:this.rt(s)&&(this.it(s),a.Le(e.resumeToken));break;default:ct(56790,{state:e.state})}}))}forEachTarget(e,s){e.targetIds.length>0?e.targetIds.forEach(s):this.ze.forEach(((a,l)=>{this.rt(l)&&s(l)}))}st(e){const s=e.targetId,a=e.Ce.count,l=this.ot(s);if(l){const d=l.target;if(tg(d))if(a===0){const h=new nt(d.path);this.et(s,h,Gs.newNoDocument(h,ft.min()))}else Pt(a===1,20013,{expectedCount:a});else{const h=this._t(s);if(h!==a){const f=this.ut(e),b=f?this.ct(f,e,h):1;if(b!==0){this.it(s);const v=b===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(s,v)}}}}}ut(e){const s=e.Ce.unchangedNames;if(!s||!s.bits)return null;const{bits:{bitmap:a="",padding:l=0},hashCount:d=0}=s;let h,f;try{h=Ma(a).toUint8Array()}catch(b){if(b instanceof G_)return Nl("Decoding the base64 bloom filter in existence filter failed ("+b.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw b}try{f=new Hg(h,l,d)}catch(b){return Nl(b instanceof kc?"BloomFilter error: ":"Applying bloom filter failed: ",b),null}return f.ge===0?null:f}ct(e,s,a){return s.Ce.count===a-this.Pt(e,s.targetId)?0:2}Pt(e,s){const a=this.Ge.getRemoteKeysForTarget(s);let l=0;return a.forEach((d=>{const h=this.Ge.ht(),f=`projects/${h.projectId}/databases/${h.database}/documents/${d.path.canonicalString()}`;e.mightContain(f)||(this.et(s,d,null),l++)})),l}Tt(e){const s=new Map;this.ze.forEach(((d,h)=>{const f=this.ot(h);if(f){if(d.current&&tg(f.target)){const b=new nt(f.target.path);this.It(b).has(h)||this.Et(h,b)||this.et(h,b,Gs.newNoDocument(b,e))}d.Be&&(s.set(h,d.ke()),d.qe())}}));let a=jt();this.He.forEach(((d,h)=>{let f=!0;h.forEachWhile((b=>{const v=this.ot(b);return!v||v.purpose==="TargetPurposeLimboResolution"||(f=!1,!1)})),f&&(a=a.add(d))})),this.je.forEach(((d,h)=>h.setReadTime(e)));const l=new bh(e,s,this.Ye,this.je,a);return this.je=Hi(),this.Je=_d(),this.He=_d(),this.Ye=new rs(Et),l}Xe(e,s){if(!this.rt(e))return;const a=this.Et(e,s.key)?2:0;this.nt(e).Qe(s.key,a),this.je=this.je.insert(s.key,s),this.Je=this.Je.insert(s.key,this.It(s.key).add(e)),this.He=this.He.insert(s.key,this.dt(s.key).add(e))}et(e,s,a){if(!this.rt(e))return;const l=this.nt(e);this.Et(e,s)?l.Qe(s,1):l.$e(s),this.He=this.He.insert(s,this.dt(s).delete(e)),this.He=this.He.insert(s,this.dt(s).add(e)),a&&(this.je=this.je.insert(s,a))}removeTarget(e){this.ze.delete(e)}_t(e){const s=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+s.addedDocuments.size-s.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let s=this.ze.get(e);return s||(s=new $b,this.ze.set(e,s)),s}dt(e){let s=this.He.get(e);return s||(s=new Es(Et),this.He=this.He.insert(e,s)),s}It(e){let s=this.Je.get(e);return s||(s=new Es(Et),this.Je=this.Je.insert(e,s)),s}rt(e){const s=this.ot(e)!==null;return s||He("WatchChangeAggregator","Detected inactive target",e),s}ot(e){const s=this.ze.get(e);return s&&s.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new $b),this.Ge.getRemoteKeysForTarget(e).forEach((s=>{this.et(e,s,null)}))}Et(e,s){return this.Ge.getRemoteKeysForTarget(e).has(s)}}function _d(){return new rs(nt.comparator)}function Qb(){return new rs(nt.comparator)}const VA={asc:"ASCENDING",desc:"DESCENDING"},UA={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},BA={and:"AND",or:"OR"};class zA{constructor(e,s){this.databaseId=e,this.useProto3Json=s}}function rg(n,e){return n.useProto3Json||fh(e)?e:{value:e}}function Jd(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function ww(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function FA(n,e){return Jd(n,e.toTimestamp())}function ei(n){return Pt(!!n,49232),ft.fromTimestamp((function(s){const a=ka(s);return new Bt(a.seconds,a.nanos)})(n))}function Gg(n,e){return ig(n,e).canonicalString()}function ig(n,e){const s=(function(l){return new Yt(["projects",l.projectId,"databases",l.database])})(n).child("documents");return e===void 0?s:s.child(e)}function Nw(n){const e=Yt.fromString(n);return Pt(Aw(e),10190,{key:e.toString()}),e}function ag(n,e){return Gg(n.databaseId,e.path)}function Rm(n,e){const s=Nw(e);if(s.get(1)!==n.databaseId.projectId)throw new qe(ke.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+s.get(1)+" vs "+n.databaseId.projectId);if(s.get(3)!==n.databaseId.database)throw new qe(ke.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+s.get(3)+" vs "+n.databaseId.database);return new nt(Ew(s))}function Sw(n,e){return Gg(n.databaseId,e)}function qA(n){const e=Nw(n);return e.length===4?Yt.emptyPath():Ew(e)}function og(n){return new Yt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Ew(n){return Pt(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function Kb(n,e,s){return{name:ag(n,e),fields:s.value.mapValue.fields}}function HA(n,e){let s;if("targetChange"in e){e.targetChange;const a=(function(v){return v==="NO_CHANGE"?0:v==="ADD"?1:v==="REMOVE"?2:v==="CURRENT"?3:v==="RESET"?4:ct(39313,{state:v})})(e.targetChange.targetChangeType||"NO_CHANGE"),l=e.targetChange.targetIds||[],d=(function(v,E){return v.useProto3Json?(Pt(E===void 0||typeof E=="string",58123),Vs.fromBase64String(E||"")):(Pt(E===void 0||E instanceof Buffer||E instanceof Uint8Array,16193),Vs.fromUint8Array(E||new Uint8Array))})(n,e.targetChange.resumeToken),h=e.targetChange.cause,f=h&&(function(v){const E=v.code===void 0?ke.UNKNOWN:bw(v.code);return new qe(E,v.message||"")})(h);s=new _w(a,l,d,f||null)}else if("documentChange"in e){e.documentChange;const a=e.documentChange;a.document,a.document.name,a.document.updateTime;const l=Rm(n,a.document.name),d=ei(a.document.updateTime),h=a.document.createTime?ei(a.document.createTime):ft.min(),f=new sr({mapValue:{fields:a.document.fields}}),b=Gs.newFoundDocument(l,d,h,f),v=a.targetIds||[],E=a.removedTargetIds||[];s=new Pd(v,E,b.key,b)}else if("documentDelete"in e){e.documentDelete;const a=e.documentDelete;a.document;const l=Rm(n,a.document),d=a.readTime?ei(a.readTime):ft.min(),h=Gs.newNoDocument(l,d),f=a.removedTargetIds||[];s=new Pd([],f,h.key,h)}else if("documentRemove"in e){e.documentRemove;const a=e.documentRemove;a.document;const l=Rm(n,a.document),d=a.removedTargetIds||[];s=new Pd([],d,l,null)}else{if(!("filter"in e))return ct(11601,{Rt:e});{e.filter;const a=e.filter;a.targetId;const{count:l=0,unchangedNames:d}=a,h=new OA(l,d),f=a.targetId;s=new vw(f,h)}}return s}function GA(n,e){let s;if(e instanceof cu)s={update:Kb(n,e.key,e.value)};else if(e instanceof xw)s={delete:ag(n,e.key)};else if(e instanceof To)s={update:Kb(n,e.key,e.data),updateMask:eC(e.fieldMask)};else{if(!(e instanceof IA))return ct(16599,{Vt:e.type});s={verify:ag(n,e.key)}}return e.fieldTransforms.length>0&&(s.updateTransforms=e.fieldTransforms.map((a=>(function(d,h){const f=h.transform;if(f instanceof Xd)return{fieldPath:h.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(f instanceof Zc)return{fieldPath:h.field.canonicalString(),appendMissingElements:{values:f.elements}};if(f instanceof eu)return{fieldPath:h.field.canonicalString(),removeAllFromArray:{values:f.elements}};if(f instanceof Wd)return{fieldPath:h.field.canonicalString(),increment:f.Ae};throw ct(20930,{transform:h.transform})})(0,a)))),e.precondition.isNone||(s.currentDocument=(function(l,d){return d.updateTime!==void 0?{updateTime:FA(l,d.updateTime)}:d.exists!==void 0?{exists:d.exists}:ct(27497)})(n,e.precondition)),s}function $A(n,e){return n&&n.length>0?(Pt(e!==void 0,14353),n.map((s=>(function(l,d){let h=l.updateTime?ei(l.updateTime):ei(d);return h.isEqual(ft.min())&&(h=ei(d)),new TA(h,l.transformResults||[])})(s,e)))):[]}function QA(n,e){return{documents:[Sw(n,e.path)]}}function KA(n,e){const s={structuredQuery:{}},a=e.path;let l;e.collectionGroup!==null?(l=a,s.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(l=a.popLast(),s.structuredQuery.from=[{collectionId:a.lastSegment()}]),s.parent=Sw(n,l);const d=(function(v){if(v.length!==0)return Tw(Rr.create(v,"and"))})(e.filters);d&&(s.structuredQuery.where=d);const h=(function(v){if(v.length!==0)return v.map((E=>(function(_){return{field:ul(_.field),direction:WA(_.dir)}})(E)))})(e.orderBy);h&&(s.structuredQuery.orderBy=h);const f=rg(n,e.limit);return f!==null&&(s.structuredQuery.limit=f),e.startAt&&(s.structuredQuery.startAt=(function(v){return{before:v.inclusive,values:v.position}})(e.startAt)),e.endAt&&(s.structuredQuery.endAt=(function(v){return{before:!v.inclusive,values:v.position}})(e.endAt)),{ft:s,parent:l}}function YA(n){let e=qA(n.parent);const s=n.structuredQuery,a=s.from?s.from.length:0;let l=null;if(a>0){Pt(a===1,65062);const E=s.from[0];E.allDescendants?l=E.collectionId:e=e.child(E.collectionId)}let d=[];s.where&&(d=(function(D){const _=jw(D);return _ instanceof Rr&&tw(_)?_.getFilters():[_]})(s.where));let h=[];s.orderBy&&(h=(function(D){return D.map((_=>(function(U){return new Jc(dl(U.field),(function(he){switch(he){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(U.direction))})(_)))})(s.orderBy));let f=null;s.limit&&(f=(function(D){let _;return _=typeof D=="object"?D.value:D,fh(_)?null:_})(s.limit));let b=null;s.startAt&&(b=(function(D){const _=!!D.before,R=D.values||[];return new Yd(R,_)})(s.startAt));let v=null;return s.endAt&&(v=(function(D){const _=!D.before,R=D.values||[];return new Yd(R,_)})(s.endAt)),mA(e,l,h,d,f,"F",b,v)}function XA(n,e){const s=(function(l){switch(l){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ct(28987,{purpose:l})}})(e.purpose);return s==null?null:{"goog-listen-tags":s}}function jw(n){return n.unaryFilter!==void 0?(function(s){switch(s.unaryFilter.op){case"IS_NAN":const a=dl(s.unaryFilter.field);return ys.create(a,"==",{doubleValue:NaN});case"IS_NULL":const l=dl(s.unaryFilter.field);return ys.create(l,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const d=dl(s.unaryFilter.field);return ys.create(d,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const h=dl(s.unaryFilter.field);return ys.create(h,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ct(61313);default:return ct(60726)}})(n):n.fieldFilter!==void 0?(function(s){return ys.create(dl(s.fieldFilter.field),(function(l){switch(l){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ct(58110);default:return ct(50506)}})(s.fieldFilter.op),s.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(s){return Rr.create(s.compositeFilter.filters.map((a=>jw(a))),(function(l){switch(l){case"AND":return"and";case"OR":return"or";default:return ct(1026)}})(s.compositeFilter.op))})(n):ct(30097,{filter:n})}function WA(n){return VA[n]}function JA(n){return UA[n]}function ZA(n){return BA[n]}function ul(n){return{fieldPath:n.canonicalString()}}function dl(n){return Ls.fromServerFormat(n.fieldPath)}function Tw(n){return n instanceof ys?(function(s){if(s.op==="=="){if(Mb(s.value))return{unaryFilter:{field:ul(s.field),op:"IS_NAN"}};if(kb(s.value))return{unaryFilter:{field:ul(s.field),op:"IS_NULL"}}}else if(s.op==="!="){if(Mb(s.value))return{unaryFilter:{field:ul(s.field),op:"IS_NOT_NAN"}};if(kb(s.value))return{unaryFilter:{field:ul(s.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ul(s.field),op:JA(s.op),value:s.value}}})(n):n instanceof Rr?(function(s){const a=s.getFilters().map((l=>Tw(l)));return a.length===1?a[0]:{compositeFilter:{op:ZA(s.op),filters:a}}})(n):ct(54877,{filter:n})}function eC(n){const e=[];return n.fields.forEach((s=>e.push(s.canonicalString()))),{fieldPaths:e}}function Aw(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ja{constructor(e,s,a,l,d=ft.min(),h=ft.min(),f=Vs.EMPTY_BYTE_STRING,b=null){this.target=e,this.targetId=s,this.purpose=a,this.sequenceNumber=l,this.snapshotVersion=d,this.lastLimboFreeSnapshotVersion=h,this.resumeToken=f,this.expectedCount=b}withSequenceNumber(e){return new ja(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,s){return new ja(this.target,this.targetId,this.purpose,this.sequenceNumber,s,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ja(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ja(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tC{constructor(e){this.yt=e}}function sC(n){const e=YA({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?ng(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nC{constructor(){this.Cn=new rC}addToCollectionParentIndex(e,s){return this.Cn.add(s),Le.resolve()}getCollectionParents(e,s){return Le.resolve(this.Cn.getEntries(s))}addFieldIndex(e,s){return Le.resolve()}deleteFieldIndex(e,s){return Le.resolve()}deleteAllFieldIndexes(e){return Le.resolve()}createTargetIndexes(e,s){return Le.resolve()}getDocumentsMatchingTarget(e,s){return Le.resolve(null)}getIndexType(e,s){return Le.resolve(0)}getFieldIndexes(e,s){return Le.resolve([])}getNextCollectionGroupToUpdate(e){return Le.resolve(null)}getMinOffset(e,s){return Le.resolve(Oa.min())}getMinOffsetFromCollectionGroup(e,s){return Le.resolve(Oa.min())}updateCollectionGroup(e,s,a){return Le.resolve()}updateIndexEntries(e,s){return Le.resolve()}}class rC{constructor(){this.index={}}add(e){const s=e.lastSegment(),a=e.popLast(),l=this.index[s]||new Es(Yt.comparator),d=!l.has(a);return this.index[s]=l.add(a),d}has(e){const s=e.lastSegment(),a=e.popLast(),l=this.index[s];return l&&l.has(a)}getEntries(e){return(this.index[e]||new Es(Yt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yb={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Cw=41943040;class gn{static withCacheSize(e){return new gn(e,gn.DEFAULT_COLLECTION_PERCENTILE,gn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,s,a){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=s,this.maximumSequenceNumbersToCollect=a}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */gn.DEFAULT_COLLECTION_PERCENTILE=10,gn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,gn.DEFAULT=new gn(Cw,gn.DEFAULT_COLLECTION_PERCENTILE,gn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),gn.DISABLED=new gn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tl{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Tl(0)}static cr(){return new Tl(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xb="LruGarbageCollector",iC=1048576;function Wb([n,e],[s,a]){const l=Et(n,s);return l===0?Et(e,a):l}class aC{constructor(e){this.Ir=e,this.buffer=new Es(Wb),this.Er=0}dr(){return++this.Er}Ar(e){const s=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(s);else{const a=this.buffer.last();Wb(s,a)<0&&(this.buffer=this.buffer.delete(a).add(s))}}get maxValue(){return this.buffer.last()[0]}}class oC{constructor(e,s,a){this.garbageCollector=e,this.asyncQueue=s,this.localStore=a,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){He(Xb,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(()=>K(this,null,function*(){this.Rr=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(s){Dl(s)?He(Xb,"Ignoring IndexedDB error during garbage collection: ",s):yield Rl(s)}yield this.Vr(3e5)})))}}class lC{constructor(e,s){this.mr=e,this.params=s}calculateTargetCount(e,s){return this.mr.gr(e).next((a=>Math.floor(s/100*a)))}nthSequenceNumber(e,s){if(s===0)return Le.resolve(hh.ce);const a=new aC(s);return this.mr.forEachTarget(e,(l=>a.Ar(l.sequenceNumber))).next((()=>this.mr.pr(e,(l=>a.Ar(l))))).next((()=>a.maxValue))}removeTargets(e,s,a){return this.mr.removeTargets(e,s,a)}removeOrphanedDocuments(e,s){return this.mr.removeOrphanedDocuments(e,s)}collect(e,s){return this.params.cacheSizeCollectionThreshold===-1?(He("LruGarbageCollector","Garbage collection skipped; disabled"),Le.resolve(Yb)):this.getCacheSize(e).next((a=>a<this.params.cacheSizeCollectionThreshold?(He("LruGarbageCollector",`Garbage collection skipped; Cache size ${a} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Yb):this.yr(e,s)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,s){let a,l,d,h,f,b,v;const E=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((D=>(D>this.params.maximumSequenceNumbersToCollect?(He("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${D}`),l=this.params.maximumSequenceNumbersToCollect):l=D,h=Date.now(),this.nthSequenceNumber(e,l)))).next((D=>(a=D,f=Date.now(),this.removeTargets(e,a,s)))).next((D=>(d=D,b=Date.now(),this.removeOrphanedDocuments(e,a)))).next((D=>(v=Date.now(),ll()<=St.DEBUG&&He("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${h-E}ms
	Determined least recently used ${l} in `+(f-h)+`ms
	Removed ${d} targets in `+(b-f)+`ms
	Removed ${D} documents in `+(v-b)+`ms
Total Duration: ${v-E}ms`),Le.resolve({didRun:!0,sequenceNumbersCollected:l,targetsRemoved:d,documentsRemoved:D}))))}}function cC(n,e){return new lC(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uC{constructor(){this.changes=new jo((e=>e.toString()),((e,s)=>e.isEqual(s))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,s){this.assertNotApplied(),this.changes.set(e,Gs.newInvalidDocument(e).setReadTime(s))}getEntry(e,s){this.assertNotApplied();const a=this.changes.get(s);return a!==void 0?Le.resolve(a):this.getFromCache(e,s)}getEntries(e,s){return this.getAllFromCache(e,s)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dC{constructor(e,s){this.overlayedDocument=e,this.mutatedFields=s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hC{constructor(e,s,a,l){this.remoteDocumentCache=e,this.mutationQueue=s,this.documentOverlayCache=a,this.indexManager=l}getDocument(e,s){let a=null;return this.documentOverlayCache.getOverlay(e,s).next((l=>(a=l,this.remoteDocumentCache.getEntry(e,s)))).next((l=>(a!==null&&Fc(a.mutation,l,Ar.empty(),Bt.now()),l)))}getDocuments(e,s){return this.remoteDocumentCache.getEntries(e,s).next((a=>this.getLocalViewOfDocuments(e,a,jt()).next((()=>a))))}getLocalViewOfDocuments(e,s,a=jt()){const l=mo();return this.populateOverlays(e,l,s).next((()=>this.computeViews(e,s,l,a).next((d=>{let h=Oc();return d.forEach(((f,b)=>{h=h.insert(f,b.overlayedDocument)})),h}))))}getOverlayedDocuments(e,s){const a=mo();return this.populateOverlays(e,a,s).next((()=>this.computeViews(e,s,a,jt())))}populateOverlays(e,s,a){const l=[];return a.forEach((d=>{s.has(d)||l.push(d)})),this.documentOverlayCache.getOverlays(e,l).next((d=>{d.forEach(((h,f)=>{s.set(h,f)}))}))}computeViews(e,s,a,l){let d=Hi();const h=zc(),f=(function(){return zc()})();return s.forEach(((b,v)=>{const E=a.get(v.key);l.has(v.key)&&(E===void 0||E.mutation instanceof To)?d=d.insert(v.key,v):E!==void 0?(h.set(v.key,E.mutation.getFieldMask()),Fc(E.mutation,v,E.mutation.getFieldMask(),Bt.now())):h.set(v.key,Ar.empty())})),this.recalculateAndSaveOverlays(e,d).next((b=>(b.forEach(((v,E)=>h.set(v,E))),s.forEach(((v,E)=>{var D;return f.set(v,new dC(E,(D=h.get(v))!=null?D:null))})),f)))}recalculateAndSaveOverlays(e,s){const a=zc();let l=new rs(((h,f)=>h-f)),d=jt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,s).next((h=>{for(const f of h)f.keys().forEach((b=>{const v=s.get(b);if(v===null)return;let E=a.get(b)||Ar.empty();E=f.applyToLocalView(v,E),a.set(b,E);const D=(l.get(f.batchId)||jt()).add(b);l=l.insert(f.batchId,D)}))})).next((()=>{const h=[],f=l.getReverseIterator();for(;f.hasNext();){const b=f.getNext(),v=b.key,E=b.value,D=uw();E.forEach((_=>{if(!d.has(_)){const R=pw(s.get(_),a.get(_));R!==null&&D.set(_,R),d=d.add(_)}})),h.push(this.documentOverlayCache.saveOverlays(e,v,D))}return Le.waitFor(h)})).next((()=>a))}recalculateAndSaveOverlaysForDocumentKeys(e,s){return this.remoteDocumentCache.getEntries(e,s).next((a=>this.recalculateAndSaveOverlays(e,a)))}getDocumentsMatchingQuery(e,s,a,l){return(function(h){return nt.isDocumentKey(h.path)&&h.collectionGroup===null&&h.filters.length===0})(s)?this.getDocumentsMatchingDocumentQuery(e,s.path):iw(s)?this.getDocumentsMatchingCollectionGroupQuery(e,s,a,l):this.getDocumentsMatchingCollectionQuery(e,s,a,l)}getNextDocuments(e,s,a,l){return this.remoteDocumentCache.getAllFromCollectionGroup(e,s,a,l).next((d=>{const h=l-d.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,s,a.largestBatchId,l-d.size):Le.resolve(mo());let f=Kc,b=d;return h.next((v=>Le.forEach(v,((E,D)=>(f<D.largestBatchId&&(f=D.largestBatchId),d.get(E)?Le.resolve():this.remoteDocumentCache.getEntry(e,E).next((_=>{b=b.insert(E,_)}))))).next((()=>this.populateOverlays(e,v,d))).next((()=>this.computeViews(e,b,v,jt()))).next((E=>({batchId:f,changes:cw(E)})))))}))}getDocumentsMatchingDocumentQuery(e,s){return this.getDocument(e,new nt(s)).next((a=>{let l=Oc();return a.isFoundDocument()&&(l=l.insert(a.key,a)),l}))}getDocumentsMatchingCollectionGroupQuery(e,s,a,l){const d=s.collectionGroup;let h=Oc();return this.indexManager.getCollectionParents(e,d).next((f=>Le.forEach(f,(b=>{const v=(function(D,_){return new Ol(_,null,D.explicitOrderBy.slice(),D.filters.slice(),D.limit,D.limitType,D.startAt,D.endAt)})(s,b.child(d));return this.getDocumentsMatchingCollectionQuery(e,v,a,l).next((E=>{E.forEach(((D,_)=>{h=h.insert(D,_)}))}))})).next((()=>h))))}getDocumentsMatchingCollectionQuery(e,s,a,l){let d;return this.documentOverlayCache.getOverlaysForCollection(e,s.path,a.largestBatchId).next((h=>(d=h,this.remoteDocumentCache.getDocumentsMatchingQuery(e,s,a,d,l)))).next((h=>{d.forEach(((b,v)=>{const E=v.getKey();h.get(E)===null&&(h=h.insert(E,Gs.newInvalidDocument(E)))}));let f=Oc();return h.forEach(((b,v)=>{const E=d.get(b);E!==void 0&&Fc(E.mutation,v,Ar.empty(),Bt.now()),ph(s,v)&&(f=f.insert(b,v))})),f}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fC{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,s){return Le.resolve(this.Lr.get(s))}saveBundleMetadata(e,s){return this.Lr.set(s.id,(function(l){return{id:l.id,version:l.version,createTime:ei(l.createTime)}})(s)),Le.resolve()}getNamedQuery(e,s){return Le.resolve(this.kr.get(s))}saveNamedQuery(e,s){return this.kr.set(s.name,(function(l){return{name:l.name,query:sC(l.bundledQuery),readTime:ei(l.readTime)}})(s)),Le.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mC{constructor(){this.overlays=new rs(nt.comparator),this.qr=new Map}getOverlay(e,s){return Le.resolve(this.overlays.get(s))}getOverlays(e,s){const a=mo();return Le.forEach(s,(l=>this.getOverlay(e,l).next((d=>{d!==null&&a.set(l,d)})))).next((()=>a))}saveOverlays(e,s,a){return a.forEach(((l,d)=>{this.St(e,s,d)})),Le.resolve()}removeOverlaysForBatchId(e,s,a){const l=this.qr.get(a);return l!==void 0&&(l.forEach((d=>this.overlays=this.overlays.remove(d))),this.qr.delete(a)),Le.resolve()}getOverlaysForCollection(e,s,a){const l=mo(),d=s.length+1,h=new nt(s.child("")),f=this.overlays.getIteratorFrom(h);for(;f.hasNext();){const b=f.getNext().value,v=b.getKey();if(!s.isPrefixOf(v.path))break;v.path.length===d&&b.largestBatchId>a&&l.set(b.getKey(),b)}return Le.resolve(l)}getOverlaysForCollectionGroup(e,s,a,l){let d=new rs(((v,E)=>v-E));const h=this.overlays.getIterator();for(;h.hasNext();){const v=h.getNext().value;if(v.getKey().getCollectionGroup()===s&&v.largestBatchId>a){let E=d.get(v.largestBatchId);E===null&&(E=mo(),d=d.insert(v.largestBatchId,E)),E.set(v.getKey(),v)}}const f=mo(),b=d.getIterator();for(;b.hasNext()&&(b.getNext().value.forEach(((v,E)=>f.set(v,E))),!(f.size()>=l)););return Le.resolve(f)}St(e,s,a){const l=this.overlays.get(a.key);if(l!==null){const h=this.qr.get(l.largestBatchId).delete(a.key);this.qr.set(l.largestBatchId,h)}this.overlays=this.overlays.insert(a.key,new DA(s,a));let d=this.qr.get(s);d===void 0&&(d=jt(),this.qr.set(s,d)),this.qr.set(s,d.add(a.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gC{constructor(){this.sessionToken=Vs.EMPTY_BYTE_STRING}getSessionToken(e){return Le.resolve(this.sessionToken)}setSessionToken(e,s){return this.sessionToken=s,Le.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $g{constructor(){this.Qr=new Es(Cs.$r),this.Ur=new Es(Cs.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,s){const a=new Cs(e,s);this.Qr=this.Qr.add(a),this.Ur=this.Ur.add(a)}Wr(e,s){e.forEach((a=>this.addReference(a,s)))}removeReference(e,s){this.Gr(new Cs(e,s))}zr(e,s){e.forEach((a=>this.removeReference(a,s)))}jr(e){const s=new nt(new Yt([])),a=new Cs(s,e),l=new Cs(s,e+1),d=[];return this.Ur.forEachInRange([a,l],(h=>{this.Gr(h),d.push(h.key)})),d}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const s=new nt(new Yt([])),a=new Cs(s,e),l=new Cs(s,e+1);let d=jt();return this.Ur.forEachInRange([a,l],(h=>{d=d.add(h.key)})),d}containsKey(e){const s=new Cs(e,0),a=this.Qr.firstAfterOrEqual(s);return a!==null&&e.isEqual(a.key)}}class Cs{constructor(e,s){this.key=e,this.Yr=s}static $r(e,s){return nt.comparator(e.key,s.key)||Et(e.Yr,s.Yr)}static Kr(e,s){return Et(e.Yr,s.Yr)||nt.comparator(e.key,s.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pC{constructor(e,s){this.indexManager=e,this.referenceDelegate=s,this.mutationQueue=[],this.tr=1,this.Zr=new Es(Cs.$r)}checkEmpty(e){return Le.resolve(this.mutationQueue.length===0)}addMutationBatch(e,s,a,l){const d=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const h=new RA(d,s,a,l);this.mutationQueue.push(h);for(const f of l)this.Zr=this.Zr.add(new Cs(f.key,d)),this.indexManager.addToCollectionParentIndex(e,f.key.path.popLast());return Le.resolve(h)}lookupMutationBatch(e,s){return Le.resolve(this.Xr(s))}getNextMutationBatchAfterBatchId(e,s){const a=s+1,l=this.ei(a),d=l<0?0:l;return Le.resolve(this.mutationQueue.length>d?this.mutationQueue[d]:null)}getHighestUnacknowledgedBatchId(){return Le.resolve(this.mutationQueue.length===0?Pg:this.tr-1)}getAllMutationBatches(e){return Le.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,s){const a=new Cs(s,0),l=new Cs(s,Number.POSITIVE_INFINITY),d=[];return this.Zr.forEachInRange([a,l],(h=>{const f=this.Xr(h.Yr);d.push(f)})),Le.resolve(d)}getAllMutationBatchesAffectingDocumentKeys(e,s){let a=new Es(Et);return s.forEach((l=>{const d=new Cs(l,0),h=new Cs(l,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([d,h],(f=>{a=a.add(f.Yr)}))})),Le.resolve(this.ti(a))}getAllMutationBatchesAffectingQuery(e,s){const a=s.path,l=a.length+1;let d=a;nt.isDocumentKey(d)||(d=d.child(""));const h=new Cs(new nt(d),0);let f=new Es(Et);return this.Zr.forEachWhile((b=>{const v=b.key.path;return!!a.isPrefixOf(v)&&(v.length===l&&(f=f.add(b.Yr)),!0)}),h),Le.resolve(this.ti(f))}ti(e){const s=[];return e.forEach((a=>{const l=this.Xr(a);l!==null&&s.push(l)})),s}removeMutationBatch(e,s){Pt(this.ni(s.batchId,"removed")===0,55003),this.mutationQueue.shift();let a=this.Zr;return Le.forEach(s.mutations,(l=>{const d=new Cs(l.key,s.batchId);return a=a.delete(d),this.referenceDelegate.markPotentiallyOrphaned(e,l.key)})).next((()=>{this.Zr=a}))}ir(e){}containsKey(e,s){const a=new Cs(s,0),l=this.Zr.firstAfterOrEqual(a);return Le.resolve(s.isEqual(l&&l.key))}performConsistencyCheck(e){return this.mutationQueue.length,Le.resolve()}ni(e,s){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const s=this.ei(e);return s<0||s>=this.mutationQueue.length?null:this.mutationQueue[s]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yC{constructor(e){this.ri=e,this.docs=(function(){return new rs(nt.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,s){const a=s.key,l=this.docs.get(a),d=l?l.size:0,h=this.ri(s);return this.docs=this.docs.insert(a,{document:s.mutableCopy(),size:h}),this.size+=h-d,this.indexManager.addToCollectionParentIndex(e,a.path.popLast())}removeEntry(e){const s=this.docs.get(e);s&&(this.docs=this.docs.remove(e),this.size-=s.size)}getEntry(e,s){const a=this.docs.get(s);return Le.resolve(a?a.document.mutableCopy():Gs.newInvalidDocument(s))}getEntries(e,s){let a=Hi();return s.forEach((l=>{const d=this.docs.get(l);a=a.insert(l,d?d.document.mutableCopy():Gs.newInvalidDocument(l))})),Le.resolve(a)}getDocumentsMatchingQuery(e,s,a,l){let d=Hi();const h=s.path,f=new nt(h.child("__id-9223372036854775808__")),b=this.docs.getIteratorFrom(f);for(;b.hasNext();){const{key:v,value:{document:E}}=b.getNext();if(!h.isPrefixOf(v.path))break;v.path.length>h.length+1||$T(GT(E),a)<=0||(l.has(E.key)||ph(s,E))&&(d=d.insert(E.key,E.mutableCopy()))}return Le.resolve(d)}getAllFromCollectionGroup(e,s,a,l){ct(9500)}ii(e,s){return Le.forEach(this.docs,(a=>s(a)))}newChangeBuffer(e){return new xC(this)}getSize(e){return Le.resolve(this.size)}}class xC extends uC{constructor(e){super(),this.Nr=e}applyChanges(e){const s=[];return this.changes.forEach(((a,l)=>{l.isValidDocument()?s.push(this.Nr.addEntry(e,l)):this.Nr.removeEntry(a)})),Le.waitFor(s)}getFromCache(e,s){return this.Nr.getEntry(e,s)}getAllFromCache(e,s){return this.Nr.getEntries(e,s)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bC{constructor(e){this.persistence=e,this.si=new jo((s=>Ug(s)),Bg),this.lastRemoteSnapshotVersion=ft.min(),this.highestTargetId=0,this.oi=0,this._i=new $g,this.targetCount=0,this.ai=Tl.ur()}forEachTarget(e,s){return this.si.forEach(((a,l)=>s(l))),Le.resolve()}getLastRemoteSnapshotVersion(e){return Le.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Le.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),Le.resolve(this.highestTargetId)}setTargetsMetadata(e,s,a){return a&&(this.lastRemoteSnapshotVersion=a),s>this.oi&&(this.oi=s),Le.resolve()}Pr(e){this.si.set(e.target,e);const s=e.targetId;s>this.highestTargetId&&(this.ai=new Tl(s),this.highestTargetId=s),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,s){return this.Pr(s),this.targetCount+=1,Le.resolve()}updateTargetData(e,s){return this.Pr(s),Le.resolve()}removeTargetData(e,s){return this.si.delete(s.target),this._i.jr(s.targetId),this.targetCount-=1,Le.resolve()}removeTargets(e,s,a){let l=0;const d=[];return this.si.forEach(((h,f)=>{f.sequenceNumber<=s&&a.get(f.targetId)===null&&(this.si.delete(h),d.push(this.removeMatchingKeysForTargetId(e,f.targetId)),l++)})),Le.waitFor(d).next((()=>l))}getTargetCount(e){return Le.resolve(this.targetCount)}getTargetData(e,s){const a=this.si.get(s)||null;return Le.resolve(a)}addMatchingKeys(e,s,a){return this._i.Wr(s,a),Le.resolve()}removeMatchingKeys(e,s,a){this._i.zr(s,a);const l=this.persistence.referenceDelegate,d=[];return l&&s.forEach((h=>{d.push(l.markPotentiallyOrphaned(e,h))})),Le.waitFor(d)}removeMatchingKeysForTargetId(e,s){return this._i.jr(s),Le.resolve()}getMatchingKeysForTargetId(e,s){const a=this._i.Hr(s);return Le.resolve(a)}containsKey(e,s){return Le.resolve(this._i.containsKey(s))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iw{constructor(e,s){this.ui={},this.overlays={},this.ci=new hh(0),this.li=!1,this.li=!0,this.hi=new gC,this.referenceDelegate=e(this),this.Pi=new bC(this),this.indexManager=new nC,this.remoteDocumentCache=(function(l){return new yC(l)})((a=>this.referenceDelegate.Ti(a))),this.serializer=new tC(s),this.Ii=new fC(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let s=this.overlays[e.toKey()];return s||(s=new mC,this.overlays[e.toKey()]=s),s}getMutationQueue(e,s){let a=this.ui[e.toKey()];return a||(a=new pC(s,this.referenceDelegate),this.ui[e.toKey()]=a),a}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,s,a){He("MemoryPersistence","Starting transaction:",e);const l=new vC(this.ci.next());return this.referenceDelegate.Ei(),a(l).next((d=>this.referenceDelegate.di(l).next((()=>d)))).toPromise().then((d=>(l.raiseOnCommittedEvent(),d)))}Ai(e,s){return Le.or(Object.values(this.ui).map((a=>()=>a.containsKey(e,s))))}}class vC extends KT{constructor(e){super(),this.currentSequenceNumber=e}}class Qg{constructor(e){this.persistence=e,this.Ri=new $g,this.Vi=null}static mi(e){return new Qg(e)}get fi(){if(this.Vi)return this.Vi;throw ct(60996)}addReference(e,s,a){return this.Ri.addReference(a,s),this.fi.delete(a.toString()),Le.resolve()}removeReference(e,s,a){return this.Ri.removeReference(a,s),this.fi.add(a.toString()),Le.resolve()}markPotentiallyOrphaned(e,s){return this.fi.add(s.toString()),Le.resolve()}removeTarget(e,s){this.Ri.jr(s.targetId).forEach((l=>this.fi.add(l.toString())));const a=this.persistence.getTargetCache();return a.getMatchingKeysForTargetId(e,s.targetId).next((l=>{l.forEach((d=>this.fi.add(d.toString())))})).next((()=>a.removeTargetData(e,s)))}Ei(){this.Vi=new Set}di(e){const s=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Le.forEach(this.fi,(a=>{const l=nt.fromPath(a);return this.gi(e,l).next((d=>{d||s.removeEntry(l,ft.min())}))})).next((()=>(this.Vi=null,s.apply(e))))}updateLimboDocument(e,s){return this.gi(e,s).next((a=>{a?this.fi.delete(s.toString()):this.fi.add(s.toString())}))}Ti(e){return 0}gi(e,s){return Le.or([()=>Le.resolve(this.Ri.containsKey(s)),()=>this.persistence.getTargetCache().containsKey(e,s),()=>this.persistence.Ai(e,s)])}}class Zd{constructor(e,s){this.persistence=e,this.pi=new jo((a=>WT(a.path)),((a,l)=>a.isEqual(l))),this.garbageCollector=cC(this,s)}static mi(e,s){return new Zd(e,s)}Ei(){}di(e){return Le.resolve()}forEachTarget(e,s){return this.persistence.getTargetCache().forEachTarget(e,s)}gr(e){const s=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((a=>s.next((l=>a+l))))}wr(e){let s=0;return this.pr(e,(a=>{s++})).next((()=>s))}pr(e,s){return Le.forEach(this.pi,((a,l)=>this.br(e,a,l).next((d=>d?Le.resolve():s(l)))))}removeTargets(e,s,a){return this.persistence.getTargetCache().removeTargets(e,s,a)}removeOrphanedDocuments(e,s){let a=0;const l=this.persistence.getRemoteDocumentCache(),d=l.newChangeBuffer();return l.ii(e,(h=>this.br(e,h,s).next((f=>{f||(a++,d.removeEntry(h,ft.min()))})))).next((()=>d.apply(e))).next((()=>a))}markPotentiallyOrphaned(e,s){return this.pi.set(s,e.currentSequenceNumber),Le.resolve()}removeTarget(e,s){const a=s.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,a)}addReference(e,s,a){return this.pi.set(a,e.currentSequenceNumber),Le.resolve()}removeReference(e,s,a){return this.pi.set(a,e.currentSequenceNumber),Le.resolve()}updateLimboDocument(e,s){return this.pi.set(s,e.currentSequenceNumber),Le.resolve()}Ti(e){let s=e.key.toString().length;return e.isFoundDocument()&&(s+=Od(e.data.value)),s}br(e,s,a){return Le.or([()=>this.persistence.Ai(e,s),()=>this.persistence.getTargetCache().containsKey(e,s),()=>{const l=this.pi.get(s);return Le.resolve(l!==void 0&&l>a)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kg{constructor(e,s,a,l){this.targetId=e,this.fromCache=s,this.Es=a,this.ds=l}static As(e,s){let a=jt(),l=jt();for(const d of s.docChanges)switch(d.type){case 0:a=a.add(d.doc.key);break;case 1:l=l.add(d.doc.key)}return new Kg(e,s.fromCache,a,l)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _C{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wC{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return p2()?8:YT($s())>0?6:4})()}initialize(e,s){this.ps=e,this.indexManager=s,this.Rs=!0}getDocumentsMatchingQuery(e,s,a,l){const d={result:null};return this.ys(e,s).next((h=>{d.result=h})).next((()=>{if(!d.result)return this.ws(e,s,l,a).next((h=>{d.result=h}))})).next((()=>{if(d.result)return;const h=new _C;return this.Ss(e,s,h).next((f=>{if(d.result=f,this.Vs)return this.bs(e,s,h,f.size)}))})).next((()=>d.result))}bs(e,s,a,l){return a.documentReadCount<this.fs?(ll()<=St.DEBUG&&He("QueryEngine","SDK will not create cache indexes for query:",cl(s),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),Le.resolve()):(ll()<=St.DEBUG&&He("QueryEngine","Query:",cl(s),"scans",a.documentReadCount,"local documents and returns",l,"documents as results."),a.documentReadCount>this.gs*l?(ll()<=St.DEBUG&&He("QueryEngine","The SDK decides to create cache indexes for query:",cl(s),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Zr(s))):Le.resolve())}ys(e,s){if(Ub(s))return Le.resolve(null);let a=Zr(s);return this.indexManager.getIndexType(e,a).next((l=>l===0?null:(s.limit!==null&&l===1&&(s=ng(s,null,"F"),a=Zr(s)),this.indexManager.getDocumentsMatchingTarget(e,a).next((d=>{const h=jt(...d);return this.ps.getDocuments(e,h).next((f=>this.indexManager.getMinOffset(e,a).next((b=>{const v=this.Ds(s,f);return this.Cs(s,v,h,b.readTime)?this.ys(e,ng(s,null,"F")):this.vs(e,v,s,b)}))))})))))}ws(e,s,a,l){return Ub(s)||l.isEqual(ft.min())?Le.resolve(null):this.ps.getDocuments(e,a).next((d=>{const h=this.Ds(s,d);return this.Cs(s,h,a,l)?Le.resolve(null):(ll()<=St.DEBUG&&He("QueryEngine","Re-using previous result from %s to execute query: %s",l.toString(),cl(s)),this.vs(e,h,s,HT(l,Kc)).next((f=>f)))}))}Ds(e,s){let a=new Es(ow(e));return s.forEach(((l,d)=>{ph(e,d)&&(a=a.add(d))})),a}Cs(e,s,a,l){if(e.limit===null)return!1;if(a.size!==s.size)return!0;const d=e.limitType==="F"?s.last():s.first();return!!d&&(d.hasPendingWrites||d.version.compareTo(l)>0)}Ss(e,s,a){return ll()<=St.DEBUG&&He("QueryEngine","Using full collection scan to execute query:",cl(s)),this.ps.getDocumentsMatchingQuery(e,s,Oa.min(),a)}vs(e,s,a,l){return this.ps.getDocumentsMatchingQuery(e,a,l).next((d=>(s.forEach((h=>{d=d.insert(h.key,h)})),d)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yg="LocalStore",NC=3e8;class SC{constructor(e,s,a,l){this.persistence=e,this.Fs=s,this.serializer=l,this.Ms=new rs(Et),this.xs=new jo((d=>Ug(d)),Bg),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(a)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new hC(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(s=>e.collect(s,this.Ms)))}}function EC(n,e,s,a){return new SC(n,e,s,a)}function Rw(n,e){return K(this,null,function*(){const s=mt(n);return yield s.persistence.runTransaction("Handle user change","readonly",(a=>{let l;return s.mutationQueue.getAllMutationBatches(a).next((d=>(l=d,s.Bs(e),s.mutationQueue.getAllMutationBatches(a)))).next((d=>{const h=[],f=[];let b=jt();for(const v of l){h.push(v.batchId);for(const E of v.mutations)b=b.add(E.key)}for(const v of d){f.push(v.batchId);for(const E of v.mutations)b=b.add(E.key)}return s.localDocuments.getDocuments(a,b).next((v=>({Ls:v,removedBatchIds:h,addedBatchIds:f})))}))}))})}function jC(n,e){const s=mt(n);return s.persistence.runTransaction("Acknowledge batch","readwrite-primary",(a=>{const l=e.batch.keys(),d=s.Ns.newChangeBuffer({trackRemovals:!0});return(function(f,b,v,E){const D=v.batch,_=D.keys();let R=Le.resolve();return _.forEach((U=>{R=R.next((()=>E.getEntry(b,U))).next((ie=>{const he=v.docVersions.get(U);Pt(he!==null,48541),ie.version.compareTo(he)<0&&(D.applyToRemoteDocument(ie,v),ie.isValidDocument()&&(ie.setReadTime(v.commitVersion),E.addEntry(ie)))}))})),R.next((()=>f.mutationQueue.removeMutationBatch(b,D)))})(s,a,e,d).next((()=>d.apply(a))).next((()=>s.mutationQueue.performConsistencyCheck(a))).next((()=>s.documentOverlayCache.removeOverlaysForBatchId(a,l,e.batch.batchId))).next((()=>s.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(a,(function(f){let b=jt();for(let v=0;v<f.mutationResults.length;++v)f.mutationResults[v].transformResults.length>0&&(b=b.add(f.batch.mutations[v].key));return b})(e)))).next((()=>s.localDocuments.getDocuments(a,l)))}))}function Dw(n){const e=mt(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(s=>e.Pi.getLastRemoteSnapshotVersion(s)))}function TC(n,e){const s=mt(n),a=e.snapshotVersion;let l=s.Ms;return s.persistence.runTransaction("Apply remote event","readwrite-primary",(d=>{const h=s.Ns.newChangeBuffer({trackRemovals:!0});l=s.Ms;const f=[];e.targetChanges.forEach(((E,D)=>{const _=l.get(D);if(!_)return;f.push(s.Pi.removeMatchingKeys(d,E.removedDocuments,D).next((()=>s.Pi.addMatchingKeys(d,E.addedDocuments,D))));let R=_.withSequenceNumber(d.currentSequenceNumber);e.targetMismatches.get(D)!==null?R=R.withResumeToken(Vs.EMPTY_BYTE_STRING,ft.min()).withLastLimboFreeSnapshotVersion(ft.min()):E.resumeToken.approximateByteSize()>0&&(R=R.withResumeToken(E.resumeToken,a)),l=l.insert(D,R),(function(ie,he,Se){return ie.resumeToken.approximateByteSize()===0||he.snapshotVersion.toMicroseconds()-ie.snapshotVersion.toMicroseconds()>=NC?!0:Se.addedDocuments.size+Se.modifiedDocuments.size+Se.removedDocuments.size>0})(_,R,E)&&f.push(s.Pi.updateTargetData(d,R))}));let b=Hi(),v=jt();if(e.documentUpdates.forEach((E=>{e.resolvedLimboDocuments.has(E)&&f.push(s.persistence.referenceDelegate.updateLimboDocument(d,E))})),f.push(AC(d,h,e.documentUpdates).next((E=>{b=E.ks,v=E.qs}))),!a.isEqual(ft.min())){const E=s.Pi.getLastRemoteSnapshotVersion(d).next((D=>s.Pi.setTargetsMetadata(d,d.currentSequenceNumber,a)));f.push(E)}return Le.waitFor(f).next((()=>h.apply(d))).next((()=>s.localDocuments.getLocalViewOfDocuments(d,b,v))).next((()=>b))})).then((d=>(s.Ms=l,d)))}function AC(n,e,s){let a=jt(),l=jt();return s.forEach((d=>a=a.add(d))),e.getEntries(n,a).next((d=>{let h=Hi();return s.forEach(((f,b)=>{const v=d.get(f);b.isFoundDocument()!==v.isFoundDocument()&&(l=l.add(f)),b.isNoDocument()&&b.version.isEqual(ft.min())?(e.removeEntry(f,b.readTime),h=h.insert(f,b)):!v.isValidDocument()||b.version.compareTo(v.version)>0||b.version.compareTo(v.version)===0&&v.hasPendingWrites?(e.addEntry(b),h=h.insert(f,b)):He(Yg,"Ignoring outdated watch update for ",f,". Current version:",v.version," Watch version:",b.version)})),{ks:h,qs:l}}))}function CC(n,e){const s=mt(n);return s.persistence.runTransaction("Get next mutation batch","readonly",(a=>(e===void 0&&(e=Pg),s.mutationQueue.getNextMutationBatchAfterBatchId(a,e))))}function IC(n,e){const s=mt(n);return s.persistence.runTransaction("Allocate target","readwrite",(a=>{let l;return s.Pi.getTargetData(a,e).next((d=>d?(l=d,Le.resolve(l)):s.Pi.allocateTargetId(a).next((h=>(l=new ja(e,h,"TargetPurposeListen",a.currentSequenceNumber),s.Pi.addTargetData(a,l).next((()=>l)))))))})).then((a=>{const l=s.Ms.get(a.targetId);return(l===null||a.snapshotVersion.compareTo(l.snapshotVersion)>0)&&(s.Ms=s.Ms.insert(a.targetId,a),s.xs.set(e,a.targetId)),a}))}function lg(n,e,s){return K(this,null,function*(){const a=mt(n),l=a.Ms.get(e),d=s?"readwrite":"readwrite-primary";try{s||(yield a.persistence.runTransaction("Release target",d,(h=>a.persistence.referenceDelegate.removeTarget(h,l))))}catch(h){if(!Dl(h))throw h;He(Yg,`Failed to update sequence numbers for target ${e}: ${h}`)}a.Ms=a.Ms.remove(e),a.xs.delete(l.target)})}function Jb(n,e,s){const a=mt(n);let l=ft.min(),d=jt();return a.persistence.runTransaction("Execute query","readwrite",(h=>(function(b,v,E){const D=mt(b),_=D.xs.get(E);return _!==void 0?Le.resolve(D.Ms.get(_)):D.Pi.getTargetData(v,E)})(a,h,Zr(e)).next((f=>{if(f)return l=f.lastLimboFreeSnapshotVersion,a.Pi.getMatchingKeysForTargetId(h,f.targetId).next((b=>{d=b}))})).next((()=>a.Fs.getDocumentsMatchingQuery(h,e,s?l:ft.min(),s?d:jt()))).next((f=>(RC(a,pA(e),f),{documents:f,Qs:d})))))}function RC(n,e,s){let a=n.Os.get(e)||ft.min();s.forEach(((l,d)=>{d.readTime.compareTo(a)>0&&(a=d.readTime)})),n.Os.set(e,a)}class Zb{constructor(){this.activeTargetIds=wA()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class DC{constructor(){this.Mo=new Zb,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,s,a){}addLocalQueryTarget(e,s=!0){return s&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,s,a){this.xo[e]=s}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Zb,Promise.resolve()}handleUserChange(e,s,a){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OC{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ev="ConnectivityMonitor";class tv{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){He(ev,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){He(ev,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window!="undefined"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wd=null;function cg(){return wd===null?wd=(function(){return 268435456+Math.round(2147483648*Math.random())})():wd++,"0x"+wd.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dm="RestConnection",kC={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class MC{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const s=e.ssl?"https":"http",a=encodeURIComponent(this.databaseId.projectId),l=encodeURIComponent(this.databaseId.database);this.Uo=s+"://"+e.host,this.Ko=`projects/${a}/databases/${l}`,this.Wo=this.databaseId.database===Qd?`project_id=${a}`:`project_id=${a}&database_id=${l}`}Go(e,s,a,l,d){const h=cg(),f=this.zo(e,s.toUriEncodedString());He(Dm,`Sending RPC '${e}' ${h}:`,f,a);const b={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(b,l,d);const{host:v}=new URL(f),E=No(v);return this.Jo(e,f,b,a,E).then((D=>(He(Dm,`Received RPC '${e}' ${h}: `,D),D)),(D=>{throw Nl(Dm,`RPC '${e}' ${h} failed with error: `,D,"url: ",f,"request:",a),D}))}Ho(e,s,a,l,d,h){return this.Go(e,s,a,l,d)}jo(e,s,a){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Il})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),s&&s.headers.forEach(((l,d)=>e[d]=l)),a&&a.headers.forEach(((l,d)=>e[d]=l))}zo(e,s){const a=kC[e];return`${this.Uo}/v1/${s}:${a}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PC{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fs="WebChannelConnection";class LC extends MC{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,s,a,l,d){const h=cg();return new Promise(((f,b)=>{const v=new k_;v.setWithCredentials(!0),v.listenOnce(M_.COMPLETE,(()=>{try{switch(v.getLastErrorCode()){case Dd.NO_ERROR:const D=v.getResponseJson();He(Fs,`XHR for RPC '${e}' ${h} received:`,JSON.stringify(D)),f(D);break;case Dd.TIMEOUT:He(Fs,`RPC '${e}' ${h} timed out`),b(new qe(ke.DEADLINE_EXCEEDED,"Request time out"));break;case Dd.HTTP_ERROR:const _=v.getStatus();if(He(Fs,`RPC '${e}' ${h} failed with status:`,_,"response text:",v.getResponseText()),_>0){let R=v.getResponseJson();Array.isArray(R)&&(R=R[0]);const U=R==null?void 0:R.error;if(U&&U.status&&U.message){const ie=(function(Se){const Be=Se.toLowerCase().replace(/_/g,"-");return Object.values(ke).indexOf(Be)>=0?Be:ke.UNKNOWN})(U.status);b(new qe(ie,U.message))}else b(new qe(ke.UNKNOWN,"Server responded with status "+v.getStatus()))}else b(new qe(ke.UNAVAILABLE,"Connection failed."));break;default:ct(9055,{l_:e,streamId:h,h_:v.getLastErrorCode(),P_:v.getLastError()})}}finally{He(Fs,`RPC '${e}' ${h} completed.`)}}));const E=JSON.stringify(l);He(Fs,`RPC '${e}' ${h} sending request:`,l),v.send(s,"POST",E,a,15)}))}T_(e,s,a){const l=cg(),d=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],h=V_(),f=L_(),b={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},v=this.longPollingOptions.timeoutSeconds;v!==void 0&&(b.longPollingTimeout=Math.round(1e3*v)),this.useFetchStreams&&(b.useFetchStreams=!0),this.jo(b.initMessageHeaders,s,a),b.encodeInitMessageHeaders=!0;const E=d.join("");He(Fs,`Creating RPC '${e}' stream ${l}: ${E}`,b);const D=h.createWebChannel(E,b);this.I_(D);let _=!1,R=!1;const U=new PC({Yo:he=>{R?He(Fs,`Not sending because RPC '${e}' stream ${l} is closed:`,he):(_||(He(Fs,`Opening RPC '${e}' stream ${l} transport.`),D.open(),_=!0),He(Fs,`RPC '${e}' stream ${l} sending:`,he),D.send(he))},Zo:()=>D.close()}),ie=(he,Se,Be)=>{he.listen(Se,(xe=>{try{Be(xe)}catch(_e){setTimeout((()=>{throw _e}),0)}}))};return ie(D,Dc.EventType.OPEN,(()=>{R||(He(Fs,`RPC '${e}' stream ${l} transport opened.`),U.o_())})),ie(D,Dc.EventType.CLOSE,(()=>{R||(R=!0,He(Fs,`RPC '${e}' stream ${l} transport closed`),U.a_(),this.E_(D))})),ie(D,Dc.EventType.ERROR,(he=>{R||(R=!0,Nl(Fs,`RPC '${e}' stream ${l} transport errored. Name:`,he.name,"Message:",he.message),U.a_(new qe(ke.UNAVAILABLE,"The operation could not be completed")))})),ie(D,Dc.EventType.MESSAGE,(he=>{var Se;if(!R){const Be=he.data[0];Pt(!!Be,16349);const xe=Be,_e=(xe==null?void 0:xe.error)||((Se=xe[0])==null?void 0:Se.error);if(_e){He(Fs,`RPC '${e}' stream ${l} received error:`,_e);const Ne=_e.status;let De=(function(L){const z=ps[L];if(z!==void 0)return bw(z)})(Ne),G=_e.message;De===void 0&&(De=ke.INTERNAL,G="Unknown error status: "+Ne+" with message "+_e.message),R=!0,U.a_(new qe(De,G)),D.close()}else He(Fs,`RPC '${e}' stream ${l} received:`,Be),U.u_(Be)}})),ie(f,P_.STAT_EVENT,(he=>{he.stat===Xm.PROXY?He(Fs,`RPC '${e}' stream ${l} detected buffering proxy`):he.stat===Xm.NOPROXY&&He(Fs,`RPC '${e}' stream ${l} detected no buffering proxy`)})),setTimeout((()=>{U.__()}),0),U}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((s=>s===e))}}function Om(){return typeof document!="undefined"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vh(n){return new zA(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ow{constructor(e,s,a=1e3,l=1.5,d=6e4){this.Mi=e,this.timerId=s,this.d_=a,this.A_=l,this.R_=d,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const s=Math.floor(this.V_+this.y_()),a=Math.max(0,Date.now()-this.f_),l=Math.max(0,s-a);l>0&&He("ExponentialBackoff",`Backing off for ${l} ms (base delay: ${this.V_} ms, delay with jitter: ${s} ms, last attempt: ${a} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,l,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sv="PersistentStream";class kw{constructor(e,s,a,l,d,h,f,b){this.Mi=e,this.S_=a,this.b_=l,this.connection=d,this.authCredentialsProvider=h,this.appCheckCredentialsProvider=f,this.listener=b,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Ow(e,s)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}stop(){return K(this,null,function*(){this.x_()&&(yield this.close(0))})}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}k_(){return K(this,null,function*(){if(this.O_())return this.close(0)})}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}close(e,s){return K(this,null,function*(){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():s&&s.code===ke.RESOURCE_EXHAUSTED?(qi(s.toString()),qi("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):s&&s.code===ke.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.r_(s)})}K_(){}auth(){this.state=1;const e=this.W_(this.D_),s=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([a,l])=>{this.D_===s&&this.G_(a,l)}),(a=>{e((()=>{const l=new qe(ke.UNKNOWN,"Fetching auth token failed: "+a.message);return this.z_(l)}))}))}G_(e,s){const a=this.W_(this.D_);this.stream=this.j_(e,s),this.stream.Xo((()=>{a((()=>this.listener.Xo()))})),this.stream.t_((()=>{a((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((l=>{a((()=>this.z_(l)))})),this.stream.onMessage((l=>{a((()=>++this.F_==1?this.J_(l):this.onNext(l)))}))}N_(){this.state=5,this.M_.p_((()=>K(this,null,function*(){this.state=0,this.start()})))}z_(e){return He(sv,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return s=>{this.Mi.enqueueAndForget((()=>this.D_===e?s():(He(sv,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class VC extends kw{constructor(e,s,a,l,d,h){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",s,a,l,h),this.serializer=d}j_(e,s){return this.connection.T_("Listen",e,s)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const s=HA(this.serializer,e),a=(function(d){if(!("targetChange"in d))return ft.min();const h=d.targetChange;return h.targetIds&&h.targetIds.length?ft.min():h.readTime?ei(h.readTime):ft.min()})(e);return this.listener.H_(s,a)}Y_(e){const s={};s.database=og(this.serializer),s.addTarget=(function(d,h){let f;const b=h.target;if(f=tg(b)?{documents:QA(d,b)}:{query:KA(d,b).ft},f.targetId=h.targetId,h.resumeToken.approximateByteSize()>0){f.resumeToken=ww(d,h.resumeToken);const v=rg(d,h.expectedCount);v!==null&&(f.expectedCount=v)}else if(h.snapshotVersion.compareTo(ft.min())>0){f.readTime=Jd(d,h.snapshotVersion.toTimestamp());const v=rg(d,h.expectedCount);v!==null&&(f.expectedCount=v)}return f})(this.serializer,e);const a=XA(this.serializer,e);a&&(s.labels=a),this.q_(s)}Z_(e){const s={};s.database=og(this.serializer),s.removeTarget=e,this.q_(s)}}class UC extends kw{constructor(e,s,a,l,d,h){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",s,a,l,h),this.serializer=d}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,s){return this.connection.T_("Write",e,s)}J_(e){return Pt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Pt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Pt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const s=$A(e.writeResults,e.commitTime),a=ei(e.commitTime);return this.listener.na(a,s)}ra(){const e={};e.database=og(this.serializer),this.q_(e)}ea(e){const s={streamToken:this.lastStreamToken,writes:e.map((a=>GA(this.serializer,a)))};this.q_(s)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BC{}class zC extends BC{constructor(e,s,a,l){super(),this.authCredentials=e,this.appCheckCredentials=s,this.connection=a,this.serializer=l,this.ia=!1}sa(){if(this.ia)throw new qe(ke.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,s,a,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([d,h])=>this.connection.Go(e,ig(s,a),l,d,h))).catch((d=>{throw d.name==="FirebaseError"?(d.code===ke.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),d):new qe(ke.UNKNOWN,d.toString())}))}Ho(e,s,a,l,d){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([h,f])=>this.connection.Ho(e,ig(s,a),l,h,f,d))).catch((h=>{throw h.name==="FirebaseError"?(h.code===ke.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),h):new qe(ke.UNKNOWN,h.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class FC{constructor(e,s){this.asyncQueue=e,this.onlineStateHandler=s,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const s=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(qi(s),this.aa=!1):He("OnlineStateTracker",s)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wo="RemoteStore";class qC{constructor(e,s,a,l,d){this.localStore=e,this.datastore=s,this.asyncQueue=a,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=d,this.Aa.Oo((h=>{a.enqueueAndForget((()=>K(this,null,function*(){Ao(this)&&(He(wo,"Restarting streams for network reachability change."),yield(function(b){return K(this,null,function*(){const v=mt(b);v.Ea.add(4),yield du(v),v.Ra.set("Unknown"),v.Ea.delete(4),yield _h(v)})})(this))})))})),this.Ra=new FC(a,l)}}function _h(n){return K(this,null,function*(){if(Ao(n))for(const e of n.da)yield e(!0)})}function du(n){return K(this,null,function*(){for(const e of n.da)yield e(!1)})}function Mw(n,e){const s=mt(n);s.Ia.has(e.targetId)||(s.Ia.set(e.targetId,e),Zg(s)?Jg(s):kl(s).O_()&&Wg(s,e))}function Xg(n,e){const s=mt(n),a=kl(s);s.Ia.delete(e),a.O_()&&Pw(s,e),s.Ia.size===0&&(a.O_()?a.L_():Ao(s)&&s.Ra.set("Unknown"))}function Wg(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ft.min())>0){const s=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(s)}kl(n).Y_(e)}function Pw(n,e){n.Va.Ue(e),kl(n).Z_(e)}function Jg(n){n.Va=new LA({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),kl(n).start(),n.Ra.ua()}function Zg(n){return Ao(n)&&!kl(n).x_()&&n.Ia.size>0}function Ao(n){return mt(n).Ea.size===0}function Lw(n){n.Va=void 0}function HC(n){return K(this,null,function*(){n.Ra.set("Online")})}function GC(n){return K(this,null,function*(){n.Ia.forEach(((e,s)=>{Wg(n,e)}))})}function $C(n,e){return K(this,null,function*(){Lw(n),Zg(n)?(n.Ra.ha(e),Jg(n)):n.Ra.set("Unknown")})}function QC(n,e,s){return K(this,null,function*(){if(n.Ra.set("Online"),e instanceof _w&&e.state===2&&e.cause)try{yield(function(l,d){return K(this,null,function*(){const h=d.cause;for(const f of d.targetIds)l.Ia.has(f)&&(yield l.remoteSyncer.rejectListen(f,h),l.Ia.delete(f),l.Va.removeTarget(f))})})(n,e)}catch(a){He(wo,"Failed to remove targets %s: %s ",e.targetIds.join(","),a),yield eh(n,a)}else if(e instanceof Pd?n.Va.Ze(e):e instanceof vw?n.Va.st(e):n.Va.tt(e),!s.isEqual(ft.min()))try{const a=yield Dw(n.localStore);s.compareTo(a)>=0&&(yield(function(d,h){const f=d.Va.Tt(h);return f.targetChanges.forEach(((b,v)=>{if(b.resumeToken.approximateByteSize()>0){const E=d.Ia.get(v);E&&d.Ia.set(v,E.withResumeToken(b.resumeToken,h))}})),f.targetMismatches.forEach(((b,v)=>{const E=d.Ia.get(b);if(!E)return;d.Ia.set(b,E.withResumeToken(Vs.EMPTY_BYTE_STRING,E.snapshotVersion)),Pw(d,b);const D=new ja(E.target,b,v,E.sequenceNumber);Wg(d,D)})),d.remoteSyncer.applyRemoteEvent(f)})(n,s))}catch(a){He(wo,"Failed to raise snapshot:",a),yield eh(n,a)}})}function eh(n,e,s){return K(this,null,function*(){if(!Dl(e))throw e;n.Ea.add(1),yield du(n),n.Ra.set("Offline"),s||(s=()=>Dw(n.localStore)),n.asyncQueue.enqueueRetryable((()=>K(null,null,function*(){He(wo,"Retrying IndexedDB access"),yield s(),n.Ea.delete(1),yield _h(n)})))})}function Vw(n,e){return e().catch((s=>eh(n,s,e)))}function wh(n){return K(this,null,function*(){const e=mt(n),s=La(e);let a=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Pg;for(;KC(e);)try{const l=yield CC(e.localStore,a);if(l===null){e.Ta.length===0&&s.L_();break}a=l.batchId,YC(e,l)}catch(l){yield eh(e,l)}Uw(e)&&Bw(e)})}function KC(n){return Ao(n)&&n.Ta.length<10}function YC(n,e){n.Ta.push(e);const s=La(n);s.O_()&&s.X_&&s.ea(e.mutations)}function Uw(n){return Ao(n)&&!La(n).x_()&&n.Ta.length>0}function Bw(n){La(n).start()}function XC(n){return K(this,null,function*(){La(n).ra()})}function WC(n){return K(this,null,function*(){const e=La(n);for(const s of n.Ta)e.ea(s.mutations)})}function JC(n,e,s){return K(this,null,function*(){const a=n.Ta.shift(),l=qg.from(a,e,s);yield Vw(n,(()=>n.remoteSyncer.applySuccessfulWrite(l))),yield wh(n)})}function ZC(n,e){return K(this,null,function*(){e&&La(n).X_&&(yield(function(a,l){return K(this,null,function*(){if((function(h){return kA(h)&&h!==ke.ABORTED})(l.code)){const d=a.Ta.shift();La(a).B_(),yield Vw(a,(()=>a.remoteSyncer.rejectFailedWrite(d.batchId,l))),yield wh(a)}})})(n,e)),Uw(n)&&Bw(n)})}function nv(n,e){return K(this,null,function*(){const s=mt(n);s.asyncQueue.verifyOperationInProgress(),He(wo,"RemoteStore received new credentials");const a=Ao(s);s.Ea.add(3),yield du(s),a&&s.Ra.set("Unknown"),yield s.remoteSyncer.handleCredentialChange(e),s.Ea.delete(3),yield _h(s)})}function eI(n,e){return K(this,null,function*(){const s=mt(n);e?(s.Ea.delete(2),yield _h(s)):e||(s.Ea.add(2),yield du(s),s.Ra.set("Unknown"))})}function kl(n){return n.ma||(n.ma=(function(s,a,l){const d=mt(s);return d.sa(),new VC(a,d.connection,d.authCredentials,d.appCheckCredentials,d.serializer,l)})(n.datastore,n.asyncQueue,{Xo:HC.bind(null,n),t_:GC.bind(null,n),r_:$C.bind(null,n),H_:QC.bind(null,n)}),n.da.push((e=>K(null,null,function*(){e?(n.ma.B_(),Zg(n)?Jg(n):n.Ra.set("Unknown")):(yield n.ma.stop(),Lw(n))})))),n.ma}function La(n){return n.fa||(n.fa=(function(s,a,l){const d=mt(s);return d.sa(),new UC(a,d.connection,d.authCredentials,d.appCheckCredentials,d.serializer,l)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:XC.bind(null,n),r_:ZC.bind(null,n),ta:WC.bind(null,n),na:JC.bind(null,n)}),n.da.push((e=>K(null,null,function*(){e?(n.fa.B_(),yield wh(n)):(yield n.fa.stop(),n.Ta.length>0&&(He(wo,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))})))),n.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ep{constructor(e,s,a,l,d){this.asyncQueue=e,this.timerId=s,this.targetTimeMs=a,this.op=l,this.removalCallback=d,this.deferred=new Li,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((h=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,s,a,l,d){const h=Date.now()+a,f=new ep(e,s,h,l,d);return f.start(a),f}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new qe(ke.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function tp(n,e){if(qi("AsyncQueue",`${e}: ${n}`),Dl(n))return new qe(ke.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bl{static emptySet(e){return new bl(e.comparator)}constructor(e){this.comparator=e?(s,a)=>e(s,a)||nt.comparator(s.key,a.key):(s,a)=>nt.comparator(s.key,a.key),this.keyedMap=Oc(),this.sortedSet=new rs(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const s=this.keyedMap.get(e);return s?this.sortedSet.indexOf(s):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((s,a)=>(e(s),!1)))}add(e){const s=this.delete(e.key);return s.copy(s.keyedMap.insert(e.key,e),s.sortedSet.insert(e,null))}delete(e){const s=this.get(e);return s?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(s)):this}isEqual(e){if(!(e instanceof bl)||this.size!==e.size)return!1;const s=this.sortedSet.getIterator(),a=e.sortedSet.getIterator();for(;s.hasNext();){const l=s.getNext().key,d=a.getNext().key;if(!l.isEqual(d))return!1}return!0}toString(){const e=[];return this.forEach((s=>{e.push(s.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,s){const a=new bl;return a.comparator=this.comparator,a.keyedMap=e,a.sortedSet=s,a}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rv{constructor(){this.ga=new rs(nt.comparator)}track(e){const s=e.doc.key,a=this.ga.get(s);a?e.type!==0&&a.type===3?this.ga=this.ga.insert(s,e):e.type===3&&a.type!==1?this.ga=this.ga.insert(s,{type:a.type,doc:e.doc}):e.type===2&&a.type===2?this.ga=this.ga.insert(s,{type:2,doc:e.doc}):e.type===2&&a.type===0?this.ga=this.ga.insert(s,{type:0,doc:e.doc}):e.type===1&&a.type===0?this.ga=this.ga.remove(s):e.type===1&&a.type===2?this.ga=this.ga.insert(s,{type:1,doc:a.doc}):e.type===0&&a.type===1?this.ga=this.ga.insert(s,{type:2,doc:e.doc}):ct(63341,{Rt:e,pa:a}):this.ga=this.ga.insert(s,e)}ya(){const e=[];return this.ga.inorderTraversal(((s,a)=>{e.push(a)})),e}}class Al{constructor(e,s,a,l,d,h,f,b,v){this.query=e,this.docs=s,this.oldDocs=a,this.docChanges=l,this.mutatedKeys=d,this.fromCache=h,this.syncStateChanged=f,this.excludesMetadataChanges=b,this.hasCachedResults=v}static fromInitialDocuments(e,s,a,l,d){const h=[];return s.forEach((f=>{h.push({type:0,doc:f})})),new Al(e,s,bl.emptySet(s),h,a,l,!0,!1,d)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&gh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const s=this.docChanges,a=e.docChanges;if(s.length!==a.length)return!1;for(let l=0;l<s.length;l++)if(s[l].type!==a[l].type||!s[l].doc.isEqual(a[l].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tI{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class sI{constructor(){this.queries=iv(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(s,a){const l=mt(s),d=l.queries;l.queries=iv(),d.forEach(((h,f)=>{for(const b of f.Sa)b.onError(a)}))})(this,new qe(ke.ABORTED,"Firestore shutting down"))}}function iv(){return new jo((n=>aw(n)),gh)}function zw(n,e){return K(this,null,function*(){const s=mt(n);let a=3;const l=e.query;let d=s.queries.get(l);d?!d.ba()&&e.Da()&&(a=2):(d=new tI,a=e.Da()?0:1);try{switch(a){case 0:d.wa=yield s.onListen(l,!0);break;case 1:d.wa=yield s.onListen(l,!1);break;case 2:yield s.onFirstRemoteStoreListen(l)}}catch(h){const f=tp(h,`Initialization of query '${cl(e.query)}' failed`);return void e.onError(f)}s.queries.set(l,d),d.Sa.push(e),e.va(s.onlineState),d.wa&&e.Fa(d.wa)&&sp(s)})}function Fw(n,e){return K(this,null,function*(){const s=mt(n),a=e.query;let l=3;const d=s.queries.get(a);if(d){const h=d.Sa.indexOf(e);h>=0&&(d.Sa.splice(h,1),d.Sa.length===0?l=e.Da()?0:1:!d.ba()&&e.Da()&&(l=2))}switch(l){case 0:return s.queries.delete(a),s.onUnlisten(a,!0);case 1:return s.queries.delete(a),s.onUnlisten(a,!1);case 2:return s.onLastRemoteStoreUnlisten(a);default:return}})}function nI(n,e){const s=mt(n);let a=!1;for(const l of e){const d=l.query,h=s.queries.get(d);if(h){for(const f of h.Sa)f.Fa(l)&&(a=!0);h.wa=l}}a&&sp(s)}function rI(n,e,s){const a=mt(n),l=a.queries.get(e);if(l)for(const d of l.Sa)d.onError(s);a.queries.delete(e)}function sp(n){n.Ca.forEach((e=>{e.next()}))}var ug,av;(av=ug||(ug={})).Ma="default",av.Cache="cache";class qw{constructor(e,s,a){this.query=e,this.xa=s,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=a||{}}Fa(e){if(!this.options.includeMetadataChanges){const a=[];for(const l of e.docChanges)l.type!==3&&a.push(l);e=new Al(e.query,e.docs,e.oldDocs,a,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let s=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),s=!0):this.La(e,this.onlineState)&&(this.ka(e),s=!0),this.Na=e,s}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let s=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),s=!0),s}La(e,s){if(!e.fromCache||!this.Da())return!0;const a=s!=="Offline";return(!this.options.qa||!a)&&(!e.docs.isEmpty()||e.hasCachedResults||s==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const s=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!s)&&this.options.includeMetadataChanges===!0}ka(e){e=Al.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==ug.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hw{constructor(e){this.key=e}}class Gw{constructor(e){this.key=e}}class iI{constructor(e,s){this.query=e,this.Ya=s,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=jt(),this.mutatedKeys=jt(),this.eu=ow(e),this.tu=new bl(this.eu)}get nu(){return this.Ya}ru(e,s){const a=s?s.iu:new rv,l=s?s.tu:this.tu;let d=s?s.mutatedKeys:this.mutatedKeys,h=l,f=!1;const b=this.query.limitType==="F"&&l.size===this.query.limit?l.last():null,v=this.query.limitType==="L"&&l.size===this.query.limit?l.first():null;if(e.inorderTraversal(((E,D)=>{const _=l.get(E),R=ph(this.query,D)?D:null,U=!!_&&this.mutatedKeys.has(_.key),ie=!!R&&(R.hasLocalMutations||this.mutatedKeys.has(R.key)&&R.hasCommittedMutations);let he=!1;_&&R?_.data.isEqual(R.data)?U!==ie&&(a.track({type:3,doc:R}),he=!0):this.su(_,R)||(a.track({type:2,doc:R}),he=!0,(b&&this.eu(R,b)>0||v&&this.eu(R,v)<0)&&(f=!0)):!_&&R?(a.track({type:0,doc:R}),he=!0):_&&!R&&(a.track({type:1,doc:_}),he=!0,(b||v)&&(f=!0)),he&&(R?(h=h.add(R),d=ie?d.add(E):d.delete(E)):(h=h.delete(E),d=d.delete(E)))})),this.query.limit!==null)for(;h.size>this.query.limit;){const E=this.query.limitType==="F"?h.last():h.first();h=h.delete(E.key),d=d.delete(E.key),a.track({type:1,doc:E})}return{tu:h,iu:a,Cs:f,mutatedKeys:d}}su(e,s){return e.hasLocalMutations&&s.hasCommittedMutations&&!s.hasLocalMutations}applyChanges(e,s,a,l){const d=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const h=e.iu.ya();h.sort(((E,D)=>(function(R,U){const ie=he=>{switch(he){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ct(20277,{Rt:he})}};return ie(R)-ie(U)})(E.type,D.type)||this.eu(E.doc,D.doc))),this.ou(a),l=l!=null?l:!1;const f=s&&!l?this._u():[],b=this.Xa.size===0&&this.current&&!l?1:0,v=b!==this.Za;return this.Za=b,h.length!==0||v?{snapshot:new Al(this.query,e.tu,d,h,e.mutatedKeys,b===0,v,!1,!!a&&a.resumeToken.approximateByteSize()>0),au:f}:{au:f}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new rv,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((s=>this.Ya=this.Ya.add(s))),e.modifiedDocuments.forEach((s=>{})),e.removedDocuments.forEach((s=>this.Ya=this.Ya.delete(s))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=jt(),this.tu.forEach((a=>{this.uu(a.key)&&(this.Xa=this.Xa.add(a.key))}));const s=[];return e.forEach((a=>{this.Xa.has(a)||s.push(new Gw(a))})),this.Xa.forEach((a=>{e.has(a)||s.push(new Hw(a))})),s}cu(e){this.Ya=e.Qs,this.Xa=jt();const s=this.ru(e.documents);return this.applyChanges(s,!0)}lu(){return Al.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const np="SyncEngine";class aI{constructor(e,s,a){this.query=e,this.targetId=s,this.view=a}}class oI{constructor(e){this.key=e,this.hu=!1}}class lI{constructor(e,s,a,l,d,h){this.localStore=e,this.remoteStore=s,this.eventManager=a,this.sharedClientState=l,this.currentUser=d,this.maxConcurrentLimboResolutions=h,this.Pu={},this.Tu=new jo((f=>aw(f)),gh),this.Iu=new Map,this.Eu=new Set,this.du=new rs(nt.comparator),this.Au=new Map,this.Ru=new $g,this.Vu={},this.mu=new Map,this.fu=Tl.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}function cI(n,e,s=!0){return K(this,null,function*(){const a=Ww(n);let l;const d=a.Tu.get(e);return d?(a.sharedClientState.addLocalQueryTarget(d.targetId),l=d.view.lu()):l=yield $w(a,e,s,!0),l})}function uI(n,e){return K(this,null,function*(){const s=Ww(n);yield $w(s,e,!0,!1)})}function $w(n,e,s,a){return K(this,null,function*(){const l=yield IC(n.localStore,Zr(e)),d=l.targetId,h=n.sharedClientState.addLocalQueryTarget(d,s);let f;return a&&(f=yield dI(n,e,d,h==="current",l.resumeToken)),n.isPrimaryClient&&s&&Mw(n.remoteStore,l),f})}function dI(n,e,s,a,l){return K(this,null,function*(){n.pu=(D,_,R)=>(function(ie,he,Se,Be){return K(this,null,function*(){let xe=he.view.ru(Se);xe.Cs&&(xe=yield Jb(ie.localStore,he.query,!1).then((({documents:G})=>he.view.ru(G,xe))));const _e=Be&&Be.targetChanges.get(he.targetId),Ne=Be&&Be.targetMismatches.get(he.targetId)!=null,De=he.view.applyChanges(xe,ie.isPrimaryClient,_e,Ne);return lv(ie,he.targetId,De.au),De.snapshot})})(n,D,_,R);const d=yield Jb(n.localStore,e,!0),h=new iI(e,d.Qs),f=h.ru(d.documents),b=uu.createSynthesizedTargetChangeForCurrentChange(s,a&&n.onlineState!=="Offline",l),v=h.applyChanges(f,n.isPrimaryClient,b);lv(n,s,v.au);const E=new aI(e,s,h);return n.Tu.set(e,E),n.Iu.has(s)?n.Iu.get(s).push(e):n.Iu.set(s,[e]),v.snapshot})}function hI(n,e,s){return K(this,null,function*(){const a=mt(n),l=a.Tu.get(e),d=a.Iu.get(l.targetId);if(d.length>1)return a.Iu.set(l.targetId,d.filter((h=>!gh(h,e)))),void a.Tu.delete(e);a.isPrimaryClient?(a.sharedClientState.removeLocalQueryTarget(l.targetId),a.sharedClientState.isActiveQueryTarget(l.targetId)||(yield lg(a.localStore,l.targetId,!1).then((()=>{a.sharedClientState.clearQueryState(l.targetId),s&&Xg(a.remoteStore,l.targetId),dg(a,l.targetId)})).catch(Rl))):(dg(a,l.targetId),yield lg(a.localStore,l.targetId,!0))})}function fI(n,e){return K(this,null,function*(){const s=mt(n),a=s.Tu.get(e),l=s.Iu.get(a.targetId);s.isPrimaryClient&&l.length===1&&(s.sharedClientState.removeLocalQueryTarget(a.targetId),Xg(s.remoteStore,a.targetId))})}function mI(n,e,s){return K(this,null,function*(){const a=_I(n);try{const l=yield(function(h,f){const b=mt(h),v=Bt.now(),E=f.reduce(((R,U)=>R.add(U.key)),jt());let D,_;return b.persistence.runTransaction("Locally write mutations","readwrite",(R=>{let U=Hi(),ie=jt();return b.Ns.getEntries(R,E).next((he=>{U=he,U.forEach(((Se,Be)=>{Be.isValidDocument()||(ie=ie.add(Se))}))})).next((()=>b.localDocuments.getOverlayedDocuments(R,U))).next((he=>{D=he;const Se=[];for(const Be of f){const xe=CA(Be,D.get(Be.key).overlayedDocument);xe!=null&&Se.push(new To(Be.key,xe,J_(xe.value.mapValue),Vi.exists(!0)))}return b.mutationQueue.addMutationBatch(R,v,Se,f)})).next((he=>{_=he;const Se=he.applyToLocalDocumentSet(D,ie);return b.documentOverlayCache.saveOverlays(R,he.batchId,Se)}))})).then((()=>({batchId:_.batchId,changes:cw(D)})))})(a.localStore,e);a.sharedClientState.addPendingMutation(l.batchId),(function(h,f,b){let v=h.Vu[h.currentUser.toKey()];v||(v=new rs(Et)),v=v.insert(f,b),h.Vu[h.currentUser.toKey()]=v})(a,l.batchId,s),yield hu(a,l.changes),yield wh(a.remoteStore)}catch(l){const d=tp(l,"Failed to persist write");s.reject(d)}})}function Qw(n,e){return K(this,null,function*(){const s=mt(n);try{const a=yield TC(s.localStore,e);e.targetChanges.forEach(((l,d)=>{const h=s.Au.get(d);h&&(Pt(l.addedDocuments.size+l.modifiedDocuments.size+l.removedDocuments.size<=1,22616),l.addedDocuments.size>0?h.hu=!0:l.modifiedDocuments.size>0?Pt(h.hu,14607):l.removedDocuments.size>0&&(Pt(h.hu,42227),h.hu=!1))})),yield hu(s,a,e)}catch(a){yield Rl(a)}})}function ov(n,e,s){const a=mt(n);if(a.isPrimaryClient&&s===0||!a.isPrimaryClient&&s===1){const l=[];a.Tu.forEach(((d,h)=>{const f=h.view.va(e);f.snapshot&&l.push(f.snapshot)})),(function(h,f){const b=mt(h);b.onlineState=f;let v=!1;b.queries.forEach(((E,D)=>{for(const _ of D.Sa)_.va(f)&&(v=!0)})),v&&sp(b)})(a.eventManager,e),l.length&&a.Pu.H_(l),a.onlineState=e,a.isPrimaryClient&&a.sharedClientState.setOnlineState(e)}}function gI(n,e,s){return K(this,null,function*(){const a=mt(n);a.sharedClientState.updateQueryState(e,"rejected",s);const l=a.Au.get(e),d=l&&l.key;if(d){let h=new rs(nt.comparator);h=h.insert(d,Gs.newNoDocument(d,ft.min()));const f=jt().add(d),b=new bh(ft.min(),new Map,new rs(Et),h,f);yield Qw(a,b),a.du=a.du.remove(d),a.Au.delete(e),rp(a)}else yield lg(a.localStore,e,!1).then((()=>dg(a,e,s))).catch(Rl)})}function pI(n,e){return K(this,null,function*(){const s=mt(n),a=e.batch.batchId;try{const l=yield jC(s.localStore,e);Yw(s,a,null),Kw(s,a),s.sharedClientState.updateMutationState(a,"acknowledged"),yield hu(s,l)}catch(l){yield Rl(l)}})}function yI(n,e,s){return K(this,null,function*(){const a=mt(n);try{const l=yield(function(h,f){const b=mt(h);return b.persistence.runTransaction("Reject batch","readwrite-primary",(v=>{let E;return b.mutationQueue.lookupMutationBatch(v,f).next((D=>(Pt(D!==null,37113),E=D.keys(),b.mutationQueue.removeMutationBatch(v,D)))).next((()=>b.mutationQueue.performConsistencyCheck(v))).next((()=>b.documentOverlayCache.removeOverlaysForBatchId(v,E,f))).next((()=>b.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(v,E))).next((()=>b.localDocuments.getDocuments(v,E)))}))})(a.localStore,e);Yw(a,e,s),Kw(a,e),a.sharedClientState.updateMutationState(e,"rejected",s),yield hu(a,l)}catch(l){yield Rl(l)}})}function Kw(n,e){(n.mu.get(e)||[]).forEach((s=>{s.resolve()})),n.mu.delete(e)}function Yw(n,e,s){const a=mt(n);let l=a.Vu[a.currentUser.toKey()];if(l){const d=l.get(e);d&&(s?d.reject(s):d.resolve(),l=l.remove(e)),a.Vu[a.currentUser.toKey()]=l}}function dg(n,e,s=null){n.sharedClientState.removeLocalQueryTarget(e);for(const a of n.Iu.get(e))n.Tu.delete(a),s&&n.Pu.yu(a,s);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((a=>{n.Ru.containsKey(a)||Xw(n,a)}))}function Xw(n,e){n.Eu.delete(e.path.canonicalString());const s=n.du.get(e);s!==null&&(Xg(n.remoteStore,s),n.du=n.du.remove(e),n.Au.delete(s),rp(n))}function lv(n,e,s){for(const a of s)a instanceof Hw?(n.Ru.addReference(a.key,e),xI(n,a)):a instanceof Gw?(He(np,"Document no longer in limbo: "+a.key),n.Ru.removeReference(a.key,e),n.Ru.containsKey(a.key)||Xw(n,a.key)):ct(19791,{wu:a})}function xI(n,e){const s=e.key,a=s.path.canonicalString();n.du.get(s)||n.Eu.has(a)||(He(np,"New document in limbo: "+s),n.Eu.add(a),rp(n))}function rp(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const s=new nt(Yt.fromString(e)),a=n.fu.next();n.Au.set(a,new oI(s)),n.du=n.du.insert(s,a),Mw(n.remoteStore,new ja(Zr(zg(s.path)),a,"TargetPurposeLimboResolution",hh.ce))}}function hu(n,e,s){return K(this,null,function*(){const a=mt(n),l=[],d=[],h=[];a.Tu.isEmpty()||(a.Tu.forEach(((f,b)=>{h.push(a.pu(b,e,s).then((v=>{var E;if((v||s)&&a.isPrimaryClient){const D=v?!v.fromCache:(E=s==null?void 0:s.targetChanges.get(b.targetId))==null?void 0:E.current;a.sharedClientState.updateQueryState(b.targetId,D?"current":"not-current")}if(v){l.push(v);const D=Kg.As(b.targetId,v);d.push(D)}})))})),yield Promise.all(h),a.Pu.H_(l),yield(function(b,v){return K(this,null,function*(){const E=mt(b);try{yield E.persistence.runTransaction("notifyLocalViewChanges","readwrite",(D=>Le.forEach(v,(_=>Le.forEach(_.Es,(R=>E.persistence.referenceDelegate.addReference(D,_.targetId,R))).next((()=>Le.forEach(_.ds,(R=>E.persistence.referenceDelegate.removeReference(D,_.targetId,R)))))))))}catch(D){if(!Dl(D))throw D;He(Yg,"Failed to update sequence numbers: "+D)}for(const D of v){const _=D.targetId;if(!D.fromCache){const R=E.Ms.get(_),U=R.snapshotVersion,ie=R.withLastLimboFreeSnapshotVersion(U);E.Ms=E.Ms.insert(_,ie)}}})})(a.localStore,d))})}function bI(n,e){return K(this,null,function*(){const s=mt(n);if(!s.currentUser.isEqual(e)){He(np,"User change. New user:",e.toKey());const a=yield Rw(s.localStore,e);s.currentUser=e,(function(d,h){d.mu.forEach((f=>{f.forEach((b=>{b.reject(new qe(ke.CANCELLED,h))}))})),d.mu.clear()})(s,"'waitForPendingWrites' promise is rejected due to a user change."),s.sharedClientState.handleUserChange(e,a.removedBatchIds,a.addedBatchIds),yield hu(s,a.Ls)}})}function vI(n,e){const s=mt(n),a=s.Au.get(e);if(a&&a.hu)return jt().add(a.key);{let l=jt();const d=s.Iu.get(e);if(!d)return l;for(const h of d){const f=s.Tu.get(h);l=l.unionWith(f.view.nu)}return l}}function Ww(n){const e=mt(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Qw.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=vI.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=gI.bind(null,e),e.Pu.H_=nI.bind(null,e.eventManager),e.Pu.yu=rI.bind(null,e.eventManager),e}function _I(n){const e=mt(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=pI.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=yI.bind(null,e),e}class th{constructor(){this.kind="memory",this.synchronizeTabs=!1}initialize(e){return K(this,null,function*(){this.serializer=vh(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),yield this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)})}Fu(e,s){return null}Mu(e,s){return null}vu(e){return EC(this.persistence,new wC,e.initialUser,this.serializer)}Cu(e){return new Iw(Qg.mi,this.serializer)}Du(e){return new DC}terminate(){return K(this,null,function*(){var e,s;(e=this.gcScheduler)==null||e.stop(),(s=this.indexBackfillerScheduler)==null||s.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}}th.provider={build:()=>new th};class wI extends th{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,s){Pt(this.persistence.referenceDelegate instanceof Zd,46915);const a=this.persistence.referenceDelegate.garbageCollector;return new oC(a,e.asyncQueue,s)}Cu(e){const s=this.cacheSizeBytes!==void 0?gn.withCacheSize(this.cacheSizeBytes):gn.DEFAULT;return new Iw((a=>Zd.mi(a,s)),this.serializer)}}class hg{initialize(e,s){return K(this,null,function*(){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(s),this.remoteStore=this.createRemoteStore(s),this.eventManager=this.createEventManager(s),this.syncEngine=this.createSyncEngine(s,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=a=>ov(this.syncEngine,a,1),this.remoteStore.remoteSyncer.handleCredentialChange=bI.bind(null,this.syncEngine),yield eI(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(e){return(function(){return new sI})()}createDatastore(e){const s=vh(e.databaseInfo.databaseId),a=(function(d){return new LC(d)})(e.databaseInfo);return(function(d,h,f,b){return new zC(d,h,f,b)})(e.authCredentials,e.appCheckCredentials,a,s)}createRemoteStore(e){return(function(a,l,d,h,f){return new qC(a,l,d,h,f)})(this.localStore,this.datastore,e.asyncQueue,(s=>ov(this.syncEngine,s,0)),(function(){return tv.v()?new tv:new OC})())}createSyncEngine(e,s){return(function(l,d,h,f,b,v,E){const D=new lI(l,d,h,f,b,v);return E&&(D.gu=!0),D})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,s)}terminate(){return K(this,null,function*(){var e,s;yield(function(l){return K(this,null,function*(){const d=mt(l);He(wo,"RemoteStore shutting down."),d.Ea.add(5),yield du(d),d.Aa.shutdown(),d.Ra.set("Unknown")})})(this.remoteStore),(e=this.datastore)==null||e.terminate(),(s=this.eventManager)==null||s.terminate()})}}hg.provider={build:()=>new hg};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jw{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):qi("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,s){setTimeout((()=>{this.muted||e(s)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Va="FirestoreClient";class NI{constructor(e,s,a,l,d){this.authCredentials=e,this.appCheckCredentials=s,this.asyncQueue=a,this.databaseInfo=l,this.user=Hs.UNAUTHENTICATED,this.clientId=Mg.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=d,this.authCredentials.start(a,(h=>K(this,null,function*(){He(Va,"Received user=",h.uid),yield this.authCredentialListener(h),this.user=h}))),this.appCheckCredentials.start(a,(h=>(He(Va,"Received new app check token=",h),this.appCheckCredentialListener(h,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Li;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((()=>K(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(s){const a=tp(s,"Failed to shutdown persistence");e.reject(a)}}))),e.promise}}function km(n,e){return K(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),He(Va,"Initializing OfflineComponentProvider");const s=n.configuration;yield e.initialize(s);let a=s.initialUser;n.setCredentialChangeListener((l=>K(null,null,function*(){a.isEqual(l)||(yield Rw(e.localStore,l),a=l)}))),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e})}function cv(n,e){return K(this,null,function*(){n.asyncQueue.verifyOperationInProgress();const s=yield SI(n);He(Va,"Initializing OnlineComponentProvider"),yield e.initialize(s,n.configuration),n.setCredentialChangeListener((a=>nv(e.remoteStore,a))),n.setAppCheckTokenChangeListener(((a,l)=>nv(e.remoteStore,l))),n._onlineComponents=e})}function SI(n){return K(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){He(Va,"Using user provided OfflineComponentProvider");try{yield km(n,n._uninitializedComponentsProvider._offline)}catch(e){const s=e;if(!(function(l){return l.name==="FirebaseError"?l.code===ke.FAILED_PRECONDITION||l.code===ke.UNIMPLEMENTED:!(typeof DOMException!="undefined"&&l instanceof DOMException)||l.code===22||l.code===20||l.code===11})(s))throw s;Nl("Error using user provided cache. Falling back to memory cache: "+s),yield km(n,new th)}}else He(Va,"Using default OfflineComponentProvider"),yield km(n,new wI(void 0));return n._offlineComponents})}function Zw(n){return K(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(He(Va,"Using user provided OnlineComponentProvider"),yield cv(n,n._uninitializedComponentsProvider._online)):(He(Va,"Using default OnlineComponentProvider"),yield cv(n,new hg))),n._onlineComponents})}function EI(n){return Zw(n).then((e=>e.syncEngine))}function e1(n){return K(this,null,function*(){const e=yield Zw(n),s=e.eventManager;return s.onListen=cI.bind(null,e.syncEngine),s.onUnlisten=hI.bind(null,e.syncEngine),s.onFirstRemoteStoreListen=uI.bind(null,e.syncEngine),s.onLastRemoteStoreUnlisten=fI.bind(null,e.syncEngine),s})}function jI(n,e,s={}){const a=new Li;return n.asyncQueue.enqueueAndForget((()=>K(null,null,function*(){return(function(d,h,f,b,v){const E=new Jw({next:_=>{E.Nu(),h.enqueueAndForget((()=>Fw(d,D)));const R=_.docs.has(f);!R&&_.fromCache?v.reject(new qe(ke.UNAVAILABLE,"Failed to get document because the client is offline.")):R&&_.fromCache&&b&&b.source==="server"?v.reject(new qe(ke.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):v.resolve(_)},error:_=>v.reject(_)}),D=new qw(zg(f.path),E,{includeMetadataChanges:!0,qa:!0});return zw(d,D)})(yield e1(n),n.asyncQueue,e,s,a)}))),a.promise}function TI(n,e,s={}){const a=new Li;return n.asyncQueue.enqueueAndForget((()=>K(null,null,function*(){return(function(d,h,f,b,v){const E=new Jw({next:_=>{E.Nu(),h.enqueueAndForget((()=>Fw(d,D))),_.fromCache&&b.source==="server"?v.reject(new qe(ke.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):v.resolve(_)},error:_=>v.reject(_)}),D=new qw(f,E,{includeMetadataChanges:!0,qa:!0});return zw(d,D)})(yield e1(n),n.asyncQueue,e,s,a)}))),a.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t1(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uv=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s1="firestore.googleapis.com",dv=!0;class hv{constructor(e){var s,a;if(e.host===void 0){if(e.ssl!==void 0)throw new qe(ke.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=s1,this.ssl=dv}else this.host=e.host,this.ssl=(s=e.ssl)!=null?s:dv;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Cw;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<iC)throw new qe(ke.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}qT("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=t1((a=e.experimentalLongPollingOptions)!=null?a:{}),(function(d){if(d.timeoutSeconds!==void 0){if(isNaN(d.timeoutSeconds))throw new qe(ke.INVALID_ARGUMENT,`invalid long polling timeout: ${d.timeoutSeconds} (must not be NaN)`);if(d.timeoutSeconds<5)throw new qe(ke.INVALID_ARGUMENT,`invalid long polling timeout: ${d.timeoutSeconds} (minimum allowed value is 5)`);if(d.timeoutSeconds>30)throw new qe(ke.INVALID_ARGUMENT,`invalid long polling timeout: ${d.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(a,l){return a.timeoutSeconds===l.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Nh{constructor(e,s,a,l){this._authCredentials=e,this._appCheckCredentials=s,this._databaseId=a,this._app=l,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new hv({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new qe(ke.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new qe(ke.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new hv(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(a){if(!a)return new OT;switch(a.type){case"firstParty":return new LT(a.sessionIndex||"0",a.iamToken||null,a.authTokenFactory||null);case"provider":return a.client;default:throw new qe(ke.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}_restart(){return K(this,null,function*(){this._terminateTask==="notTerminated"?yield this._terminate():this._terminateTask="notTerminated"})}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(s){const a=uv.get(s);a&&(He("ComponentProvider","Removing Datastore"),uv.delete(s),a.terminate())})(this),Promise.resolve()}}function AI(n,e,s,a={}){var v;n=_o(n,Nh);const l=No(e),d=n._getSettings(),h=oe(X({},d),{emulatorOptions:n._getEmulatorOptions()}),f=`${e}:${s}`;l&&(vg(`https://${f}`),_g("Firestore",!0)),d.host!==s1&&d.host!==f&&Nl("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const b=oe(X({},d),{host:f,ssl:l,emulatorOptions:a});if(!yo(b,h)&&(n._setSettings(b),a.mockUserToken)){let E,D;if(typeof a.mockUserToken=="string")E=a.mockUserToken,D=Hs.MOCK_USER;else{E=Wv(a.mockUserToken,(v=n._app)==null?void 0:v.options.projectId);const _=a.mockUserToken.sub||a.mockUserToken.user_id;if(!_)throw new qe(ke.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");D=new Hs(_)}n._authCredentials=new kT(new B_(E,D))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Co{constructor(e,s,a){this.converter=s,this._query=a,this.type="query",this.firestore=e}withConverter(e){return new Co(this.firestore,e,this._query)}}class bs{constructor(e,s,a){this.converter=s,this._key=a,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ra(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new bs(this.firestore,e,this._key)}toJSON(){return{type:bs._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,s,a){if(lu(s,bs._jsonSchema))return new bs(e,a||null,new nt(Yt.fromString(s.referencePath)))}}bs._jsonSchemaVersion="firestore/documentReference/1.0",bs._jsonSchema={type:xs("string",bs._jsonSchemaVersion),referencePath:xs("string")};class Ra extends Co{constructor(e,s,a){super(e,s,zg(a)),this._path=a,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new bs(this.firestore,null,new nt(e))}withConverter(e){return new Ra(this.firestore,e,this._path)}}function Nd(n,e,...s){if(n=Mn(n),z_("collection","path",e),n instanceof Nh){const a=Yt.fromString(e,...s);return Eb(a),new Ra(n,null,a)}{if(!(n instanceof bs||n instanceof Ra))throw new qe(ke.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const a=n._path.child(Yt.fromString(e,...s));return Eb(a),new Ra(n.firestore,null,a)}}function Cc(n,e,...s){if(n=Mn(n),arguments.length===1&&(e=Mg.newId()),z_("doc","path",e),n instanceof Nh){const a=Yt.fromString(e,...s);return Sb(a),new bs(n,null,new nt(a))}{if(!(n instanceof bs||n instanceof Ra))throw new qe(ke.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const a=n._path.child(Yt.fromString(e,...s));return Sb(a),new bs(n.firestore,n instanceof Ra?n.converter:null,new nt(a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fv="AsyncQueue";class mv{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Ow(this,"async_queue_retry"),this._c=()=>{const a=Om();a&&He(fv,"Visibility state changed to "+a.visibilityState),this.M_.w_()},this.ac=e;const s=Om();s&&typeof s.addEventListener=="function"&&s.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const s=Om();s&&typeof s.removeEventListener=="function"&&s.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const s=new Li;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(s.resolve,s.reject),s.promise))).then((()=>s.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}lc(){return K(this,null,function*(){if(this.Xu.length!==0){try{yield this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Dl(e))throw e;He(fv,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}})}cc(e){const s=this.ac.then((()=>(this.rc=!0,e().catch((a=>{throw this.nc=a,this.rc=!1,qi("INTERNAL UNHANDLED ERROR: ",gv(a)),a})).then((a=>(this.rc=!1,a))))));return this.ac=s,s}enqueueAfterDelay(e,s,a){this.uc(),this.oc.indexOf(e)>-1&&(s=0);const l=ep.createAndSchedule(this,e,s,a,(d=>this.hc(d)));return this.tc.push(l),l}uc(){this.nc&&ct(47125,{Pc:gv(this.nc)})}verifyOperationInProgress(){}Tc(){return K(this,null,function*(){let e;do e=this.ac,yield e;while(e!==this.ac)})}Ic(e){for(const s of this.tc)if(s.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((s,a)=>s.targetTimeMs-a.targetTimeMs));for(const s of this.tc)if(s.skipDelay(),e!=="all"&&s.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const s=this.tc.indexOf(e);this.tc.splice(s,1)}}function gv(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class Sh extends Nh{constructor(e,s,a,l){super(e,s,a,l),this.type="firestore",this._queue=new mv,this._persistenceKey=(l==null?void 0:l.name)||"[DEFAULT]"}_terminate(){return K(this,null,function*(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new mv(e),this._firestoreClient=void 0,yield e}})}}function CI(n,e){const s=typeof n=="object"?n:Sg(),a=typeof n=="string"?n:Qd,l=lh(s,"firestore").getImmediate({identifier:a});if(!l._initialized){const d=Kv("firestore");d&&AI(l,...d)}return l}function ip(n){if(n._terminated)throw new qe(ke.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||II(n),n._firestoreClient}function II(n){var a,l,d;const e=n._freezeSettings(),s=(function(f,b,v,E){return new eA(f,b,v,E.host,E.ssl,E.experimentalForceLongPolling,E.experimentalAutoDetectLongPolling,t1(E.experimentalLongPollingOptions),E.useFetchStreams,E.isUsingEmulator)})(n._databaseId,((a=n._app)==null?void 0:a.options.appId)||"",n._persistenceKey,e);n._componentsProvider||(l=e.localCache)!=null&&l._offlineComponentProvider&&((d=e.localCache)!=null&&d._onlineComponentProvider)&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new NI(n._authCredentials,n._appCheckCredentials,n._queue,s,n._componentsProvider&&(function(f){const b=f==null?void 0:f._online.build();return{_offline:f==null?void 0:f._offline.build(b),_online:b}})(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new nr(Vs.fromBase64String(e))}catch(s){throw new qe(ke.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+s)}}static fromUint8Array(e){return new nr(Vs.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:nr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(lu(e,nr._jsonSchema))return nr.fromBase64String(e.bytes)}}nr._jsonSchemaVersion="firestore/bytes/1.0",nr._jsonSchema={type:xs("string",nr._jsonSchemaVersion),bytes:xs("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ap{constructor(...e){for(let s=0;s<e.length;++s)if(e[s].length===0)throw new qe(ke.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ls(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n1{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ti{constructor(e,s){if(!isFinite(e)||e<-90||e>90)throw new qe(ke.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(s)||s<-180||s>180)throw new qe(ke.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+s);this._lat=e,this._long=s}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Et(this._lat,e._lat)||Et(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:ti._jsonSchemaVersion}}static fromJSON(e){if(lu(e,ti._jsonSchema))return new ti(e.latitude,e.longitude)}}ti._jsonSchemaVersion="firestore/geoPoint/1.0",ti._jsonSchema={type:xs("string",ti._jsonSchemaVersion),latitude:xs("number"),longitude:xs("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class si{constructor(e){this._values=(e||[]).map((s=>s))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(a,l){if(a.length!==l.length)return!1;for(let d=0;d<a.length;++d)if(a[d]!==l[d])return!1;return!0})(this._values,e._values)}toJSON(){return{type:si._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(lu(e,si._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((s=>typeof s=="number")))return new si(e.vectorValues);throw new qe(ke.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}si._jsonSchemaVersion="firestore/vectorValue/1.0",si._jsonSchema={type:xs("string",si._jsonSchemaVersion),vectorValues:xs("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RI=/^__.*__$/;class DI{constructor(e,s,a){this.data=e,this.fieldMask=s,this.fieldTransforms=a}toMutation(e,s){return this.fieldMask!==null?new To(e,this.data,this.fieldMask,s,this.fieldTransforms):new cu(e,this.data,s,this.fieldTransforms)}}function r1(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ct(40011,{Ac:n})}}class op{constructor(e,s,a,l,d,h){this.settings=e,this.databaseId=s,this.serializer=a,this.ignoreUndefinedProperties=l,d===void 0&&this.Rc(),this.fieldTransforms=d||[],this.fieldMask=h||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new op(X(X({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var l;const s=(l=this.path)==null?void 0:l.child(e),a=this.Vc({path:s,fc:!1});return a.gc(e),a}yc(e){var l;const s=(l=this.path)==null?void 0:l.child(e),a=this.Vc({path:s,fc:!1});return a.Rc(),a}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return sh(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((s=>e.isPrefixOf(s)))!==void 0||this.fieldTransforms.find((s=>e.isPrefixOf(s.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(r1(this.Ac)&&RI.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class OI{constructor(e,s,a){this.databaseId=e,this.ignoreUndefinedProperties=s,this.serializer=a||vh(e)}Cc(e,s,a,l=!1){return new op({Ac:e,methodName:s,Dc:a,path:Ls.emptyPath(),fc:!1,bc:l},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function i1(n){const e=n._freezeSettings(),s=vh(n._databaseId);return new OI(n._databaseId,!!e.ignoreUndefinedProperties,s)}function kI(n,e,s,a,l,d={}){const h=n.Cc(d.merge||d.mergeFields?2:0,e,s,l);l1("Data must be an object, but it was:",h,a);const f=a1(a,h);let b,v;if(d.merge)b=new Ar(h.fieldMask),v=h.fieldTransforms;else if(d.mergeFields){const E=[];for(const D of d.mergeFields){const _=PI(e,D,s);if(!h.contains(_))throw new qe(ke.INVALID_ARGUMENT,`Field '${_}' is specified in your field mask but missing from your input data.`);VI(E,_)||E.push(_)}b=new Ar(E),v=h.fieldTransforms.filter((D=>b.covers(D.field)))}else b=null,v=h.fieldTransforms;return new DI(new sr(f),b,v)}function MI(n,e,s,a=!1){return lp(s,n.Cc(a?4:3,e))}function lp(n,e){if(o1(n=Mn(n)))return l1("Unsupported field value:",e,n),a1(n,e);if(n instanceof n1)return(function(a,l){if(!r1(l.Ac))throw l.Sc(`${a._methodName}() can only be used with update() and set()`);if(!l.path)throw l.Sc(`${a._methodName}() is not currently supported inside arrays`);const d=a._toFieldTransform(l);d&&l.fieldTransforms.push(d)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(a,l){const d=[];let h=0;for(const f of a){let b=lp(f,l.wc(h));b==null&&(b={nullValue:"NULL_VALUE"}),d.push(b),h++}return{arrayValue:{values:d}}})(n,e)}return(function(a,l){if((a=Mn(a))===null)return{nullValue:"NULL_VALUE"};if(typeof a=="number")return NA(l.serializer,a);if(typeof a=="boolean")return{booleanValue:a};if(typeof a=="string")return{stringValue:a};if(a instanceof Date){const d=Bt.fromDate(a);return{timestampValue:Jd(l.serializer,d)}}if(a instanceof Bt){const d=new Bt(a.seconds,1e3*Math.floor(a.nanoseconds/1e3));return{timestampValue:Jd(l.serializer,d)}}if(a instanceof ti)return{geoPointValue:{latitude:a.latitude,longitude:a.longitude}};if(a instanceof nr)return{bytesValue:ww(l.serializer,a._byteString)};if(a instanceof bs){const d=l.databaseId,h=a.firestore._databaseId;if(!h.isEqual(d))throw l.Sc(`Document reference is for database ${h.projectId}/${h.database} but should be for database ${d.projectId}/${d.database}`);return{referenceValue:Gg(a.firestore._databaseId||l.databaseId,a._key.path)}}if(a instanceof si)return(function(h,f){return{mapValue:{fields:{[X_]:{stringValue:W_},[Kd]:{arrayValue:{values:h.toArray().map((v=>{if(typeof v!="number")throw f.Sc("VectorValues must only contain numeric values.");return Fg(f.serializer,v)}))}}}}}})(a,l);throw l.Sc(`Unsupported field value: ${dh(a)}`)})(n,e)}function a1(n,e){const s={};return H_(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Eo(n,((a,l)=>{const d=lp(l,e.mc(a));d!=null&&(s[a]=d)})),{mapValue:{fields:s}}}function o1(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Bt||n instanceof ti||n instanceof nr||n instanceof bs||n instanceof n1||n instanceof si)}function l1(n,e,s){if(!o1(s)||!F_(s)){const a=dh(s);throw a==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+a)}}function PI(n,e,s){if((e=Mn(e))instanceof ap)return e._internalPath;if(typeof e=="string")return c1(n,e);throw sh("Field path arguments must be of type string or ",n,!1,void 0,s)}const LI=new RegExp("[~\\*/\\[\\]]");function c1(n,e,s){if(e.search(LI)>=0)throw sh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,s);try{return new ap(...e.split("."))._internalPath}catch(a){throw sh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,s)}}function sh(n,e,s,a,l){const d=a&&!a.isEmpty(),h=l!==void 0;let f=`Function ${e}() called with invalid data`;s&&(f+=" (via `toFirestore()`)"),f+=". ";let b="";return(d||h)&&(b+=" (found",d&&(b+=` in field ${a}`),h&&(b+=` in document ${l}`),b+=")"),new qe(ke.INVALID_ARGUMENT,f+n+b)}function VI(n,e){return n.some((s=>s.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u1{constructor(e,s,a,l,d){this._firestore=e,this._userDataWriter=s,this._key=a,this._document=l,this._converter=d}get id(){return this._key.path.lastSegment()}get ref(){return new bs(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new UI(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const s=this._document.data.field(Eh("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s)}}}class UI extends u1{data(){return super.data()}}function Eh(n,e){return typeof e=="string"?c1(n,e):e instanceof ap?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BI(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new qe(ke.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class cp{}class d1 extends cp{}function pv(n,e,...s){let a=[];e instanceof cp&&a.push(e),a=a.concat(s),(function(d){const h=d.filter((b=>b instanceof up)).length,f=d.filter((b=>b instanceof jh)).length;if(h>1||h>0&&f>0)throw new qe(ke.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(a);for(const l of a)n=l._apply(n);return n}class jh extends d1{constructor(e,s,a){super(),this._field=e,this._op=s,this._value=a,this.type="where"}static _create(e,s,a){return new jh(e,s,a)}_apply(e){const s=this._parse(e);return h1(e._query,s),new Co(e.firestore,e.converter,sg(e._query,s))}_parse(e){const s=i1(e.firestore);return(function(d,h,f,b,v,E,D){let _;if(v.isKeyField()){if(E==="array-contains"||E==="array-contains-any")throw new qe(ke.INVALID_ARGUMENT,`Invalid Query. You can't perform '${E}' queries on documentId().`);if(E==="in"||E==="not-in"){bv(D,E);const U=[];for(const ie of D)U.push(xv(b,d,ie));_={arrayValue:{values:U}}}else _=xv(b,d,D)}else E!=="in"&&E!=="not-in"&&E!=="array-contains-any"||bv(D,E),_=MI(f,h,D,E==="in"||E==="not-in");return ys.create(v,E,_)})(e._query,"where",s,e.firestore._databaseId,this._field,this._op,this._value)}}function Mm(n,e,s){const a=e,l=Eh("where",n);return jh._create(l,a,s)}class up extends cp{constructor(e,s){super(),this.type=e,this._queryConstraints=s}static _create(e,s){return new up(e,s)}_parse(e){const s=this._queryConstraints.map((a=>a._parse(e))).filter((a=>a.getFilters().length>0));return s.length===1?s[0]:Rr.create(s,this._getOperator())}_apply(e){const s=this._parse(e);return s.getFilters().length===0?e:((function(l,d){let h=l;const f=d.getFlattenedFilters();for(const b of f)h1(h,b),h=sg(h,b)})(e._query,s),new Co(e.firestore,e.converter,sg(e._query,s)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class dp extends d1{constructor(e,s){super(),this._field=e,this._direction=s,this.type="orderBy"}static _create(e,s){return new dp(e,s)}_apply(e){const s=(function(l,d,h){if(l.startAt!==null)throw new qe(ke.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(l.endAt!==null)throw new qe(ke.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Jc(d,h)})(e._query,this._field,this._direction);return new Co(e.firestore,e.converter,(function(l,d){const h=l.explicitOrderBy.concat([d]);return new Ol(l.path,l.collectionGroup,h,l.filters.slice(),l.limit,l.limitType,l.startAt,l.endAt)})(e._query,s))}}function yv(n,e="asc"){const s=e,a=Eh("orderBy",n);return dp._create(a,s)}function xv(n,e,s){if(typeof(s=Mn(s))=="string"){if(s==="")throw new qe(ke.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!iw(e)&&s.indexOf("/")!==-1)throw new qe(ke.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${s}' contains a '/' character.`);const a=e.path.child(Yt.fromString(s));if(!nt.isDocumentKey(a))throw new qe(ke.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${a}' is not because it has an odd number of segments (${a.length}).`);return Ob(n,new nt(a))}if(s instanceof bs)return Ob(n,s._key);throw new qe(ke.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${dh(s)}.`)}function bv(n,e){if(!Array.isArray(n)||n.length===0)throw new qe(ke.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function h1(n,e){const s=(function(l,d){for(const h of l)for(const f of h.getFlattenedFilters())if(d.indexOf(f.op)>=0)return f.op;return null})(n.filters,(function(l){switch(l){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(s!==null)throw s===e.op?new qe(ke.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new qe(ke.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${s.toString()}' filters.`)}class zI{convertValue(e,s="none"){switch(Pa(e)){case 0:return null;case 1:return e.booleanValue;case 2:return hs(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,s);case 5:return e.stringValue;case 6:return this.convertBytes(Ma(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,s);case 11:return this.convertObject(e.mapValue,s);case 10:return this.convertVectorValue(e.mapValue);default:throw ct(62114,{value:e})}}convertObject(e,s){return this.convertObjectMap(e.fields,s)}convertObjectMap(e,s="none"){const a={};return Eo(e,((l,d)=>{a[l]=this.convertValue(d,s)})),a}convertVectorValue(e){var a,l,d;const s=(d=(l=(a=e.fields)==null?void 0:a[Kd].arrayValue)==null?void 0:l.values)==null?void 0:d.map((h=>hs(h.doubleValue)));return new si(s)}convertGeoPoint(e){return new ti(hs(e.latitude),hs(e.longitude))}convertArray(e,s){return(e.values||[]).map((a=>this.convertValue(a,s)))}convertServerTimestamp(e,s){switch(s){case"previous":const a=mh(e);return a==null?null:this.convertValue(a,s);case"estimate":return this.convertTimestamp(Yc(e));default:return null}}convertTimestamp(e){const s=ka(e);return new Bt(s.seconds,s.nanos)}convertDocumentKey(e,s){const a=Yt.fromString(e);Pt(Aw(a),9688,{name:e});const l=new Xc(a.get(1),a.get(3)),d=new nt(a.popFirst(5));return l.isEqual(s)||qi(`Document ${d} contains a document reference within a different database (${l.projectId}/${l.database}) which is not supported. It will be treated as a reference in the current database (${s.projectId}/${s.database}) instead.`),d}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FI(n,e,s){let a;return a=n?n.toFirestore(e):e,a}class Mc{constructor(e,s){this.hasPendingWrites=e,this.fromCache=s}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class po extends u1{constructor(e,s,a,l,d,h){super(e,s,a,l,h),this._firestore=e,this._firestoreImpl=e,this.metadata=d}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const s=new Ld(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(s,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,s={}){if(this._document){const a=this._document.data.field(Eh("DocumentSnapshot.get",e));if(a!==null)return this._userDataWriter.convertValue(a,s.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new qe(ke.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,s={};return s.type=po._jsonSchemaVersion,s.bundle="",s.bundleSource="DocumentSnapshot",s.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?s:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),s.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),s)}}po._jsonSchemaVersion="firestore/documentSnapshot/1.0",po._jsonSchema={type:xs("string",po._jsonSchemaVersion),bundleSource:xs("string","DocumentSnapshot"),bundleName:xs("string"),bundle:xs("string")};class Ld extends po{data(e={}){return super.data(e)}}class vl{constructor(e,s,a,l){this._firestore=e,this._userDataWriter=s,this._snapshot=l,this.metadata=new Mc(l.hasPendingWrites,l.fromCache),this.query=a}get docs(){const e=[];return this.forEach((s=>e.push(s))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,s){this._snapshot.docs.forEach((a=>{e.call(s,new Ld(this._firestore,this._userDataWriter,a.key,a,new Mc(this._snapshot.mutatedKeys.has(a.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const s=!!e.includeMetadataChanges;if(s&&this._snapshot.excludesMetadataChanges)throw new qe(ke.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===s||(this._cachedChanges=(function(l,d){if(l._snapshot.oldDocs.isEmpty()){let h=0;return l._snapshot.docChanges.map((f=>{const b=new Ld(l._firestore,l._userDataWriter,f.doc.key,f.doc,new Mc(l._snapshot.mutatedKeys.has(f.doc.key),l._snapshot.fromCache),l.query.converter);return f.doc,{type:"added",doc:b,oldIndex:-1,newIndex:h++}}))}{let h=l._snapshot.oldDocs;return l._snapshot.docChanges.filter((f=>d||f.type!==3)).map((f=>{const b=new Ld(l._firestore,l._userDataWriter,f.doc.key,f.doc,new Mc(l._snapshot.mutatedKeys.has(f.doc.key),l._snapshot.fromCache),l.query.converter);let v=-1,E=-1;return f.type!==0&&(v=h.indexOf(f.doc.key),h=h.delete(f.doc.key)),f.type!==1&&(h=h.add(f.doc),E=h.indexOf(f.doc.key)),{type:qI(f.type),doc:b,oldIndex:v,newIndex:E}}))}})(this,s),this._cachedChangesIncludeMetadataChanges=s),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new qe(ke.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=vl._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Mg.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const s=[],a=[],l=[];return this.docs.forEach((d=>{d._document!==null&&(s.push(d._document),a.push(this._userDataWriter.convertObjectMap(d._document.data.value.mapValue.fields,"previous")),l.push(d.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function qI(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ct(61501,{type:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HI(n){n=_o(n,bs);const e=_o(n.firestore,Sh);return jI(ip(e),n._key).then((s=>$I(e,n,s)))}vl._jsonSchemaVersion="firestore/querySnapshot/1.0",vl._jsonSchema={type:xs("string",vl._jsonSchemaVersion),bundleSource:xs("string","QuerySnapshot"),bundleName:xs("string"),bundle:xs("string")};class f1 extends zI{constructor(e){super(),this.firestore=e}convertBytes(e){return new nr(e)}convertReference(e){const s=this.convertDocumentKey(e,this.firestore._databaseId);return new bs(this.firestore,null,s)}}function Pm(n){n=_o(n,Co);const e=_o(n.firestore,Sh),s=ip(e),a=new f1(e);return BI(n._query),TI(s,n._query).then((l=>new vl(e,a,n,l)))}function Sd(n,e,s){n=_o(n,bs);const a=_o(n.firestore,Sh),l=FI(n.converter,e);return GI(a,[kI(i1(a),"setDoc",n._key,l,n.converter!==null,s).toMutation(n._key,Vi.none())])}function GI(n,e){return(function(a,l){const d=new Li;return a.asyncQueue.enqueueAndForget((()=>K(null,null,function*(){return mI(yield EI(a),l,d)}))),d.promise})(ip(n),e)}function $I(n,e,s){const a=s.docs.get(e._key),l=new f1(n);return new po(n,l,e._key,a,new Mc(s.hasPendingWrites,s.fromCache),e.converter)}(function(e,s=!0){(function(l){Il=l})(So),xo(new Da("firestore",((a,{instanceIdentifier:l,options:d})=>{const h=a.getProvider("app").getImmediate(),f=new Sh(new MT(a.getProvider("auth-internal")),new VT(h,a.getProvider("app-check-internal")),(function(v,E){if(!Object.prototype.hasOwnProperty.apply(v.options,["projectId"]))throw new qe(ke.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Xc(v.options.projectId,E)})(h,l),h);return d=X({useFetchStreams:s},d),f._setSettings(d),f}),"PUBLIC").setMultipleInstances(!0)),Xr(vb,_b,e),Xr(vb,_b,"esm2020")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m1="firebasestorage.googleapis.com",QI="storageBucket",KI=120*1e3,YI=600*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ai extends ii{constructor(e,s,a=0){super(Lm(e),`Firebase Storage: ${s} (${Lm(e)})`),this.status_=a,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,ai.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Lm(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var ri;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(ri||(ri={}));function Lm(n){return"storage/"+n}function XI(){const n="An unknown error occurred, please check the error payload for server response.";return new ai(ri.UNKNOWN,n)}function WI(){return new ai(ri.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function JI(){return new ai(ri.CANCELED,"User canceled the upload/download.")}function ZI(n){return new ai(ri.INVALID_URL,"Invalid URL '"+n+"'.")}function eR(n){return new ai(ri.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function vv(n){return new ai(ri.INVALID_ARGUMENT,n)}function g1(){return new ai(ri.APP_DELETED,"The Firebase app was deleted.")}function tR(n){return new ai(ri.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cr{constructor(e,s){this.bucket=e,this.path_=s}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,s){let a;try{a=Cr.makeFromUrl(e,s)}catch(l){return new Cr(e,"")}if(a.path==="")return a;throw eR(e)}static makeFromUrl(e,s){let a=null;const l="([A-Za-z0-9.\\-_]+)";function d(_e){_e.path.charAt(_e.path.length-1)==="/"&&(_e.path_=_e.path_.slice(0,-1))}const h="(/(.*))?$",f=new RegExp("^gs://"+l+h,"i"),b={bucket:1,path:3};function v(_e){_e.path_=decodeURIComponent(_e.path)}const E="v[A-Za-z0-9_]+",D=s.replace(/[.]/g,"\\."),_="(/([^?#]*).*)?$",R=new RegExp(`^https?://${D}/${E}/b/${l}/o${_}`,"i"),U={bucket:1,path:3},ie=s===m1?"(?:storage.googleapis.com|storage.cloud.google.com)":s,he="([^?#]*)",Se=new RegExp(`^https?://${ie}/${l}/${he}`,"i"),xe=[{regex:f,indices:b,postModify:d},{regex:R,indices:U,postModify:v},{regex:Se,indices:{bucket:1,path:2},postModify:v}];for(let _e=0;_e<xe.length;_e++){const Ne=xe[_e],De=Ne.regex.exec(e);if(De){const G=De[Ne.indices.bucket];let V=De[Ne.indices.path];V||(V=""),a=new Cr(G,V),Ne.postModify(a);break}}if(a==null)throw ZI(e);return a}}class sR{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nR(n,e,s){let a=1,l=null,d=null,h=!1,f=0;function b(){return f===2}let v=!1;function E(...he){v||(v=!0,e.apply(null,he))}function D(he){l=setTimeout(()=>{l=null,n(R,b())},he)}function _(){d&&clearTimeout(d)}function R(he,...Se){if(v){_();return}if(he){_(),E.call(null,he,...Se);return}if(b()||h){_(),E.call(null,he,...Se);return}a<64&&(a*=2);let xe;f===1?(f=2,xe=0):xe=(a+Math.random())*1e3,D(xe)}let U=!1;function ie(he){U||(U=!0,_(),!v&&(l!==null?(he||(f=2),clearTimeout(l),D(0)):he||(f=1)))}return D(0),d=setTimeout(()=>{h=!0,ie(!0)},s),ie}function rR(n){n(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iR(n){return n!==void 0}function _v(n,e,s,a){if(a<e)throw vv(`Invalid value for '${n}'. Expected ${e} or greater.`);if(a>s)throw vv(`Invalid value for '${n}'. Expected ${s} or less.`)}function aR(n){const e=encodeURIComponent;let s="?";for(const a in n)if(n.hasOwnProperty(a)){const l=e(a)+"="+e(n[a]);s=s+l+"&"}return s=s.slice(0,-1),s}var nh;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(nh||(nh={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oR(n,e){const s=n>=500&&n<600,l=[408,429].indexOf(n)!==-1,d=e.indexOf(n)!==-1;return s||l||d}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lR{constructor(e,s,a,l,d,h,f,b,v,E,D,_=!0,R=!1){this.url_=e,this.method_=s,this.headers_=a,this.body_=l,this.successCodes_=d,this.additionalRetryCodes_=h,this.callback_=f,this.errorCallback_=b,this.timeout_=v,this.progressCallback_=E,this.connectionFactory_=D,this.retry=_,this.isUsingEmulator=R,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((U,ie)=>{this.resolve_=U,this.reject_=ie,this.start_()})}start_(){const e=(a,l)=>{if(l){a(!1,new Ed(!1,null,!0));return}const d=this.connectionFactory_();this.pendingConnection_=d;const h=f=>{const b=f.loaded,v=f.lengthComputable?f.total:-1;this.progressCallback_!==null&&this.progressCallback_(b,v)};this.progressCallback_!==null&&d.addUploadProgressListener(h),d.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&d.removeUploadProgressListener(h),this.pendingConnection_=null;const f=d.getErrorCode()===nh.NO_ERROR,b=d.getStatus();if(!f||oR(b,this.additionalRetryCodes_)&&this.retry){const E=d.getErrorCode()===nh.ABORT;a(!1,new Ed(!1,null,E));return}const v=this.successCodes_.indexOf(b)!==-1;a(!0,new Ed(v,d))})},s=(a,l)=>{const d=this.resolve_,h=this.reject_,f=l.connection;if(l.wasSuccessCode)try{const b=this.callback_(f,f.getResponse());iR(b)?d(b):d()}catch(b){h(b)}else if(f!==null){const b=XI();b.serverResponse=f.getErrorText(),this.errorCallback_?h(this.errorCallback_(f,b)):h(b)}else if(l.canceled){const b=this.appDelete_?g1():JI();h(b)}else{const b=WI();h(b)}};this.canceled_?s(!1,new Ed(!1,null,!0)):this.backoffId_=nR(e,s,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&rR(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Ed{constructor(e,s,a){this.wasSuccessCode=e,this.connection=s,this.canceled=!!a}}function cR(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function uR(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e!=null?e:"AppManager")}function dR(n,e){e&&(n["X-Firebase-GMPID"]=e)}function hR(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function fR(n,e,s,a,l,d,h=!0,f=!1){const b=aR(n.urlParams),v=n.url+b,E=Object.assign({},n.headers);return dR(E,e),cR(E,s),uR(E,d),hR(E,a),new lR(v,n.method,E,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,l,h,f)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mR(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function gR(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rh{constructor(e,s){this._service=e,s instanceof Cr?this._location=s:this._location=Cr.makeFromUrl(s,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,s){return new rh(e,s)}get root(){const e=new Cr(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return gR(this._location.path)}get storage(){return this._service}get parent(){const e=mR(this._location.path);if(e===null)return null;const s=new Cr(this._location.bucket,e);return new rh(this._service,s)}_throwIfRoot(e){if(this._location.path==="")throw tR(e)}}function wv(n,e){const s=e==null?void 0:e[QI];return s==null?null:Cr.makeFromBucketSpec(s,n)}function pR(n,e,s,a={}){n.host=`${e}:${s}`;const l=No(e);l&&(vg(`https://${n.host}/b`),_g("Storage",!0)),n._isUsingEmulator=!0,n._protocol=l?"https":"http";const{mockUserToken:d}=a;d&&(n._overrideAuthToken=typeof d=="string"?d:Wv(d,n.app.options.projectId))}class yR{constructor(e,s,a,l,d,h=!1){this.app=e,this._authProvider=s,this._appCheckProvider=a,this._url=l,this._firebaseVersion=d,this._isUsingEmulator=h,this._bucket=null,this._host=m1,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=KI,this._maxUploadRetryTime=YI,this._requests=new Set,l!=null?this._bucket=Cr.makeFromBucketSpec(l,this._host):this._bucket=wv(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Cr.makeFromBucketSpec(this._url,e):this._bucket=wv(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){_v("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){_v("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}_getAuthToken(){return K(this,null,function*(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const s=yield e.getToken();if(s!==null)return s.accessToken}return null})}_getAppCheckToken(){return K(this,null,function*(){if(jr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(yield e.getToken()).token:null})}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new rh(this,e)}_makeRequest(e,s,a,l,d=!0){if(this._deleted)return new sR(g1());{const h=fR(e,this._appId,a,l,s,this._firebaseVersion,d,this._isUsingEmulator);return this._requests.add(h),h.getPromise().then(()=>this._requests.delete(h),()=>this._requests.delete(h)),h}}makeRequestWithTokens(e,s){return K(this,null,function*(){const[a,l]=yield Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,s,a,l).getPromise()})}}const Nv="@firebase/storage",Sv="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p1="storage";function xR(n=Sg(),e){n=Mn(n);const a=lh(n,p1).getImmediate({identifier:e}),l=Kv("storage");return l&&bR(a,...l),a}function bR(n,e,s,a={}){pR(n,e,s,a)}function vR(n,{instanceIdentifier:e}){const s=n.getProvider("app").getImmediate(),a=n.getProvider("auth-internal"),l=n.getProvider("app-check-internal");return new yR(s,a,l,e,So)}function _R(){xo(new Da(p1,vR,"PUBLIC").setMultipleInstances(!0)),Xr(Nv,Sv,""),Xr(Nv,Sv,"esm2020")}_R();const wR={apiKey:"AIzaSyCFQSuzdalFAKgCeNOh44T6zLpGm8PD0e0",authDomain:"studio-2008079270-29431.firebaseapp.com",projectId:"studio-2008079270-29431",storageBucket:"studio-2008079270-29431.firebasestorage.app",messagingSenderId:"376682035127",appId:"1:376682035127:web:3e377f2c48371e4ab81a32"},hp=e_(wR);RT(hp);const _a=CI(hp);xR(hp);const NR={:"Coordinator",:"Doctor",:"Nurse","  ":"PhysicalTherapist","  ":"PhysicalTherapist"," ":"SocialWorker",:"Driver"},SR=[{email:"salshahrani173@moh.gov.sa",name:"   ",role:""},{email:"amemahmoud@mog.gov.sa",name:"  ",role:""},{email:"rowa.ali.omer@gmail.com",name:"   ",role:""},{email:"aaldawsari23@moh.gov.sa",name:"   ",role:"  "},{email:"atante@moh.gov.sa",name:" ",role:"  "},{email:"yalbishe@moh.gov.sa",name:"   ",role:" "},{email:"relbarahamtoshy@moh.gov.sa",name:"   ",role:""},{email:"zdalamri@outlook.sa",name:"  ",role:""},{email:"handaa@mog.gov.sa",name:"  ",role:""},{email:"nalqahtani112@moh.gov.sa",name:"   ",role:""},{email:"hamad1234nmnm@moh.gov.sa",name:"   ",role:""},{email:"thamralshhrany188@gmail.com",name:"   ",role:""},{email:"salsahrani@moh.gov.sa",name:"   ",role:""},{email:"fahhadms10@gmail.com",name:"   ",role:""},{email:"halmanfi@moh.gov.sa",name:"  ",role:""}];class Ta{static signIn(e,s){return K(this,null,function*(){try{const a=SR.find(d=>d.email.toLowerCase()===e.toLowerCase());if(!a)throw new Error("    ");if(s!=="12345")throw new Error("   ");const l={email:a.email,name:a.name,role:a.role,mappedRole:NR[a.role]||"Coordinator",uid:btoa(a.email),loginTime:new Date().toISOString()};return localStorage.setItem("currentUser",JSON.stringify(l)),{user:l,success:!0}}catch(a){throw console.error("Login error:",a),a}})}static signOut(){return K(this,null,function*(){return localStorage.removeItem("currentUser"),{success:!0}})}static getCurrentUser(){const e=localStorage.getItem("currentUser");return e?JSON.parse(e):null}static isAuthenticated(){return this.getCurrentUser()!==null}}class jd{static savePatient(e){return K(this,null,function*(){var s;try{const a=Cc(_a,"patients",e.nationalId);return yield Sd(a,oe(X({},e),{updatedAt:Bt.now(),updatedBy:((s=Ta.getCurrentUser())==null?void 0:s.email)||"system"})),{success:!0}}catch(a){throw console.error("Error saving patient:",a),a}})}static getPatient(e){return K(this,null,function*(){try{const s=Cc(_a,"patients",e),a=yield HI(s);return a.exists()?X({id:a.id},a.data()):null}catch(s){throw console.error("Error getting patient:",s),s}})}static getAllPatients(){return K(this,null,function*(){try{return(yield Pm(Nd(_a,"patients"))).docs.map(s=>X({id:s.id},s.data()))}catch(e){throw console.error("Error getting patients:",e),e}})}static saveVisit(e){return K(this,null,function*(){var s;try{const a=`${e.patientId}_${e.date}`,l=Cc(_a,"visits",a);return yield Sd(l,oe(X({},e),{updatedAt:Bt.now(),updatedBy:((s=Ta.getCurrentUser())==null?void 0:s.email)||"system"})),{success:!0}}catch(a){throw console.error("Error saving visit:",a),a}})}static getVisitsByDateRange(e,s){return K(this,null,function*(){try{const a=pv(Nd(_a,"visits"),Mm("date",">=",e),Mm("date","<=",s),yv("date","desc"));return(yield Pm(a)).docs.map(d=>X({id:d.id},d.data()))}catch(a){throw console.error("Error getting visits:",a),a}})}static saveAssessment(e){return K(this,null,function*(){var s;try{const a=Cc(_a,"assessments",e.id);return yield Sd(a,oe(X({},e),{updatedAt:Bt.now(),updatedBy:((s=Ta.getCurrentUser())==null?void 0:s.email)||"system"})),{success:!0}}catch(a){throw console.error("Error saving assessment:",a),a}})}static getAssessmentsByPatient(e){return K(this,null,function*(){try{const s=pv(Nd(_a,"assessments"),Mm("patientId","==",e),yv("date","desc"));return(yield Pm(s)).docs.map(l=>X({id:l.id},l.data()))}catch(s){throw console.error("Error getting assessments:",s),s}})}static logActivity(e,s){return K(this,null,function*(){try{const a=Ta.getCurrentUser(),l={action:e,details:s,user:(a==null?void 0:a.email)||"system",userName:(a==null?void 0:a.name)||"System",timestamp:Bt.now(),date:new Date().toISOString().split("T")[0]},d=Cc(Nd(_a,"activityLog"));return yield Sd(d,l),{success:!0}}catch(a){throw console.error("Error logging activity:",a),a}})}}const qc=class qc{static init(){const e=localStorage.getItem("firebase-sync-queue");if(e)try{this.syncQueue=JSON.parse(e)}catch(s){console.error("Error loading sync queue:",s)}window.addEventListener("online",()=>{this.isOnline=!0,this.processSyncQueue()}),window.addEventListener("offline",()=>{this.isOnline=!1}),this.isOnline&&setTimeout(()=>this.processSyncQueue(),1e3)}static queueForSync(e,s){const a={id:Date.now().toString(),operation:e,data:s,timestamp:new Date().toISOString(),retryCount:0};this.syncQueue.push(a),this.persistQueue(),this.isOnline&&!this.syncInProgress&&this.processSyncQueue()}static processSyncQueue(){return K(this,null,function*(){if(!this.isOnline||this.syncInProgress||this.syncQueue.length===0)return;this.syncInProgress=!0;const e=[];for(const s of this.syncQueue)try{switch(s.operation){case"savePatient":yield jd.savePatient(s.data);break;case"saveVisit":yield jd.saveVisit(s.data);break;case"saveAssessment":yield jd.saveAssessment(s.data);break;case"logActivity":yield jd.logActivity(s.data.action,s.data.details);break;default:console.warn("Unknown sync operation:",s.operation)}e.push(s.id)}catch(a){console.error("Sync failed for item:",s,a),s.retryCount=(s.retryCount||0)+1,s.retryCount>=3&&e.push(s.id)}this.syncQueue=this.syncQueue.filter(s=>!e.includes(s.id)),this.persistQueue(),this.syncInProgress=!1})}static persistQueue(){try{localStorage.setItem("firebase-sync-queue",JSON.stringify(this.syncQueue))}catch(e){console.error("Error persisting sync queue:",e)}}static getSyncStatus(){return{isOnline:this.isOnline,queueLength:this.syncQueue.length,syncInProgress:this.syncInProgress}}};qc.syncQueue=[],qc.isOnline=navigator.onLine,qc.syncInProgress=!1;let fg=qc;fg.init();const ER=({onLoginSuccess:n})=>{const[e,s]=Pe.useState(""),[a,l]=Pe.useState(""),[d,h]=Pe.useState(!1),[f,b]=Pe.useState(!1),[v,E]=Pe.useState(""),[D,_]=Pe.useState(""),R=he=>K(null,null,function*(){he.preventDefault(),b(!0),E(""),_("");try{const Se=yield Ta.signIn(e,a);Se.success&&(_("   "),setTimeout(()=>{n(Se.user)},1e3))}catch(Se){E(Se.message||"    ")}finally{b(!1)}}),U=[{email:"salshahrani173@moh.gov.sa",name:" - ",role:""},{email:"amemahmoud@mog.gov.sa",name:" - ",role:""},{email:"aaldawsari23@moh.gov.sa",name:" -  ",role:" "},{email:"relbarahamtoshy@moh.gov.sa",name:" - ",role:""},{email:"yalbishe@moh.gov.sa",name:" - ",role:""},{email:"thamralshhrany188@gmail.com",name:" - ",role:""}],ie=he=>{s(he),l("12345")};return i.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-600 via-blue-700 to-indigo-800 flex items-center justify-center p-4",children:i.jsxs("div",{className:"w-full max-w-md space-y-6",children:[i.jsxs("div",{className:"text-center space-y-4",children:[i.jsx("div",{className:"mx-auto w-20 h-20 bg-white rounded-full flex items-center justify-center shadow-xl",children:i.jsx("div",{className:"w-12 h-12 bg-blue-600 rounded-full flex items-center justify-center",children:i.jsx("span",{className:"text-white font-bold text-xl",children:"KA"})})}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-3xl font-bold text-white",children:"Home Healthcare"}),i.jsx("p",{className:"text-blue-200 mt-2",children:"   - "}),i.jsx("p",{className:"text-blue-300 text-sm mt-1",children:"  "})]})]}),i.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8 space-y-6",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:" "}),i.jsx("p",{className:"text-gray-600 mt-2",children:"   "})]}),v&&i.jsxs("div",{className:"bg-red-50 border-2 border-red-200 rounded-xl p-4 flex items-center gap-3",children:[i.jsx(Hc,{size:20,className:"text-red-500 flex-shrink-0"}),i.jsx("p",{className:"text-red-700 text-sm",children:v})]}),D&&i.jsxs("div",{className:"bg-green-50 border-2 border-green-200 rounded-xl p-4 flex items-center gap-3",children:[i.jsx(mg,{size:20,className:"text-green-500 flex-shrink-0"}),i.jsx("p",{className:"text-green-700 text-sm",children:D})]}),i.jsxs("form",{onSubmit:R,className:"space-y-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" "}),i.jsxs("div",{className:"relative",children:[i.jsx(lS,{size:20,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),i.jsx("input",{type:"email",value:e,onChange:he=>s(he.target.value),className:"w-full pl-12 pr-4 py-3 border-2 border-gray-300 rounded-xl focus:border-blue-500 focus:ring-4 focus:ring-blue-200 transition-all duration-200",placeholder:"  ",required:!0,disabled:f})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" "}),i.jsxs("div",{className:"relative",children:[i.jsx(cS,{size:20,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),i.jsx("input",{type:d?"text":"password",value:a,onChange:he=>l(he.target.value),className:"w-full pl-12 pr-12 py-3 border-2 border-gray-300 rounded-xl focus:border-blue-500 focus:ring-4 focus:ring-blue-200 transition-all duration-200",placeholder:"  ",required:!0,disabled:f}),i.jsx("button",{type:"button",onClick:()=>h(!d),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",disabled:f,children:d?i.jsx(uS,{size:20}):i.jsx(Dv,{size:20})})]}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"  : 12345"})]}),i.jsxs("button",{type:"submit",disabled:f||!e||!a,className:"w-full bg-blue-600 text-white py-3 px-6 rounded-xl font-medium hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-all duration-200 flex items-center justify-center gap-2",children:[f?i.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):i.jsx(dS,{size:20}),f?"  ...":" "]})]}),i.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[i.jsx("p",{className:"text-sm font-medium text-gray-700 mb-3 text-center",children:"  :"}),i.jsx("div",{className:"grid grid-cols-1 gap-2",children:U.map((he,Se)=>i.jsx("button",{onClick:()=>ie(he.email),disabled:f,className:"w-full text-left px-4 py-2 bg-gray-50 hover:bg-gray-100 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-sm font-medium text-gray-800",children:he.name}),i.jsx("span",{className:"text-xs text-gray-500 px-2 py-1 bg-white rounded-full",children:he.role})]})},Se))})]}),i.jsx("div",{className:"text-center pt-4 border-t border-gray-200",children:i.jsx("p",{className:"text-xs text-gray-500",children:"           "})})]}),i.jsxs("div",{className:"text-center text-blue-200 text-sm",children:[i.jsx("p",{children:" 2024    - "}),i.jsx("p",{children:"   "})]})]})})},jR=({role:n,currentRole:e,onClick:s,icon:a})=>{const l=d=>{switch(d){case rt.Doctor:return"";case rt.Nurse:return"";case rt.PhysicalTherapist:return" ";case rt.SocialWorker:return"";case rt.Driver:return"";default:return d}};return i.jsxs("button",{onClick:()=>s(n),className:`flex flex-col items-center gap-1 px-2 md:px-3 py-2 text-xs rounded-xl font-bold transition-all duration-300 touch-target-44 transform active:scale-95 min-w-[60px] ${e===n?"bg-white text-blue-700 shadow-xl scale-110 ring-2 ring-blue-300 border-2 border-blue-200":"bg-white/20 text-white hover:bg-white/30 backdrop-blur-sm hover:scale-105 hover:shadow-lg border border-white/30"}`,title:`   ${l(n)}`,children:[i.jsx("span",{className:"flex-shrink-0",children:a}),i.jsx("span",{className:"text-[10px] leading-tight text-center",children:l(n)})]})},TR=({activeView:n,setActiveView:e})=>{const s=[{id:"patients",label:"Patients",icon:i.jsx(ah,{size:16})},{id:"visits",label:"Today's Visits",icon:i.jsx(fS,{size:16})},{id:"scheduler",label:"Scheduler",icon:i.jsx(rr,{size:16})},{id:"settings",label:"Settings",icon:i.jsx(Ov,{size:16})}];return i.jsx("div",{className:"flex items-center bg-white/95 backdrop-blur-md rounded-xl p-1 shadow-xl border border-white/30",children:s.map(a=>i.jsxs("button",{onClick:()=>e(a.id),className:`flex items-center gap-1.5 px-2 md:px-4 py-2 text-xs md:text-sm rounded-lg font-medium transition-all duration-300 touch-target-44 transform active:scale-95 ${n===a.id?"bg-gradient-to-r from-blue-600 to-blue-700 text-white shadow-lg scale-105":"text-blue-700 hover:bg-blue-50 hover:scale-102"}`,children:[a.icon,i.jsx("span",{className:"hidden md:inline",children:a.label})]},a.id))})},Ev=({activeView:n,setActiveView:e})=>{const{state:s,dispatch:a}=os(),l=h=>{a({type:"SET_ROLE",payload:h})},d=[{role:rt.Doctor,icon:i.jsx(Ui,{size:16})},{role:rt.Nurse,icon:i.jsx(ih,{size:16})},{role:rt.PhysicalTherapist,icon:i.jsx(gg,{size:16})},{role:rt.SocialWorker,icon:i.jsx(pg,{size:16})},{role:rt.Driver,icon:i.jsx(hS,{size:16})}];return i.jsxs("header",{className:"bg-gradient-to-r from-blue-700 to-blue-600 border-b border-blue-800 p-3 md:p-4 flex flex-col lg:flex-row items-center justify-between gap-3 md:gap-4 sticky top-0 z-50 shadow-lg",children:[i.jsxs("div",{className:"flex items-center gap-2 md:gap-3 w-full lg:w-auto justify-center lg:justify-start",children:[i.jsxs("div",{className:"w-10 h-10 md:w-12 md:h-12 bg-white rounded-full flex items-center justify-center shadow-md p-1",children:[i.jsx("img",{src:"/logo.png",alt:"Aseer Health Cluster Logo",className:"w-full h-full object-contain",onError:h=>{h.currentTarget.style.display="none",h.currentTarget.nextElementSibling.style.display="flex"}}),i.jsx("div",{className:"w-full h-full bg-blue-600 rounded-full items-center justify-center hidden",children:i.jsx("span",{className:"text-white font-bold text-sm md:text-base",children:"AHC"})})]}),i.jsxs("div",{className:"text-center lg:text-left",children:[i.jsx("h1",{className:"text-lg md:text-xl font-bold text-white leading-tight",children:"Home Healthcare Department"}),i.jsx("p",{className:"text-xs md:text-sm text-blue-100 font-medium",children:"       "}),i.jsx("p",{className:"text-xs text-blue-200",children:"  "})]})]}),i.jsx("div",{className:"flex-grow flex items-center justify-center w-full lg:w-auto order-3 lg:order-2",children:s.currentRole!==rt.Driver&&i.jsx(TR,{activeView:n,setActiveView:e})}),i.jsx("div",{className:"flex items-center gap-1.5 p-1.5 bg-white/10 rounded-xl overflow-x-auto w-full lg:w-auto justify-center lg:justify-end order-2 lg:order-3 backdrop-blur-md border border-white/20",children:d.map(h=>i.jsx(jR,{role:h.role,currentRole:s.currentRole,onClick:l,icon:h.icon},h.role))})]})},Vm=({label:n,isActive:e,onClick:s})=>i.jsx("button",{onClick:s,className:`px-3 md:px-4 py-2 text-xs md:text-sm rounded-xl border-2 transition-all duration-200 flex-shrink-0 font-semibold touch-target-44 ${e?"bg-blue-600 text-white border-blue-600 shadow-lg scale-105":"bg-white text-gray-700 border-gray-200 hover:border-blue-400 hover:text-blue-600 hover:bg-blue-50 shadow-sm"}`,children:n}),AR=()=>{const{state:n,dispatch:e}=os(),[s,a]=Pe.useState("team1"),l=n.selectedPatientIds.size>0,d=()=>{if(n.selectedPatientIds.size>0){const h=new Date().toISOString().split("T")[0];e({type:"ASSIGN_TO_VISITS",payload:{patientIds:Array.from(n.selectedPatientIds),date:h,teamId:s}})}};return l?i.jsx("div",{className:"p-3 md:p-4 border-t border-gray-200 bg-gradient-to-r from-blue-50 to-indigo-50",children:i.jsxs("div",{className:"bg-white rounded-lg p-3 shadow-sm border border-blue-200",children:[i.jsxs("h3",{className:"text-sm font-bold text-blue-800 mb-3 flex items-center gap-2",children:[i.jsx(fo,{size:16}),n.selectedPatientIds.size,"  "]}),i.jsxs("div",{className:"mb-4",children:[i.jsx("label",{className:"text-xs font-semibold text-gray-700 mb-2 block",children:" "}),i.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2",children:n.teams.map(h=>i.jsx("button",{onClick:()=>a(h.id),className:`px-4 py-3 text-sm font-medium rounded-lg border-2 transition-all duration-200 touch-target-44 ${s===h.id?"bg-blue-600 text-white border-blue-600 shadow-lg scale-[1.02]":"bg-white text-gray-700 border-gray-200 hover:border-blue-400 hover:bg-blue-50"}`,children:h.name},h.id))})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("button",{onClick:d,className:"w-full bg-gradient-to-r from-blue-600 to-blue-700 text-white font-bold py-3 px-4 rounded-lg hover:from-blue-700 hover:to-blue-800 transition-all duration-200 flex items-center justify-center gap-2 shadow-md touch-target-44",children:[i.jsx(yS,{size:18}),"  "]}),i.jsx("button",{onClick:()=>e({type:"CLEAR_SELECTIONS"}),className:"w-full text-center py-2 text-sm text-gray-500 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors",children:" "})]})]})}):null},jv=()=>{const{state:n,dispatch:e,filteredPatients:s}=os(),{filters:a,areas:l,selectedPatientIds:d}=n,h=Pe.useMemo(()=>{const b=new Set;return n.patients&&Array.isArray(n.patients)&&n.patients.forEach(v=>{v.tags&&Array.isArray(v.tags)&&v.tags.forEach(E=>b.add(E))}),Array.from(b)},[n.patients]),f=()=>{if(s&&Array.isArray(s)){const b=s.map(v=>v.nationalId);e({type:"SELECT_ALL_FILTERED",payload:b})}};return i.jsxs("aside",{className:"w-full lg:w-80 bg-white border-r border-gray-200 flex flex-col flex-shrink-0 h-full overflow-y-hidden",children:[i.jsxs("div",{className:"p-3 md:p-4 border-b border-gray-200 bg-gradient-to-r from-blue-50 to-indigo-50",children:[i.jsxs("div",{className:"relative",children:[i.jsx(mS,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-blue-500",size:18}),i.jsx("input",{type:"text",placeholder:"Smart search: name, ID, area, diagnosis...",value:a.search,onChange:b=>e({type:"SET_SEARCH",payload:b.target.value}),className:"w-full bg-white border-2 border-blue-200 rounded-xl pl-11 pr-4 py-3 text-sm md:text-base font-medium focus:outline-none focus:ring-4 focus:ring-blue-300 focus:border-blue-500 shadow-sm placeholder-gray-500 touch-target-44"})]}),i.jsxs("div",{className:"flex items-center justify-between mt-3 text-xs md:text-sm",children:[i.jsxs("div",{className:"flex items-center gap-2 md:gap-3",children:[i.jsx("input",{type:"checkbox",id:"select-all",className:"h-5 w-5 md:h-6 md:w-6 rounded-md border-2 border-gray-300 text-blue-600 focus:ring-blue-500 focus:ring-2 touch-target-44",onChange:b=>b.target.checked?f():e({type:"CLEAR_SELECTIONS"}),checked:s.length>0&&d.size===s.length}),i.jsxs("label",{htmlFor:"select-all",className:"text-gray-700 font-medium",children:[i.jsx("span",{className:"text-blue-600 font-bold",children:s.length})," Results",d.size>0&&i.jsxs("span",{className:"text-green-600 ml-1",children:["(",d.size," selected)"]})]})]}),i.jsxs("button",{onClick:()=>e({type:"CLEAR_FILTERS"}),className:"flex items-center gap-1 text-red-500 hover:text-red-700 font-medium px-2 py-1 rounded-lg hover:bg-red-50 transition-colors touch-target-44",children:[i.jsx(xn,{size:14})," Clear"]})]})]}),i.jsx("div",{className:"flex-1 overflow-y-auto",children:i.jsxs("div",{className:"p-3 md:p-4 space-y-4 md:space-y-5",children:[i.jsx(Um,{icon:i.jsx(Gc,{size:16}),title:"Areas",children:(l||[]).map(b=>i.jsx(Vm,{label:b,isActive:a.areas.includes(b),onClick:()=>e({type:"TOGGLE_AREA_FILTER",payload:b})},b))}),i.jsx(Um,{icon:i.jsx(gS,{size:16}),title:"Tags",children:h.map(b=>i.jsx(Vm,{label:b,isActive:a.tags.includes(b),onClick:()=>e({type:"TOGGLE_TAG_FILTER",payload:b})},b))}),i.jsx(Um,{icon:i.jsx(pS,{size:16}),title:"Last Visit Risk",children:["green","yellow","red"].map(b=>i.jsx(Vm,{label:b.charAt(0).toUpperCase()+b.slice(1),isActive:a.risk.includes(b),onClick:()=>e({type:"TOGGLE_RISK_FILTER",payload:b})},b))})]})}),i.jsx(AR,{})]})},Um=({icon:n,title:e,children:s})=>i.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-3 md:p-4 shadow-sm",children:[i.jsxs("h3",{className:"text-sm md:text-base font-bold text-gray-800 uppercase tracking-wider mb-3 flex items-center gap-2",children:[i.jsx("span",{className:"text-blue-600",children:n})," ",e]}),i.jsx("div",{className:"flex flex-wrap gap-2 md:gap-3",children:s})]}),y1=({title:n,titleAr:e,patient:s,role:a,subtitle:l,showIcons:d=!0})=>{const h=f=>{switch(f){case rt.Doctor:return"from-blue-600 to-blue-700";case rt.Nurse:return"from-green-600 to-green-700";case rt.PhysicalTherapist:return"from-purple-600 to-purple-700";case rt.SocialWorker:return"from-orange-600 to-orange-700";default:return"from-blue-600 to-blue-700"}};return i.jsxs("div",{className:`bg-gradient-to-r ${h(a)} text-white p-4 md:p-6 rounded-t-lg`,children:[i.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-start gap-4",children:[i.jsxs("div",{className:"flex items-start gap-3 md:gap-4",children:[d&&i.jsxs("div",{className:"flex flex-col gap-2 flex-shrink-0",children:[i.jsx("div",{className:"w-12 h-12 md:w-16 md:h-16 bg-white rounded-lg flex items-center justify-center shadow-lg",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-green-600 font-bold text-lg md:text-xl",children:""}),i.jsx("div",{className:"text-xs text-green-600 font-bold",children:"MOH"})]})}),i.jsx("div",{className:"w-12 h-12 md:w-14 md:h-14 bg-white rounded-lg flex items-center justify-center shadow-lg",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-blue-600 font-bold text-sm",children:"KAH"}),i.jsx("div",{className:"text-xs text-blue-600",children:"Bisha"})]})})]}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"mb-2",children:[i.jsx("h1",{className:"text-lg md:text-2xl font-bold leading-tight",children:n}),i.jsx("p",{className:"text-sm md:text-lg text-blue-100 opacity-90",children:e})]}),l&&i.jsx("p",{className:"text-xs md:text-sm text-blue-200",children:l}),i.jsxs("div",{className:"text-xs md:text-sm text-blue-200 mt-1",children:[i.jsx("p",{children:"King Abdullah Hospital - Bisha |    - "}),i.jsx("p",{className:"opacity-75",children:"Home Healthcare Division |    "})]})]})]}),i.jsxs("div",{className:"flex-shrink-0",children:[s&&i.jsxs("div",{className:"bg-white/10 rounded-lg p-3 md:p-4 text-right",children:[i.jsx("p",{className:"text-xs md:text-sm text-blue-100 mb-1",children:"Patient | "}),i.jsx("p",{className:"font-bold text-sm md:text-lg mb-1",children:s.nameAr}),i.jsxs("p",{className:"text-xs text-blue-200",children:["ID: ",s.nationalId]}),s.areaId&&i.jsxs("p",{className:"text-xs text-blue-200",children:["Area: ",s.areaId]})]}),i.jsxs("div",{className:"bg-white/10 rounded-lg p-3 mt-2 text-right text-xs md:text-sm",children:[i.jsx("p",{className:"text-blue-100 mb-1",children:"Date | "}),i.jsx("p",{className:"font-bold",children:new Date().toLocaleDateString()}),i.jsx("p",{className:"text-blue-200",children:new Date().toLocaleDateString("ar-SA")}),a&&i.jsxs("div",{className:"mt-2 pt-2 border-t border-white/20",children:[i.jsx("p",{className:"text-blue-100",children:"Role | "}),i.jsx("p",{className:"font-semibold",children:a})]})]})]})]}),i.jsx("div",{className:"mt-4 pt-3 border-t border-white/20",children:i.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center gap-2 text-xs text-blue-200",children:[i.jsx("p",{children:"Aseer Health Cluster |   "}),i.jsxs("p",{children:["Document ID: DOC-",Date.now().toString().slice(-6)]})]})})]})},hn={DRAFT_ASSESSMENTS:"mhhc_draft_assessments",DRAFT_VISIT_NOTES:"mhhc_draft_visit_notes",AUTO_SAVE_ENABLED:"mhhc_auto_save_enabled"};class fl{constructor(){this.autoSaveEnabled=!0,this.autoSaveInterval=3e4,this.autoSaveEnabled=this.getAutoSaveEnabled()}static getInstance(){return fl.instance||(fl.instance=new fl),fl.instance}saveDraftAssessment(e,s,a,l=!1){try{const d=this.getDraftAssessments(),h=`${e}_${s}`,f={id:h,patientId:e,role:s,formData:a,lastSaved:new Date,isComplete:l,timestamp:Date.now()};d[h]=f,localStorage.setItem(hn.DRAFT_ASSESSMENTS,JSON.stringify(d)),console.log(` Saved draft assessment for ${e} - ${s}`,{isComplete:l})}catch(d){console.error("Error saving draft assessment:",d)}}getDraftAssessment(e,s){try{const a=this.getDraftAssessments(),l=`${e}_${s}`;return a[l]||null}catch(a){return console.error("Error getting draft assessment:",a),null}}deleteDraftAssessment(e,s){try{const a=this.getDraftAssessments(),l=`${e}_${s}`;delete a[l],localStorage.setItem(hn.DRAFT_ASSESSMENTS,JSON.stringify(a))}catch(a){console.error("Error deleting draft assessment:",a)}}getDraftAssessments(){try{const e=localStorage.getItem(hn.DRAFT_ASSESSMENTS);return e?JSON.parse(e):{}}catch(e){return console.error("Error parsing draft assessments:",e),{}}}saveDraftVisitNote(e,s,a,l,d=!1){try{const h=this.getDraftVisitNotes(),f=`${e}_${s}_${a}`,b={id:f,patientId:e,visitDate:s,role:a,formData:l,lastSaved:new Date,isComplete:d,timestamp:Date.now()};h[f]=b,localStorage.setItem(hn.DRAFT_VISIT_NOTES,JSON.stringify(h)),console.log(` Saved draft visit note for ${e} - ${a}`,{isComplete:d})}catch(h){console.error("Error saving draft visit note:",h)}}getDraftVisitNote(e,s,a){try{const l=this.getDraftVisitNotes(),d=`${e}_${s}_${a}`;return l[d]||null}catch(l){return console.error("Error getting draft visit note:",l),null}}deleteDraftVisitNote(e,s,a){try{const l=this.getDraftVisitNotes(),d=`${e}_${s}_${a}`;delete l[d],localStorage.setItem(hn.DRAFT_VISIT_NOTES,JSON.stringify(l))}catch(l){console.error("Error deleting draft visit note:",l)}}getDraftVisitNotes(){try{const e=localStorage.getItem(hn.DRAFT_VISIT_NOTES);return e?JSON.parse(e):{}}catch(e){return console.error("Error parsing draft visit notes:",e),{}}}getAllDraftsForPatient(e){const s=Object.values(this.getDraftAssessments()).filter(l=>l.patientId===e),a=Object.values(this.getDraftVisitNotes()).filter(l=>l.patientId===e);return{assessments:s,visitNotes:a}}getDraftCount(){return{assessments:Object.keys(this.getDraftAssessments()).length,visitNotes:Object.keys(this.getDraftVisitNotes()).length}}cleanupOldDrafts(e=10080*60*1e3){try{const s=Date.now()-e,a=this.getDraftAssessments();Object.keys(a).forEach(d=>{a[d].timestamp<s&&delete a[d]}),localStorage.setItem(hn.DRAFT_ASSESSMENTS,JSON.stringify(a));const l=this.getDraftVisitNotes();Object.keys(l).forEach(d=>{l[d].timestamp<s&&delete l[d]}),localStorage.setItem(hn.DRAFT_VISIT_NOTES,JSON.stringify(l)),console.log(" Cleaned up old drafts")}catch(s){console.error("Error cleaning up old drafts:",s)}}getAutoSaveEnabled(){try{const e=localStorage.getItem(hn.AUTO_SAVE_ENABLED);return e?JSON.parse(e):!0}catch(e){return!0}}setAutoSaveEnabled(e){this.autoSaveEnabled=e,localStorage.setItem(hn.AUTO_SAVE_ENABLED,JSON.stringify(e))}exportDrafts(){return JSON.stringify({assessments:this.getDraftAssessments(),visitNotes:this.getDraftVisitNotes(),timestamp:Date.now()})}importDrafts(e){try{const s=JSON.parse(e);return s.assessments&&localStorage.setItem(hn.DRAFT_ASSESSMENTS,JSON.stringify(s.assessments)),s.visitNotes&&localStorage.setItem(hn.DRAFT_VISIT_NOTES,JSON.stringify(s.visitNotes)),!0}catch(s){return console.error("Error importing drafts:",s),!1}}clearAllDrafts(){localStorage.removeItem(hn.DRAFT_ASSESSMENTS),localStorage.removeItem(hn.DRAFT_VISIT_NOTES),console.log(" Cleared all drafts")}}const CR=()=>{const n=fl.getInstance();return{saveDraftAssessment:n.saveDraftAssessment.bind(n),getDraftAssessment:n.getDraftAssessment.bind(n),deleteDraftAssessment:n.deleteDraftAssessment.bind(n),saveDraftVisitNote:n.saveDraftVisitNote.bind(n),getDraftVisitNote:n.getDraftVisitNote.bind(n),deleteDraftVisitNote:n.deleteDraftVisitNote.bind(n),getAllDraftsForPatient:n.getAllDraftsForPatient.bind(n),getDraftCount:n.getDraftCount.bind(n),cleanupOldDrafts:n.cleanupOldDrafts.bind(n),getAutoSaveEnabled:n.getAutoSaveEnabled.bind(n),setAutoSaveEnabled:n.setAutoSaveEnabled.bind(n),exportDrafts:n.exportDrafts.bind(n),importDrafts:n.importDrafts.bind(n),clearAllDrafts:n.clearAllDrafts.bind(n)}},Wt=({title:n,children:e,defaultOpen:s=!1})=>{const[a,l]=Pe.useState(s);return i.jsxs("div",{className:"border-2 border-blue-200 rounded-xl bg-white shadow-lg overflow-hidden",children:[i.jsxs("button",{type:"button",onClick:()=>l(!a),className:"w-full text-left p-3 md:p-4 font-bold text-sm md:text-base text-gray-800 bg-gradient-to-r from-blue-50 to-indigo-50 hover:from-blue-100 hover:to-indigo-100 flex justify-between items-center transition-all duration-200 touch-target-44",children:[i.jsx("span",{children:n}),i.jsx(Ic,{size:18,className:`transition-transform duration-300 ${a?"rotate-180 text-blue-600":"text-gray-500"}`})]}),a&&i.jsx("div",{className:"p-3 md:p-4 border-t-2 border-blue-100 bg-white animate-slide-up",children:i.jsx("div",{className:"space-y-4",children:e})})]})},ze=({legend:n,children:e})=>i.jsxs("div",{className:"space-y-2",children:[i.jsxs("label",{className:"font-bold text-sm md:text-base text-blue-800 mb-2 block flex items-center",children:[i.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full mr-2"}),n]}),i.jsx("div",{className:"pl-4",children:e})]}),x1="px-3 md:px-4 py-2 md:py-2.5 text-xs md:text-sm rounded-xl border-2 transition-all duration-200 font-medium touch-target-44",b1="bg-blue-600 text-white font-bold border-blue-600 shadow-lg scale-105",v1="bg-white text-gray-700 hover:border-blue-400 hover:bg-blue-50 hover:text-blue-700 border-gray-300 shadow-sm",Ke=({value:n,onChange:e,options:s})=>i.jsx("div",{className:"flex gap-2 md:gap-3 flex-wrap",children:s.map(a=>i.jsx("button",{type:"button",onClick:()=>e(a),className:`${x1} ${n===a?b1:v1} ${n===a?"ring-4 ring-blue-200":""}`,children:a},a))}),Ut=({value:n,onChange:e,options:s})=>i.jsx("div",{className:"flex gap-2 md:gap-3 flex-wrap",children:s.map(a=>i.jsx("button",{type:"button",onClick:()=>e(a),className:`${x1} ${n.has(a)?b1:v1} ${n.has(a)?"ring-4 ring-blue-200":""}`,children:i.jsxs("span",{className:"flex items-center gap-1.5",children:[i.jsx("span",{className:`w-2 h-2 rounded-full ${n.has(a)?"bg-white":"bg-gray-400"}`}),a]})},a))}),IR=({patient:n,onSave:e,onCancel:s})=>{const{state:a}=os(),[l,d]=Pe.useState({reasonForVisit:"Chronic Disease Mgt",activeDiagnoses:new Set,generalExam:new Set,chestExam:new Set,cardiacExam:new Set,neuroExam:new Set,dmStatus:"Stable",htnStatus:"Controlled",chfStatus:"Compensated",primaryAssessment:"CHF Exacerbation",goal:"Maintain",medications:new Set,labsImaging:new Set,referrals:new Set,action:"Continue Home Care",nextVisit:"2 wks",customNextVisit:""}),h=(xe,_e)=>{const Ne=new Set(xe);return Ne.has(_e)?Ne.delete(_e):Ne.add(_e),Ne},f=xe=>{d(_e=>oe(X({},_e),{activeDiagnoses:h(_e.activeDiagnoses,xe)}))},b=xe=>{d(_e=>oe(X({},_e),{generalExam:h(_e.generalExam,xe)}))},v=xe=>{d(_e=>oe(X({},_e),{chestExam:h(_e.chestExam,xe)}))},E=xe=>{d(_e=>oe(X({},_e),{cardiacExam:h(_e.cardiacExam,xe)}))},D=xe=>{d(_e=>oe(X({},_e),{neuroExam:h(_e.neuroExam,xe)}))},_=xe=>{d(_e=>oe(X({},_e),{medications:h(_e.medications,xe)}))},R=xe=>{d(_e=>oe(X({},_e),{labsImaging:h(_e.labsImaging,xe)}))},U=xe=>{d(_e=>oe(X({},_e),{referrals:h(_e.referrals,xe)}))},ie=()=>{const xe=["No Change"];return l.activeDiagnoses.has("CHF")&&xe.push("Adjust Diuretics"),l.activeDiagnoses.has("DM")&&xe.push("Adjust Insulin"),(l.primaryAssessment==="UTI"||l.primaryAssessment==="Pneumonia")&&xe.push("Start/Stop Antibiotic"),l.primaryAssessment==="Pain"&&xe.push("Adjust Pain Meds"),xe.push("Polypharmacy Review"),xe},he=()=>{const xe=[];return l.goal==="Rehab"&&xe.push("Physiotherapy"),l.goal==="Palliative"&&xe.push("Palliative"),l.activeDiagnoses.has("DM")&&xe.push("Dietitian"),xe.push("Social Worker"),xe},Se=()=>{const xe=[];return l.primaryAssessment==="UTI"&&xe.push("Urine Cx"),(l.primaryAssessment==="Pneumonia"||l.chestExam.has("Crackles"))&&xe.push("CXR"),l.activeDiagnoses.has("DM")&&xe.push("HbA1c"),l.activeDiagnoses.has("CHF")&&xe.push("CBC","Chem-7"),xe.push("CBC","Chem-7","LFTs","INR"),[...new Set(xe)]},Be=xe=>{xe.preventDefault();const _e=a.staff.find(De=>De.==="")||a.staff[0],Ne={id:Date.now().toString(),date:new Date().toISOString(),assessorId:_e._,assessorName:_e.,role:rt.Doctor,status:"Unchanged",plan:"Continue same plan",chiefFocus:Array.from(l.activeDiagnoses),assessment:{etiology:[],severity:"Mild"},followUpTiming:l.nextVisit,mdNote:l.note};e(Ne)};return i.jsxs("form",{onSubmit:Be,className:"p-4 md:p-6 bg-gradient-to-br from-blue-50 to-white flex flex-col h-full",children:[i.jsxs("div",{className:"flex justify-between items-center mb-4 md:mb-6 pb-3 border-b-2 border-blue-200",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"font-bold text-lg md:text-xl text-blue-900",children:"Doctor Assessment"}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:n.nameAr})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{type:"button",onClick:s,title:"Cancel",className:"p-2.5 md:p-3 rounded-xl hover:bg-red-500 bg-red-100 text-red-600 hover:text-white transition-all duration-200 shadow-md touch-target-44",children:i.jsx(xn,{size:18})}),i.jsx("button",{type:"submit",title:"Save Assessment",className:"p-2.5 md:p-3 rounded-xl hover:bg-green-600 bg-green-500 text-white hover:shadow-lg transition-all duration-200 shadow-md touch-target-44",children:i.jsx(Gi,{size:18})})]})]}),i.jsxs("div",{className:"space-y-4 md:space-y-5 overflow-y-auto flex-grow pr-1 text-sm md:text-base",children:[i.jsx(Wt,{title:"Reason for visit (single-select chips)",defaultOpen:!0,children:i.jsx(Ke,{value:l.reasonForVisit,onChange:xe=>d(_e=>oe(X({},_e),{reasonForVisit:xe})),options:["Chronic Disease Mgt","Post-Hospital F/U","Acute Change","Goals of Care"]})}),i.jsxs(Wt,{title:"Active diagnoses (multi-select chips)",children:[i.jsx(Ut,{value:l.activeDiagnoses,onChange:f,options:["CHF","DM","HTN","CKD","COPD","Dementia","Stroke","Malignancy","Chronic Pain","Other Dx"]}),l.activeDiagnoses.has("Other Dx")&&i.jsx("input",{value:l.otherDiagnosis||"",onChange:xe=>d(_e=>oe(X({},_e),{otherDiagnosis:xe.target.value})),placeholder:"Specify other diagnosis",className:"mt-2 w-full p-2 text-xs border rounded"})]}),i.jsx(Wt,{title:"Exam (abnormal only; system chips)",children:i.jsxs("div",{className:"space-y-3",children:[i.jsx(ze,{legend:"General",children:i.jsx(Ut,{value:l.generalExam,onChange:b,options:["Edema","Dehydrated","Cachexia"]})}),i.jsx(ze,{legend:"Chest",children:i.jsx(Ut,{value:l.chestExam,onChange:v,options:["Crackles","Wheeze"," Air Entry"]})}),i.jsx(ze,{legend:"Cardiac",children:i.jsx(Ut,{value:l.cardiacExam,onChange:E,options:["AFib","New Murmur"]})}),i.jsx(ze,{legend:"Neuro",children:i.jsx(Ut,{value:l.neuroExam,onChange:D,options:["Delirium","Weakness","Agitation"]})})]})}),i.jsx(Wt,{title:"Chronic disease quick status (single-select per row)",children:i.jsxs("div",{className:"space-y-3",children:[i.jsx(ze,{legend:"DM",children:i.jsx(Ke,{value:l.dmStatus,onChange:xe=>d(_e=>oe(X({},_e),{dmStatus:xe})),options:["Stable","Hyper","Hypo"]})}),i.jsx(ze,{legend:"HTN",children:i.jsx(Ke,{value:l.htnStatus,onChange:xe=>d(_e=>oe(X({},_e),{htnStatus:xe})),options:["Controlled","Uncontrolled"]})}),i.jsx(ze,{legend:"CHF",children:i.jsx(Ke,{value:l.chfStatus,onChange:xe=>d(_e=>oe(X({},_e),{chfStatus:xe})),options:["Compensated","Decompensated"]})})]})}),i.jsxs(Wt,{title:"Primary assessment (chips)",children:[i.jsx(Ke,{value:l.primaryAssessment,onChange:xe=>d(_e=>oe(X({},_e),{primaryAssessment:xe})),options:["CHF Exacerbation","UTI","Pneumonia","Ulcer Management","Delirium","Fall","Pain","Side Effect","Other"]}),l.primaryAssessment==="Other"&&i.jsx("input",{value:l.otherAssessment||"",onChange:xe=>d(_e=>oe(X({},_e),{otherAssessment:xe.target.value})),placeholder:"Specify other assessment",className:"mt-2 w-full p-2 text-xs border rounded"})]}),i.jsx(Wt,{title:"Plan of care (chips)",children:i.jsxs("div",{className:"space-y-3",children:[i.jsx(ze,{legend:"Goal",children:i.jsx(Ke,{value:l.goal,onChange:xe=>d(_e=>oe(X({},_e),{goal:xe})),options:["Rehab","Maintain","Palliative"]})}),i.jsxs(ze,{legend:"Medications ()",children:[i.jsx(Ut,{value:l.medications,onChange:_,options:ie()}),l.medications.size>0&&i.jsx("div",{className:"mt-2 p-2 bg-blue-50 rounded-lg",children:i.jsx("p",{className:"text-xs text-blue-600",children:"       "})})]}),i.jsxs(ze,{legend:"Labs/Imaging ()",children:[i.jsx(Ut,{value:l.labsImaging,onChange:R,options:Se()}),l.labsImaging.size>0&&i.jsx("div",{className:"mt-2 p-2 bg-green-50 rounded-lg",children:i.jsx("p",{className:"text-xs text-green-600",children:"       "})})]}),i.jsxs(ze,{legend:"Referrals ()",children:[i.jsx(Ut,{value:l.referrals,onChange:U,options:he()}),l.referrals.size>0&&i.jsx("div",{className:"mt-2 p-2 bg-purple-50 rounded-lg",children:i.jsx("p",{className:"text-xs text-purple-600",children:"       "})})]}),i.jsx(ze,{legend:"Action",children:i.jsx(Ke,{value:l.action,onChange:xe=>d(_e=>oe(X({},_e),{action:xe})),options:["Continue Home Care","Family Meeting","Hospital Transfer"]})}),i.jsxs(ze,{legend:"Next visit ()",children:[i.jsx(Ke,{value:l.nextVisit,onChange:xe=>d(_e=>oe(X({},_e),{nextVisit:xe})),options:["1 wk","2 wks","1 month","2 months","PRN","Custom"]}),l.nextVisit==="Custom"&&i.jsxs("div",{className:"mt-3",children:[i.jsx("input",{type:"text",value:l.customNextVisit||"",onChange:xe=>d(_e=>oe(X({},_e),{customNextVisit:xe.target.value})),placeholder:"    (: 3 weeks, 6 months)",className:"w-full p-3 text-sm border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:ring-4 focus:ring-blue-200 transition-all duration-200"}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"      "})]}),l.nextVisit!=="PRN"&&l.nextVisit!=="Custom"&&i.jsx("div",{className:"mt-2 p-2 bg-blue-50 rounded-lg",children:i.jsxs("p",{className:"text-xs text-blue-600",children:["    : ",l.nextVisit]})})]})]})}),i.jsxs("div",{className:"bg-white rounded-xl border-2 border-gray-200 p-4 shadow-sm",children:[i.jsxs("label",{className:"font-bold text-sm md:text-base text-blue-800 mb-2 block flex items-center",children:[i.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full mr-2"}),"Optional note"]}),i.jsx("textarea",{value:l.note||"",onChange:xe=>d(_e=>oe(X({},_e),{note:xe.target.value})),rows:3,placeholder:"Optional note (single free text)",className:"w-full p-3 text-sm md:text-base border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:ring-4 focus:ring-blue-200 transition-all duration-200 resize-none"})]})]})]})},RR=({patient:n,onSave:e,onCancel:s})=>{var _,R,U,ie,he,Se,Be,xe,_e,Ne,De,G,V;const{state:a}=os(),[l,d]=Pe.useState({vitals:{bp_systolic:"",bp_diastolic:"",hr:"",rr:"",temp:"",spo2:"",bgl:"",pain:"0"},falls_risk:"Low (024)",pressure_risk:"No risk (1923)",mobility:"Independent",transfers:"Independent",feeding:"Independent",toileting:"Independent",skin_status:"Intact",interventions:new Set,caregiver_status:"Engaged",education_topics:new Set,understanding:"Understands"}),h=(L,z)=>{d(Q=>oe(X({},Q),{vitals:oe(X({},Q.vitals),{[L]:z})}))},f=L=>{d(z=>{const Q=new Set(z.interventions);return Q.has(L)?Q.delete(L):Q.add(L),oe(X({},z),{interventions:Q})})},b=L=>{d(z=>{const Q=new Set(z.education_topics);return Q.has(L)?Q.delete(L):Q.add(L),oe(X({},z),{education_topics:Q})})},v=L=>{d(z=>{if(!z.wound_details)return z;const Q=new Set(z.wound_details.locations);return Q.has(L)?Q.delete(L):Q.add(L),oe(X({},z),{wound_details:oe(X({},z.wound_details),{locations:Q})})})},E=l.skin_status==="Wound",D=L=>{L.preventDefault();const z=a.staff.find(Y=>Y.==="")||a.staff[0],Q={id:Date.now().toString(),date:new Date().toISOString(),assessorId:z._,assessorName:z.,role:rt.Nurse,vitals:{bp:`${l.vitals.bp_systolic}/${l.vitals.bp_diastolic}`,hr:l.vitals.hr,temp:l.vitals.temp,rr:l.vitals.rr,o2sat:l.vitals.spo2,pain:l.vitals.pain},status:"Unchanged",plan:"Continue same plan",impression:"Stable",nursingTasks:Array.from(l.interventions),nurseNote:l.note};e(Q)};return i.jsxs("form",{onSubmit:D,className:"p-4 bg-gray-50 flex flex-col h-full",children:[i.jsxs("div",{className:"flex justify-between items-center mb-3",children:[i.jsx("h4",{className:"font-bold text-gray-800",children:"Nurse Assessment"}),i.jsxs("div",{className:"flex gap-1",children:[i.jsx("button",{type:"button",onClick:s,title:"Cancel",className:"p-1.5 rounded-full hover:bg-red-100 text-red-500",children:i.jsx(xn,{size:16})}),i.jsx("button",{type:"submit",title:"Save",className:"p-1.5 rounded-full hover:bg-green-100 text-green-600",children:i.jsx(Gi,{size:16})})]})]}),i.jsxs("div",{className:"space-y-2 overflow-y-auto flex-grow pr-1 text-sm",children:[i.jsx(Wt,{title:"Vitals (row inputs; compact for mobile)",defaultOpen:!0,children:i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("div",{className:"flex gap-1",children:[i.jsx("input",{value:l.vitals.bp_systolic,onChange:L=>h("bp_systolic",L.target.value),placeholder:"___",className:"w-12 p-1 text-center border rounded text-xs"}),i.jsx("span",{className:"self-center text-xs",children:"/"}),i.jsx("input",{value:l.vitals.bp_diastolic,onChange:L=>h("bp_diastolic",L.target.value),placeholder:"___",className:"w-12 p-1 text-center border rounded text-xs"}),i.jsx("span",{className:"self-center text-xs text-gray-600 ml-1",children:"mmHg"})]}),i.jsxs("div",{className:"flex gap-1",children:[i.jsx("input",{value:l.vitals.hr,onChange:L=>h("hr",L.target.value),placeholder:"___",className:"w-16 p-1 text-center border rounded text-xs"}),i.jsx("span",{className:"self-center text-xs text-gray-600",children:"bpm"})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("div",{className:"flex gap-1",children:[i.jsx("input",{value:l.vitals.rr,onChange:L=>h("rr",L.target.value),placeholder:"___",className:"w-16 p-1 text-center border rounded text-xs"}),i.jsx("span",{className:"self-center text-xs text-gray-600",children:"/min"})]}),i.jsxs("div",{className:"flex gap-1",children:[i.jsx("input",{value:l.vitals.temp,onChange:L=>h("temp",L.target.value),placeholder:"___",className:"w-16 p-1 text-center border rounded text-xs"}),i.jsx("span",{className:"self-center text-xs text-gray-600",children:"C"})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("div",{className:"flex gap-1",children:[i.jsx("input",{value:l.vitals.spo2,onChange:L=>h("spo2",L.target.value),placeholder:"___",className:"w-16 p-1 text-center border rounded text-xs"}),i.jsx("span",{className:"self-center text-xs text-gray-600",children:"%"})]}),i.jsxs("div",{className:"flex gap-1",children:[i.jsx("input",{value:l.vitals.bgl,onChange:L=>h("bgl",L.target.value),placeholder:"___",className:"w-16 p-1 text-center border rounded text-xs"}),i.jsx("span",{className:"self-center text-xs text-gray-600",children:"mg/dL"})]})]}),i.jsxs(ze,{legend:"Pain (010)",children:[i.jsx(Ke,{value:l.vitals.pain,onChange:L=>h("pain",L),options:["0","1","2","3","4","5","6","7","8","9","10"]}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"0 = no pain, 10 = worst imaginable"})]})]})}),i.jsx(Wt,{title:"Risk profile (chips only)",children:i.jsxs("div",{className:"space-y-3",children:[i.jsx(ze,{legend:"Falls (Morse category)",children:i.jsx(Ke,{value:l.falls_risk,onChange:L=>d(z=>oe(X({},z),{falls_risk:L})),options:["Low (024)","Moderate (2545)","High (46)"]})}),i.jsx(ze,{legend:"Pressure injury (Braden category)",children:i.jsx(Ke,{value:l.pressure_risk,onChange:L=>d(z=>oe(X({},z),{pressure_risk:L})),options:["Severe (9)","High (1012)","Moderate (1314)","Mild (1518)","No risk (1923)"]})})]})}),i.jsx(Wt,{title:"Functional status (ADLs; single-select per row)",children:i.jsxs("div",{className:"space-y-3",children:[i.jsx(ze,{legend:"Mobility",children:i.jsx(Ke,{value:l.mobility,onChange:L=>d(z=>oe(X({},z),{mobility:L})),options:["Independent","Walker/Cane","Wheelchair","Bedbound"]})}),i.jsx(ze,{legend:"Transfers",children:i.jsx(Ke,{value:l.transfers,onChange:L=>d(z=>oe(X({},z),{transfers:L})),options:["Independent","Supervision","Needs Assist"]})}),i.jsx(ze,{legend:"Feeding",children:i.jsx(Ke,{value:l.feeding,onChange:L=>d(z=>oe(X({},z),{feeding:L})),options:["Independent","Setup","Needs Feeding"]})}),i.jsx(ze,{legend:"Toileting",children:i.jsx(Ke,{value:l.toileting,onChange:L=>d(z=>oe(X({},z),{toileting:L})),options:["Independent","Assist","Incontinent"]})})]})}),i.jsx(Wt,{title:"Skin integrity (progressive reveal)",children:i.jsxs("div",{className:"space-y-3",children:[i.jsx(ze,{legend:"Skin Status",children:i.jsx(Ke,{value:l.skin_status,onChange:L=>{d(z=>oe(X({},z),{skin_status:L,wound_details:L==="Wound"?{locations:new Set,type:"Pressure",pressure_stage:"I",length:"",width:"",depth:""}:void 0}))},options:["Intact","At Risk","Bruising","Wound"]})}),E&&i.jsxs("div",{className:"space-y-3 p-3 bg-red-50 rounded border border-red-200",children:[i.jsxs(ze,{legend:"Location",children:[i.jsx(Ut,{value:((_=l.wound_details)==null?void 0:_.locations)||new Set,onChange:v,options:["Heel","Sacrum","Hip","Foot","Leg","Arm","Back","Other"]}),((R=l.wound_details)==null?void 0:R.locations.has("Other"))&&i.jsx("input",{value:((U=l.wound_details)==null?void 0:U.other_location)||"",onChange:L=>d(z=>oe(X({},z),{wound_details:oe(X({},z.wound_details),{other_location:L.target.value})})),placeholder:"Specify other location",className:"mt-2 w-full p-2 text-xs border rounded"})]}),i.jsx(ze,{legend:"Type",children:i.jsx(Ke,{value:((ie=l.wound_details)==null?void 0:ie.type)||"Pressure",onChange:L=>d(z=>oe(X({},z),{wound_details:oe(X({},z.wound_details),{type:L})})),options:["Pressure","Surgical","Diabetic","Venous"]})}),i.jsx(ze,{legend:"Pressure Stage",children:i.jsx(Ke,{value:((he=l.wound_details)==null?void 0:he.pressure_stage)||"I",onChange:L=>d(z=>oe(X({},z),{wound_details:oe(X({},z.wound_details),{pressure_stage:L})})),options:["I","II","III","IV","Unstageable","DTI"]})}),i.jsx(ze,{legend:"Size",children:i.jsxs("div",{className:"flex gap-2 text-xs",children:[i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("span",{children:"L"}),i.jsx("input",{value:((Se=l.wound_details)==null?void 0:Se.length)||"",onChange:L=>d(z=>oe(X({},z),{wound_details:oe(X({},z.wound_details),{length:L.target.value})})),placeholder:"__",className:"w-12 p-1 text-center border rounded"}),i.jsx("span",{children:"cm"})]}),i.jsx("span",{children:""}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("span",{children:"W"}),i.jsx("input",{value:((Be=l.wound_details)==null?void 0:Be.width)||"",onChange:L=>d(z=>oe(X({},z),{wound_details:oe(X({},z.wound_details),{width:L.target.value})})),placeholder:"__",className:"w-12 p-1 text-center border rounded"}),i.jsx("span",{children:"cm"})]}),i.jsx("span",{children:""}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("span",{children:"D"}),i.jsx("input",{value:((xe=l.wound_details)==null?void 0:xe.depth)||"",onChange:L=>d(z=>oe(X({},z),{wound_details:oe(X({},z.wound_details),{depth:L.target.value})})),placeholder:"__",className:"w-12 p-1 text-center border rounded"}),i.jsx("span",{children:"cm"})]})]})})]})]})}),i.jsx(Wt,{title:"Key interventions (multi-select chips)",children:i.jsxs("div",{className:"space-y-3",children:[i.jsx(Ut,{value:l.interventions,onChange:f,options:["Wound Care","Blood Draw","Catheter","Insulin","Injection","IV Line","Vaccination"]}),l.interventions.has("Vaccination")&&i.jsxs("div",{className:"space-y-3 p-3 bg-blue-50 rounded border border-blue-200",children:[i.jsx(ze,{legend:"Type",children:i.jsx(Ke,{value:((_e=l.vaccination_details)==null?void 0:_e.type)||"None",onChange:L=>d(z=>{var Q,Y,J;return oe(X({},z),{vaccination_details:oe(X({},z.vaccination_details),{type:L,dose:((Q=z.vaccination_details)==null?void 0:Q.dose)||"First",site:((Y=z.vaccination_details)==null?void 0:Y.site)||"L-Arm",batch:((J=z.vaccination_details)==null?void 0:J.batch)||"Not available"})})}),options:["Influenza","Pneumococcal","COVID-19","Tetanus","None"]})}),((Ne=l.vaccination_details)==null?void 0:Ne.type)!=="None"&&i.jsxs(i.Fragment,{children:[i.jsx(ze,{legend:"Dose",children:i.jsx(Ke,{value:((De=l.vaccination_details)==null?void 0:De.dose)||"First",onChange:L=>d(z=>oe(X({},z),{vaccination_details:oe(X({},z.vaccination_details),{dose:L})})),options:["First","Second","Booster"]})}),i.jsx(ze,{legend:"Site",children:i.jsx(Ke,{value:((G=l.vaccination_details)==null?void 0:G.site)||"L-Arm",onChange:L=>d(z=>oe(X({},z),{vaccination_details:oe(X({},z.vaccination_details),{site:L})})),options:["L-Arm","R-Arm","L-Thigh","R-Thigh"]})}),i.jsx(ze,{legend:"Batch",children:i.jsx("input",{value:((V=l.vaccination_details)==null?void 0:V.batch)||"Not available",onChange:L=>d(z=>oe(X({},z),{vaccination_details:oe(X({},z.vaccination_details),{batch:L.target.value})})),placeholder:"Batch number",className:"w-full p-2 text-xs border rounded"})})]})]})]})}),i.jsx(Wt,{title:"Caregiver & education (chips)",children:i.jsxs("div",{className:"space-y-3",children:[i.jsx(ze,{legend:"Caregiver status",children:i.jsx(Ke,{value:l.caregiver_status,onChange:L=>d(z=>oe(X({},z),{caregiver_status:L})),options:["Engaged","Stressed","Needs Support"]})}),i.jsx(ze,{legend:"Education topics",children:i.jsx(Ut,{value:l.education_topics,onChange:b,options:["Medications","Wound Care","Fall Prevention"]})}),i.jsx(ze,{legend:"Understanding",children:i.jsx(Ke,{value:l.understanding,onChange:L=>d(z=>oe(X({},z),{understanding:L})),options:["Understands","Needs Reinforcement"]})})]})}),i.jsx("textarea",{value:l.note||"",onChange:L=>d(z=>oe(X({},z),{note:L.target.value})),rows:2,placeholder:"Optional note (single free text)",className:"w-full p-2 text-sm border rounded-md"})]})]})},DR=({patient:n,onSave:e,onCancel:s})=>{const{state:a}=os(),[l,d]=Pe.useState({vitals:{hr:"",rr:"",spo2:"",bp_systolic:"",bp_diastolic:"",pain:"0"},bedMobility:"Independent",transfers:"Independent",ambulation:"Independent",balance:"Normal",romMmtEntries:[{region:"Shoulder",rom:"",mmt:"5"},{region:"Elbow",rom:"",mmt:"5"},{region:"Hip",rom:"",mmt:"5"},{region:"Knee",rom:"",mmt:"5"},{region:"Ankle",rom:"",mmt:"5"}],problems:new Set,shortTermGoals:new Set,longTermGoals:new Set}),h=(_,R)=>{d(U=>oe(X({},U),{vitals:oe(X({},U.vitals),{[_]:R})}))},f=_=>{d(R=>{const U=new Set(R.problems);return U.has(_)?U.delete(_):U.add(_),oe(X({},R),{problems:U})})},b=_=>{d(R=>{const U=new Set(R.shortTermGoals);return U.has(_)?U.delete(_):U.add(_),oe(X({},R),{shortTermGoals:U})})},v=_=>{d(R=>{const U=new Set(R.longTermGoals);return U.has(_)?U.delete(_):U.add(_),oe(X({},R),{longTermGoals:U})})},E=(_,R,U)=>{d(ie=>{const he=[...ie.romMmtEntries];return he[_]=oe(X({},he[_]),{[R]:U}),oe(X({},ie),{romMmtEntries:he})})},D=_=>{_.preventDefault();const R=a.staff.find(ie=>ie..includes(" "))||a.staff[0],U={id:Date.now().toString(),date:new Date().toISOString(),assessorId:R._,assessorName:R.,role:rt.PhysicalTherapist,status:"Unchanged",plan:"Continue same plan",dxFocus:[],phase:"subacute",pain:l.vitals.pain,function:{bedMobility:l.bedMobility,transfers:l.transfers,gaitDistance:"520m",assistiveDevice:l.ambulation==="Walker"?"walker":l.ambulation==="Cane"?"cane":"none",stairs:"none",balance:{static:l.balance.toLowerCase(),dynamic:l.balance.toLowerCase()}},romMmt:{region:[],rom:"WNL",mmt:"5"},interventions:[],ptNote:l.note};e(U)};return i.jsxs("form",{onSubmit:D,className:"p-4 bg-gray-50 flex flex-col h-full",children:[i.jsxs("div",{className:"flex justify-between items-center mb-3",children:[i.jsx("h4",{className:"font-bold text-gray-800",children:"Physical Therapy Assessment"}),i.jsxs("div",{className:"flex gap-1",children:[i.jsx("button",{type:"button",onClick:s,title:"Cancel",className:"p-1.5 rounded-full hover:bg-red-100 text-red-500",children:i.jsx(xn,{size:16})}),i.jsx("button",{type:"submit",title:"Save",className:"p-1.5 rounded-full hover:bg-green-100 text-green-600",children:i.jsx(Gi,{size:16})})]})]}),i.jsxs("div",{className:"space-y-2 overflow-y-auto flex-grow pr-1 text-sm",children:[i.jsx(Wt,{title:"Vitals (row inputs)",defaultOpen:!0,children:i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("div",{className:"flex gap-1",children:[i.jsx("input",{value:l.vitals.hr,onChange:_=>h("hr",_.target.value),placeholder:"__",className:"w-16 p-1 text-center border rounded text-xs"}),i.jsx("span",{className:"self-center text-xs text-gray-600",children:"HR"})]}),i.jsxs("div",{className:"flex gap-1",children:[i.jsx("input",{value:l.vitals.rr,onChange:_=>h("rr",_.target.value),placeholder:"__",className:"w-16 p-1 text-center border rounded text-xs"}),i.jsx("span",{className:"self-center text-xs text-gray-600",children:"RR"})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("div",{className:"flex gap-1",children:[i.jsx("input",{value:l.vitals.spo2,onChange:_=>h("spo2",_.target.value),placeholder:"__",className:"w-16 p-1 text-center border rounded text-xs"}),i.jsx("span",{className:"self-center text-xs text-gray-600",children:"SpO%"})]}),i.jsxs("div",{className:"flex gap-1",children:[i.jsx("input",{value:l.vitals.bp_systolic,onChange:_=>h("bp_systolic",_.target.value),placeholder:"__",className:"w-12 p-1 text-center border rounded text-xs"}),i.jsx("span",{className:"self-center text-xs",children:"/"}),i.jsx("input",{value:l.vitals.bp_diastolic,onChange:_=>h("bp_diastolic",_.target.value),placeholder:"__",className:"w-12 p-1 text-center border rounded text-xs"}),i.jsx("span",{className:"self-center text-xs text-gray-600",children:"BP"})]})]}),i.jsx(ze,{legend:"Pain (010)",children:i.jsx(Ke,{value:l.vitals.pain,onChange:_=>h("pain",_),options:["0","1","2","3","4","5","6","7","8","9","10"]})})]})}),i.jsx(Wt,{title:"Functional mobility (single-select per row)",children:i.jsxs("div",{className:"space-y-3",children:[i.jsx(ze,{legend:"Bed mobility",children:i.jsx(Ke,{value:l.bedMobility,onChange:_=>d(R=>oe(X({},R),{bedMobility:_})),options:["Independent","Min Assist","Max Assist","Dependent"]})}),i.jsx(ze,{legend:"Transfers",children:i.jsx(Ke,{value:l.transfers,onChange:_=>d(R=>oe(X({},R),{transfers:_})),options:["Independent","Min Assist","Max Assist","Dependent"]})}),i.jsx(ze,{legend:"Ambulation",children:i.jsx(Ke,{value:l.ambulation,onChange:_=>d(R=>oe(X({},R),{ambulation:_})),options:["Independent","Walker","Cane","Wheelchair","Bedbound"]})}),i.jsx(ze,{legend:"Balance",children:i.jsx(Ke,{value:l.balance,onChange:_=>d(R=>oe(X({},R),{balance:_})),options:["Normal","Fair","Poor"]})})]})}),i.jsx(Wt,{title:"ROM / MMT (inputs table with 5 rows)",children:i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs font-semibold text-gray-600",children:[i.jsx("span",{children:"Region"}),i.jsx("span",{children:"ROM ()"}),i.jsx("span",{children:"MMT (05)"})]}),l.romMmtEntries.map((_,R)=>i.jsxs("div",{className:"grid grid-cols-3 gap-2 items-center",children:[i.jsx("span",{className:"text-xs font-medium",children:_.region}),i.jsx("input",{value:_.rom,onChange:U=>E(R,"rom",U.target.value),placeholder:"__",className:"w-16 p-1 text-center border rounded text-xs"}),i.jsx(Ke,{value:_.mmt,onChange:U=>E(R,"mmt",U),options:["0","1","2","3","4","5"]})]},_.region))]})}),i.jsxs(Wt,{title:"Common PT problems (chips)",children:[i.jsx(Ut,{value:l.problems,onChange:f,options:["Weakness","Spasticity","Contracture","Joint Stiffness","Pain","Balance Deficit","Gait Abnormality","Other"]}),l.problems.has("Other")&&i.jsx("input",{value:l.otherProblem||"",onChange:_=>d(R=>oe(X({},R),{otherProblem:_.target.value})),placeholder:"Specify other problem",className:"mt-2 w-full p-2 text-xs border rounded"})]}),i.jsx(Wt,{title:"Goals (chips; separate Short vs Long)",children:i.jsxs("div",{className:"space-y-3",children:[i.jsx(ze,{legend:"Short-term",children:i.jsx(Ut,{value:l.shortTermGoals,onChange:b,options:["Improve ROM","Improve Strength","Improve Balance","Pain Reduction"]})}),i.jsx(ze,{legend:"Long-term",children:i.jsx(Ut,{value:l.longTermGoals,onChange:v,options:["Independent Ambulation","Independent Transfers","Prevent Complications","Improve ADLs"]})})]})}),i.jsx("textarea",{value:l.note||"",onChange:_=>d(R=>oe(X({},R),{note:_.target.value})),rows:2,placeholder:"Optional note",className:"w-full p-2 text-sm border rounded-md"})]})]})},OR=({patient:n,onSave:e,onCancel:s})=>{const{state:a}=os(),[l,d]=Pe.useState({currentStatus:"",priority:"",familyStatus:" ",primaryCaregiver:"",housingType:"",housingSuitability:"",utilities:new Set,incomeLevel:"",incomeSource:" ",supportLevel:"",psychStatus:new Set,socialChallenges:new Set,externalResources:new Set}),h=D=>{d(_=>{const R=new Set(_.utilities);return R.has(D)?R.delete(D):R.add(D),oe(X({},_),{utilities:R})})},f=D=>{d(_=>{const R=new Set(_.psychStatus);return R.has(D)?R.delete(D):R.add(D),oe(X({},_),{psychStatus:R})})},b=D=>{d(_=>{const R=new Set(_.socialChallenges);return R.has(D)?R.delete(D):R.add(D),oe(X({},_),{socialChallenges:R})})},v=D=>{d(_=>{const R=new Set(_.externalResources);return R.has(D)?R.delete(D):R.add(D),oe(X({},_),{externalResources:R})})},E=D=>{D.preventDefault();const _=a.staff.find(U=>U..includes(""))||a.staff[0],R={id:Date.now().toString(),date:new Date().toISOString(),assessorId:_._,assessorName:_.,role:rt.SocialWorker,status:l.currentStatus===""?"Improved":l.currentStatus===""?"Worsened":"Unchanged",plan:"Continue same plan",residence:l.familyStatus,caregiverHours:"  30",adlAssistance:" ",economic:{income:l.incomeLevel,coverage:"",transport:""},homeSafety:{risks:[],aids:[]},needs:[],psychosocial:{mood:l.psychStatus.has("")?"":"",memory:"",abuseSuspicion:""},actions:Array.from(l.externalResources),swNote:l.note};e(R)};return i.jsxs("form",{onSubmit:E,className:"p-4 bg-gray-50 flex flex-col h-full",dir:"rtl",children:[i.jsxs("div",{className:"flex justify-between items-center mb-3",children:[i.jsx("h4",{className:"font-bold text-gray-800",children:" "}),i.jsxs("div",{className:"flex gap-1",children:[i.jsx("button",{type:"button",onClick:s,title:"",className:"p-1.5 rounded-full hover:bg-red-100 text-red-500",children:i.jsx(xn,{size:16})}),i.jsx("button",{type:"submit",title:"",className:"p-1.5 rounded-full hover:bg-green-100 text-green-600",children:i.jsx(Gi,{size:16})})]})]}),i.jsxs("div",{className:"space-y-2 overflow-y-auto flex-grow pr-1 text-sm",children:[i.jsx(Wt,{title:" ",defaultOpen:!0,children:i.jsxs("div",{className:"space-y-3",children:[i.jsx(ze,{legend:" ",children:i.jsx(Ke,{value:l.currentStatus,onChange:D=>d(_=>oe(X({},_),{currentStatus:D})),options:["","",""]})}),i.jsx(ze,{legend:" ",children:i.jsx(Ke,{value:l.priority,onChange:D=>d(_=>oe(X({},_),{priority:D})),options:["","",""]})})]})}),i.jsx(Wt,{title:" ",children:i.jsxs("div",{className:"space-y-3",children:[i.jsx(ze,{legend:"  ( )",children:i.jsx(Ke,{value:l.familyStatus,onChange:D=>d(_=>oe(X({},_),{familyStatus:D})),options:[" "," /","  ",""]})}),i.jsx(ze,{legend:"   ( )",children:i.jsx(Ke,{value:l.primaryCaregiver,onChange:D=>d(_=>oe(X({},_),{primaryCaregiver:D})),options:["","","/"," "," "]})})]})}),i.jsx(Wt,{title:" ",children:i.jsxs("div",{className:"space-y-3",children:[i.jsx(ze,{legend:" ",children:i.jsx(Ke,{value:l.housingType,onChange:D=>d(_=>oe(X({},_),{housingType:D})),options:["",""]})}),i.jsx(ze,{legend:" ",children:i.jsx(Ke,{value:l.housingSuitability,onChange:D=>d(_=>oe(X({},_),{housingSuitability:D})),options:["","  (// )"]})}),i.jsx(ze,{legend:" ",children:i.jsx(Ut,{value:l.utilities,onChange:h,options:["","","",""]})})]})}),i.jsx(Wt,{title:" ",children:i.jsxs("div",{className:"space-y-3",children:[i.jsx(ze,{legend:"",children:i.jsx(Ke,{value:l.incomeLevel,onChange:D=>d(_=>oe(X({},_),{incomeLevel:D})),options:["",""," "]})}),i.jsx(ze,{legend:"",children:i.jsx(Ke,{value:l.incomeSource,onChange:D=>d(_=>oe(X({},_),{incomeSource:D})),options:[" "," "," "," "]})})]})}),i.jsx(Wt,{title:" ",children:i.jsx(Ke,{value:l.supportLevel,onChange:D=>d(_=>oe(X({},_),{supportLevel:D})),options:["","",""]})}),i.jsx(Wt,{title:" / ()",children:i.jsx(Ut,{value:l.psychStatus,onChange:f,options:["","",""," "," "]})}),i.jsx(Wt,{title:"   ()",children:i.jsx(Ut,{value:l.socialChallenges,onChange:b,options:[" ","  ","/ ","   "," "]})}),i.jsx(Wt,{title:"   ()",children:i.jsx(Ut,{value:l.externalResources,onChange:v,options:[" ",""," ","  "]})}),i.jsx("textarea",{value:l.note||"",onChange:D=>d(_=>oe(X({},_),{note:D.target.value})),rows:2,placeholder:" (   )",className:"w-full p-2 text-sm border rounded-md"})]})]})},kR=["Add referral","Adjust meds","Start antibiotics","Wound care upgrade","Frequency change"],MR=["fever","pain ","wound deterioration","device issue","other"],_1=({initialData:n,onSave:e,onCancel:s})=>{const a=()=>({status:(n==null?void 0:n.status)||"Unchanged",responseToPlan:(n==null?void 0:n.responseToPlan)||"good",adherence:(n==null?void 0:n.adherence)||"good",newIssues:(n==null?void 0:n.newIssues)||[],painAssessment:{level:"0"},systemsReview:{cardiovascular:"stable",respiratory:"stable",gastrointestinal:"stable",genitourinary:"stable",neurological:"stable",skin:"stable"},medicationChanges:"none",plan:(n==null?void 0:n.plan)||"Continue",planDetails:(n==null?void 0:n.planDetails)||[],nextFollowUp:(n==null?void 0:n.nextFollowUp)||"37d",mdNote:(n==null?void 0:n.mdNote)||"",clinicalImpression:"Patient stable with current management plan",treatmentRationale:"Continue current treatment approach based on patient response",patientEducation:"Disease management and medication compliance discussed",familyEducation:"Care instructions provided to family members",riskLevel:"low",goalsMet:"all"}),[l,d]=Pe.useState(a()),[h,f]=Pe.useState("assessment"),b=R=>{d(U=>oe(X({},U),{newIssues:U.newIssues.includes(R)?U.newIssues.filter(ie=>ie!==R):[...U.newIssues,R]}))},v=R=>{d(U=>oe(X({},U),{planDetails:U.planDetails.includes(R)?U.planDetails.filter(ie=>ie!==R):[...U.planDetails,R]}))},E=(R,U)=>{d(ie=>{let he={};if(U==="concerning"||U==="deteriorating"){he.riskLevel=U==="deteriorating"?"high":"moderate",he.nextFollowUp=U==="deteriorating"?"2448h":"37d";const Se={cardiovascular:"Cardiovascular system",respiratory:"Respiratory system",gastrointestinal:"Gastrointestinal system",genitourinary:"Genitourinary system",neurological:"Neurological system",skin:"Skin and integumentary system"};he.clinicalImpression=`${Se[R]} showing ${U} status - requires monitoring`,U==="deteriorating"&&(he.treatmentRationale=`Plan modification needed due to ${R} deterioration`,he.plan="Change")}return X(oe(X({},ie),{systemsReview:oe(X({},ie.systemsReview),{[R]:U})}),he)})},D=()=>l.status&&l.responseToPlan&&l.adherence,_=()=>{const R=[l.mdNote,l.clinicalImpression&&`Clinical Impression: ${l.clinicalImpression}`,l.differentialDiagnosis&&`Differential Diagnosis: ${l.differentialDiagnosis}`,l.treatmentRationale&&`Treatment Rationale: ${l.treatmentRationale}`,l.patientEducation&&`Patient Education: ${l.patientEducation}`,l.familyEducation&&`Family Education: ${l.familyEducation}`].filter(Boolean).join(`

`),U={status:l.status,responseToPlan:l.responseToPlan,adherence:l.adherence,newIssues:l.newIssues,plan:l.plan,planDetails:l.planDetails,nextFollowUp:l.nextFollowUp,mdNote:R||void 0};e(U)};return i.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 p-4 rounded-xl border border-blue-200 shadow-sm",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[i.jsx(Ui,{className:"text-blue-600",size:20}),i.jsx("h4",{className:"font-bold text-blue-800 text-lg",children:"Physician Assessment & Follow-Up"})]}),i.jsx("div",{className:"flex flex-wrap gap-2 mb-4 p-1 bg-white rounded-lg",children:[{key:"assessment",label:"Clinical Assessment",icon:yg},{key:"systems",label:"Systems Review",icon:Ui},{key:"plan",label:"Plan & Orders",icon:xS},{key:"notes",label:"Documentation",icon:yn}].map(({key:R,label:U,icon:ie})=>i.jsxs("button",{onClick:()=>f(R),className:`flex items-center gap-1 px-3 py-2 rounded-md text-sm font-medium transition-all ${h===R?"bg-blue-600 text-white shadow-sm":"text-blue-700 hover:bg-blue-100"}`,children:[i.jsx(ie,{size:14}),U]},R))}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex justify-between items-center p-3 bg-white rounded-lg border border-blue-100",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(rr,{size:16,className:"text-blue-600"}),i.jsxs("span",{className:"text-sm font-medium text-blue-800",children:["Assessment Date: ",new Date().toLocaleDateString()]})]}),i.jsxs("div",{className:"text-xs text-gray-500",children:[" : ",new Date().toLocaleDateString("ar-SA")]})]}),h==="assessment"&&i.jsxs("div",{className:"space-y-4",children:[i.jsx(ze,{legend:"Overall Patient Status",children:i.jsx(Ke,{value:l.status,onChange:R=>d(U=>oe(X({},U),{status:R})),options:["Improved","Unchanged","Worsened"]})}),i.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[i.jsx(ze,{legend:"Response to Treatment Plan",children:i.jsx(Ke,{value:l.responseToPlan,onChange:R=>d(U=>oe(X({},U),{responseToPlan:R})),options:["good","partial","poor"]})}),i.jsx(ze,{legend:"Medication Adherence",children:i.jsx(Ke,{value:l.adherence,onChange:R=>d(U=>oe(X({},U),{adherence:R})),options:["good","partial","poor"]})})]}),i.jsxs(ze,{legend:"Pain Assessment (0-10)",children:[i.jsx(Ke,{value:l.painAssessment.level,onChange:R=>d(U=>oe(X({},U),{painAssessment:oe(X({},U.painAssessment),{level:R})})),options:["0","1","2","3","4","5","6","7","8","9","10"]}),parseInt(l.painAssessment.level)>3&&i.jsxs("div",{className:"mt-3 grid md:grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Pain Character"}),i.jsxs("select",{value:l.painAssessment.character||"",onChange:R=>d(U=>oe(X({},U),{painAssessment:oe(X({},U.painAssessment),{character:R.target.value})})),className:"w-full p-2 border rounded-md text-sm focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"",children:"Select..."}),i.jsx("option",{value:"sharp",children:"Sharp"}),i.jsx("option",{value:"dull",children:"Dull"}),i.jsx("option",{value:"burning",children:"Burning"}),i.jsx("option",{value:"cramping",children:"Cramping"}),i.jsx("option",{value:"aching",children:"Aching"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Location"}),i.jsx("input",{type:"text",value:l.painAssessment.location||"",onChange:R=>d(U=>oe(X({},U),{painAssessment:oe(X({},U.painAssessment),{location:R.target.value})})),placeholder:"Pain location",className:"w-full p-2 border rounded-md text-sm focus:ring-2 focus:ring-blue-500"})]})]})]}),i.jsxs(ze,{legend:"New Issues or Complications",children:[i.jsx(Ut,{value:new Set(l.newIssues),onChange:b,options:MR}),l.newIssues.includes("other")&&i.jsx("textarea",{value:l.otherIssueDescription||"",onChange:R=>d(U=>oe(X({},U),{otherIssueDescription:R.target.value})),rows:2,placeholder:"Describe other issues...",className:"mt-2 w-full p-2 border rounded-md text-sm focus:ring-2 focus:ring-blue-500"})]}),i.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[i.jsx(ze,{legend:"Risk Level",children:i.jsx(Ke,{value:l.riskLevel,onChange:R=>d(U=>oe(X({},U),{riskLevel:R})),options:["low","moderate","high"]})}),i.jsx(ze,{legend:"Treatment Goals Met",children:i.jsx(Ke,{value:l.goalsMet,onChange:R=>d(U=>oe(X({},U),{goalsMet:R})),options:["all","partial","none"]})})]})]}),h==="systems"&&i.jsxs("div",{className:"space-y-4",children:[i.jsx("div",{className:"grid gap-4",children:Object.entries(l.systemsReview).map(([R,U])=>i.jsx("div",{className:"bg-white p-3 rounded-lg border border-gray-200",children:i.jsx(ze,{legend:R.charAt(0).toUpperCase()+R.slice(1),children:i.jsx(Ke,{value:U,onChange:ie=>E(R,ie),options:["stable","concerning","deteriorating"]})})},R))}),i.jsxs(ze,{legend:"Medication Changes",children:[i.jsx(Ke,{value:l.medicationChanges,onChange:R=>d(U=>oe(X({},U),{medicationChanges:R})),options:["none","dose-adjustment","new-medication","discontinuation","switch"]}),l.medicationChanges!=="none"&&i.jsx("textarea",{value:l.medicationDetails||"",onChange:R=>d(U=>oe(X({},U),{medicationDetails:R.target.value})),rows:3,placeholder:"Detail medication changes...",className:"mt-2 w-full p-2 border rounded-md text-sm focus:ring-2 focus:ring-blue-500"})]})]}),h==="plan"&&i.jsxs("div",{className:"space-y-4",children:[i.jsx(ze,{legend:"Treatment Plan",children:i.jsx(Ke,{value:l.plan,onChange:R=>d(U=>oe(X({},U),{plan:R})),options:["Continue","Change"]})}),l.plan==="Change"&&i.jsx(ze,{legend:"Specify Changes",children:i.jsx(Ut,{value:new Set(l.planDetails),onChange:v,options:kR})}),i.jsx(ze,{legend:"Next Follow-up",children:i.jsx(Ke,{value:l.nextFollowUp,onChange:R=>d(U=>oe(X({},U),{nextFollowUp:R})),options:["2448h","37d","24w"]})}),(l.riskLevel==="high"||l.nextFollowUp==="2448h")&&i.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx(bS,{className:"text-red-600",size:16}),i.jsx("span",{className:"font-medium text-red-800",children:"High Priority Follow-up"})]}),i.jsx("p",{className:"text-sm text-red-700",children:"This patient requires close monitoring. Ensure proper communication with nursing staff."})]})]}),h==="notes"&&i.jsx("div",{className:"space-y-4",children:i.jsxs("div",{className:"grid gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"General Medical Note"}),i.jsx("textarea",{value:l.mdNote||"",onChange:R=>d(U=>oe(X({},U),{mdNote:R.target.value})),rows:3,placeholder:"General clinical observations and notes...",className:"w-full p-3 border rounded-md text-sm focus:ring-2 focus:ring-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Clinical Impression"}),i.jsx("textarea",{value:l.clinicalImpression||"",onChange:R=>d(U=>oe(X({},U),{clinicalImpression:R.target.value})),rows:2,placeholder:"Primary clinical impression and assessment...",className:"w-full p-3 border rounded-md text-sm focus:ring-2 focus:ring-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Treatment Rationale"}),i.jsx("textarea",{value:l.treatmentRationale||"",onChange:R=>d(U=>oe(X({},U),{treatmentRationale:R.target.value})),rows:2,placeholder:"Rationale for current treatment approach...",className:"w-full p-3 border rounded-md text-sm focus:ring-2 focus:ring-blue-500"})]}),i.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Patient Education"}),i.jsx("textarea",{value:l.patientEducation||"",onChange:R=>d(U=>oe(X({},U),{patientEducation:R.target.value})),rows:2,placeholder:"Education provided to patient...",className:"w-full p-3 border rounded-md text-sm focus:ring-2 focus:ring-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Family Education"}),i.jsx("textarea",{value:l.familyEducation||"",onChange:R=>d(U=>oe(X({},U),{familyEducation:R.target.value})),rows:2,placeholder:"Education provided to family/caregivers...",className:"w-full p-3 border rounded-md text-sm focus:ring-2 focus:ring-blue-500"})]})]})]})})]}),i.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-blue-200",children:[i.jsx("div",{className:"text-sm text-gray-600",children:!D()&&i.jsx("span",{className:"text-amber-600",children:" Complete required assessments"})}),i.jsxs("div",{className:"flex gap-3",children:[i.jsx("button",{type:"button",onClick:s,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:ring-2 focus:ring-blue-500 transition-all",children:"Cancel"}),i.jsxs("button",{type:"button",onClick:_,disabled:!D(),className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 transition-all",children:[i.jsx(Gi,{size:16}),"Save Assessment"]})]})]})]})},w1=({initialData:n,onSave:e,onCancel:s})=>{const a=()=>{var ie,he,Se,Be,xe,_e;const R=new Date().getHours();return{vitals:{bp:((ie=n==null?void 0:n.vitals)==null?void 0:ie.bp)||"120/80",hr:((he=n==null?void 0:n.vitals)==null?void 0:he.hr)||"72",temp:((Se=n==null?void 0:n.vitals)==null?void 0:Se.temp)||"36.5",rr:((Be=n==null?void 0:n.vitals)==null?void 0:Be.rr)||"16",o2sat:((xe=n==null?void 0:n.vitals)==null?void 0:xe.o2sat)||"98",pain:((_e=n==null?void 0:n.vitals)==null?void 0:_e.pain)||"0",bgl:R<12?"90":R<18?"120":"110"},status:(n==null?void 0:n.status)||"Unchanged",woundDelta:(n==null?void 0:n.woundDelta)||"unchanged",deviceDelta:(n==null?void 0:n.deviceDelta)||"unchanged",tasks:(n==null?void 0:n.tasks)||["education"],skinAssessment:"intact",mobilityLevel:"independent",mentalStatus:"alert",respiratoryStatus:"clear",fallRisk:"low",pressureRisk:"low",escalation:(n==null?void 0:n.escalation)||"No",nurseNote:(n==null?void 0:n.nurseNote)||"",clinicalFindings:"",interventionsProvided:"Routine nursing care provided",patientEducation:"Medication compliance and safety measures discussed",recommendationsForNextVisit:"Continue current care plan"}},[l,d]=Pe.useState(a()),[h,f]=Pe.useState("vitals"),b=_=>{d(R=>oe(X({},R),{tasks:R.tasks.includes(_)?R.tasks.filter(U=>U!==_):[...R.tasks,_]}))},v=(_,R)=>{d(U=>{const ie=oe(X({},U.vitals),{[_]:R});let he={};if(_==="temp"&&R&&parseFloat(R)>=38&&(he.escalation="Yes",he.escalationReason="Fever detected - temperature 38C",he.clinicalFindings="Patient presents with elevated temperature"),_==="o2sat"&&R&&parseInt(R)<95&&(he.escalation="Yes",he.escalationReason="Low oxygen saturation - SpO2 <95%",he.respiratoryStatus="sob"),_==="bp"&&R){const Se=R.split("/");if(Se.length===2){const Be=parseInt(Se[0]),xe=parseInt(Se[1]);(Be>=140||xe>=90)&&(he.clinicalFindings=U.clinicalFindings+(U.clinicalFindings?`
`:"")+"Elevated blood pressure noted")}}return _==="pain"&&R&&parseInt(R)>=7&&(he.escalation="Yes",he.escalationReason="Severe pain reported - Pain score 7/10",he.interventionsProvided="Pain assessment completed, comfort measures provided"),X(oe(X({},U),{vitals:ie}),he)})},E=()=>{const{bp:_,hr:R,temp:U,rr:ie,o2sat:he}=l.vitals;return _&&R&&U&&ie&&he},D=()=>{const _=[l.nurseNote,l.clinicalFindings&&`Clinical Findings: ${l.clinicalFindings}`,l.interventionsProvided&&`Interventions: ${l.interventionsProvided}`,l.patientEducation&&`Education Provided: ${l.patientEducation}`,l.recommendationsForNextVisit&&`Next Visit Recommendations: ${l.recommendationsForNextVisit}`].filter(Boolean).join(`

`),R={vitals:l.vitals,status:l.status,woundDelta:l.woundDelta,deviceDelta:l.deviceDelta,tasks:l.tasks,escalation:l.escalation,nurseNote:_||void 0};e(R)};return i.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 to-teal-50 p-4 rounded-xl border border-emerald-200 shadow-sm",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[i.jsx(Ui,{className:"text-emerald-600",size:20}),i.jsx("h4",{className:"font-bold text-emerald-800 text-lg",children:"Nursing Assessment & Follow-Up"})]}),i.jsx("div",{className:"flex flex-wrap gap-2 mb-4 p-1 bg-white rounded-lg",children:[{key:"vitals",label:"Vital Signs",icon:_l},{key:"assessment",label:"Assessment",icon:Ui},{key:"tasks",label:"Tasks",icon:Ix},{key:"notes",label:"Notes",icon:rr}].map(({key:_,label:R,icon:U})=>i.jsxs("button",{onClick:()=>f(_),className:`flex items-center gap-1 px-3 py-2 rounded-md text-sm font-medium transition-all ${h===_?"bg-emerald-600 text-white shadow-sm":"text-emerald-700 hover:bg-emerald-100"}`,children:[i.jsx(U,{size:14}),R]},_))}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex justify-between items-center p-3 bg-white rounded-lg border border-emerald-100",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(rr,{size:16,className:"text-emerald-600"}),i.jsxs("span",{className:"text-sm font-medium text-emerald-800",children:["Visit Date: ",new Date().toLocaleDateString()]})]}),i.jsxs("div",{className:"text-xs text-gray-500",children:[" : ",new Date().toLocaleDateString("ar-SA")]})]}),h==="vitals"&&i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[i.jsxs("div",{className:"bg-white p-3 rounded-lg border border-gray-200",children:[i.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 mb-2",children:[i.jsx(Ix,{size:14,className:"text-red-500"}),"Blood Pressure"]}),i.jsx("input",{type:"text",value:l.vitals.bp,onChange:_=>v("bp",_.target.value),placeholder:"120/80",className:"w-full p-2 border rounded-md text-sm focus:ring-2 focus:ring-emerald-500"})]}),i.jsxs("div",{className:"bg-white p-3 rounded-lg border border-gray-200",children:[i.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 mb-2",children:[i.jsx(_l,{size:14,className:"text-blue-500"}),"Heart Rate"]}),i.jsx("input",{type:"number",value:l.vitals.hr,onChange:_=>v("hr",_.target.value),placeholder:"72",className:"w-full p-2 border rounded-md text-sm focus:ring-2 focus:ring-emerald-500"})]}),i.jsxs("div",{className:"bg-white p-3 rounded-lg border border-gray-200",children:[i.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 mb-2",children:[i.jsx(vS,{size:14,className:"text-orange-500"}),"Temperature (C)"]}),i.jsx("input",{type:"number",step:"0.1",value:l.vitals.temp,onChange:_=>v("temp",_.target.value),placeholder:"36.5",className:"w-full p-2 border rounded-md text-sm focus:ring-2 focus:ring-emerald-500"})]}),i.jsxs("div",{className:"bg-white p-3 rounded-lg border border-gray-200",children:[i.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Respiratory Rate"}),i.jsx("input",{type:"number",value:l.vitals.rr,onChange:_=>v("rr",_.target.value),placeholder:"16",className:"w-full p-2 border rounded-md text-sm focus:ring-2 focus:ring-emerald-500"})]}),i.jsxs("div",{className:"bg-white p-3 rounded-lg border border-gray-200",children:[i.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"SpO (%)"}),i.jsx("input",{type:"number",value:l.vitals.o2sat,onChange:_=>v("o2sat",_.target.value),placeholder:"98",className:"w-full p-2 border rounded-md text-sm focus:ring-2 focus:ring-emerald-500"})]}),i.jsxs("div",{className:"bg-white p-3 rounded-lg border border-gray-200",children:[i.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Blood Glucose"}),i.jsx("input",{type:"number",value:l.vitals.bgl,onChange:_=>v("bgl",_.target.value),placeholder:"120 (optional)",className:"w-full p-2 border rounded-md text-sm focus:ring-2 focus:ring-emerald-500"})]})]}),i.jsx(ze,{legend:"Pain Level (0-10)",children:i.jsx(Ke,{value:l.vitals.pain,onChange:_=>v("pain",_),options:["0","1","2","3","4","5","6","7","8","9","10"]})})]}),h==="assessment"&&i.jsxs("div",{className:"space-y-4",children:[i.jsx(ze,{legend:"Overall Patient Status",children:i.jsx(Ke,{value:l.status,onChange:_=>d(R=>oe(X({},R),{status:_})),options:["Improved","Unchanged","Worsened"]})}),i.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[i.jsx(ze,{legend:"Skin Assessment",children:i.jsx(Ke,{value:l.skinAssessment,onChange:_=>d(R=>oe(X({},R),{skinAssessment:_})),options:["intact","at-risk","breakdown","wound-present"]})}),i.jsx(ze,{legend:"Mobility Level",children:i.jsx(Ke,{value:l.mobilityLevel,onChange:_=>d(R=>oe(X({},R),{mobilityLevel:_})),options:["independent","assistance","bedbound"]})})]}),i.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[i.jsx(ze,{legend:"Mental Status",children:i.jsx(Ke,{value:l.mentalStatus,onChange:_=>d(R=>oe(X({},R),{mentalStatus:_})),options:["alert","confused","lethargic"]})}),i.jsx(ze,{legend:"Respiratory Status",children:i.jsx(Ke,{value:l.respiratoryStatus,onChange:_=>d(R=>oe(X({},R),{respiratoryStatus:_})),options:["clear","congested","sob"]})})]}),i.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[i.jsx(ze,{legend:"Fall Risk",children:i.jsx(Ke,{value:l.fallRisk,onChange:_=>d(R=>oe(X({},R),{fallRisk:_})),options:["low","moderate","high"]})}),i.jsx(ze,{legend:"Pressure Risk",children:i.jsx(Ke,{value:l.pressureRisk,onChange:_=>d(R=>oe(X({},R),{pressureRisk:_})),options:["low","moderate","high"]})}),i.jsx(ze,{legend:"Escalation Needed",children:i.jsx(Ke,{value:l.escalation,onChange:_=>d(R=>oe(X({},R),{escalation:_})),options:["No","Yes"]})})]}),l.woundDelta!==void 0&&i.jsx(ze,{legend:"Wound Status Change",children:i.jsx(Ke,{value:l.woundDelta,onChange:_=>d(R=>oe(X({},R),{woundDelta:_})),options:["better","unchanged","worse"]})}),l.deviceDelta!==void 0&&i.jsx(ze,{legend:"Device Status Change",children:i.jsx(Ke,{value:l.deviceDelta,onChange:_=>d(R=>oe(X({},R),{deviceDelta:_})),options:["better","unchanged","worse"]})})]}),h==="tasks"&&i.jsxs("div",{className:"space-y-4",children:[i.jsx(ze,{legend:"Tasks Completed During Visit",children:i.jsx(Ut,{value:new Set(l.tasks),onChange:b,options:["dressing change","vaccine","meds given","education","wound care","blood draw","catheter care","IV therapy"]})}),l.escalation==="Yes"&&i.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[i.jsx("label",{className:"block text-sm font-medium text-yellow-800 mb-2",children:"Reason for Escalation"}),i.jsx("textarea",{value:l.escalationReason||"",onChange:_=>d(R=>oe(X({},R),{escalationReason:_.target.value})),rows:3,placeholder:"Describe the reason for escalating to physician...",className:"w-full p-3 border border-yellow-300 rounded-md text-sm focus:ring-2 focus:ring-yellow-500"})]})]}),h==="notes"&&i.jsx("div",{className:"space-y-4",children:i.jsxs("div",{className:"grid gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"General Nursing Note"}),i.jsx("textarea",{value:l.nurseNote||"",onChange:_=>d(R=>oe(X({},R),{nurseNote:_.target.value})),rows:3,placeholder:"General observations and notes...",className:"w-full p-3 border rounded-md text-sm focus:ring-2 focus:ring-emerald-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Clinical Findings"}),i.jsx("textarea",{value:l.clinicalFindings||"",onChange:_=>d(R=>oe(X({},R),{clinicalFindings:_.target.value})),rows:2,placeholder:"Specific clinical findings and observations...",className:"w-full p-3 border rounded-md text-sm focus:ring-2 focus:ring-emerald-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Interventions Provided"}),i.jsx("textarea",{value:l.interventionsProvided||"",onChange:_=>d(R=>oe(X({},R),{interventionsProvided:_.target.value})),rows:2,placeholder:"Detail interventions performed during visit...",className:"w-full p-3 border rounded-md text-sm focus:ring-2 focus:ring-emerald-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Patient Education Provided"}),i.jsx("textarea",{value:l.patientEducation||"",onChange:_=>d(R=>oe(X({},R),{patientEducation:_.target.value})),rows:2,placeholder:"Education topics covered with patient/family...",className:"w-full p-3 border rounded-md text-sm focus:ring-2 focus:ring-emerald-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Recommendations for Next Visit"}),i.jsx("textarea",{value:l.recommendationsForNextVisit||"",onChange:_=>d(R=>oe(X({},R),{recommendationsForNextVisit:_.target.value})),rows:2,placeholder:"Recommendations and focus areas for next visit...",className:"w-full p-3 border rounded-md text-sm focus:ring-2 focus:ring-emerald-500"})]})]})})]}),i.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-emerald-200",children:[i.jsxs("div",{className:"text-sm text-gray-600",children:[!E()&&h==="vitals"&&i.jsx("span",{className:"text-amber-600",children:" Complete all vital signs"}),l.escalation==="Yes"&&!l.escalationReason&&i.jsx("span",{className:"text-red-600",children:" Escalation reason required"})]}),i.jsxs("div",{className:"flex gap-3",children:[i.jsx("button",{type:"button",onClick:s,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:ring-2 focus:ring-emerald-500 transition-all",children:"Cancel"}),i.jsxs("button",{type:"button",onClick:D,disabled:!E()||l.escalation==="Yes"&&!l.escalationReason,className:"px-4 py-2 text-sm font-medium text-white bg-emerald-600 border border-transparent rounded-md hover:bg-emerald-700 focus:ring-2 focus:ring-emerald-500 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 transition-all",children:[i.jsx(Gi,{size:16}),"Save Assessment"]})]})]})]})},N1=({initialData:n,onSave:e,onCancel:s})=>{const[a,l]=Pe.useState({patientStatus:"Stable",interventions:new Set,modalities:new Set,equipment:new Set,tolerance:"Well tolerated",education:new Set,plan:"Continue same"}),d=E=>{l(D=>{const _=new Set(D.interventions);return _.has(E)?_.delete(E):_.add(E),oe(X({},D),{interventions:_})})},h=E=>{l(D=>{const _=new Set(D.modalities);return _.has(E)?_.delete(E):_.add(E),oe(X({},D),{modalities:_})})},f=E=>{l(D=>{const _=new Set(D.equipment);return _.has(E)?_.delete(E):_.add(E),oe(X({},D),{equipment:_})})},b=E=>{l(D=>{const _=new Set(D.education);return _.has(E)?_.delete(E):_.add(E),oe(X({},D),{education:_})})},v=()=>{const E={changeSinceLast:{pain:"",function:a.patientStatus==="Improved"?"":a.patientStatus==="Declining"?"":""},tolerance:a.tolerance==="Well tolerated"?"good":a.tolerance==="Fatigue"?"fair":"poor",hep:{status:"given",adherence:"good"},plan:a.plan==="Continue same"?"Continue":"Change",ptNote:a.note};e(E)};return i.jsxs("div",{className:"bg-purple-50/50 p-3 rounded-md border border-purple-200 space-y-3 text-sm",children:[i.jsx("h4",{className:"font-bold text-purple-800",children:"PT Follow-up Note"}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs(ze,{legend:"Patient status (chips)",children:[i.jsx(Ke,{value:a.patientStatus,onChange:E=>l(D=>oe(X({},D),{patientStatus:E})),options:["Improved","Stable","Declining","New Complaint","Other"]}),a.patientStatus==="Other"&&i.jsx("input",{value:a.otherStatus||"",onChange:E=>l(D=>oe(X({},D),{otherStatus:E.target.value})),placeholder:"Specify other status",className:"mt-2 w-full p-2 text-xs border rounded"})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsx("h5",{className:"font-semibold text-purple-700",children:"Session content (multi-chips)"}),i.jsx(ze,{legend:"Interventions",children:i.jsx(Ut,{value:a.interventions,onChange:d,options:["ROM","Strengthening","Balance","Gait","Transfers","Breathing"]})}),i.jsx(ze,{legend:"Modalities",children:i.jsx(Ut,{value:a.modalities,onChange:h,options:["Heat","Cold","TENS","NMES","Ultrasound"]})}),i.jsx(ze,{legend:"Equipment",children:i.jsx(Ut,{value:a.equipment,onChange:f,options:["Walker","Cane","Parallel Bars","Theraband","Weights"]})})]}),i.jsx(ze,{legend:"Tolerance (chips)",children:i.jsx(Ke,{value:a.tolerance,onChange:E=>l(D=>oe(X({},D),{tolerance:E})),options:["Well tolerated","Fatigue","Pain increased","Limited by condition"]})}),i.jsx(ze,{legend:"Education (chips)",children:i.jsx(Ut,{value:a.education,onChange:b,options:["Home Exercise","Safety","Caregiver Education"]})}),i.jsx(ze,{legend:"Plan (chips)",children:i.jsx(Ke,{value:a.plan,onChange:E=>l(D=>oe(X({},D),{plan:E})),options:["Continue same","Progress program","Add modalities","Refer MD"]})}),i.jsx("textarea",{value:a.note||"",onChange:E=>l(D=>oe(X({},D),{note:E.target.value})),rows:2,placeholder:"Optional note",className:"w-full p-2 border rounded-md"})]}),i.jsxs("div",{className:"flex justify-end gap-2",children:[i.jsx("button",{type:"button",onClick:s,className:"text-xs px-3 py-1 rounded-md text-gray-600 bg-gray-100 hover:bg-gray-200",children:"Cancel"}),i.jsxs("button",{type:"button",onClick:v,className:"text-xs px-3 py-1 rounded-md text-white bg-purple-600 hover:bg-purple-700 flex items-center gap-1",children:[i.jsx(Gi,{size:14}),"Save Note"]})]})]})},S1=({initialData:n,onSave:e,onCancel:s})=>{const[a,l]=Pe.useState({socialStatus:"",updates:new Set,interventions:new Set,shortTermPlan:"  ",escalationIndicators:new Set,escalationPaths:new Set}),d=D=>{l(_=>{const R=new Set(_.updates);return R.has(D)?R.delete(D):R.add(D),oe(X({},_),{updates:R})})},h=D=>{l(_=>{const R=new Set(_.interventions);return R.has(D)?R.delete(D):R.add(D),oe(X({},_),{interventions:R})})},f=D=>{l(_=>{const R=new Set(_.escalationIndicators);return R.has(D)?R.delete(D):R.add(D),oe(X({},_),{escalationIndicators:R})})},b=D=>{l(_=>{const R=new Set(_.escalationPaths);return R.has(D)?R.delete(D):R.add(D),oe(X({},_),{escalationPaths:R})})},v=a.escalationIndicators.size>0,E=()=>{const D={situationChange:a.socialStatus,actionsTaken:Array.from(a.interventions),plan:a.shortTermPlan.includes("")?"":"",swNote:a.note};e(D)};return i.jsxs("div",{className:"bg-yellow-50/50 p-3 rounded-md border border-yellow-200 space-y-3 text-sm",dir:"rtl",children:[i.jsx("h4",{className:"font-bold text-yellow-800",children:"  "}),i.jsxs("div",{className:"space-y-3",children:[i.jsx(ze,{legend:"   ",children:i.jsx(Ke,{value:a.socialStatus,onChange:D=>l(_=>oe(X({},_),{socialStatus:D})),options:["","",""]})}),i.jsx(ze,{legend:" ()",children:i.jsx(Ut,{value:a.updates,onChange:d,options:["  ","/ "," "," "," "]})}),i.jsx(ze,{legend:"   ()",children:i.jsx(Ut,{value:a.interventions,onChange:h,options:[" ","  "," ","  (/)"]})}),i.jsx(ze,{legend:"   ( )",children:i.jsx(Ke,{value:a.shortTermPlan,onChange:D=>l(_=>oe(X({},_),{shortTermPlan:D})),options:["  "," ","  ","  "]})}),i.jsx(ze,{legend:"  ()",children:i.jsx(Ut,{value:a.escalationIndicators,onChange:f,options:["   ","   ","  ","/ ","  ","    ","   (  /)","  ","   ( )"]})}),v&&i.jsx("div",{className:"p-3 bg-red-50 rounded border border-red-200",children:i.jsx(ze,{legend:"  (    )",children:i.jsx(Ut,{value:a.escalationPaths,onChange:b,options:["  ","  937","  "," / ","   (//)"]})})}),i.jsx("textarea",{value:a.note||"",onChange:D=>l(_=>oe(X({},_),{note:D.target.value})),rows:2,placeholder:" (   )",className:"w-full p-2 border rounded-md"})]}),i.jsxs("div",{className:"flex justify-end gap-2",children:[i.jsx("button",{type:"button",onClick:s,className:"text-xs px-3 py-1 rounded-md text-gray-600 bg-gray-100 hover:bg-gray-200",children:""}),i.jsxs("button",{type:"button",onClick:E,className:"text-xs px-3 py-1 rounded-md text-white bg-yellow-600 hover:bg-yellow-700 flex items-center gap-1",children:[i.jsx(Gi,{size:14}),""]})]})]})},PR=({patient:n,role:e,assessmentType:s,visitDate:a,onClose:l,onSave:d})=>{const{state:h}=os(),f=CR(),[b,v]=Pe.useState(null),[E,D]=Pe.useState(!1),[_,R]=Pe.useState(!1),[U,ie]=Pe.useState(null),[he,Se]=Pe.useState(null);Pe.useEffect(()=>{(()=>{if(a){const Y=f.getDraftVisitNote(n.nationalId,a,e);Y&&(v(Y.formData),Se(new Date(Y.lastSaved)),console.log(" Loaded draft visit note:",Y))}else{const Y=f.getDraftAssessment(n.nationalId,e);Y&&(v(Y.formData),Se(new Date(Y.lastSaved)),console.log(" Loaded draft assessment:",Y))}})()},[n.nationalId,e,a,f]);const Be=Pe.useCallback(Q=>K(null,null,function*(){if(!(!f.getAutoSaveEnabled()||!E))try{ie("saving"),a?f.saveDraftVisitNote(n.nationalId,a,e,Q,!1):f.saveDraftAssessment(n.nationalId,e,Q,!1),Se(new Date),ie("saved"),setTimeout(()=>ie(null),2e3)}catch(Y){console.error("Auto-save error:",Y),ie("error")}}),[n.nationalId,e,a,E,f]);Pe.useEffect(()=>{if(!E||!b)return;const Q=setTimeout(()=>{Be(b)},3e3);return()=>clearTimeout(Q)},[b,E,Be]);const xe=Pe.useCallback(Q=>{v(Q),D(!0)},[]),_e=Q=>K(null,null,function*(){try{if(R(!0),a)d(Q),f.deleteDraftVisitNote(n.nationalId,a,e);else{const Y=X({id:Date.now().toString(),date:new Date().toISOString(),role:e,assessorName:"Current User",assessorId:"user-id"},Q);d(Y),f.deleteDraftAssessment(n.nationalId,e)}l()}catch(Y){console.error("Save error:",Y)}finally{R(!1)}}),Ne=()=>{if(E){if(!window.confirm("You have unsaved changes. They will be saved as a draft. Do you want to continue?"))return;b&&(a?f.saveDraftVisitNote(n.nationalId,a,e,b,!1):f.saveDraftAssessment(n.nationalId,e,b,!1))}l()},De=()=>{const Q={initialData:b,onSave:_e,onCancel:Ne,onChange:xe,patient:n};if(s==="initial")switch(e){case rt.Doctor:return i.jsx(IR,X({},Q));case rt.Nurse:return i.jsx(RR,X({},Q));case rt.PhysicalTherapist:return i.jsx(DR,X({},Q));case rt.SocialWorker:return i.jsx(OR,X({},Q));default:return null}else switch(e){case rt.Doctor:return i.jsx(_1,X({},Q));case rt.Nurse:return i.jsx(w1,X({},Q));case rt.PhysicalTherapist:return i.jsx(N1,X({},Q));case rt.SocialWorker:return i.jsx(S1,X({},Q));default:return null}},G=()=>{const Q=s==="initial"?"Initial Assessment":"Follow-up Assessment";return a?`Visit Note - ${Q}`:Q},V=()=>{const Q=s==="initial"?" ":" ";return a?`  - ${Q}`:Q},L=()=>{let Q=`${e} - ${s==="initial"?" ":" "}`;return a&&(Q+=` -  ${new Date(a).toLocaleDateString("ar-SA")}`),Q},z=()=>f.getAutoSaveEnabled()?i.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[U==="saving"&&i.jsxs("div",{className:"flex items-center gap-1 text-blue-600",children:[i.jsx(Kr,{size:12,className:"animate-spin"}),i.jsx("span",{children:"Saving..."})]}),U==="saved"&&i.jsxs("div",{className:"flex items-center gap-1 text-green-600",children:[i.jsx(kv,{size:12}),i.jsx("span",{children:"Auto-saved"})]}),U==="error"&&i.jsxs("div",{className:"flex items-center gap-1 text-red-600",children:[i.jsx(Hc,{size:12}),i.jsx("span",{children:"Save failed"})]}),he&&!U&&i.jsxs("div",{className:"text-gray-500",children:["Last saved: ",he.toLocaleTimeString()]})]}):null;return i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-5xl max-h-[90vh] flex flex-col border-2 border-blue-500 ring-4 ring-blue-200/50 mx-auto my-auto",children:[i.jsx(y1,{title:G(),titleAr:V(),patient:n,role:e,subtitle:L()}),i.jsx("div",{className:"px-4 md:px-6 py-2 bg-gray-50 border-b border-gray-200",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx(z,{}),E&&i.jsxs("div",{className:"flex items-center gap-1 text-orange-600 text-xs",children:[i.jsx(Hc,{size:12}),i.jsx("span",{children:"Unsaved changes"})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:Ne,className:"text-xs px-3 py-1 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition-all",children:"Cancel"}),i.jsx("button",{onClick:()=>_e(b),disabled:_||!b,className:"text-xs px-4 py-1 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-1 transition-all",children:_?i.jsxs(i.Fragment,{children:[i.jsx(Kr,{size:12,className:"animate-spin"}),"Saving..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Gi,{size:12}),"Save & Complete"]})})]})]})}),i.jsx("div",{className:"flex-1 overflow-auto",children:De()})]})})},LR=({patient:n,onSave:e,onCancel:s})=>{const{state:a}=os(),[l,d]=Pe.useState(null),[h,f]=Pe.useState(null),[b,v]=Pe.useState({dataSource:[],maritalStatus:"",wivesCount:1,educationLevel:"",profession:"",socialNotes:"",housingType:"",housingOwnership:"",housingCondition:3,incomeSources:[],incomeAmount:"",familyMembers:[],psychologicalImpact:[],physicalStatus:[],assessmentSpeech:"",assessmentSight:"",assessmentHearing:"",assessmentMovement:"",assessmentNotes:{},equipmentNeeds:[],interventionSummary:"",educationStatus:""}),[E,D]=Pe.useState([{id:"basic",title:"Basic Assessment",titleAr:"   ",icon:ml,isCompleted:!1,isOpen:!0},{id:"environment",title:"Environment & Housing",titleAr:"   ",icon:Rx,isCompleted:!1,isOpen:!1},{id:"assessment",title:"Psychological & Physical",titleAr:"   ",icon:Dx,isCompleted:!1,isOpen:!1},{id:"plan",title:"Plan & Recommendations",titleAr:"   ",icon:yn,isCompleted:!1,isOpen:!1}]),[_,R]=Pe.useState(!1),[U,ie]=Pe.useState({relation:"",relationBeforeIllness:"",relationAfterIllness:""}),he=["",""," "],Se=[{value:"",label:""},{value:"",label:""},{value:"",label:""},{value:"",label:""},{value:"",label:""}],Be=[{value:"",label:""},{value:"",label:""},{value:"",label:""},{value:"",label:""},{value:"",label:""},{value:" ",label:" "}],xe=["",""," ",""," "," "],_e=["",""," ","  ",""],Ne=["  ","",""," "," ","  ","  "," ",""],De=[" "," "," "," "," ","","   "],G=[" "," "," "," "," "," "],V=[{key:"family_education",label:" ",text:"                  ."},{key:"financial_support",label:"  ",text:"             ."},{key:"psych_eval",label:" ",text:"             ."},{key:"listening_session",label:" ",text:"               ."}],L=Pe.useCallback(Ie=>{D(Ge=>Ge.map(bt=>bt.id===Ie?oe(X({},bt),{isOpen:!bt.isOpen}):bt))},[]),z=Pe.useCallback((Ie,Ge)=>{v(bt=>oe(X({},bt),{[Ie]:Ge}))},[]),Q=Pe.useCallback((Ie,Ge)=>{v(bt=>{const xt=bt[Ie],yt=xt.includes(Ge)?xt.filter(Ht=>Ht!==Ge):[...xt,Ge];return oe(X({},bt),{[Ie]:yt})})},[]),Y=Pe.useCallback(Ie=>{v(Ge=>oe(X({},Ge),{interventionSummary:Ge.interventionSummary?`${Ge.interventionSummary}

${Ie}`:Ie}))},[]),J=Pe.useCallback(()=>{if(U.relation.trim()){const Ie=X({id:Date.now().toString()},U);v(Ge=>oe(X({},Ge),{familyMembers:[...Ge.familyMembers,Ie]})),ie({relation:"",relationBeforeIllness:"",relationAfterIllness:""}),R(!1)}},[U]),pt=Pe.useCallback(Ie=>{v(Ge=>oe(X({},Ge),{familyMembers:Ge.familyMembers.filter(bt=>bt.id!==Ie)}))},[]),Ct=Pe.useMemo(()=>({basic:!!(b.dataSource.length&&b.maritalStatus&&b.educationLevel&&b.profession),environment:!!(b.housingType&&b.housingOwnership&&b.incomeSources.length),assessment:!!(b.assessmentSpeech&&b.assessmentSight&&b.assessmentHearing&&b.assessmentMovement),plan:!!b.educationStatus}),[b]),Ae=Pe.useCallback(()=>{const Ie=oe(X({id:Date.now().toString(),date:new Date().toISOString(),assessorId:"current-user-id",assessorName:(l==null?void 0:l.)||" ",role:rt.SocialWorker,status:"Improved",plan:"",situationChange:"",actionsTaken:b.incomeSources.includes(" ")?[" "]:[" "],swNote:b.interventionSummary},b),{familyMembers});e(Ie)},[b,familyMembers,l,e]),Ue=({options:Ie,selected:Ge,onToggle:bt,allowCustom:xt=!1})=>i.jsxs("div",{className:"flex flex-wrap gap-2",children:[Ie.map(yt=>i.jsx("button",{onClick:()=>bt(yt),className:`px-3 py-1.5 text-sm rounded-full border-2 transition-all ${Ge.includes(yt)?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:border-blue-300"}`,children:yt},yt)),xt&&i.jsxs("button",{className:"px-3 py-1.5 text-sm rounded-full border-2 border-dashed border-gray-400 text-gray-600 hover:border-blue-400",children:[i.jsx(Ir,{size:14,className:"inline mr-1"})," ..."]})]}),et=({options:Ie,selected:Ge,onSelect:bt})=>i.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:Ie.map(xt=>i.jsx("button",{onClick:()=>bt(xt.value),className:`p-4 rounded-xl border-2 text-center transition-all ${Ge===xt.value?"bg-blue-50 border-blue-500 text-blue-700":"bg-white border-gray-200 hover:border-blue-300"}`,children:i.jsx("div",{className:"font-medium",children:xt.label})},xt.value))});return i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-4xl max-h-[95vh] overflow-hidden flex flex-col",children:[i.jsxs("div",{className:"bg-gradient-to-r from-orange-600 to-orange-700 text-white p-6",children:[i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:"w-16 h-16 bg-white/20 rounded-lg flex items-center justify-center",children:i.jsx(ml,{className:"text-white",size:24})}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold",children:"Social Work Assessment"}),i.jsx("p",{className:"text-orange-100",children:"   "}),i.jsxs("p",{className:"text-sm text-orange-200 mt-1",children:[": ",n.nameAr]})]})]}),i.jsx("button",{onClick:s,className:"p-2 hover:bg-white/20 rounded-lg transition-colors",children:i.jsx(xn,{size:20})})]}),i.jsx("div",{className:"mt-4 flex items-center gap-2",children:E.map((Ie,Ge)=>i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-xs font-bold ${Ct[Ie.id]?"bg-green-500 text-white":Ie.isOpen?"bg-white text-orange-600":"bg-white/30 text-white"}`,children:Ct[Ie.id]?"":Ge+1}),Ge<E.length-1&&i.jsx("div",{className:"w-8 h-0.5 bg-white/30 mx-1"})]},Ie.id))})]}),i.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"border border-gray-200 rounded-xl overflow-hidden",children:[i.jsxs("button",{onClick:()=>L("basic"),className:"w-full p-4 bg-gray-50 flex items-center justify-between hover:bg-gray-100 transition-colors",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(ml,{className:"text-orange-600",size:20}),i.jsxs("div",{className:"text-left",children:[i.jsx("h3",{className:"font-semibold text-gray-900",children:E[0].titleAr}),i.jsx("p",{className:"text-sm text-gray-600",children:"   "})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[Ct.basic&&i.jsx(fo,{className:"text-green-500",size:18}),E[0].isOpen?i.jsx(Ic,{size:20}):i.jsx(Rc,{size:20})]})]}),E[0].isOpen&&i.jsxs("div",{className:"p-6 space-y-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:" "}),i.jsx(Ue,{options:he,selected:b.dataSource,onToggle:Ie=>Q("dataSource",Ie)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:" "}),i.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:["","","",""].map(Ie=>i.jsx("button",{onClick:()=>z("maritalStatus",Ie),className:`p-4 rounded-xl border-2 text-center transition-all ${b.maritalStatus===Ie?"bg-blue-50 border-blue-500 text-blue-700":"bg-white border-gray-200 hover:border-blue-300"}`,children:i.jsx("div",{className:"font-medium",children:Ie})},Ie))}),b.maritalStatus===""&&i.jsxs("div",{className:"mt-4",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" "}),i.jsx("input",{type:"number",min:"1",max:"4",value:b.wivesCount,onChange:Ie=>z("wivesCount",parseInt(Ie.target.value)),className:"w-24 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:" "}),i.jsx(et,{options:Se,selected:b.educationLevel,onSelect:Ie=>z("educationLevel",Ie)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:""}),i.jsx(et,{options:Be,selected:b.profession,onSelect:Ie=>z("profession",Ie)})]}),i.jsxs("div",{children:[i.jsxs("button",{onClick:()=>{},className:"flex items-center gap-2 text-blue-600 hover:text-blue-700 text-sm",children:[i.jsx(Ir,{size:16}),"  "]}),i.jsx("textarea",{value:b.socialNotes,onChange:Ie=>z("socialNotes",Ie.target.value),className:"mt-2 w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:3,placeholder:"    ..."})]})]})]}),i.jsxs("div",{className:"border border-gray-200 rounded-xl overflow-hidden",children:[i.jsxs("button",{onClick:()=>L("environment"),className:"w-full p-4 bg-gray-50 flex items-center justify-between hover:bg-gray-100 transition-colors",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(Rx,{className:"text-orange-600",size:20}),i.jsxs("div",{className:"text-left",children:[i.jsx("h3",{className:"font-semibold text-gray-900",children:E[1].titleAr}),i.jsx("p",{className:"text-sm text-gray-600",children:"   "})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[Ct.environment&&i.jsx(fo,{className:"text-green-500",size:18}),E[1].isOpen?i.jsx(Ic,{size:20}):i.jsx(Rc,{size:20})]})]}),E[1].isOpen&&i.jsxs("div",{className:"p-6 space-y-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:" "}),i.jsx(Ue,{options:xe,selected:b.housingType?[b.housingType]:[],onToggle:Ie=>z("housingType",Ie)})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:" "}),i.jsx("div",{className:"flex gap-3",children:["",""].map(Ie=>i.jsx("button",{onClick:()=>z("housingOwnership",Ie),className:`px-6 py-3 rounded-lg border-2 transition-all ${b.housingOwnership===Ie?"bg-blue-50 border-blue-500 text-blue-700":"bg-white border-gray-200 hover:border-blue-300"}`,children:Ie},Ie))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"  "}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("input",{type:"range",min:"1",max:"5",value:b.housingCondition,onChange:Ie=>z("housingCondition",parseInt(Ie.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"}),i.jsxs("div",{className:"flex justify-between text-xs text-gray-500",children:[i.jsx("span",{children:""}),i.jsx("span",{children:""}),i.jsx("span",{children:""})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:" "}),i.jsx(Ue,{options:_e,selected:b.incomeSources,onToggle:Ie=>Q("incomeSources",Ie),allowCustom:!0}),i.jsx("div",{className:"mt-3",children:i.jsx("input",{type:"text",value:b.incomeAmount,onChange:Ie=>z("incomeAmount",Ie.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"  ( )"})})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"  "}),i.jsxs("button",{onClick:()=>R(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[i.jsx(Ir,{size:16}),"  "]}),b.familyMembers.length>0&&i.jsx("div",{className:"mt-4 space-y-2",children:b.familyMembers.map(Ie=>i.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("span",{className:"font-medium",children:Ie.relation}),i.jsxs("div",{className:"text-sm text-gray-600",children:[" : ",Ie.relationBeforeIllness," |  : ",Ie.relationAfterIllness]})]}),i.jsx("button",{onClick:()=>pt(Ie.id),className:"text-red-600 hover:text-red-700 p-1",children:i.jsx(xn,{size:16})})]},Ie.id))})]})]})]}),i.jsxs("div",{className:"border border-gray-200 rounded-xl overflow-hidden",children:[i.jsxs("button",{onClick:()=>L("assessment"),className:"w-full p-4 bg-gray-50 flex items-center justify-between hover:bg-gray-100 transition-colors",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(Dx,{className:"text-orange-600",size:20}),i.jsxs("div",{className:"text-left",children:[i.jsx("h3",{className:"font-semibold text-gray-900",children:E[2].titleAr}),i.jsx("p",{className:"text-sm text-gray-600",children:"   "})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[Ct.assessment&&i.jsx(fo,{className:"text-green-500",size:18}),E[2].isOpen?i.jsx(Ic,{size:20}):i.jsx(Rc,{size:20})]})]}),E[2].isOpen&&i.jsxs("div",{className:"p-6 space-y-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"   /"}),i.jsx(Ue,{options:Ne,selected:b.psychologicalImpact,onToggle:Ie=>Q("psychologicalImpact",Ie),allowCustom:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"  "}),i.jsx(Ue,{options:De,selected:b.physicalStatus,onToggle:Ie=>Q("physicalStatus",Ie),allowCustom:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"  "}),i.jsx("div",{className:"space-y-4",children:[{key:"assessmentSpeech",label:"",options:[""," "," "]},{key:"assessmentSight",label:"",options:[""," "," "]},{key:"assessmentHearing",label:"",options:[""," "," "]},{key:"assessmentMovement",label:"",options:[""," "," "," "]}].map(Ie=>i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs("div",{className:"w-20 text-sm font-medium text-gray-700",children:[Ie.label,":"]}),i.jsx("div",{className:"flex-1 flex items-center gap-2",children:Ie.options.map(Ge=>i.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[i.jsx("input",{type:"radio",name:Ie.key,value:Ge,checked:b[Ie.key]===Ge,onChange:bt=>z(Ie.key,bt.target.value),className:"text-blue-600 focus:ring-blue-500"}),i.jsx("span",{className:"text-sm",children:Ge})]},Ge))}),i.jsx("button",{onClick:()=>{},className:"p-1 text-gray-400 hover:text-blue-600",title:" ",children:i.jsx(Bm,{size:16})})]},Ie.key))})]})]})]}),i.jsxs("div",{className:"border border-gray-200 rounded-xl overflow-hidden",children:[i.jsxs("button",{onClick:()=>L("plan"),className:"w-full p-4 bg-gray-50 flex items-center justify-between hover:bg-gray-100 transition-colors",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(yn,{className:"text-orange-600",size:20}),i.jsxs("div",{className:"text-left",children:[i.jsx("h3",{className:"font-semibold text-gray-900",children:E[3].titleAr}),i.jsx("p",{className:"text-sm text-gray-600",children:"   "})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[Ct.plan&&i.jsx(fo,{className:"text-green-500",size:18}),E[3].isOpen?i.jsx(Ic,{size:20}):i.jsx(Rc,{size:20})]})]}),E[3].isOpen&&i.jsxs("div",{className:"p-6 space-y-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"  ( )"}),i.jsx(Ue,{options:G,selected:b.equipmentNeeds,onToggle:Ie=>Q("equipmentNeeds",Ie),allowCustom:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"  "}),i.jsxs("div",{className:"mb-4",children:[i.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"  :"}),i.jsx("div",{className:"flex flex-wrap gap-2",children:V.map(Ie=>i.jsxs("button",{onClick:()=>Y(Ie.text),className:"flex items-center gap-1 px-3 py-1.5 bg-blue-100 text-blue-700 rounded-full text-sm hover:bg-blue-200 transition-colors",children:[i.jsx(_S,{size:14}),Ie.label]},Ie.key))})]}),i.jsx("textarea",{value:b.interventionSummary,onChange:Ie=>z("interventionSummary",Ie.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:6,placeholder:"        ..."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"  "}),i.jsx("div",{className:"flex gap-3",children:[" ","  "].map(Ie=>i.jsx("button",{onClick:()=>z("educationStatus",Ie),className:`px-6 py-3 rounded-lg border-2 transition-all ${b.educationStatus===Ie?"bg-green-50 border-green-500 text-green-700":"bg-white border-gray-200 hover:border-green-300"}`,children:Ie},Ie))})]})]})]})]})}),i.jsxs("div",{className:"border-t border-gray-200 p-6 flex items-center justify-between bg-gray-50",children:[i.jsxs("div",{className:"text-sm text-gray-600",children:[" : ",Object.values(Ct).filter(Boolean).length,"  ",E.length]}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("button",{onClick:s,className:"px-6 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:""}),i.jsxs("button",{onClick:Ae,className:"px-6 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors flex items-center gap-2",children:[i.jsx(fo,{size:16}),"   "]})]})]}),_&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-60 flex items-center justify-center p-4",children:i.jsx("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md",children:i.jsxs("div",{className:"p-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"  "}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" "}),i.jsx("input",{type:"text",value:U.relation,onChange:Ie=>ie(Ge=>oe(X({},Ge),{relation:Ie.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:":   "})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"  "}),i.jsxs("select",{value:U.relationBeforeIllness,onChange:Ie=>ie(Ge=>oe(X({},Ge),{relationBeforeIllness:Ie.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[i.jsx("option",{value:"",children:""}),i.jsx("option",{value:"",children:""}),i.jsx("option",{value:"",children:""})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"  "}),i.jsxs("select",{value:U.relationAfterIllness,onChange:Ie=>ie(Ge=>oe(X({},Ge),{relationAfterIllness:Ie.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[i.jsx("option",{value:"",children:""}),i.jsx("option",{value:"",children:""}),i.jsx("option",{value:"",children:""})]})]})]}),i.jsxs("div",{className:"flex items-center justify-end gap-3 mt-6",children:[i.jsx("button",{onClick:()=>R(!1),className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:""}),i.jsx("button",{onClick:J,disabled:!U.relation.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:""})]})]})})})]})})},VR=({data:n,onClose:e})=>{const{patient:s,assessor:a,formData:l}=n,d=new Date,h=d.toLocaleDateString("en-US"),f=d.toLocaleDateString("ar-SA-u-ca-islamic");d.toLocaleDateString("ar-SA-u-ca-islamic"),`${s.nationalId.slice(-4)}${d.getFullYear()}${(d.getMonth()+1).toString().padStart(2,"0")}${d.getDate().toString().padStart(2,"0")}${d.getHours().toString().padStart(2,"0")}${d.getMinutes().toString().padStart(2,"0")}`;const b=s.dateOfBirth?Math.floor((d.getTime()-new Date(s.dateOfBirth).getTime())/(365.25*24*60*60*1e3)):" ",v=s.sex==="Male"?"":s.sex==="Female"?"":" ",E=()=>{if(!l.maritalStatus)return"";let Ne=`** :** ${l.maritalStatus}`;if(l.maritalStatus===""&&l.wivesCount>1&&(Ne+=`.    ${l.wivesCount} `),l.familyMembers.length>0){Ne+=`. ** :**   ${l.familyMembers.length}    `;const De=l.familyMembers.filter(G=>G.relationBeforeIllness!==G.relationAfterIllness);De.length>0&&(Ne+=`.        ${De.length}      `)}return Ne+"."},D=()=>{if(!l.housingType)return"";let Ne=`**:**     ${l.housingType}`;l.housingOwnership&&(Ne+=` ${l.housingOwnership===""?" ":" "}`);const De=[" ","","","",""][l.housingCondition-1];return Ne+=`. ** :**      ${De}        `,Ne+"."},_=()=>{if(l.incomeSources.length===0)return"";let Ne="** :** ";if(l.incomeSources.includes("  "))Ne+="                      ";else{const De=l.incomeSources.filter(G=>G!=="  ");Ne+=`      : ${De.join(" ")}`,l.incomeAmount&&(Ne+=`.     ${l.incomeAmount}  `),l.incomeSources.includes(" ")&&(Ne+=". **:**              ")}return Ne+"."},R=()=>{if(l.psychologicalImpact.length===0)return"** :**                .";let Ne="** :**      ";const De=l.psychologicalImpact.map(G=>({"  ":"   ",:" ",:" "," ":"  "," ":"  ","  ":"  ","  ":" "," ":"  ",:" "})[G]||G);return Ne+=De.slice(0,-1).join(" "),De.length>1?Ne+=` ${De[De.length-1]}`:Ne+=De[0],Ne+="   . **:**              ",Ne+"."},U=()=>{if(l.physicalStatus.length===0)return"";let Ne="** :** ";const De={" ":"     "," ":"      "," ":"       "," ":"            "," ":"     ",:"   ","   ":"      "},G=l.physicalStatus.map(V=>De[V]||V);return Ne+=G.join(" "),l.physicalStatus.includes(" ")&&(Ne+=". ** :**                 "),Ne+"."},ie=()=>{const Ne=[{key:"assessmentSpeech",label:"",value:l.assessmentSpeech},{key:"assessmentSight",label:"",value:l.assessmentSight},{key:"assessmentHearing",label:"",value:l.assessmentHearing},{key:"assessmentMovement",label:"",value:l.assessmentMovement}].filter(L=>L.value);if(Ne.length===0)return"";let De="** :** ";const G=Ne.filter(L=>L.value===""||L.value===""),V=Ne.filter(L=>L.value!==""&&L.value!=="");if(G.length>0&&(De+=`     ${G.map(L=>L.label).join(" ")}`),V.length>0){G.length>0&&(De+="  "),De+="  ";const L=V.map(z=>`${L[z.value]||z.value}  ${z.label}`);De+=L.join(" ")}return De+"."},he=()=>{if(l.equipmentNeeds.length===0)return"";let Ne="** :**      ";const De={" ":"  "," ":"     "," ":"  "," ":"   "," ":"   "," ":"   "},G=l.equipmentNeeds.map(V=>De[V]||V);return Ne+=G.join(" "),Ne+=". **:**            ",Ne+"."},Se=()=>l.interventionSummary.trim()?`**  :** ${l.interventionSummary}`:"",Be=()=>l.educationStatus?l.educationStatus===" "?"** :**              .        .":"** :**                  .":"",xe=()=>{const Ne=[];return l.incomeSources.includes("  ")&&Ne.push("      "),l.psychologicalImpact.length>0&&Ne.push("      "),l.physicalStatus.includes(" ")&&Ne.push("       "),l.equipmentNeeds.length>0&&Ne.push("    "),l.educationStatus==="  "&&Ne.push("      "),Ne},_e=()=>{window.print()};return i.jsxs(i.Fragment,{children:[i.jsx("style",{jsx:!0,global:!0,children:`
        @media print {
          .no-print { display: none !important; }
          .print-page { 
            margin: 0 !important; 
            padding: 20px !important;
            box-shadow: none !important;
            border-radius: 0 !important;
            max-width: none !important;
            background: white !important;
          }
          .print-header {
            background: linear-gradient(135deg, #059669 0%, #0369a1 100%) !important;
            -webkit-print-color-adjust: exact !important;
            color-adjust: exact !important;
            print-color-adjust: exact !important;
          }
          .print-no-break { 
            page-break-inside: avoid !important; 
            break-inside: avoid !important;
          }
          .signature-line {
            border-bottom: 2px solid #374151 !important;
            height: 60px !important;
            margin-bottom: 8px !important;
          }
          body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif !important;
            direction: rtl !important;
          }
          * {
            -webkit-print-color-adjust: exact !important;
            color-adjust: exact !important;
            print-color-adjust: exact !important;
          }
        }
        
        .signature-line {
          border-bottom: 2px solid #d1d5db;
          height: 40px;
          margin-bottom: 8px;
        }
      `}),i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-5xl max-h-[95vh] overflow-hidden flex flex-col",children:[i.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 no-print",children:[i.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"  "}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("button",{onClick:_e,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:" "}),i.jsx("button",{onClick:e,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:""})]})]}),i.jsx("div",{className:"flex-1 overflow-y-auto",children:i.jsxs("div",{className:"print-page max-w-none mx-auto bg-white",style:{fontFamily:"Arial, sans-serif"},children:[i.jsxs("div",{className:"print-header bg-gradient-to-r from-green-700 via-green-600 to-blue-700 text-white p-8 mb-6 relative overflow-hidden",children:[i.jsxs("div",{className:"absolute inset-0 opacity-10",children:[i.jsx("div",{className:"absolute top-0 left-0 w-32 h-32 bg-white rounded-full -translate-x-16 -translate-y-16"}),i.jsx("div",{className:"absolute bottom-0 right-0 w-24 h-24 bg-white rounded-full translate-x-12 translate-y-12"})]}),i.jsxs("div",{className:"relative z-10",children:[i.jsxs("div",{className:"flex justify-between items-start mb-6",children:[i.jsxs("div",{className:"flex items-center gap-6",children:[i.jsxs("div",{className:"flex flex-col items-center gap-3",children:[i.jsx("div",{className:"w-24 h-24 bg-white rounded-xl flex items-center justify-center shadow-2xl border-4 border-green-200",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-green-600 text-3xl font-bold mb-1",children:""}),i.jsx("div",{className:"text-xs text-green-700 font-bold",children:" "}),i.jsx("div",{className:"text-xs text-green-600",children:"MOH"})]})}),i.jsx("div",{className:"w-20 h-20 bg-white rounded-xl flex items-center justify-center shadow-xl border-2 border-blue-200",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-blue-600 font-bold text-lg",children:""}),i.jsx("div",{className:"text-xs text-blue-700 font-bold",children:""}),i.jsx("div",{className:"text-xs text-blue-600",children:"KAH"})]})})]}),i.jsxs("div",{className:"text-white",children:[i.jsx("h1",{className:"text-3xl font-bold mb-2 drop-shadow-lg",children:"   - "}),i.jsx("h2",{className:"text-xl text-green-100 mb-3",children:"King Abdullah Hospital - Bisha"}),i.jsxs("div",{className:"space-y-1 text-sm",children:[i.jsx("p",{className:"text-green-200 font-semibold",children:"    | Home Healthcare Division"}),i.jsx("p",{className:"text-blue-200",children:"   | Aseer Health Cluster"}),i.jsx("p",{className:"text-green-100 text-xs",children:"   | Kingdom of Saudi Arabia"})]})]})]}),i.jsx("div",{className:"bg-white/15 backdrop-blur-sm rounded-xl p-6 border border-white/20 shadow-xl",children:i.jsxs("div",{className:"text-center text-white",children:[i.jsx("p",{className:"text-sm text-green-100 mb-2",children:"  | Assessment Date"}),i.jsx("p",{className:"font-bold text-xl mb-1",children:h}),i.jsx("p",{className:"text-sm text-blue-200",children:f})]})})]}),i.jsxs("div",{className:"bg-white/10 backdrop-blur-sm rounded-xl p-6 border border-white/20",children:[i.jsx("h2",{className:"text-2xl font-bold text-center mb-2",children:"   "}),i.jsx("p",{className:"text-green-100 text-center text-lg",children:"Comprehensive Social Work Assessment Report"}),i.jsx("div",{className:"text-center mt-3",children:i.jsx("span",{className:"bg-yellow-400 text-yellow-900 px-4 py-1 rounded-full text-sm font-bold",children:"  | AI Generated Report"})})]})]})]}),i.jsxs("div",{className:"patient-info bg-gradient-to-br from-blue-50 via-white to-green-50 p-8 rounded-xl mb-6 border-2 border-blue-200 shadow-lg print-no-break",children:[i.jsxs("h3",{className:"font-bold text-xl text-gray-800 mb-6 border-b-2 border-blue-300 pb-3 flex items-center gap-3",children:[i.jsx("span",{className:"w-4 h-4 bg-gradient-to-r from-blue-600 to-green-600 rounded-full"}),"   | Patient & Assessment Information"]}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 mb-6 text-sm",children:[i.jsxs("div",{className:"bg-white p-4 rounded-lg border-r-4 border-blue-500 shadow-sm",children:[i.jsx("span",{className:"font-semibold text-gray-600 block mb-2",children:"  | Full Name"}),i.jsx("p",{className:"font-bold text-blue-900 text-lg",children:s.nameAr})]}),i.jsxs("div",{className:"bg-white p-4 rounded-lg border-r-4 border-green-500 shadow-sm",children:[i.jsx("span",{className:"font-semibold text-gray-600 block mb-2",children:"  | National ID"}),i.jsx("p",{className:"font-bold text-green-900 font-mono",children:s.nationalId})]}),i.jsxs("div",{className:"bg-white p-4 rounded-lg border-r-4 border-purple-500 shadow-sm",children:[i.jsx("span",{className:"font-semibold text-gray-600 block mb-2",children:" | Age"}),i.jsxs("p",{className:"font-bold text-purple-900",children:[b," "]})]}),i.jsxs("div",{className:"bg-white p-4 rounded-lg border-r-4 border-pink-500 shadow-sm",children:[i.jsx("span",{className:"font-semibold text-gray-600 block mb-2",children:" | Gender"}),i.jsx("p",{className:"font-bold text-pink-900",children:v})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6 text-sm",children:[i.jsxs("div",{className:"bg-white p-4 rounded-lg border-r-4 border-orange-500 shadow-sm",children:[i.jsx("span",{className:"font-semibold text-gray-600 block mb-2",children:"  | Phone Number"}),i.jsx("p",{className:"font-bold text-orange-900 font-mono",children:s.phone||" "})]}),i.jsxs("div",{className:"bg-white p-4 rounded-lg border-r-4 border-teal-500 shadow-sm",children:[i.jsx("span",{className:"font-semibold text-gray-600 block mb-2",children:" | Area"}),i.jsx("p",{className:"font-bold text-teal-900",children:s.areaId||" "})]}),i.jsxs("div",{className:"bg-white p-4 rounded-lg border-r-4 border-cyan-500 shadow-sm",children:[i.jsx("span",{className:"font-semibold text-gray-600 block mb-2",children:"  | Admission Date"}),i.jsx("p",{className:"font-bold text-cyan-900",children:s.admissionDate?new Date(s.admissionDate).toLocaleDateString("ar-SA"):" "})]})]}),i.jsx("div",{className:"bg-gradient-to-r from-indigo-100 to-blue-100 p-4 rounded-lg border border-indigo-200",children:i.jsxs("div",{className:"text-center text-sm",children:[i.jsx("p",{className:"font-bold text-indigo-900 text-lg",children:a.}),i.jsx("p",{className:"text-indigo-700",children:a.}),i.jsx("p",{className:"text-indigo-600",children:"   "}),i.jsx("p",{className:"text-indigo-600",children:"   - "})]})})]}),i.jsxs("div",{className:"space-y-6 text-gray-800 leading-relaxed",children:[i.jsxs("div",{className:"bg-blue-50 rounded-lg p-6 border border-blue-200 print-no-break",children:[i.jsx("h3",{className:"font-bold text-lg text-blue-800 mb-4 border-b border-blue-300 pb-2",children:"Social Assessment |  "}),i.jsxs("div",{className:"space-y-4 text-base",children:[E()&&i.jsx("p",{className:"leading-relaxed",children:E()}),l.educationLevel&&i.jsxs("p",{className:"leading-relaxed",children:[i.jsx("strong",{children:" :"})," ",l.educationLevel,".",i.jsx("strong",{children:":"})," ",l.profession||" ","."]}),l.socialNotes&&i.jsxs("p",{className:"leading-relaxed bg-yellow-50 p-3 rounded border-l-4 border-yellow-400",children:[i.jsx("strong",{children:"  :"})," ",l.socialNotes]})]})]}),i.jsxs("div",{className:"bg-green-50 rounded-lg p-6 border border-green-200 print-no-break",children:[i.jsx("h3",{className:"font-bold text-lg text-green-800 mb-4 border-b border-green-300 pb-2",children:"Housing & Financial Status |   "}),i.jsxs("div",{className:"space-y-4 text-base",children:[D()&&i.jsx("p",{className:"leading-relaxed",children:D()}),_()&&i.jsx("p",{className:"leading-relaxed",children:_()})]})]}),l.familyMembers.length>0&&i.jsxs("div",{className:"bg-purple-50 rounded-lg p-6 border border-purple-200 print-no-break",children:[i.jsx("h3",{className:"font-bold text-lg text-purple-800 mb-4 border-b border-purple-300 pb-2",children:"Family Composition |  "}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full border-collapse",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"bg-purple-100",children:[i.jsx("th",{className:"border border-purple-300 p-3 text-right",children:" "}),i.jsx("th",{className:"border border-purple-300 p-3 text-right",children:"  "}),i.jsx("th",{className:"border border-purple-300 p-3 text-right",children:"  "})]})}),i.jsx("tbody",{children:l.familyMembers.map((Ne,De)=>i.jsxs("tr",{className:"bg-white",children:[i.jsx("td",{className:"border border-purple-300 p-3",children:Ne.relation}),i.jsx("td",{className:"border border-purple-300 p-3",children:Ne.relationBeforeIllness}),i.jsx("td",{className:"border border-purple-300 p-3",children:Ne.relationAfterIllness})]},De))})]})})]}),i.jsxs("div",{className:"bg-red-50 rounded-lg p-6 border border-red-200 print-no-break",children:[i.jsx("h3",{className:"font-bold text-lg text-red-800 mb-4 border-b border-red-300 pb-2",children:"Psychological & Physical Status |   "}),i.jsxs("div",{className:"space-y-4 text-base",children:[R()&&i.jsx("p",{className:"leading-relaxed",children:R()}),U()&&i.jsx("p",{className:"leading-relaxed",children:U()}),ie()&&i.jsx("p",{className:"leading-relaxed",children:ie()})]})]}),he()&&i.jsxs("div",{className:"bg-indigo-50 rounded-lg p-6 border border-indigo-200 print-no-break",children:[i.jsx("h3",{className:"font-bold text-lg text-indigo-800 mb-4 border-b border-indigo-300 pb-2",children:"Equipment & Support Needs |   "}),i.jsx("p",{className:"leading-relaxed text-base",children:he()})]}),Se()&&i.jsxs("div",{className:"bg-orange-50 rounded-lg p-6 border border-orange-200 print-no-break",children:[i.jsx("h3",{className:"font-bold text-lg text-orange-800 mb-4 border-b border-orange-300 pb-2",children:"Social Work Intervention |  "}),i.jsx("p",{className:"leading-relaxed text-base whitespace-pre-line",children:Se()})]}),Be()&&i.jsxs("div",{className:"bg-teal-50 rounded-lg p-6 border border-teal-200 print-no-break",children:[i.jsx("h3",{className:"font-bold text-lg text-teal-800 mb-4 border-b border-teal-300 pb-2",children:"Patient & Family Education |   "}),i.jsx("p",{className:"leading-relaxed text-base",children:Be()})]}),xe().length>0&&i.jsxs("div",{className:"bg-gray-50 rounded-lg p-6 border border-gray-200 print-no-break",children:[i.jsx("h3",{className:"font-bold text-lg text-gray-800 mb-4 border-b border-gray-300 pb-2",children:"Recommendations & Follow-up |  "}),i.jsx("ul",{className:"space-y-2 text-base",children:xe().map((Ne,De)=>i.jsxs("li",{className:"flex items-start gap-2",children:[i.jsx("span",{className:"text-blue-600 font-bold",children:""}),i.jsx("span",{className:"leading-relaxed",children:Ne})]},De))})]})]}),i.jsx("div",{className:"signature-section mt-8 p-6 border-t border-gray-300 print-no-break",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[i.jsxs("div",{children:[i.jsx("div",{className:"signature-line"}),i.jsxs("div",{className:"signature-label mt-2 text-center",children:[i.jsx("p",{className:"font-bold text-lg",children:a.}),i.jsx("p",{className:"text-sm text-gray-600",children:a.}),i.jsx("p",{className:"text-sm text-gray-600",children:"   "}),i.jsx("p",{className:"text-sm text-gray-600",children:"   - "})]})]}),i.jsxs("div",{children:[i.jsx("div",{className:"signature-line"}),i.jsxs("div",{className:"signature-label mt-2 text-center",children:[i.jsx("p",{className:"font-semibold",children:""}),i.jsx("p",{className:"text-sm text-gray-600",children:f}),i.jsx("p",{className:"text-sm text-gray-600",children:"Date"})]})]})]})}),i.jsxs("div",{className:"print-footer text-center text-sm text-gray-600 mt-8 pt-4 border-t border-gray-200",children:[i.jsx("p",{children:"   -  | King Abdullah Hospital - Bisha"}),i.jsx("p",{className:"text-xs mt-2",children:"    | Home Healthcare Division"})]})]})})]})})]})},UR=({patient:n,onClose:e})=>{const{state:s,dispatch:a}=os(),[l,d]=Pe.useState("assessment"),[h,f]=Pe.useState(null),b=s.staff.find(D=>D.===" ")||{:" ",:" ",:"",:"",_:""},v=D=>{a({type:"SAVE_ASSESSMENT",payload:{patientId:n.nationalId,assessment:D}}),f({patient:n,assessor:b,formData:D}),d("report")},E=()=>{d("assessment"),e()};return i.jsxs(i.Fragment,{children:[l==="assessment"&&i.jsx(LR,{patient:n,onSave:v,onCancel:e}),l==="report"&&h&&i.jsx(VR,{data:h,onClose:E})]})},BR=({patient:n,onClose:e})=>{const{state:s}=os(),[a,l]=Pe.useState({selectedRole:null,assessmentType:null,showAssessmentModal:!1}),d=s.currentRole,h=[{role:rt.Doctor,title:"Doctor Assessment",titleAr:"  /",icon:Ui,color:"blue",description:"   -   "},{role:rt.Nurse,title:"Nursing Assessment",titleAr:"  /",icon:ih,color:"green",description:"    "},{role:rt.PhysicalTherapist,title:"Physical Therapy",titleAr:"  ",icon:gg,color:"purple",description:"    "},{role:rt.SocialWorker,title:"Social Work Assessment",titleAr:"  ",icon:pg,color:"orange",description:"     "}],f=Pe.useMemo(()=>n.assessments?n.assessments.reduce((ie,he)=>(ie[he.role]||(ie[he.role]=[]),ie[he.role].push(he),ie),{}):{},[n.assessments]),b=Pe.useCallback(ie=>f[ie]||[],[f]),v=Pe.useCallback(ie=>{const he=b(ie);return he.length>0?he[0]:null},[b]),E=Pe.useCallback(ie=>{const he=b(ie);l(Se=>oe(X({},Se),{selectedRole:ie,assessmentType:he.length===0?"initial":null}))},[b]),D=Pe.useCallback(ie=>{l(he=>oe(X({},he),{assessmentType:ie,showAssessmentModal:!0}))},[]),_=Pe.useCallback(ie=>{l({selectedRole:null,assessmentType:null,showAssessmentModal:!1}),e()},[e]),R=ie=>{const he=b(ie.role),Se=v(ie.role),Be=d===ie.role||d===rt.Coordinator,xe=ie.icon,_e=Se?Math.floor((Date.now()-new Date(Se.date).getTime())/(1e3*60*60*24)):null;return i.jsx("button",{onClick:()=>Be&&E(ie.role),disabled:!Be,className:`w-full text-left p-4 rounded-lg border-2 transition-all transform hover:scale-[1.02] active:scale-[0.98] ${a.selectedRole===ie.role?`border-${ie.color}-500 bg-${ie.color}-50 shadow-lg`:Be?`border-gray-200 hover:border-${ie.color}-300 bg-white hover:shadow-md`:"border-gray-100 bg-gray-50 opacity-50 cursor-not-allowed"}`,children:i.jsxs("div",{className:"flex items-start gap-4",children:[i.jsx("div",{className:`w-12 h-12 rounded-lg flex items-center justify-center transition-all ${a.selectedRole===ie.role?`bg-${ie.color}-500 text-white`:`bg-${ie.color}-100 text-${ie.color}-600`}`,children:i.jsx(xe,{size:20})}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"font-bold text-gray-900",children:ie.title}),i.jsx("p",{className:"text-sm text-gray-600",children:ie.titleAr})]}),i.jsx("div",{className:"flex items-center gap-2",children:he.length>0?i.jsxs("span",{className:`px-2 py-1 bg-${ie.color}-100 text-${ie.color}-700 text-xs rounded-full flex items-center gap-1`,children:[i.jsx(kv,{size:12}),he.length," assessment",he.length>1?"s":""]}):i.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-full flex items-center gap-1",children:[i.jsx(Kr,{size:12}),"No assessments"]})})]}),i.jsx("p",{className:"text-sm text-gray-500 mb-3",children:ie.description}),Se&&i.jsxs("div",{className:"bg-white rounded-lg p-3 border border-gray-200",children:[i.jsxs("div",{className:"flex items-center justify-between text-sm",children:[i.jsx("span",{className:"text-gray-600",children:"Last assessment:"}),i.jsx("span",{className:"font-medium",children:new Date(Se.date).toLocaleDateString("ar-SA")})]}),_e!==null&&i.jsxs("div",{className:"flex items-center justify-between text-sm mt-1",children:[i.jsx("span",{className:"text-gray-600",children:"Days ago:"}),i.jsxs("span",{className:`font-medium ${_e>30?"text-red-600":_e>14?"text-yellow-600":"text-green-600"}`,children:[_e," days"]})]}),i.jsxs("div",{className:"flex items-center justify-between text-sm mt-1",children:[i.jsx("span",{className:"text-gray-600",children:"Status:"}),i.jsx("span",{className:"font-medium",children:Se.status})]})]}),!Be&&i.jsxs("div",{className:"mt-2 text-xs text-red-600 flex items-center gap-1",children:[i.jsx(Hc,{size:12}),"Only ",ie.role," can perform this assessment"]})]})]})},ie.role)},U=()=>{if(!a.selectedRole||a.assessmentType!==null)return null;const ie=b(a.selectedRole),he=h.find(Se=>Se.role===a.selectedRole);return i.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg border border-gray-200",children:[i.jsxs("h3",{className:"font-bold text-gray-900 mb-3 flex items-center gap-2",children:[i.jsx(rr,{size:16}),"Select Assessment Type |   "]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsx("button",{onClick:()=>D("initial"),className:`p-4 rounded-lg border-2 transition-all text-left ${ie.length===0?`border-${he.color}-500 bg-${he.color}-50`:"border-gray-200 hover:border-gray-300 bg-white"}`,children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center ${ie.length===0?`bg-${he.color}-500 text-white`:"bg-gray-100 text-gray-600"}`,children:i.jsx(Ir,{size:16})}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-semibold text-gray-900",children:"Initial Assessment"}),i.jsx("p",{className:"text-sm text-gray-600 mb-2",children:" "}),i.jsx("p",{className:"text-xs text-gray-500",children:ie.length===0?"Recommended: No previous assessments found":"Create new initial baseline assessment"})]})]})}),i.jsx("button",{onClick:()=>D("followup"),disabled:ie.length===0,className:`p-4 rounded-lg border-2 transition-all text-left ${ie.length>0?`border-${he.color}-500 bg-${he.color}-50 hover:bg-${he.color}-100`:"border-gray-200 bg-gray-50 opacity-50 cursor-not-allowed"}`,children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center ${ie.length>0?`bg-${he.color}-500 text-white`:"bg-gray-100 text-gray-400"}`,children:i.jsx(_l,{size:16})}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-semibold text-gray-900",children:"Follow-up Assessment"}),i.jsx("p",{className:"text-sm text-gray-600 mb-2",children:" "}),i.jsx("p",{className:"text-xs text-gray-500",children:ie.length>0?`Based on ${ie.length} previous assessment${ie.length>1?"s":""}`:"Requires initial assessment first"})]})]})})]})]})};return i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-4xl w-full max-h-[90vh] flex flex-col mx-auto my-auto",children:[i.jsx(y1,{title:"Smart Assessment Selector",titleAr:"  ",patient:n,subtitle:"Choose the appropriate assessment type for optimal care documentation",showIcons:!0}),i.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[i.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg p-4 mb-6 border border-blue-200",children:[i.jsx("h3",{className:"font-bold text-blue-800 mb-3",children:"Patient Assessment Overview"}),i.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:h.map(ie=>{const he=b(ie.role).length,Se=v(ie.role);return i.jsxs("div",{className:"bg-white rounded-lg p-3 border border-blue-100",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[i.jsx(ie.icon,{size:14,className:`text-${ie.color}-600`}),i.jsx("span",{className:"font-medium text-gray-900",children:ie.role})]}),i.jsxs("div",{className:"text-xs text-gray-600",children:[i.jsxs("div",{children:[he," assessment",he!==1?"s":""]}),Se&&i.jsxs("div",{className:"text-blue-600",children:["Last: ",new Date(Se.date).toLocaleDateString()]})]})]},ie.role)})})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("h3",{className:"font-bold text-gray-900 text-lg mb-4",children:"Select Healthcare Role |   "}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:h.map(R)})]}),U()]}),i.jsx("div",{className:"border-t border-gray-200 p-6 bg-gray-50",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"text-sm text-gray-600",children:["Current Role: ",i.jsx("span",{className:"font-medium",children:d})]}),i.jsx("button",{onClick:e,className:"px-6 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50 transition-all",children:"Cancel | "})]})})]})}),a.showAssessmentModal&&a.selectedRole&&a.assessmentType&&i.jsx(i.Fragment,{children:a.selectedRole===rt.SocialWorker?i.jsx(UR,{patient:n,onClose:()=>{l(ie=>oe(X({},ie),{showAssessmentModal:!1,selectedRole:null,assessmentType:null})),e()}}):i.jsx(PR,{patient:n,role:a.selectedRole,assessmentType:a.assessmentType,onClose:()=>{l(ie=>oe(X({},ie),{showAssessmentModal:!1,selectedRole:null,assessmentType:null}))},onSave:_})})]})},zR=({patient:n,onClose:e})=>{const{state:s}=os(),a=()=>{window.print()},d=(()=>{const h={Doctor:"",Nurse:"","Physical Therapist":"  ","Social Worker":" "};return s.staff.find(f=>f.===h[s.currentRole])||s.staff[0]})();return i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-auto",children:[i.jsxs("div",{className:"no-print p-4 border-b border-gray-200 flex justify-between items-center",children:[i.jsx("h2",{className:"text-lg font-bold text-gray-800",children:"  "}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:a,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:""}),i.jsx("button",{onClick:e,className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:""})]})]}),i.jsxs("div",{className:"print-page p-8",children:[i.jsxs("div",{className:"text-center mb-8 print-header",children:[i.jsx("img",{src:"/logo.png",alt:"Aseer Health Cluster Logo",className:"h-16 mx-auto mb-4",onError:h=>{h.currentTarget.style.display="none"}}),i.jsx("h1",{className:"text-2xl font-bold text-blue-800 mb-2",children:"       "}),i.jsx("h2",{className:"text-lg text-gray-600 mb-1",children:"Aseer Health Cluster  King Abdullah Hospital, Bishah"}),i.jsx("h3",{className:"text-base text-blue-600 font-semibold",children:"   - Home Healthcare Department"})]}),i.jsxs("div",{className:"border-2 border-blue-600 rounded-xl p-6 mb-6",children:[i.jsxs("div",{className:"flex items-start justify-between mb-6",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:" "}),i.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-bold text-blue-800",children:":"}),i.jsx("span",{className:"mr-2 text-lg font-semibold",children:n.nameAr})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-bold text-blue-800",children:" :"}),i.jsx("span",{className:"mr-2 font-mono",children:n.nationalId})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-bold text-blue-800",children:":"}),i.jsx("span",{className:"mr-2",children:n.sex==="Male"?"":""})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-bold text-blue-800",children:":"}),i.jsx("span",{className:"mr-2",children:n.age||" "})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-bold text-blue-800",children:" :"}),i.jsx("span",{className:"mr-2 font-mono",dir:"ltr",children:n.phone||" "})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-bold text-blue-800",children:":"}),i.jsx("span",{className:"mr-2",children:n.areaId||" "})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("span",{className:"font-bold text-blue-800",children:":"}),i.jsx("span",{className:"mr-2",children:n.address||" "})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("span",{className:"font-bold text-blue-800",children:" :"}),i.jsx("span",{className:"mr-2",children:n.medicalDiagnosis||" "})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-bold text-blue-800",children:" :"}),i.jsx("span",{className:"mr-2",children:n.admissionDate||" "})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-bold text-blue-800",children:" :"}),i.jsx("span",{className:"mr-2 font-bold text-lg",children:n.bradenScore||" "})]})]})]}),i.jsxs("div",{className:"flex flex-col items-center ml-6",children:[i.jsx("div",{className:"w-32 h-32 border-2 border-gray-300 rounded-lg flex items-center justify-center bg-gray-50",children:i.jsx(xg,{size:80,className:"text-gray-400"})}),i.jsx("p",{className:"text-xs text-gray-500 mt-2 text-center",children:"  "})]})]}),n.tags&&n.tags.length>0&&i.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[i.jsx("span",{className:"font-bold text-blue-800 block mb-2",children:" :"}),i.jsx("div",{className:"flex flex-wrap gap-2",children:n.tags.map((h,f)=>i.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 text-sm font-medium rounded-full border border-blue-200",children:h},f))})]})]}),i.jsxs("div",{className:"print-footer text-center text-xs text-gray-500 mt-8 pt-4 border-t border-gray-200",children:[i.jsxs("p",{children:["    : ",d.," - ",d.]}),i.jsxs("p",{children:[" : ",new Date().toLocaleDateString("ar-SA")]}),i.jsx("p",{children:"     -  1.0"})]})]})]})})},FR=({patient:n,onClose:e})=>{const[s,a]=Pe.useState([]),[l,d]=Pe.useState("all");Pe.useEffect(()=>{(()=>{const E=localStorage.getItem(`patient_history_${n.nationalId}`);if(E)a(JSON.parse(E));else{const D=[{id:"1",patientId:n.nationalId,date:"2024-01-15",role:"Nurse",type:"Assessment",data:{vitals:{bp:"120/80",hr:"72"},notes:"  -  "},createdBy:"  "},{id:"2",patientId:n.nationalId,date:"2024-01-10",role:"Doctor",type:"Assessment",data:{diagnosis:" ",plan:" "},createdBy:".  "},{id:"3",patientId:n.nationalId,date:"2024-01-08",role:"System",type:"Card",data:{printed:!0},createdBy:""}];a(D),localStorage.setItem(`patient_history_${n.nationalId}`,JSON.stringify(D))}})()},[n.nationalId]);const h=l==="all"?s:s.filter(v=>v.type===l),f=v=>{switch(v){case"Assessment":return i.jsx(yn,{size:16,className:"text-blue-600"});case"Card":return i.jsx(ml,{size:16,className:"text-green-600"});case"Report":return i.jsx(Ox,{size:16,className:"text-purple-600"});default:return i.jsx(yn,{size:16,className:"text-gray-600"})}},b=v=>{switch(v){case"Assessment":return"bg-blue-50 border-blue-200 text-blue-800";case"Card":return"bg-green-50 border-green-200 text-green-800";case"Report":return"bg-purple-50 border-purple-200 text-purple-800";default:return"bg-gray-50 border-gray-200 text-gray-800"}};return i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[i.jsx("div",{className:"p-4 border-b border-gray-200 bg-gradient-to-r from-blue-50 to-indigo-50",children:i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("div",{children:[i.jsx("h2",{className:"text-lg font-bold text-gray-800",children:" "}),i.jsxs("p",{className:"text-sm text-gray-600",children:[n.nameAr," - ",n.nationalId]})]}),i.jsx("button",{onClick:e,className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:""})]})}),i.jsx("div",{className:"p-4 border-b border-gray-200",children:i.jsx("div",{className:"flex gap-2 flex-wrap",children:["all","Assessment","Card","Report"].map(v=>i.jsxs("button",{onClick:()=>d(v),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${l===v?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[v==="all"?"":v==="Assessment"?"":v==="Card"?"":"",i.jsx("span",{className:"mr-2 bg-white bg-opacity-20 px-2 py-0.5 rounded-full text-xs",children:v==="all"?s.length:s.filter(E=>E.type===v).length})]},v))})}),i.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:h.length===0?i.jsxs("div",{className:"text-center py-8 text-gray-500",children:[i.jsx(yn,{size:48,className:"mx-auto mb-4 text-gray-300"}),i.jsx("p",{children:"   "})]}):i.jsx("div",{className:"space-y-3",children:h.map(v=>i.jsx("div",{className:`border rounded-lg p-4 ${b(v.type)}`,children:i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[f(v.type),i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[i.jsx("h3",{className:"font-bold text-sm",children:v.type==="Assessment"?" ":v.type==="Card"?" ":""}),i.jsx("span",{className:"text-xs px-2 py-0.5 bg-white bg-opacity-50 rounded-full",children:v.role})]}),i.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-600 mb-2",children:[i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(rr,{size:12}),new Date(v.date).toLocaleDateString("ar-SA")]}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(ml,{size:12}),v.createdBy]})]}),i.jsxs("div",{className:"text-xs bg-white bg-opacity-30 rounded p-2",children:[v.type==="Assessment"&&v.data.notes&&i.jsx("p",{className:"truncate",children:v.data.notes}),v.type==="Assessment"&&v.data.vitals&&i.jsxs("p",{children:[" : ",Object.entries(v.data.vitals).map(([E,D])=>`${E}: ${D}`).join(", ")]}),v.type==="Card"&&i.jsx("p",{children:"    "})]})]})]}),i.jsxs("div",{className:"flex gap-1",children:[i.jsx("button",{title:" ",className:"p-2 rounded hover:bg-white hover:bg-opacity-30 transition-colors",children:i.jsx(Dv,{size:14})}),i.jsx("button",{title:"",className:"p-2 rounded hover:bg-white hover:bg-opacity-30 transition-colors",children:i.jsx(Ox,{size:14})})]})]})},v.id))})}),i.jsx("div",{className:"p-4 border-t border-gray-200 bg-gray-50 text-center text-xs text-gray-500",children:i.jsx("p",{children:"       "})})]})})},tu=({patient:n,title:e,subtitle:s})=>i.jsxs("div",{className:"print-header bg-gradient-to-r from-blue-600 to-blue-700 text-white p-6 rounded-t-lg mb-6 no-print-color-adjust",children:[i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs("div",{className:"flex flex-col items-center gap-2",children:[i.jsx("div",{className:"w-20 h-20 bg-white rounded-lg flex items-center justify-center shadow-lg p-2",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-green-600 font-bold text-lg",children:""}),i.jsx("div",{className:"text-xs text-green-600 font-bold mt-1",children:"MOH"})]})}),i.jsx("div",{className:"w-16 h-16 bg-white rounded-lg flex items-center justify-center shadow-lg",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-blue-600 font-bold text-sm",children:"KAH"}),i.jsx("div",{className:"text-xs text-blue-600",children:"Bisha"})]})})]}),i.jsxs("div",{children:[i.jsx("div",{className:"flex items-center gap-3 mb-2",children:i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold mb-1",children:"King Abdullah Hospital - Bisha"}),i.jsx("p",{className:"text-blue-100 text-lg",children:"   - "})]})}),i.jsxs("div",{className:"text-blue-200 text-sm",children:[i.jsx("p",{className:"font-medium",children:"Home Healthcare Division"}),i.jsx("p",{children:"   "}),i.jsx("p",{className:"mt-1",children:"Aseer Health Cluster |   "})]})]})]}),i.jsxs("div",{className:"text-right bg-white/10 rounded-lg p-4",children:[i.jsx("p",{className:"text-sm text-blue-100 mb-1",children:"Print Date |  "}),i.jsx("p",{className:"font-bold text-lg",children:new Date().toLocaleDateString()}),i.jsx("p",{className:"text-xs text-blue-200",children:new Date().toLocaleDateString("ar-SA")}),i.jsx("div",{className:"mt-2 text-xs text-blue-200",children:i.jsxs("p",{children:["Document ID: DOC-",Date.now().toString().slice(-6)]})})]})]}),i.jsxs("div",{className:"mt-4 pt-4 border-t border-blue-500",children:[i.jsx("h2",{className:"text-xl font-bold",children:e}),s&&i.jsx("p",{className:"text-blue-100",children:s})]})]}),su=({patient:n})=>i.jsxs("div",{className:"patient-info bg-gradient-to-br from-gray-50 to-white p-6 rounded-lg mb-6 border border-gray-200 shadow-sm print-no-break",children:[i.jsxs("h3",{className:"font-bold text-lg text-gray-800 mb-4 border-b border-gray-300 pb-2 flex items-center gap-2",children:[i.jsx("span",{className:"w-2 h-2 bg-blue-600 rounded-full"}),"Patient Information |  "]}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[i.jsxs("div",{className:"bg-white p-3 rounded border-l-4 border-blue-500",children:[i.jsx("span",{className:"font-semibold text-gray-600 block mb-1",children:"Name | "}),i.jsx("p",{className:"font-bold text-blue-900",children:n.nameAr})]}),i.jsxs("div",{className:"bg-white p-3 rounded border-l-4 border-green-500",children:[i.jsx("span",{className:"font-semibold text-gray-600 block mb-1",children:"National ID |  "}),i.jsx("p",{className:"font-bold text-green-900",children:n.nationalId})]}),i.jsxs("div",{className:"bg-white p-3 rounded border-l-4 border-purple-500",children:[i.jsx("span",{className:"font-semibold text-gray-600 block mb-1",children:"Phone | "}),i.jsx("p",{className:"font-bold text-purple-900",children:n.phone||"N/A"})]}),i.jsxs("div",{className:"bg-white p-3 rounded border-l-4 border-orange-500",children:[i.jsx("span",{className:"font-semibold text-gray-600 block mb-1",children:"Area | "}),i.jsx("p",{className:"font-bold text-orange-900",children:n.areaId||"N/A"})]}),i.jsxs("div",{className:"bg-white p-3 rounded border-l-4 border-pink-500",children:[i.jsx("span",{className:"font-semibold text-gray-600 block mb-1",children:"Sex | "}),i.jsx("p",{className:"font-bold text-pink-900",children:n.sex||"N/A"})]}),i.jsxs("div",{className:"bg-white p-3 rounded border-l-4 border-indigo-500",children:[i.jsx("span",{className:"font-semibold text-gray-600 block mb-1",children:"Level | "}),i.jsx("p",{className:"font-bold text-indigo-900",children:n.level||"N/A"})]}),i.jsxs("div",{className:"bg-white p-3 rounded border-l-4 border-red-500",children:[i.jsx("span",{className:"font-semibold text-gray-600 block mb-1",children:"Admission | "}),i.jsx("p",{className:"font-bold text-red-900",children:n.admissionDate?new Date(n.admissionDate).toLocaleDateString():"N/A"})]}),i.jsxs("div",{className:"bg-white p-3 rounded border-l-4 border-yellow-500",children:[i.jsx("span",{className:"font-semibold text-gray-600 block mb-1",children:"Braden Score |  "}),i.jsx("p",{className:"font-bold text-yellow-900",children:n.bradenScore||"N/A"})]})]}),i.jsxs("div",{className:"mt-4",children:[i.jsx("h4",{className:"font-semibold text-gray-700 mb-2",children:"Medical Indicators |  "}),i.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.hasCatheter&&i.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 text-xs font-medium rounded-full border border-blue-200",children:" Catheter | "}),n.wounds&&n.wounds.presentCount&&n.wounds.presentCount>0&&i.jsxs("span",{className:"px-3 py-1 bg-red-100 text-red-800 text-xs font-medium rounded-full border border-red-200",children:[" Wounds (",n.wounds.presentCount,") | "]}),n.ngTube&&i.jsx("span",{className:"px-3 py-1 bg-green-100 text-green-800 text-xs font-medium rounded-full border border-green-200",children:" NG Tube |  "}),n.gTube&&i.jsx("span",{className:"px-3 py-1 bg-purple-100 text-purple-800 text-xs font-medium rounded-full border border-purple-200",children:" G-Tube |  "}),n.fallHighRisk&&i.jsx("span",{className:"px-3 py-1 bg-orange-100 text-orange-800 text-xs font-medium rounded-full border border-orange-200",children:" Fall Risk |  "}),n.ivTherapy&&i.jsx("span",{className:"px-3 py-1 bg-indigo-100 text-indigo-800 text-xs font-medium rounded-full border border-indigo-200",children:" IV Therapy |  "}),n.ventSupport&&i.jsx("span",{className:"px-3 py-1 bg-yellow-100 text-yellow-800 text-xs font-medium rounded-full border border-yellow-200",children:" Vent Support |  "})]})]}),n.tags.length>0&&i.jsxs("div",{className:"mt-4",children:[i.jsx("span",{className:"font-semibold text-gray-600 block mb-2",children:"Tags | "}),i.jsx("div",{className:"flex flex-wrap gap-2",children:n.tags.map(e=>i.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 text-xs font-medium rounded-full border border-blue-200",children:e},e))})]})]}),E1=({vitals:n,title:e="Vital Signs |  "})=>n?i.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-white p-4 rounded-lg border border-blue-200 mb-4",children:[i.jsxs("h4",{className:"font-bold text-blue-800 mb-3 flex items-center gap-2",children:[i.jsx("span",{className:"w-2 h-2 bg-blue-600 rounded-full"}),e]}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-3",children:[n.bp&&i.jsxs("div",{className:"bg-white p-3 rounded-lg border border-red-200 text-center",children:[i.jsx("div",{className:"text-xs font-bold text-red-600 mb-1",children:"BP |  "}),i.jsx("div",{className:"font-mono text-lg font-bold text-red-800",children:n.bp})]}),n.hr&&i.jsxs("div",{className:"bg-white p-3 rounded-lg border border-blue-200 text-center",children:[i.jsx("div",{className:"text-xs font-bold text-blue-600 mb-1",children:"HR | "}),i.jsx("div",{className:"font-mono text-lg font-bold text-blue-800",children:n.hr})]}),n.rr&&i.jsxs("div",{className:"bg-white p-3 rounded-lg border border-green-200 text-center",children:[i.jsx("div",{className:"text-xs font-bold text-green-600 mb-1",children:"RR | "}),i.jsx("div",{className:"font-mono text-lg font-bold text-green-800",children:n.rr})]}),n.temp&&i.jsxs("div",{className:"bg-white p-3 rounded-lg border border-orange-200 text-center",children:[i.jsx("div",{className:"text-xs font-bold text-orange-600 mb-1",children:"Temp | "}),i.jsxs("div",{className:"font-mono text-lg font-bold text-orange-800",children:[n.temp,"C"]})]}),n.o2sat&&i.jsxs("div",{className:"bg-white p-3 rounded-lg border border-purple-200 text-center",children:[i.jsx("div",{className:"text-xs font-bold text-purple-600 mb-1",children:"SpO | "}),i.jsxs("div",{className:"font-mono text-lg font-bold text-purple-800",children:[n.o2sat,"%"]})]}),n.pain&&i.jsxs("div",{className:"bg-white p-3 rounded-lg border border-pink-200 text-center",children:[i.jsx("div",{className:"text-xs font-bold text-pink-600 mb-1",children:"Pain | "}),i.jsxs("div",{className:"font-mono text-lg font-bold text-pink-800",children:[n.pain,"/10"]})]})]})]}):null,pn=({title:n,children:e,color:s="blue"})=>i.jsxs("div",{className:`bg-gradient-to-br from-${s}-50 to-white p-4 rounded-lg border border-${s}-200 mb-4 print-no-break`,children:[i.jsxs("h4",{className:`font-bold text-${s}-800 mb-3 flex items-center gap-2`,children:[i.jsx("span",{className:`w-2 h-2 bg-${s}-600 rounded-full`}),n]}),i.jsx("div",{className:"space-y-2 text-sm",children:e})]}),Je=({label:n,value:e,icon:s,highlight:a})=>{if(!e||Array.isArray(e)&&e.length===0)return null;const l=Array.isArray(e)?e.join(", "):e;return i.jsxs("div",{className:`flex items-start gap-2 p-2 rounded ${a?"bg-yellow-50 border border-yellow-200":""}`,children:[s&&i.jsx("span",{className:"text-sm",children:s}),i.jsxs("div",{className:"flex-1",children:[i.jsxs("span",{className:"font-semibold text-gray-700",children:[n,":"]}),i.jsx("span",{className:`ml-2 ${a?"font-bold text-yellow-800":"text-gray-900"}`,children:l})]})]})},qR=({assessment:n,patient:e})=>i.jsxs("div",{className:"print-page",children:[i.jsx(tu,{patient:e,title:"Medical Assessment Report",subtitle:"  "}),i.jsx(su,{patient:e}),i.jsxs("div",{className:"assessment-details space-y-4",children:[i.jsxs("div",{className:"flex justify-between items-center p-4 bg-blue-50 rounded-lg border border-blue-200",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"font-bold text-lg text-blue-800",children:"Medical Assessment Details"}),i.jsx("p",{className:"text-blue-600",children:"  "})]}),i.jsxs("div",{className:"text-right text-sm text-blue-700",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Date:"})," ",new Date(n.date).toLocaleDateString()]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Assessor:"})," ",n.assessorName]}),i.jsxs("p",{children:[i.jsx("strong",{children:"ID:"})," ",n.assessorId]})]})]}),i.jsxs(pn,{title:"Clinical Focus |  ",color:"blue",children:[i.jsx(Je,{label:"Chief Focus",value:n.chiefFocus,icon:""}),n.redFlags&&n.redFlags.length>0&&i.jsx(Je,{label:"Red Flags",value:n.redFlags,icon:"",highlight:!0}),i.jsx(Je,{label:"Red Flag Action",value:n.redFlagAction,icon:""})]}),i.jsxs(pn,{title:"Clinical Assessment |  ",color:"green",children:[i.jsx(Je,{label:"Status",value:n.status,icon:""}),i.jsx(Je,{label:"Plan",value:n.plan,icon:""}),i.jsx(Je,{label:"Etiology",value:n.assessment.etiology,icon:""}),i.jsx(Je,{label:"Severity",value:n.assessment.severity,icon:""}),n.worsenedCause&&i.jsx(Je,{label:"Worsened Cause",value:n.worsenedCause,icon:""})]}),n.orders&&i.jsxs(pn,{title:"Orders & Interventions |  ",color:"purple",children:[n.orders.labs&&i.jsx(Je,{label:"Laboratory Tests",value:n.orders.labs,icon:""}),n.orders.imaging&&i.jsx(Je,{label:"Imaging Studies",value:n.orders.imaging,icon:""}),n.orders.antibiotic&&i.jsx(Je,{label:"Antibiotics",value:n.orders.antibiotic,icon:""}),n.orders.customAntibiotic&&i.jsx(Je,{label:"Custom Antibiotic",value:n.orders.customAntibiotic,icon:""})]}),i.jsxs(pn,{title:"Medications & Plan |  ",color:"orange",children:[i.jsx(Je,{label:"Medication Changes",value:n.medChanges,icon:""}),i.jsx(Je,{label:"High-Risk Medications",value:n.highRiskMeds,icon:""}),i.jsx(Je,{label:"Plan Details",value:n.planDetails,icon:""}),i.jsx(Je,{label:"Follow-up Timing",value:n.followUpTiming,icon:""}),i.jsx(Je,{label:"Entitlement",value:n.entitlement,icon:""})]}),n.mdNote&&i.jsx(pn,{title:"Physician Notes |  ",color:"indigo",children:i.jsx("div",{className:"bg-white p-4 rounded border border-gray-200",children:i.jsx("pre",{className:"whitespace-pre-wrap text-sm leading-relaxed",children:n.mdNote})})})]}),i.jsx("div",{className:"print-footer mt-8 pt-4 border-t-2 border-gray-300",children:i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("div",{children:[i.jsx("p",{className:"font-semibold text-gray-800",children:"Digital Assessment Record"}),i.jsx("p",{className:"text-xs text-gray-600",children:"Aseer Health Cluster  King Abdullah Hospital, Bishah"}),i.jsx("p",{className:"text-xs text-gray-500",children:"       "})]}),i.jsxs("div",{className:"text-right text-xs text-gray-500",children:[i.jsxs("p",{children:["Generated: ",new Date().toLocaleString()]}),i.jsxs("p",{children:["Assessment ID: ",n.id]})]})]})})]}),HR=({assessment:n,patient:e})=>i.jsxs("div",{className:"print-page",children:[i.jsx(tu,{patient:e,title:"Nursing Assessment Report",subtitle:"  "}),i.jsx(su,{patient:e}),i.jsx(E1,{vitals:n.vitals}),i.jsxs("div",{className:"assessment-details space-y-4",children:[i.jsxs("div",{className:"flex justify-between items-center p-4 bg-green-50 rounded-lg border border-green-200",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"font-bold text-lg text-green-800",children:"Nursing Assessment Details"}),i.jsx("p",{className:"text-green-600",children:"  "})]}),i.jsxs("div",{className:"text-right text-sm text-green-700",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Date:"})," ",new Date(n.date).toLocaleDateString()]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Nurse:"})," ",n.assessorName]}),i.jsxs("p",{children:[i.jsx("strong",{children:"ID:"})," ",n.assessorId]})]})]}),i.jsxs(pn,{title:"Clinical Status |  ",color:"green",children:[i.jsx(Je,{label:"Overall Status",value:n.status,icon:""}),i.jsx(Je,{label:"Plan",value:n.plan,icon:""}),i.jsx(Je,{label:"Impression",value:n.impression,icon:""}),i.jsx(Je,{label:"Braden Score",value:n.bradenScore,icon:""})]}),n.devices&&n.devices.length>0&&i.jsxs(pn,{title:"Medical Devices |  ",color:"blue",children:[i.jsx(Je,{label:"Devices Present",value:n.devices,icon:""}),n.catheterDetails&&i.jsxs("div",{className:"bg-blue-50 p-3 rounded border border-blue-200",children:[i.jsx("h5",{className:"font-semibold text-blue-800 mb-2",children:"Catheter Care |  "}),i.jsx(Je,{label:"Care Done",value:n.catheterDetails.careDone}),i.jsx(Je,{label:"Issues",value:n.catheterDetails.issues})]}),n.pegNgDetails&&i.jsxs("div",{className:"bg-blue-50 p-3 rounded border border-blue-200",children:[i.jsx("h5",{className:"font-semibold text-blue-800 mb-2",children:"PEG/NG Tube |  /"}),i.jsx(Je,{label:"Site Condition",value:n.pegNgDetails.site}),i.jsx(Je,{label:"Feeding Given",value:n.pegNgDetails.feedingGiven})]}),n.ivPortDetails&&i.jsxs("div",{className:"bg-blue-50 p-3 rounded border border-blue-200",children:[i.jsx("h5",{className:"font-semibold text-blue-800 mb-2",children:"IV/Port Care |  "}),i.jsx(Je,{label:"Site Condition",value:n.ivPortDetails.site}),i.jsx(Je,{label:"Dressing Changed",value:n.ivPortDetails.dressingChanged}),i.jsx(Je,{label:"Flush Done",value:n.ivPortDetails.flush})]})]}),n.woundStatus&&n.woundStatus!=="None"&&i.jsxs(pn,{title:"Wound Assessment |  ",color:"red",children:[i.jsx(Je,{label:"Wound Status",value:n.woundStatus,icon:""}),n.woundDetails&&i.jsxs("div",{className:"bg-red-50 p-3 rounded border border-red-200",children:[i.jsx(Je,{label:"Sites",value:n.woundDetails.sites}),i.jsx(Je,{label:"Other Site",value:n.woundDetails.otherSite}),i.jsx(Je,{label:"Stage",value:n.woundDetails.stage}),i.jsx(Je,{label:"Exudate",value:n.woundDetails.exudate}),i.jsx(Je,{label:"Infection Signs",value:n.woundDetails.infectionSigns}),i.jsx(Je,{label:"Care Provided",value:n.woundDetails.careToday})]})]}),i.jsxs(pn,{title:"Nursing Tasks |  ",color:"purple",children:[i.jsx(Je,{label:"Tasks Performed",value:n.nursingTasks,icon:""}),n.vaccinationDetails&&i.jsx(Je,{label:"Vaccination Details",value:n.vaccinationDetails,icon:""}),n.glucoseValue&&i.jsx(Je,{label:"Glucose Value",value:n.glucoseValue,icon:""})]}),n.nurseNote&&i.jsx(pn,{title:"Nursing Notes |  ",color:"indigo",children:i.jsx("div",{className:"bg-white p-4 rounded border border-gray-200",children:i.jsx("pre",{className:"whitespace-pre-wrap text-sm leading-relaxed",children:n.nurseNote})})})]}),i.jsx("div",{className:"print-footer mt-8 pt-4 border-t-2 border-gray-300",children:i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("div",{children:[i.jsx("p",{className:"font-semibold text-gray-800",children:"Digital Nursing Record"}),i.jsx("p",{className:"text-xs text-gray-600",children:"Aseer Health Cluster  King Abdullah Hospital, Bishah"}),i.jsx("p",{className:"text-xs text-gray-500",children:"       "})]}),i.jsxs("div",{className:"text-right text-xs text-gray-500",children:[i.jsxs("p",{children:["Generated: ",new Date().toLocaleString()]}),i.jsxs("p",{children:["Assessment ID: ",n.id]})]})]})})]}),GR=({visit:n,patient:e})=>{var s,a,l;return i.jsxs("div",{className:"print-page",children:[i.jsx(tu,{patient:e,title:"Home Healthcare Visit Report",subtitle:"   "}),i.jsx(su,{patient:e}),i.jsxs("div",{className:"visit-details space-y-4",children:[i.jsxs("div",{className:"flex justify-between items-center p-4 bg-purple-50 rounded-lg border border-purple-200",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"font-bold text-lg text-purple-800",children:"Visit Information"}),i.jsx("p",{className:"text-purple-600",children:" "})]}),i.jsxs("div",{className:"text-right text-sm text-purple-700",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Date:"})," ",new Date(n.date).toLocaleDateString()]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Team:"})," ",n.teamId]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Status:"})," ",n.status]})]})]}),((s=n.nurseNote)==null?void 0:s.vitals)&&i.jsx(E1,{vitals:n.nurseNote.vitals}),i.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[n.nurseNote&&i.jsxs(pn,{title:"Nursing Assessment |  ",color:"green",children:[i.jsx(Je,{label:"Status",value:n.nurseNote.status,icon:""}),i.jsx(Je,{label:"Wound Delta",value:n.nurseNote.woundDelta,icon:""}),i.jsx(Je,{label:"Device Delta",value:n.nurseNote.deviceDelta,icon:""}),i.jsx(Je,{label:"Tasks Completed",value:n.nurseNote.tasks,icon:""}),i.jsx(Je,{label:"Escalation",value:n.nurseNote.escalation,icon:""}),n.nurseNote.nurseNote&&i.jsxs("div",{className:"mt-2 p-3 bg-white rounded border border-gray-200",children:[i.jsx("strong",{className:"text-green-700",children:"Notes:"}),i.jsx("p",{className:"text-sm mt-1",children:n.nurseNote.nurseNote})]})]}),n.doctorNote&&i.jsxs(pn,{title:"Medical Assessment |  ",color:"blue",children:[i.jsx(Je,{label:"Status",value:n.doctorNote.status,icon:""}),i.jsx(Je,{label:"Response to Plan",value:n.doctorNote.responseToPlan,icon:""}),i.jsx(Je,{label:"Adherence",value:n.doctorNote.adherence,icon:""}),i.jsx(Je,{label:"New Issues",value:n.doctorNote.newIssues,icon:""}),i.jsx(Je,{label:"Plan",value:n.doctorNote.plan,icon:""}),i.jsx(Je,{label:"Plan Details",value:n.doctorNote.planDetails,icon:""}),i.jsx(Je,{label:"Next Follow-up",value:n.doctorNote.nextFollowUp,icon:""}),n.doctorNote.mdNote&&i.jsxs("div",{className:"mt-2 p-3 bg-white rounded border border-gray-200",children:[i.jsx("strong",{className:"text-blue-700",children:"Notes:"}),i.jsx("p",{className:"text-sm mt-1",children:n.doctorNote.mdNote})]})]})]}),(n.ptNote||n.swNote)&&i.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[n.ptNote&&i.jsxs(pn,{title:"Physical Therapy |  ",color:"orange",children:[i.jsx(Je,{label:"Status",value:n.ptNote.status,icon:""}),i.jsx(Je,{label:"Pain Change",value:(a=n.ptNote.changeSinceLast)==null?void 0:a.pain,icon:""}),i.jsx(Je,{label:"Function Change",value:(l=n.ptNote.changeSinceLast)==null?void 0:l.function,icon:""}),i.jsx(Je,{label:"Tolerance",value:n.ptNote.tolerance,icon:""}),i.jsx(Je,{label:"Plan",value:n.ptNote.plan,icon:""}),n.ptNote.ptNote&&i.jsxs("div",{className:"mt-2 p-3 bg-white rounded border border-gray-200",children:[i.jsx("strong",{className:"text-orange-700",children:"Notes:"}),i.jsx("p",{className:"text-sm mt-1",children:n.ptNote.ptNote})]})]}),n.swNote&&i.jsxs(pn,{title:"Social Work |  ",color:"teal",children:[i.jsx(Je,{label:"Situation Change",value:n.swNote.situationChange,icon:""}),i.jsx(Je,{label:"Actions Taken",value:n.swNote.actionsTaken,icon:""}),i.jsx(Je,{label:"Plan",value:n.swNote.plan,icon:""}),n.swNote.swNote&&i.jsxs("div",{className:"mt-2 p-3 bg-white rounded border border-gray-200",children:[i.jsx("strong",{className:"text-teal-700",children:"Notes:"}),i.jsx("p",{className:"text-sm mt-1",children:n.swNote.swNote})]})]})]})]}),i.jsxs("div",{className:"mt-8 pt-6 border-t-2 border-gray-300",children:[i.jsx("h4",{className:"font-bold text-gray-800 mb-4",children:"Team Signatures |  "}),i.jsxs("div",{className:"grid grid-cols-2 gap-8",children:[n.nurseSign&&i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"border-b border-gray-400 pb-2 mb-2",children:i.jsx("p",{className:"font-semibold text-lg",children:n.nurseSign})}),i.jsx("p",{className:"text-sm text-gray-600",children:"Nurse | /"})]}),n.doctorSign&&i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"border-b border-gray-400 pb-2 mb-2",children:i.jsx("p",{className:"font-semibold text-lg",children:n.doctorSign})}),i.jsx("p",{className:"text-sm text-gray-600",children:"Doctor | "})]}),n.ptSign&&i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"border-b border-gray-400 pb-2 mb-2",children:i.jsx("p",{className:"font-semibold text-lg",children:n.ptSign})}),i.jsx("p",{className:"text-sm text-gray-600",children:"Physical Therapist |   "})]}),n.swSign&&i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"border-b border-gray-400 pb-2 mb-2",children:i.jsx("p",{className:"font-semibold text-lg",children:n.swSign})}),i.jsx("p",{className:"text-sm text-gray-600",children:"Social Worker |  "})]})]})]}),i.jsx("div",{className:"print-footer mt-8 pt-4 border-t-2 border-gray-300",children:i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("div",{children:[i.jsx("p",{className:"font-semibold text-gray-800",children:"Digital Visit Record"}),i.jsx("p",{className:"text-xs text-gray-600",children:"This document was generated electronically and is valid without signature."}),i.jsx("p",{className:"text-xs text-gray-500",children:"Aseer Health Cluster  King Abdullah Hospital, Bishah - Home Healthcare Department"}),i.jsx("p",{className:"text-xs text-gray-500",children:"        -   "})]}),i.jsxs("div",{className:"text-right text-xs text-gray-500",children:[i.jsxs("p",{children:["Generated: ",new Date().toLocaleString()]}),i.jsxs("p",{children:["Visit Date: ",n.date]})]})]})})]})},$R=({patient:n,visit:e,assessment:s,type:a,additionalData:l})=>{switch(a){case"visit":return e?i.jsx(GR,{patient:n,visit:e}):null;case"assessment":if(!s)return null;switch(s.role){case"Doctor":return i.jsx(qR,{assessment:s,patient:n});case"Nurse":return i.jsx(HR,{assessment:s,patient:n});default:return i.jsxs("div",{className:"print-page",children:[i.jsx(tu,{patient:n,title:`${s.role} Assessment`}),i.jsx(su,{patient:n}),i.jsxs("div",{className:"text-center text-gray-600 py-8",children:[i.jsxs("p",{children:["Assessment details for ",s.role," are being developed."]}),i.jsxs("p",{children:["   ",s.role,"  ."]})]})]})}default:return i.jsxs("div",{className:"print-page",children:[i.jsx(tu,{patient:n,title:"Healthcare Document"}),i.jsx(su,{patient:n}),i.jsxs("div",{className:"text-center text-gray-600 py-8",children:[i.jsxs("p",{children:['Document type "',a,'" is not yet implemented.']}),i.jsxs("p",{children:['  "',a,'"   .']})]})]})}},QR=({patient:n,patients:e,visit:s,assessment:a,staff:l,onClose:d})=>{const[h,f]=Pe.useState("visit"),[b,v]=Pe.useState(!1),[E,D]=Pe.useState(!1),_=Pe.useRef(null),R=[{type:"visit",label:"Visit Report",description:"Complete visit documentation with all team assessments",icon:yn,color:"blue",available:!!s&&!!n,requiresData:["visit","patient"]},{type:"assessment",label:"Assessment Report",description:"Detailed clinical assessment by specific role",icon:Ui,color:"green",available:!!a&&!!n,requiresData:["assessment","patient"]},{type:"visit-history",label:"  | Visit History",description:"Complete history of all patient visits",icon:yn,color:"teal",available:!!n,requiresData:["patient"]},{type:"assessment-history",label:"  | Assessment History",description:"Complete history of all assessments",icon:yg,color:"cyan",available:!!n,requiresData:["patient"]},{type:"patient-summary",label:"Patient Summary",description:"Comprehensive patient overview with history",icon:_l,color:"purple",available:!!n,requiresData:["patient"]},{type:"care-plan",label:"Care Plan",description:"Individualized care plan and goals",icon:ah,color:"orange",available:!!n,requiresData:["patient"]},{type:"driver-route",label:"Driver Route",description:"Optimized route for patient visits",icon:wS,color:"indigo",available:!!e&&e.length>0,requiresData:["patients"]}],U=()=>K(null,null,function*(){h&&(v(!0),yield new Promise(Se=>setTimeout(Se,500)),D(!0),v(!1))}),ie=()=>{var xe;const Se=window.open("","_blank");if(!Se)return;const Be=((xe=_.current)==null?void 0:xe.innerHTML)||"";Se.document.write(`
      <!DOCTYPE html>
      <html dir="rtl">
        <head>
          <title>Healthcare Report - King Abdullah Hospital</title>
          <meta charset="utf-8">
          <style>
            * {
              margin: 0;
              padding: 0;
              box-sizing: border-box;
            }
            
            body {
              font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
              line-height: 1.6;
              color: #333;
              background: white;
            }
            
            .print-page {
              max-width: none;
              margin: 0;
              padding: 20px;
              font-size: 14px;
              background: white;
            }
            
            .print-header {
              background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%) !important;
              -webkit-print-color-adjust: exact !important;
              color-adjust: exact !important;
              color: white !important;
            }
            
            .print-no-break {
              page-break-inside: avoid;
              break-inside: avoid;
            }
            
            .print-footer {
              page-break-inside: avoid;
              margin-top: 2rem;
            }
            
            /* Color preservation for print */
            .bg-blue-50, .bg-blue-100 { background-color: #eff6ff !important; }
            .bg-green-50, .bg-green-100 { background-color: #f0fdf4 !important; }
            .bg-red-50, .bg-red-100 { background-color: #fef2f2 !important; }
            .bg-purple-50, .bg-purple-100 { background-color: #faf5ff !important; }
            .bg-orange-50, .bg-orange-100 { background-color: #fff7ed !important; }
            .bg-indigo-50, .bg-indigo-100 { background-color: #eef2ff !important; }
            .bg-yellow-50, .bg-yellow-100 { background-color: #fefce8 !important; }
            .bg-pink-50, .bg-pink-100 { background-color: #fdf2f8 !important; }
            .bg-teal-50, .bg-teal-100 { background-color: #f0fdfa !important; }
            
            .text-blue-600 { color: #2563eb !important; }
            .text-blue-700 { color: #1d4ed8 !important; }
            .text-blue-800 { color: #1e40af !important; }
            .text-green-600 { color: #16a34a !important; }
            .text-green-700 { color: #15803d !important; }
            .text-green-800 { color: #166534 !important; }
            .text-red-600 { color: #dc2626 !important; }
            .text-red-700 { color: #b91c1c !important; }
            .text-red-800 { color: #991b1b !important; }
            
            .border-blue-200 { border-color: #bfdbfe !important; }
            .border-green-200 { border-color: #bbf7d0 !important; }
            .border-red-200 { border-color: #fecaca !important; }
            .border-purple-200 { border-color: #e9d5ff !important; }
            .border-orange-200 { border-color: #fed7aa !important; }
            .border-indigo-200 { border-color: #c7d2fe !important; }
            .border-yellow-200 { border-color: #fef08a !important; }
            .border-pink-200 { border-color: #fbcfe8 !important; }
            .border-teal-200 { border-color: #99f6e4 !important; }
            
            .border-l-4 { border-left-width: 4px !important; }
            .border-blue-500 { border-color: #3b82f6 !important; }
            .border-green-500 { border-color: #22c55e !important; }
            .border-red-500 { border-color: #ef4444 !important; }
            .border-purple-500 { border-color: #a855f7 !important; }
            .border-orange-500 { border-color: #f97316 !important; }
            .border-pink-500 { border-color: #ec4899 !important; }
            .border-indigo-500 { border-color: #6366f1 !important; }
            .border-yellow-500 { border-color: #eab308 !important; }
            
            .rounded, .rounded-lg, .rounded-xl { border-radius: 8px; }
            .rounded-full { border-radius: 50%; }
            
            .shadow-sm { box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05); }
            .shadow-lg { box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1); }
            
            .grid { display: grid; }
            .grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); }
            .grid-cols-4 { grid-template-columns: repeat(4, minmax(0, 1fr)); }
            .grid-cols-6 { grid-template-columns: repeat(6, minmax(0, 1fr)); }
            .gap-2 { gap: 0.5rem; }
            .gap-3 { gap: 0.75rem; }
            .gap-4 { gap: 1rem; }
            .gap-8 { gap: 2rem; }
            
            .flex { display: flex; }
            .items-center { align-items: center; }
            .items-start { align-items: flex-start; }
            .justify-between { justify-content: space-between; }
            .flex-1 { flex: 1 1 0%; }
            
            .p-2 { padding: 0.5rem; }
            .p-3 { padding: 0.75rem; }
            .p-4 { padding: 1rem; }
            .p-6 { padding: 1.5rem; }
            .px-3 { padding-left: 0.75rem; padding-right: 0.75rem; }
            .py-1 { padding-top: 0.25rem; padding-bottom: 0.25rem; }
            .pt-4 { padding-top: 1rem; }
            .pb-2 { padding-bottom: 0.5rem; }
            .ml-2 { margin-left: 0.5rem; }
            .mb-1 { margin-bottom: 0.25rem; }
            .mb-2 { margin-bottom: 0.5rem; }
            .mb-3 { margin-bottom: 0.75rem; }
            .mb-4 { margin-bottom: 1rem; }
            .mb-6 { margin-bottom: 1.5rem; }
            .mt-1 { margin-top: 0.25rem; }
            .mt-2 { margin-top: 0.5rem; }
            .mt-4 { margin-top: 1rem; }
            .mt-8 { margin-top: 2rem; }
            
            .text-xs { font-size: 0.75rem; }
            .text-sm { font-size: 0.875rem; }
            .text-base { font-size: 1rem; }
            .text-lg { font-size: 1.125rem; }
            .text-xl { font-size: 1.25rem; }
            .text-2xl { font-size: 1.5rem; }
            
            .font-bold { font-weight: 700; }
            .font-semibold { font-weight: 600; }
            .font-medium { font-weight: 500; }
            .font-mono { font-family: monospace; }
            
            .text-center { text-align: center; }
            .text-right { text-align: right; }
            
            .border { border-width: 1px; }
            .border-t { border-top-width: 1px; }
            .border-t-2 { border-top-width: 2px; }
            .border-b { border-bottom-width: 1px; }
            
            .space-y-2 > * + * { margin-top: 0.5rem; }
            .space-y-4 > * + * { margin-top: 1rem; }
            .gap-2 { gap: 0.5rem; }
            
            .w-2 { width: 0.5rem; }
            .h-2 { height: 0.5rem; }
            .w-16 { width: 4rem; }
            .h-16 { height: 4rem; }
            
            .whitespace-pre-wrap { white-space: pre-wrap; }
            .leading-relaxed { line-height: 1.625; }
            
            @page {
              margin: 0.75in;
              size: A4;
            }
            
            @media print {
              .print-page {
                margin: 0;
                padding: 0;
              }
              
              .print-no-break {
                page-break-inside: avoid !important;
                break-inside: avoid !important;
              }
              
              .print-header {
                -webkit-print-color-adjust: exact !important;
                color-adjust: exact !important;
              }
            }
          </style>
        </head>
        <body>
          ${Be}
        </body>
      </html>
    `),Se.document.close(),Se.focus(),setTimeout(()=>{Se.print(),Se.close()},500)},he=R.find(Se=>Se.type===h);return i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-6xl w-full max-h-[90vh] flex flex-col",children:[i.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:i.jsx(Pi,{className:"text-blue-600",size:20})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Print Manager"}),i.jsx("p",{className:"text-sm text-gray-600",children:"Generate professional healthcare reports"})]})]}),i.jsx("button",{onClick:d,className:"text-gray-400 hover:text-gray-600 text-2xl font-bold w-8 h-8 flex items-center justify-center",children:""})]}),i.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[i.jsxs("div",{className:"w-1/3 border-r border-gray-200 p-6 overflow-y-auto",children:[i.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Select Report Type"}),i.jsx("div",{className:"space-y-3",children:R.map(Se=>{var xe;const Be=Se.icon;return i.jsx("button",{onClick:()=>f(Se.type),disabled:!Se.available,className:`w-full text-left p-4 rounded-lg border-2 transition-all ${h===Se.type?`border-${Se.color}-500 bg-${Se.color}-50`:Se.available?"border-gray-200 hover:border-gray-300 bg-white":"border-gray-100 bg-gray-50 opacity-50 cursor-not-allowed"}`,children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center ${h===Se.type?`bg-${Se.color}-500 text-white`:`bg-${Se.color}-100 text-${Se.color}-600`}`,children:i.jsx(Be,{size:16})}),i.jsxs("div",{className:"flex-1",children:[i.jsx("h4",{className:"font-medium text-gray-900 mb-1",children:Se.label}),i.jsx("p",{className:"text-sm text-gray-600",children:Se.description}),!Se.available&&i.jsxs("p",{className:"text-xs text-red-500 mt-1",children:["Missing required data: ",(xe=Se.requiresData)==null?void 0:xe.join(", ")]})]})]})},Se.type)})}),i.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[i.jsx("button",{onClick:U,disabled:!(he!=null&&he.available)||b,className:"w-full bg-blue-600 text-white px-4 py-3 rounded-lg font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 transition-all",children:b?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Generating..."]}):i.jsxs(i.Fragment,{children:[i.jsx(yn,{size:16}),"Generate Preview"]})}),E&&i.jsxs("button",{onClick:ie,className:"w-full mt-3 bg-green-600 text-white px-4 py-3 rounded-lg font-medium hover:bg-green-700 flex items-center justify-center gap-2 transition-all",children:[i.jsx(Pi,{size:16}),"Print Document"]})]})]}),i.jsx("div",{className:"flex-1 overflow-y-auto bg-gray-50",children:E&&(he!=null&&he.available)?i.jsx("div",{ref:_,className:"h-full",children:i.jsx($R,{patient:n,patients:e,visit:s,assessment:a,staff:l,type:h})}):i.jsx("div",{className:"flex items-center justify-center h-full",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"w-16 h-16 bg-gray-200 rounded-full flex items-center justify-center mx-auto mb-4",children:i.jsx(yn,{className:"text-gray-400",size:24})}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Preview Area"}),i.jsx("p",{className:"text-gray-600 max-w-sm",children:he!=null&&he.available?'Click "Generate Preview" to see your document':"Select an available report type to continue"})]})})})]})]})})},KR=[{type:"assessments",title:"Medical Assessments",titleAr:" ",description:"Complete assessment history and current status",icon:yg,color:"blue"},{type:"visit-notes",title:"Visit Notes History",titleAr:"  ",description:"All previous visit notes and observations",icon:yn,color:"green"},{type:"contact-log",title:"Contact Attempts Log",titleAr:"  ",description:"Communication history and contact attempts",icon:Yr,color:"orange"}],fp=({title:n,titleAr:e,patient:s})=>i.jsxs("div",{className:"print-header bg-gradient-to-r from-blue-600 to-blue-700 text-white p-4 md:p-6 rounded-t-lg mb-4 md:mb-6 no-print-color-adjust print:bg-blue-700",style:{pageBreakInside:"avoid",marginTop:"10mm",marginLeft:"10mm",marginRight:"10mm"},children:[i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs("div",{className:"flex flex-col items-center gap-2",children:[i.jsx("div",{className:"w-20 h-20 bg-white rounded-lg flex items-center justify-center shadow-lg p-2",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-green-600 font-bold text-lg",children:""}),i.jsx("div",{className:"text-xs text-green-600 font-bold mt-1",children:"MOH"})]})}),i.jsx("div",{className:"w-16 h-16 bg-white rounded-lg flex items-center justify-center shadow-lg",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-blue-600 font-bold text-sm",children:"KAH"}),i.jsx("div",{className:"text-xs text-blue-600",children:"Bisha"})]})})]}),i.jsxs("div",{children:[i.jsx("div",{className:"flex items-center gap-3 mb-2",children:i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold mb-1",children:"King Abdullah Hospital - Bisha"}),i.jsx("p",{className:"text-blue-100 text-lg",children:"   - "})]})}),i.jsxs("div",{className:"text-blue-200 text-sm",children:[i.jsx("p",{className:"font-medium",children:"Home Healthcare Division |    "}),i.jsx("p",{className:"mt-1",children:"Aseer Health Cluster |   "})]})]})]}),i.jsxs("div",{className:"text-right bg-white/10 rounded-lg p-4",children:[i.jsx("p",{className:"text-sm text-blue-100 mb-1",children:"Print Date |  "}),i.jsx("p",{className:"font-bold text-lg",children:new Date().toLocaleDateString()}),i.jsx("p",{className:"text-xs text-blue-200",children:new Date().toLocaleDateString("ar-SA")}),i.jsx("div",{className:"mt-2 text-xs text-blue-200",children:i.jsxs("p",{children:["Document ID: DOC-",Date.now().toString().slice(-6)]})})]})]}),i.jsxs("div",{className:"mt-4 pt-4 border-t border-blue-500",children:[i.jsx("h2",{className:"text-xl font-bold",children:n}),i.jsx("p",{className:"text-blue-100",children:e})]})]}),mp=({patient:n})=>i.jsxs("div",{className:"patient-info bg-gradient-to-br from-gray-50 to-white p-6 rounded-lg mb-6 border border-gray-200 shadow-sm print-no-break",children:[i.jsxs("h3",{className:"font-bold text-lg text-gray-800 mb-4 border-b border-gray-300 pb-2 flex items-center gap-2",children:[i.jsx("span",{className:"w-2 h-2 bg-blue-600 rounded-full"}),"Patient Information |  "]}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[i.jsxs("div",{className:"bg-white p-3 rounded border-l-4 border-blue-500",children:[i.jsx("span",{className:"font-semibold text-gray-600 block mb-1",children:"Name | "}),i.jsx("p",{className:"font-bold text-blue-900",children:n.nameAr})]}),i.jsxs("div",{className:"bg-white p-3 rounded border-l-4 border-green-500",children:[i.jsx("span",{className:"font-semibold text-gray-600 block mb-1",children:"National ID |  "}),i.jsx("p",{className:"font-bold text-green-900",children:n.nationalId})]}),i.jsxs("div",{className:"bg-white p-3 rounded border-l-4 border-purple-500",children:[i.jsx("span",{className:"font-semibold text-gray-600 block mb-1",children:"Phone | "}),i.jsx("p",{className:"font-bold text-purple-900",children:n.phone||"N/A"})]}),i.jsxs("div",{className:"bg-white p-3 rounded border-l-4 border-orange-500",children:[i.jsx("span",{className:"font-semibold text-gray-600 block mb-1",children:"Area | "}),i.jsx("p",{className:"font-bold text-orange-900",children:n.areaId||"N/A"})]})]})]}),YR=({patient:n})=>i.jsxs("div",{className:"print-page",children:[i.jsx(fp,{title:"Medical Assessments Report",titleAr:"  ",patient:n}),i.jsx(mp,{patient:n}),i.jsx("div",{className:"assessment-details space-y-6",children:i.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 border border-blue-200",children:[i.jsx("h3",{className:"font-bold text-lg text-blue-800 mb-4",children:"Assessment Summary |  "}),n.assessments&&n.assessments.length>0?i.jsx("div",{className:"space-y-4",children:n.assessments.map((e,s)=>i.jsxs("div",{className:"bg-white rounded-lg p-4 border border-blue-200",children:[i.jsxs("div",{className:"flex justify-between items-start mb-3",children:[i.jsxs("div",{children:[i.jsxs("h4",{className:"font-semibold text-blue-800",children:[e.role," Assessment"]}),i.jsxs("p",{className:"text-sm text-blue-600",children:[" ",e.role]})]}),i.jsxs("div",{className:"text-right text-sm text-blue-700",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Date:"})," ",new Date(e.date).toLocaleDateString()]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Assessor:"})," ",e.assessorName]})]})]}),i.jsxs("div",{className:"space-y-3 text-sm",children:[e.role==="Doctor"&&i.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-gray-700",children:"Status:"}),i.jsx("span",{className:"ml-2",children:e.status||"N/A"})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-gray-700",children:"Plan:"}),i.jsx("span",{className:"ml-2",children:e.plan||"N/A"})]})]}),e.role==="Nurse"&&i.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-gray-700",children:"Status:"}),i.jsx("span",{className:"ml-2",children:e.status||"N/A"})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-gray-700",children:"Braden Score:"}),i.jsx("span",{className:"ml-2",children:e.bradenScore||"N/A"})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-gray-700",children:"Wound Status:"}),i.jsx("span",{className:"ml-2",children:e.woundStatus||"N/A"})]})]}),e.nurseNote&&i.jsxs("div",{className:"bg-gray-50 p-3 rounded border-l-4 border-green-500",children:[i.jsx("span",{className:"font-medium text-gray-700 block mb-1",children:"Notes:"}),i.jsx("p",{className:"text-gray-600 text-sm leading-relaxed",children:e.nurseNote})]}),e.mdNote&&i.jsxs("div",{className:"bg-gray-50 p-3 rounded border-l-4 border-blue-500",children:[i.jsx("span",{className:"font-medium text-gray-700 block mb-1",children:"Medical Notes:"}),i.jsx("p",{className:"text-gray-600 text-sm leading-relaxed",children:e.mdNote})]})]})]},e.id))}):i.jsx("div",{className:"text-center py-8 text-gray-500",children:i.jsx("p",{children:"No assessments recorded |    "})})]})}),i.jsx("div",{className:"print-footer mt-8 pt-4 border-t-2 border-gray-300",children:i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("div",{children:[i.jsx("p",{className:"font-semibold text-gray-800",children:"Digital Assessment Record"}),i.jsx("p",{className:"text-xs text-gray-600",children:"Aseer Health Cluster  King Abdullah Hospital, Bishah"}),i.jsx("p",{className:"text-xs text-gray-500",children:"       "})]}),i.jsxs("div",{className:"text-right text-xs text-gray-500",children:[i.jsxs("p",{children:["Generated: ",new Date().toLocaleString()]}),i.jsxs("p",{children:["Patient ID: ",n.nationalId]})]})]})})]}),XR=({patient:n})=>i.jsxs("div",{className:"print-page",children:[i.jsx(fp,{title:"Visit Notes History",titleAr:"  ",patient:n}),i.jsx(mp,{patient:n}),i.jsx("div",{className:"visit-notes-details space-y-6",children:i.jsxs("div",{className:"bg-green-50 rounded-lg p-4 border border-green-200",children:[i.jsx("h3",{className:"font-bold text-lg text-green-800 mb-4",children:"All Visit Notes |   "}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"bg-white rounded-lg p-4 border border-green-200",children:[i.jsxs("div",{className:"flex justify-between items-start mb-3",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"font-semibold text-green-800",children:"Doctor Follow-up Visit"}),i.jsx("p",{className:"text-sm text-green-600",children:"  "})]}),i.jsxs("div",{className:"text-right text-sm text-green-700",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Date:"})," ",new Date().toLocaleDateString()]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Status:"})," Improved"]})]})]}),i.jsxs("div",{className:"space-y-3 text-sm",children:[i.jsxs("div",{className:"bg-gray-50 p-3 rounded border-l-4 border-blue-500",children:[i.jsx("span",{className:"font-medium text-gray-700 block mb-1",children:"Clinical Impression:"}),i.jsx("p",{className:"text-gray-600",children:"Patient stable with current management plan. Response to treatment is good."})]}),i.jsxs("div",{className:"bg-gray-50 p-3 rounded border-l-4 border-green-500",children:[i.jsx("span",{className:"font-medium text-gray-700 block mb-1",children:"Treatment Rationale:"}),i.jsx("p",{className:"text-gray-600",children:"Continue current treatment approach based on patient response."})]})]})]}),i.jsxs("div",{className:"bg-white rounded-lg p-4 border border-green-200",children:[i.jsxs("div",{className:"flex justify-between items-start mb-3",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"font-semibold text-green-800",children:"Nursing Care Visit"}),i.jsx("p",{className:"text-sm text-green-600",children:"  "})]}),i.jsxs("div",{className:"text-right text-sm text-green-700",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Date:"})," ",new Date(Date.now()-1440*60*1e3).toLocaleDateString()]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Status:"})," Unchanged"]})]})]}),i.jsxs("div",{className:"space-y-3 text-sm",children:[i.jsxs("div",{className:"bg-gray-50 p-3 rounded border-l-4 border-emerald-500",children:[i.jsx("span",{className:"font-medium text-gray-700 block mb-1",children:"Clinical Findings:"}),i.jsx("p",{className:"text-gray-600",children:"Patient presents with stable vital signs. No acute distress noted."})]}),i.jsxs("div",{className:"bg-gray-50 p-3 rounded border-l-4 border-teal-500",children:[i.jsx("span",{className:"font-medium text-gray-700 block mb-1",children:"Interventions Provided:"}),i.jsx("p",{className:"text-gray-600",children:"Routine nursing care provided. Medication compliance discussed."})]})]})]})]})]})}),i.jsx("div",{className:"print-footer mt-8 pt-4 border-t-2 border-gray-300",children:i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("div",{children:[i.jsx("p",{className:"font-semibold text-gray-800",children:"Digital Visit Record"}),i.jsx("p",{className:"text-xs text-gray-600",children:"Aseer Health Cluster  King Abdullah Hospital, Bishah"}),i.jsx("p",{className:"text-xs text-gray-500",children:"       "})]}),i.jsxs("div",{className:"text-right text-xs text-gray-500",children:[i.jsxs("p",{children:["Generated: ",new Date().toLocaleString()]}),i.jsxs("p",{children:["Patient ID: ",n.nationalId]})]})]})})]}),WR=({patient:n})=>{var e,s;return i.jsxs("div",{className:"print-page",children:[i.jsx(fp,{title:"Contact Attempts Log",titleAr:"  ",patient:n}),i.jsx(mp,{patient:n}),i.jsx("div",{className:"contact-log-details space-y-6",children:i.jsxs("div",{className:"bg-orange-50 rounded-lg p-4 border border-orange-200",children:[i.jsx("h3",{className:"font-bold text-lg text-orange-800 mb-4",children:"Communication History |  "}),i.jsxs("div",{className:"space-y-4",children:[n.contactAttempts&&n.contactAttempts.length>0?n.contactAttempts.map((a,l)=>i.jsxs("div",{className:"bg-white rounded-lg p-4 border border-orange-200",children:[i.jsxs("div",{className:"flex justify-between items-start mb-3",children:[i.jsxs("div",{children:[i.jsxs("h4",{className:"font-semibold text-orange-800",children:["Contact Attempt #",l+1]}),i.jsxs("p",{className:"text-sm text-orange-600",children:["   ",l+1]})]}),i.jsxs("div",{className:"text-right text-sm text-orange-700",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Date:"})," ",new Date(a.date).toLocaleDateString()]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Staff:"})," ",a.staffName]})]})]}),i.jsxs("div",{className:"space-y-3 text-sm",children:[i.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-gray-700",children:"Attempt Type:"}),i.jsx("span",{className:`ml-2 px-2 py-1 rounded text-xs font-medium ${a.outcome==="Successful"?"bg-green-100 text-green-800":a.outcome==="Rescheduled"?"bg-blue-100 text-blue-800":a.type==="No Answer"||a.type==="Busy"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:a.type})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-gray-700",children:"Time:"}),i.jsx("span",{className:"ml-2",children:new Date(a.date).toLocaleTimeString()})]})]}),a.notes&&i.jsxs("div",{className:"bg-gray-50 p-3 rounded border-l-4 border-orange-500",children:[i.jsx("span",{className:"font-medium text-gray-700 block mb-1",children:"Notes:"}),i.jsx("p",{className:"text-gray-600",children:a.notes})]})]})]},l)):i.jsx("div",{className:"text-center py-8 text-gray-500",children:i.jsx("p",{children:"No contact attempts recorded |     "})}),i.jsxs("div",{className:"bg-white rounded-lg p-4 border-2 border-orange-300 mt-6",children:[i.jsx("h4",{className:"font-semibold text-orange-800 mb-3",children:"Contact Recommendations |  "}),i.jsxs("div",{className:"grid md:grid-cols-2 gap-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-gray-700",children:"Best Contact Time:"}),i.jsx("span",{className:"ml-2",children:"Morning (8 AM - 12 PM)"})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-gray-700",children:"Preferred Method:"}),i.jsx("span",{className:"ml-2",children:"Phone Call"})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-gray-700",children:"Total Attempts:"}),i.jsx("span",{className:"ml-2",children:((e=n.contactAttempts)==null?void 0:e.length)||0})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-gray-700",children:"Success Rate:"}),i.jsx("span",{className:"ml-2",children:((s=n.contactAttempts)==null?void 0:s.length)>0?`${Math.round(n.contactAttempts.filter(a=>a.type!=="No Answer"&&a.type!=="Door Not Opened").length/n.contactAttempts.length*100)}%`:"0%"})]})]})]})]})]})}),i.jsx("div",{className:"print-footer mt-8 pt-4 border-t-2 border-gray-300",children:i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("div",{children:[i.jsx("p",{className:"font-semibold text-gray-800",children:"Digital Communication Record"}),i.jsx("p",{className:"text-xs text-gray-600",children:"Aseer Health Cluster  King Abdullah Hospital, Bishah"}),i.jsx("p",{className:"text-xs text-gray-500",children:"       "})]}),i.jsxs("div",{className:"text-right text-xs text-gray-500",children:[i.jsxs("p",{children:["Generated: ",new Date().toLocaleString()]}),i.jsxs("p",{children:["Patient ID: ",n.nationalId]})]})]})})]})},JR=({patient:n,onClose:e})=>{const[s,a]=Pe.useState("assessments"),[l,d]=Pe.useState(!1),[h,f]=Pe.useState(!1),b=Pe.useRef(null),v=()=>K(null,null,function*(){f(!0),yield new Promise(_=>setTimeout(_,500)),d(!0),f(!1)}),E=()=>{var U;const _=window.open("","_blank");if(!_)return;const R=((U=b.current)==null?void 0:U.innerHTML)||"";_.document.write(`
      <!DOCTYPE html>
      <html>
        <head>
          <title>Healthcare Report - King Abdullah Hospital</title>
          <meta charset="utf-8">
          <style>
            * { margin: 0; padding: 0; box-sizing: border-box; }
            body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; line-height: 1.6; color: #333; background: white; }
            .print-page { max-width: none; margin: 0; padding: 20px; font-size: 14px; background: white; }
            .print-header { background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%) !important; -webkit-print-color-adjust: exact !important; color-adjust: exact !important; color: white !important; }
            .print-no-break { page-break-inside: avoid; break-inside: avoid; }
            .print-footer { page-break-inside: avoid; margin-top: 2rem; }
            
            /* Color preservation */
            .bg-blue-50, .bg-blue-100 { background-color: #eff6ff !important; }
            .bg-green-50, .bg-green-100 { background-color: #f0fdf4 !important; }
            .bg-orange-50, .bg-orange-100 { background-color: #fff7ed !important; }
            .bg-gray-50 { background-color: #f9fafb !important; }
            
            .text-blue-600 { color: #2563eb !important; }
            .text-blue-700 { color: #1d4ed8 !important; }
            .text-blue-800 { color: #1e40af !important; }
            .text-green-600 { color: #16a34a !important; }
            .text-green-700 { color: #15803d !important; }
            .text-green-800 { color: #166534 !important; }
            .text-orange-600 { color: #ea580c !important; }
            .text-orange-700 { color: #c2410c !important; }
            .text-orange-800 { color: #9a3412 !important; }
            
            .border-blue-200 { border-color: #bfdbfe !important; }
            .border-green-200 { border-color: #bbf7d0 !important; }
            .border-orange-200 { border-color: #fed7aa !important; }
            .border-gray-300 { border-color: #d1d5db !important; }
            
            .border-l-4 { border-left-width: 4px !important; }
            .border-blue-500 { border-color: #3b82f6 !important; }
            .border-green-500 { border-color: #22c55e !important; }
            .border-orange-500 { border-color: #f97316 !important; }
            
            .rounded, .rounded-lg { border-radius: 8px; }
            .grid { display: grid; }
            .grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); }
            .grid-cols-4 { grid-template-columns: repeat(4, minmax(0, 1fr)); }
            .gap-4 { gap: 1rem; }
            .flex { display: flex; }
            .items-center { align-items: center; }
            .items-start { align-items: flex-start; }
            .justify-between { justify-content: space-between; }
            .p-3 { padding: 0.75rem; }
            .p-4 { padding: 1rem; }
            .p-6 { padding: 1.5rem; }
            .mb-1 { margin-bottom: 0.25rem; }
            .mb-3 { margin-bottom: 0.75rem; }
            .mb-4 { margin-bottom: 1rem; }
            .mb-6 { margin-bottom: 1.5rem; }
            .mt-6 { margin-top: 1.5rem; }
            .mt-8 { margin-top: 2rem; }
            .text-xs { font-size: 0.75rem; }
            .text-sm { font-size: 0.875rem; }
            .text-lg { font-size: 1.125rem; }
            .text-xl { font-size: 1.25rem; }
            .text-2xl { font-size: 1.5rem; }
            .font-bold { font-weight: 700; }
            .font-semibold { font-weight: 600; }
            .font-medium { font-weight: 500; }
            .text-center { text-align: center; }
            .text-right { text-align: right; }
            .border-t-2 { border-top-width: 2px; }
            .border-b { border-bottom-width: 1px; }
            .pt-4 { padding-top: 1rem; }
            .pb-2 { padding-bottom: 0.5rem; }
            .space-y-3 > * + * { margin-top: 0.75rem; }
            .space-y-4 > * + * { margin-top: 1rem; }
            .space-y-6 > * + * { margin-top: 1.5rem; }
            .w-2 { width: 0.5rem; }
            .h-2 { height: 0.5rem; }
            .w-16 { width: 4rem; }
            .h-16 { height: 4rem; }
            .w-20 { width: 5rem; }
            .h-20 { height: 5rem; }
            .shadow-lg { box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1); }
            
            @page { margin: 0.75in; size: A4; }
            @media print {
              .print-page { margin: 0; padding: 0; }
              .print-no-break { page-break-inside: avoid !important; break-inside: avoid !important; }
              .print-header { -webkit-print-color-adjust: exact !important; color-adjust: exact !important; }
            }
          </style>
        </head>
        <body>
          ${R}
        </body>
      </html>
    `),_.document.close(),_.focus(),setTimeout(()=>{_.print(),_.close()},500)},D=()=>{switch(s){case"assessments":return i.jsx(YR,{patient:n});case"visit-notes":return i.jsx(XR,{patient:n});case"contact-log":return i.jsx(WR,{patient:n});default:return null}};return i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-7xl w-full max-h-[95vh] flex flex-col",children:[i.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:i.jsx(Pi,{className:"text-blue-600",size:20})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Enhanced Print Manager"}),i.jsxs("p",{className:"text-sm text-gray-600",children:["   - ",n.nameAr]})]})]}),i.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 p-2 hover:bg-gray-100 rounded-lg",children:i.jsx(xn,{size:20})})]}),i.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[i.jsxs("div",{className:"w-1/3 border-r border-gray-200 p-6 overflow-y-auto",children:[i.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Select Document |  "}),i.jsx("div",{className:"space-y-3",children:KR.map(_=>{const R=_.icon;return i.jsx("button",{onClick:()=>a(_.type),className:`w-full text-left p-4 rounded-lg border-2 transition-all ${s===_.type?`border-${_.color}-500 bg-${_.color}-50`:"border-gray-200 hover:border-gray-300 bg-white"}`,children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center ${s===_.type?`bg-${_.color}-500 text-white`:`bg-${_.color}-100 text-${_.color}-600`}`,children:i.jsx(R,{size:16})}),i.jsxs("div",{className:"flex-1",children:[i.jsx("h4",{className:"font-medium text-gray-900 mb-1",children:_.title}),i.jsx("p",{className:"text-sm text-gray-600 mb-1",children:_.titleAr}),i.jsx("p",{className:"text-xs text-gray-500",children:_.description})]})]})},_.type)})}),i.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200 space-y-3",children:[i.jsx("button",{onClick:v,disabled:h,className:"w-full bg-blue-600 text-white px-4 py-3 rounded-lg font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 transition-all",children:h?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Generating..."]}):i.jsxs(i.Fragment,{children:[i.jsx(yn,{size:16}),"Generate Preview | "]})}),l&&i.jsxs("button",{onClick:E,className:"w-full bg-green-600 text-white px-4 py-3 rounded-lg font-medium hover:bg-green-700 flex items-center justify-center gap-2 transition-all",children:[i.jsx(Pi,{size:16}),"Print Document | "]})]})]}),i.jsx("div",{className:"flex-1 overflow-y-auto bg-gray-50",children:l?i.jsx("div",{ref:b,className:"h-full",children:D()}):i.jsx("div",{className:"flex items-center justify-center h-full",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"w-16 h-16 bg-gray-200 rounded-full flex items-center justify-center mx-auto mb-4",children:i.jsx(yn,{className:"text-gray-400",size:24})}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Document Preview"}),i.jsx("p",{className:"text-gray-600 max-w-sm",children:'Click "Generate Preview" to see your document'}),i.jsx("p",{className:"text-gray-500 text-sm mt-1",children:' ""  '})]})})})]})]})})},Tv=[{value:"Phone Answered",label:"Phone Answered",labelAr:"   ",icon:Yr,color:"green"},{value:"No Answer",label:"No Answer",labelAr:"  ",icon:zm,color:"yellow"},{value:"Door Not Opened",label:"Door Not Opened",labelAr:"   ",icon:Mv,color:"orange"},{value:"Family Answered",label:"Family Answered",labelAr:"   ",icon:Yr,color:"blue"},{value:"Busy",label:"Line Busy",labelAr:" ",icon:Yr,color:"red"},{value:"Phone Off",label:"Phone Turned Off",labelAr:" ",icon:zm,color:"gray"},{value:"Wrong Number",label:"Wrong Number",labelAr:" ",icon:Hc,color:"red"},{value:"Patient Not Available",label:"Patient Not Available",labelAr:"  ",icon:Kr,color:"yellow"},{value:"Rescheduled",label:"Rescheduled",labelAr:"  ",icon:rr,color:"blue"},{value:"Refused Visit",label:"Refused Visit",labelAr:" ",icon:xn,color:"red"}],Av=[{value:"Phone Call",label:"Phone Call",labelAr:" ",icon:Yr},{value:"Home Visit",label:"Home Visit",labelAr:" ",icon:Mv},{value:"WhatsApp",label:"WhatsApp",labelAr:"",icon:Bm},{value:"SMS",label:"SMS",labelAr:" ",icon:Bm}],Cv=[{value:"Successful",label:"Successful",labelAr:"",color:"green"},{value:"Failed",label:"Failed",labelAr:"",color:"red"},{value:"Rescheduled",label:"Rescheduled",labelAr:" ",color:"blue"},{value:"Cancelled",label:"Cancelled",labelAr:"",color:"gray"}],ZR=({patientId:n,patientName:e,onClose:s})=>{const{state:a,dispatch:l}=os(),[d,h]=Pe.useState("Phone Answered"),[f,b]=Pe.useState("Phone Call"),[v,E]=Pe.useState("Successful"),[D,_]=Pe.useState(""),[R,U]=Pe.useState(""),[ie,he]=Pe.useState(""),[Se,Be]=Pe.useState(""),[xe,_e]=Pe.useState(!1),Ne=a.staff.find(Y=>Y..includes(""))||{:"System User"},De=()=>K(null,null,function*(){_e(!0);const Y={date:new Date().toISOString(),type:d,staffName:Ne.,notes:D.trim()||void 0,callDuration:typeof R=="number"?R:void 0,nextAttemptScheduled:ie&&Se?new Date(`${ie}T${Se}`).toISOString():void 0,outcome:v,contactMethod:f};l({type:"LOG_CONTACT_ATTEMPT",payload:{patientId:n,contactAttempt:Y}}),yield new Promise(J=>setTimeout(J,500)),_e(!1),s()}),G=Tv.find(Y=>Y.value===d),V=Av.find(Y=>Y.value===f),L=Cv.find(Y=>Y.value===v),z=f==="Phone Call"&&d==="Phone Answered",Q=v==="Rescheduled"||d==="No Answer"||d==="Busy";return i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[95vh] overflow-y-auto",children:[i.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center",children:i.jsx(Yr,{className:"text-orange-600",size:20})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Contact Attempt"}),i.jsxs("p",{className:"text-sm text-gray-600",children:["  - ",e]})]})]}),i.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 p-2 hover:bg-gray-100 rounded-lg",children:i.jsx(xn,{size:20})})]}),i.jsxs("div",{className:"p-6 space-y-6",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Contact Method |  "}),i.jsx("div",{className:"grid grid-cols-2 gap-3",children:Av.map(Y=>{const J=Y.icon;return i.jsx("button",{onClick:()=>b(Y.value),className:`p-4 rounded-lg border-2 transition-all ${f===Y.value?"border-orange-500 bg-orange-50":"border-gray-200 hover:border-gray-300 bg-white"}`,children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center ${f===Y.value?"bg-orange-500 text-white":"bg-orange-100 text-orange-600"}`,children:i.jsx(J,{size:16})}),i.jsxs("div",{className:"text-left",children:[i.jsx("h4",{className:"font-medium text-gray-900",children:Y.label}),i.jsx("p",{className:"text-sm text-gray-600",children:Y.labelAr})]})]})},Y.value)})})]}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Contact Result |  "}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:Tv.map(Y=>{const J=Y.icon;return i.jsx("button",{onClick:()=>h(Y.value),className:`p-3 rounded-lg border-2 transition-all ${d===Y.value?`border-${Y.color}-500 bg-${Y.color}-50`:"border-gray-200 hover:border-gray-300 bg-white"}`,children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:`w-6 h-6 rounded flex items-center justify-center ${d===Y.value?`bg-${Y.color}-500 text-white`:`bg-${Y.color}-100 text-${Y.color}-600`}`,children:i.jsx(J,{size:14})}),i.jsxs("div",{className:"text-left flex-1",children:[i.jsx("h4",{className:"font-medium text-gray-900 text-sm",children:Y.label}),i.jsx("p",{className:"text-xs text-gray-600",children:Y.labelAr})]})]})},Y.value)})})]}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Overall Outcome |  "}),i.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:Cv.map(Y=>i.jsx("button",{onClick:()=>E(Y.value),className:`p-3 rounded-lg border-2 transition-all ${v===Y.value?`border-${Y.color}-500 bg-${Y.color}-50`:"border-gray-200 hover:border-gray-300 bg-white"}`,children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:`w-3 h-3 rounded-full mx-auto mb-1 ${v===Y.value?`bg-${Y.color}-500`:`bg-${Y.color}-300`}`}),i.jsx("h4",{className:"font-medium text-gray-900 text-sm",children:Y.label}),i.jsx("p",{className:"text-xs text-gray-600",children:Y.labelAr})]})},Y.value))})]}),z&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Call Duration (minutes) |   ()"}),i.jsx("input",{type:"number",min:"0",max:"120",value:R,onChange:Y=>U(Y.target.value?parseInt(Y.target.value):""),placeholder:"5",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"})]}),Q&&i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Schedule Next Attempt |   "}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date | "}),i.jsx("input",{type:"date",value:ie,onChange:Y=>he(Y.target.value),min:new Date().toISOString().split("T")[0],className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Time | "}),i.jsx("input",{type:"time",value:Se,onChange:Y=>Be(Y.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Additional Notes |  "}),i.jsx("textarea",{value:D,onChange:Y=>_(Y.target.value),rows:4,placeholder:"Add any additional details about the contact attempt...",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"})]}),i.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[i.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Summary | "}),i.jsxs("div",{className:"space-y-2 text-sm",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Method:"}),i.jsx("span",{className:"font-medium",children:V==null?void 0:V.label})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Result:"}),i.jsx("span",{className:"font-medium",children:G==null?void 0:G.label})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Outcome:"}),i.jsx("span",{className:`font-medium text-${L==null?void 0:L.color}-600`,children:L==null?void 0:L.label})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Staff:"}),i.jsx("span",{className:"font-medium",children:Ne.})]})]})]})]}),i.jsxs("div",{className:"flex items-center justify-between p-6 border-t border-gray-200",children:[i.jsx("button",{onClick:s,className:"px-6 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 focus:ring-2 focus:ring-orange-500 transition-all",children:"Cancel | "}),i.jsx("button",{onClick:De,disabled:xe,className:"px-6 py-2 text-sm font-medium text-white bg-orange-600 border border-transparent rounded-lg hover:bg-orange-700 focus:ring-2 focus:ring-orange-500 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 transition-all",children:xe?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Saving..."]}):i.jsxs(i.Fragment,{children:[i.jsx(fo,{size:16}),"Save Contact Attempt | "]})})]})]})})},e4=({label:n})=>{const e={Catheter:"bg-blue-500 text-white shadow-sm","Pressure Ulcer":"bg-red-500 text-white shadow-sm","Tube Feeding":"bg-amber-500 text-white shadow-sm","Fall Risk":"bg-purple-500 text-white shadow-sm","IV Therapy":"bg-indigo-500 text-white shadow-sm",Ventilation:"bg-pink-500 text-white shadow-sm"};return i.jsx("span",{className:`px-2.5 py-1 text-xs font-bold rounded-full border-2 border-white/50 ${e[n]||"bg-gray-500 text-white shadow-sm"}`,children:n})},j1=Pe.memo(({patient:n})=>{var R,U;const{state:e,dispatch:s}=os(),[a,l]=Pe.useState({showSmartAssessmentSelector:!1,generatingPdf:!1,showPrintCard:!1,showHistory:!1,showPrintManager:!1,showEnhancedPrintManager:!1,showEnhancedContactManager:!1,selectedAssessmentForPrint:null}),[d,h]=Pe.useState(!1),[f,b]=Pe.useState(!1),v=e.selectedPatientIds.has(n.nationalId),E=Uv(n.admissionDate);(R=n.assessments)==null||R[0];const D=Pe.useCallback(()=>{s({type:"TOGGLE_PATIENT_SELECTION",payload:n.nationalId})},[s,n.nationalId]);Pe.useCallback(ie=>{const Se=(e.staff||[]).find(xe=>xe.&&xe..length>0)||{:"System User"},Be={date:new Date().toISOString(),type:ie,staffName:Se.,contactMethod:"Phone Call",outcome:"Successful"};s({type:"LOG_CONTACT_ATTEMPT",payload:{patientId:n.nationalId,contactAttempt:Be}})},[e.staff,n.nationalId,s]);const _=[rt.Doctor,rt.Nurse,rt.PhysicalTherapist,rt.SocialWorker].includes(e.currentRole);return i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:`bg-white rounded-2xl shadow-lg border-2 ${v?"border-blue-500 ring-4 ring-blue-200/50 shadow-blue-100 transform scale-[1.02]":"border-gray-100 hover:border-blue-200"} transition-all duration-300 flex flex-col hover:shadow-xl transform hover:scale-[1.01] gpu-accelerated`,children:[i.jsxs("div",{className:"p-4 md:p-5 flex-grow",children:[i.jsxs("div",{className:"flex items-start justify-between mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[i.jsx("button",{onClick:()=>{if(n.gmapsUrl){const ie=encodeURIComponent(`${n.nameAr} ${n.areaId||""}`);window.open(`https://maps.google.com/?q=${ie}`,"_blank")}else alert("No location data available |    ")},className:"w-12 h-12 md:w-14 md:h-14 bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg flex items-center justify-center shadow-lg border-2 border-white hover:shadow-xl transition-all transform hover:scale-110 active:scale-95 ripple",title:"Open Google Maps Location |     ",children:i.jsx(xg,{size:20,className:"text-white"})}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("h3",{className:"font-bold text-gray-900 text-base md:text-lg leading-tight truncate",children:n.nameAr}),i.jsxs("div",{className:"flex items-center gap-2 mt-0.5",children:[i.jsx("p",{className:"text-xs md:text-sm text-gray-500",children:n.sex}),n.status==="active"&&i.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-green-100 text-green-700 text-xs font-medium rounded-full",children:[i.jsx("div",{className:"w-1.5 h-1.5 bg-green-500 rounded-full animate-pulse"}),""]})]})]})]}),i.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0 ml-2",children:[n.contactAttempts&&n.contactAttempts.length>0&&i.jsxs("span",{className:"bg-orange-500 text-white text-xs font-bold px-2.5 py-1 rounded-full flex items-center gap-1 shadow-sm",title:`${n.contactAttempts.length} failed contact attempts`,children:[i.jsx(zm,{size:12}),n.contactAttempts.length]}),i.jsx("input",{type:"checkbox",checked:v,onChange:D,className:"h-5 w-5 md:h-6 md:w-6 rounded-md border-2 border-gray-300 text-blue-600 focus:ring-blue-500 focus:ring-2 cursor-pointer touch-target-44"})]})]}),i.jsxs("div",{className:"space-y-2.5 text-sm md:text-base text-gray-700",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2.5",children:[i.jsxs("div",{className:"flex items-center gap-3 bg-gray-50 rounded-lg p-2.5",children:[i.jsx(Pv,{size:16,className:"text-blue-500 flex-shrink-0"}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("span",{className:"text-xs text-gray-500 block",children:" "}),i.jsx("span",{className:"font-medium truncate",children:n.nationalId})]})]}),i.jsxs("div",{className:"flex items-center gap-3 bg-gray-50 rounded-lg p-2.5",children:[i.jsx(Yr,{size:16,className:"text-green-500 flex-shrink-0"}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("span",{className:"text-xs text-gray-500 block",children:""}),i.jsx("span",{className:"font-medium truncate",children:n.phone||"N/A"})]})]}),i.jsxs("div",{className:"flex items-center gap-3 bg-gray-50 rounded-lg p-2.5",children:[i.jsx(Gc,{size:16,className:"text-purple-500 flex-shrink-0"}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("span",{className:"text-xs text-gray-500 block",children:""}),i.jsx("span",{className:"font-medium truncate",children:n.areaId||"N/A"})]})]}),i.jsxs("div",{className:"flex items-center gap-3 bg-gray-50 rounded-lg p-2.5",children:[i.jsx(rr,{size:16,className:"text-amber-500 flex-shrink-0"}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("span",{className:"text-xs text-gray-500 block",children:" "}),i.jsx("span",{className:"font-medium truncate",children:n.admissionDate?new Date(n.admissionDate).toLocaleDateString("ar-SA"):"N/A"})]})]})]}),(n.bradenScore||n.level||n.minMonthlyRequired)&&i.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg p-3 border border-blue-200",children:[i.jsxs("h4",{className:"text-sm font-bold text-blue-800 mb-2 flex items-center gap-2",children:[i.jsx(_l,{size:14,className:"text-blue-600"})," ",i.jsx("span",{className:"text-xs font-normal text-blue-600",children:"Clinical Data"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[n.bradenScore&&i.jsxs("div",{className:"flex items-center gap-2 bg-white rounded-lg p-2 border border-blue-100",children:[i.jsx(Lv,{size:14,className:"text-blue-500"}),i.jsxs("span",{children:[" : ",i.jsx("strong",{className:`${n.bradenScore<=12?"text-red-600":n.bradenScore<=14?"text-yellow-600":"text-green-600"}`,children:n.bradenScore})]})]}),n.level&&i.jsxs("div",{className:"flex items-center gap-2 bg-white rounded-lg p-2 border border-green-100",children:[i.jsx(NS,{size:14,className:"text-green-500"}),i.jsxs("span",{children:[": ",i.jsx("strong",{children:n.level})]})]}),n.minMonthlyRequired&&i.jsxs("div",{className:"flex items-center gap-2 bg-white rounded-lg p-2 border border-purple-100",children:[i.jsx(rr,{size:14,className:"text-purple-500"}),i.jsxs("span",{children:[" : ",i.jsx("strong",{children:n.minMonthlyRequired})]})]}),n.lastVisit&&i.jsxs("div",{className:"flex items-center gap-2 bg-white rounded-lg p-2 border border-orange-100",children:[i.jsx(kx,{size:14,className:"text-orange-500"}),i.jsxs("span",{children:[" : ",i.jsx("strong",{children:new Date(n.lastVisit).toLocaleDateString("ar-SA")})]})]})]})]})]}),i.jsxs("div",{className:"mt-4 space-y-3",children:[(n.hasCatheter||((U=n.wounds)==null?void 0:U.presentCount)||n.ngTube||n.gTube||n.fallHighRisk||n.ivTherapy||n.ventSupport)&&i.jsxs("div",{className:"bg-red-50 rounded-lg p-3 border border-red-200",children:[i.jsxs("h4",{className:"text-sm font-bold text-red-800 mb-2 flex items-center gap-2",children:[i.jsx("span",{className:"w-2 h-2 bg-red-600 rounded-full"}),"  "]}),i.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.hasCatheter&&i.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs font-medium rounded-full border border-blue-200",children:" "}),n.wounds&&n.wounds.presentCount&&n.wounds.presentCount>0&&i.jsxs("span",{className:"px-2 py-1 bg-red-100 text-red-800 text-xs font-medium rounded-full border border-red-200",children:["  (",n.wounds.presentCount,")"]}),n.ngTube&&i.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs font-medium rounded-full border border-green-200",children:"  "}),n.gTube&&i.jsx("span",{className:"px-2 py-1 bg-purple-100 text-purple-800 text-xs font-medium rounded-full border border-purple-200",children:"  "}),n.fallHighRisk&&i.jsx("span",{className:"px-2 py-1 bg-orange-100 text-orange-800 text-xs font-medium rounded-full border border-orange-200",children:"  "}),n.ivTherapy&&i.jsx("span",{className:"px-2 py-1 bg-indigo-100 text-indigo-800 text-xs font-medium rounded-full border border-indigo-200",children:"  "}),n.ventSupport&&i.jsx("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-800 text-xs font-medium rounded-full border border-yellow-200",children:"  "})]})]}),n.tags.length>0&&i.jsx("div",{className:"flex flex-wrap gap-2",children:n.tags.map(ie=>i.jsx(e4,{label:ie},ie))})]})]}),i.jsx("div",{className:"border-t-2 border-gray-100 bg-gradient-to-r from-gray-50 to-blue-50/30 px-4 md:px-5 py-3 md:py-4 rounded-b-2xl",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:`px-3 py-2 text-xs md:text-sm font-bold rounded-xl flex items-center gap-2 shadow-sm border ${VS[E.level]}`,children:[i.jsx("div",{className:`w-2.5 h-2.5 rounded-full ${E.level==="red"?"bg-red-500":E.level==="yellow"?"bg-yellow-500":"bg-green-500"}`}),E.label]}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("div",{className:"flex items-center bg-white/50 rounded-lg p-1 border border-white/50",children:i.jsx("button",{onClick:()=>l(ie=>oe(X({},ie),{showEnhancedContactManager:!0})),title:" ",className:"p-1.5 rounded-md hover:bg-blue-500 text-blue-600 hover:text-white transition-all transform hover:scale-110",children:i.jsx(Yr,{size:14})})}),i.jsxs("div",{className:"flex items-center bg-white/50 rounded-lg p-1 border border-white/50",children:[i.jsx("button",{onClick:()=>l(ie=>oe(X({},ie),{showHistory:!0})),title:" ",className:"p-1.5 rounded-md hover:bg-purple-500 text-purple-600 hover:text-white transition-all transform hover:scale-110",children:i.jsx(kx,{size:14})}),i.jsx("button",{onClick:()=>l(ie=>oe(X({},ie),{showEnhancedPrintManager:!0})),title:"  ",className:"p-1.5 rounded-md hover:bg-indigo-500 text-indigo-600 hover:text-white transition-all transform hover:scale-110",children:i.jsx(rr,{size:14})})]}),_&&i.jsx("div",{className:"flex items-center bg-white/50 rounded-lg p-1 border border-white/50",children:i.jsx("button",{onClick:()=>l(ie=>oe(X({},ie),{showSmartAssessmentSelector:!0})),title:"  ",className:"p-1.5 rounded-md hover:bg-green-500 text-green-600 hover:text-white transition-all transform hover:scale-110",children:i.jsx(Ir,{size:14})})}),i.jsx("div",{className:"flex items-center bg-white/50 rounded-lg p-1 border border-white/50",children:i.jsx("button",{onClick:()=>l(ie=>oe(X({},ie),{showEnhancedPrintManager:!0})),title:" ",className:"p-1.5 rounded-md hover:bg-orange-500 text-orange-600 hover:text-white transition-all transform hover:scale-110",children:i.jsx(Pi,{size:14})})})]})]})})]}),a.showPrintCard&&i.jsx(zR,{patient:n,onClose:()=>l(ie=>oe(X({},ie),{showPrintCard:!1}))}),a.showHistory&&i.jsx(FR,{patient:n,onClose:()=>l(ie=>oe(X({},ie),{showHistory:!1}))}),a.showPrintManager&&i.jsx(QR,{patient:n,assessment:a.selectedAssessmentForPrint,staff:e.staff,onClose:()=>l(ie=>oe(X({},ie),{showPrintManager:!1,selectedAssessmentForPrint:null}))}),a.showEnhancedPrintManager&&i.jsx(JR,{patient:n,onClose:()=>l(ie=>oe(X({},ie),{showEnhancedPrintManager:!1}))}),a.showEnhancedContactManager&&i.jsx(ZR,{patientId:n.nationalId,patientName:n.nameAr,onClose:()=>l(ie=>oe(X({},ie),{showEnhancedContactManager:!1}))}),a.showSmartAssessmentSelector&&i.jsx(BR,{patient:n,onClose:()=>l(ie=>oe(X({},ie),{showSmartAssessmentSelector:!1}))})]})});j1.displayName="PatientCard";const Iv=({onClose:n})=>{const{state:e,dispatch:s}=os(),[a,l]=Pe.useState({nationalId:"",nameAr:"",phone:"",areaId:"",sex:"Male",bradenScore:"",level:"",minMonthlyRequired:"",admissionDate:new Date().toISOString().split("T")[0],hasCatheter:!1,ngTube:!1,gTube:!1,fallHighRisk:!1,ivTherapy:!1,ventSupport:!1}),[d,h]=Pe.useState({}),[f,b]=Pe.useState(!1),v=()=>{const _={};return a.nationalId.trim()?/^\d{10}$/.test(a.nationalId)?e.patients.some(R=>R.nationalId===a.nationalId)&&(_.nationalId="   "):_.nationalId="     10 ":_.nationalId="  ",a.nameAr.trim()||(_.nameAr="  "),a.phone&&!/^0\d{9}$/.test(a.phone)&&(_.phone="    (    0 10 )"),a.bradenScore&&(isNaN(Number(a.bradenScore))||Number(a.bradenScore)<6||Number(a.bradenScore)>23)&&(_.bradenScore="      6  23"),h(_),Object.keys(_).length===0},E=_=>K(null,null,function*(){if(_.preventDefault(),!!v()){b(!0);try{const R={nationalId:a.nationalId,nameAr:a.nameAr,phone:a.phone||null,areaId:a.areaId||null,status:"active",level:a.level||null,bradenScore:a.bradenScore?Number(a.bradenScore):null,minMonthlyRequired:a.minMonthlyRequired?Number(a.minMonthlyRequired):null,admissionDate:a.admissionDate,gmapsUrl:!1,sex:a.sex,hasCatheter:a.hasCatheter,ngTube:a.ngTube,gTube:a.gTube,fallHighRisk:a.fallHighRisk,ivTherapy:a.ivTherapy,ventSupport:a.ventSupport,tags:[],assessments:[],contactAttempts:[]},U=[...e.patients,R];s({type:"IMPORT_STATE",payload:oe(X({},e),{patients:U,selectedPatientIds:new Set})}),n()}catch(R){console.error("Error adding patient:",R)}finally{b(!1)}}}),D=(_,R)=>{l(U=>oe(X({},U),{[_]:R})),d[_]&&h(U=>oe(X({},U),{[_]:""}))};return i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[i.jsx("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-4 rounded-t-2xl",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:i.jsx(Ir,{className:"text-blue-600",size:20})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"  "}),i.jsx("p",{className:"text-sm text-gray-600",children:"   "})]})]}),i.jsx("button",{onClick:n,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:i.jsx(xn,{size:20})})]})}),i.jsxs("form",{onSubmit:E,className:"p-6 space-y-6",children:[i.jsxs("div",{className:"space-y-4",children:[i.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[i.jsx(ml,{size:18,className:"text-blue-600"})," "]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"  *"}),i.jsxs("div",{className:"relative",children:[i.jsx(Pv,{size:16,className:"absolute left-3 top-3 text-gray-400"}),i.jsx("input",{type:"text",value:a.nationalId,onChange:_=>D("nationalId",_.target.value),className:`w-full pl-10 pr-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${d.nationalId?"border-red-500":"border-gray-300"}`,placeholder:"1234567890",maxLength:10})]}),d.nationalId&&i.jsx("p",{className:"text-red-500 text-xs mt-1",children:d.nationalId})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"  *"}),i.jsx("input",{type:"text",value:a.nameAr,onChange:_=>D("nameAr",_.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${d.nameAr?"border-red-500":"border-gray-300"}`,placeholder:"  ",dir:"rtl"}),d.nameAr&&i.jsx("p",{className:"text-red-500 text-xs mt-1",children:d.nameAr})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "}),i.jsxs("div",{className:"relative",children:[i.jsx(Yr,{size:16,className:"absolute left-3 top-3 text-gray-400"}),i.jsx("input",{type:"text",value:a.phone,onChange:_=>D("phone",_.target.value),className:`w-full pl-10 pr-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${d.phone?"border-red-500":"border-gray-300"}`,placeholder:"0501234567",maxLength:10})]}),d.phone&&i.jsx("p",{className:"text-red-500 text-xs mt-1",children:d.phone})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),i.jsxs("div",{className:"relative",children:[i.jsx(Gc,{size:16,className:"absolute left-3 top-3 text-gray-400"}),i.jsxs("select",{value:a.areaId,onChange:_=>D("areaId",_.target.value),className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[i.jsx("option",{value:"",children:" "}),e.areas.map(_=>i.jsx("option",{value:_,children:_},_))]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),i.jsxs("select",{value:a.sex,onChange:_=>D("sex",_.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[i.jsx("option",{value:"Male",children:""}),i.jsx("option",{value:"Female",children:""})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "}),i.jsxs("div",{className:"relative",children:[i.jsx(rr,{size:16,className:"absolute left-3 top-3 text-gray-400"}),i.jsx("input",{type:"date",value:a.admissionDate,onChange:_=>D("admissionDate",_.target.value),className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[i.jsx(Lv,{size:18,className:"text-green-600"})," "]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "}),i.jsx("input",{type:"number",value:a.bradenScore,onChange:_=>D("bradenScore",_.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${d.bradenScore?"border-red-500":"border-gray-300"}`,placeholder:"6-23",min:"6",max:"23"}),d.bradenScore&&i.jsx("p",{className:"text-red-500 text-xs mt-1",children:d.bradenScore})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),i.jsx("input",{type:"text",value:a.level,onChange:_=>D("level",_.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"1-4"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"  "}),i.jsx("input",{type:"number",value:a.minMonthlyRequired,onChange:_=>D("minMonthlyRequired",_.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"1-4",min:"1",max:"10"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"  "}),i.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:[{key:"hasCatheter",label:""},{key:"ngTube",label:" "},{key:"gTube",label:" "},{key:"fallHighRisk",label:" "},{key:"ivTherapy",label:" "},{key:"ventSupport",label:" "}].map(_=>i.jsxs("label",{className:"flex items-center gap-2 p-2 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:a[_.key],onChange:R=>D(_.key,R.target.checked),className:"text-blue-600 focus:ring-blue-500 rounded"}),i.jsx("span",{className:"text-sm",children:_.label})]},_.key))})]})]}),i.jsxs("div",{className:"flex items-center justify-end gap-3 pt-4 border-t border-gray-200",children:[i.jsx("button",{type:"button",onClick:n,className:"px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:""}),i.jsx("button",{type:"submit",disabled:f,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:f?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"})," ..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Ir,{size:16})," "]})})]})]})]})})},T1=Pe.memo(()=>{const{filteredPatients:n,state:e}=os(),[s,a]=Pe.useState(!1),[l,d]=Pe.useState(20),h=Pe.useMemo(()=>n.slice(0,l),[n,l]),f=n.length>l,b=()=>{d(v=>Math.min(v+20,n.length))};return n.length===0?i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("h2",{className:"text-lg font-bold text-gray-900",children:" "}),i.jsx("span",{className:"bg-gray-100 text-gray-800 text-sm font-medium px-2.5 py-0.5 rounded-full",children:"0"})]}),i.jsxs("button",{onClick:()=>a(!0),className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors font-medium shadow-lg",children:[i.jsx(Ir,{size:18}),i.jsx("span",{className:"hidden sm:inline",children:" "})]})]}),i.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-500 p-8 animate-fade-in",children:[i.jsx("div",{className:"bg-blue-50 rounded-full p-6 mb-6",children:i.jsx(SS,{size:48,className:"text-blue-400"})}),i.jsx("h2",{className:"text-xl md:text-2xl font-bold text-gray-800 mb-2",children:"  "}),i.jsx("p",{className:"text-center text-gray-600 max-w-md mb-4",children:e.patients.length===0?"     .    .":"        ."}),e.patients.length===0&&i.jsxs("button",{onClick:()=>a(!0),className:"flex items-center gap-2 bg-blue-600 text-white px-6 py-3 rounded-xl hover:bg-blue-700 transition-colors font-medium shadow-lg",children:[i.jsx(Ir,{size:20}),"  "]})]}),s&&i.jsx(Iv,{onClose:()=>a(!1)})]}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("h2",{className:"text-lg font-bold text-gray-900",children:" "}),i.jsx("span",{className:"bg-blue-100 text-blue-800 text-sm font-medium px-2.5 py-0.5 rounded-full",children:n.length})]}),i.jsxs("button",{onClick:()=>a(!0),className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors font-medium shadow-lg",children:[i.jsx(Ir,{size:18}),i.jsx("span",{className:"hidden sm:inline",children:" "})]})]}),i.jsx("div",{className:"mobile-grid gap-4 md:gap-6",children:h.map(v=>i.jsx(j1,{patient:v},v.nationalId))}),f&&i.jsx("div",{className:"mt-6 text-center",children:i.jsxs("button",{onClick:b,className:"bg-gray-100 hover:bg-gray-200 text-gray-700 px-6 py-3 rounded-lg transition-colors font-medium",children:["  (",n.length-l," )"]})}),l>=n.length&&n.length>20&&i.jsxs("div",{className:"mt-4 text-center text-sm text-gray-500",children:["    (",n.length,")"]}),s&&i.jsx(Iv,{onClose:()=>a(!1)})]})});T1.displayName="PatientList";const gs=({label:n,value:e})=>{if(!e||Array.isArray(e)&&e.length===0)return null;const s=Array.isArray(e)?e.join(", "):e;return i.jsxs("p",{children:[i.jsxs("strong",{className:"font-semibold",children:[n,":"]})," ",s]})},t4=({visit:n,patient:e})=>{const{doctorNote:s,nurseNote:a}=n;return i.jsxs("div",{className:"p-8 font-sans text-sm",style:{width:"210mm",height:"297mm"},children:[i.jsxs("header",{className:"flex items-center justify-between pb-4 border-b",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("img",{src:"/logo.png",alt:"Aseer Health Cluster Logo",className:"h-16 w-16 object-contain",onError:l=>{l.currentTarget.style.display="none"}}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Home Healthcare Visit Note"}),i.jsx("p",{className:"text-lg text-gray-600",children:"       "}),i.jsx("p",{className:"text-sm text-gray-500",children:"  "})]})]}),i.jsxs("div",{className:"text-right text-xs text-gray-500",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Date:"})," ",new Date(n.date).toLocaleDateString()]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Team:"})," ",n.teamId]})]})]}),i.jsxs("section",{className:"grid grid-cols-2 gap-x-8 gap-y-2 mt-4 pb-4 border-b text-sm",children:[i.jsx("h2",{className:"col-span-2 text-base font-bold text-gray-700 mb-1",children:"Patient Information"}),i.jsx(gs,{label:"Name (EN)",value:e.nameAr}),i.jsx(gs,{label:"Name (AR)",value:e.nameAr}),i.jsx(gs,{label:"National ID",value:e.nationalId}),i.jsx(gs,{label:"MRN",value:e.nationalId}),i.jsx(gs,{label:"Area",value:e.areaId}),i.jsx(gs,{label:"Phone",value:e.phone})]}),(a==null?void 0:a.vitals)&&i.jsxs("section",{className:"mt-4 pb-4 border-b",children:[i.jsx("h2",{className:"text-base font-bold text-gray-700 mb-2",children:"Vital Signs"}),i.jsxs("div",{className:"grid grid-cols-6 gap-2 text-center",children:[i.jsxs("div",{className:"bg-gray-50 p-1 rounded-md",children:[i.jsx("div",{className:"text-xs font-bold text-gray-500",children:"BP"}),i.jsx("div",{className:"font-mono text-base",children:a.vitals.bp||"-"})]}),i.jsxs("div",{className:"bg-gray-50 p-1 rounded-md",children:[i.jsx("div",{className:"text-xs font-bold text-gray-500",children:"HR"}),i.jsx("div",{className:"font-mono text-base",children:a.vitals.hr||"-"})]}),i.jsxs("div",{className:"bg-gray-50 p-1 rounded-md",children:[i.jsx("div",{className:"text-xs font-bold text-gray-500",children:"RR"}),i.jsx("div",{className:"font-mono text-base",children:a.vitals.rr||"-"})]}),i.jsxs("div",{className:"bg-gray-50 p-1 rounded-md",children:[i.jsx("div",{className:"text-xs font-bold text-gray-500",children:"Temp"}),i.jsx("div",{className:"font-mono text-base",children:a.vitals.temp?`${a.vitals.temp}C`:"-"})]}),i.jsxs("div",{className:"bg-gray-50 p-1 rounded-md",children:[i.jsx("div",{className:"text-xs font-bold text-gray-500",children:"SpO"}),i.jsx("div",{className:"font-mono text-base",children:a.vitals.o2sat?`${a.vitals.o2sat}%`:"-"})]}),i.jsxs("div",{className:"bg-gray-50 p-1 rounded-md",children:[i.jsx("div",{className:"text-xs font-bold text-gray-500",children:"Pain"}),i.jsx("div",{className:"font-mono text-base",children:a.vitals.pain?`${a.vitals.pain}/10`:"-"})]})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-x-8 mt-4",children:[a&&i.jsxs("section",{children:[i.jsx("h2",{className:"text-base font-bold text-gray-700 mb-2",children:"Nursing Section"}),i.jsxs("div",{className:"space-y-1",children:[i.jsx(gs,{label:"Status",value:a.status}),i.jsx(gs,{label:"Wound Delta",value:a.woundDelta}),i.jsx(gs,{label:"Device Delta",value:a.deviceDelta}),i.jsx(gs,{label:"Tasks",value:a.tasks}),i.jsx(gs,{label:"Escalation",value:a.escalation}),i.jsx(gs,{label:"Note",value:a.nurseNote})]})]}),s&&i.jsxs("section",{children:[i.jsx("h2",{className:"text-base font-bold text-gray-700 mb-2",children:"Doctor Section"}),i.jsxs("div",{className:"space-y-1",children:[i.jsx(gs,{label:"Status",value:s.status}),i.jsx(gs,{label:"Response to Plan",value:s.responseToPlan}),i.jsx(gs,{label:"Adherence",value:s.adherence}),i.jsx(gs,{label:"New Issues",value:s.newIssues}),i.jsx(gs,{label:"Plan",value:s.plan}),i.jsx(gs,{label:"Plan Details",value:s.planDetails}),i.jsx(gs,{label:"Next Follow-up",value:s.nextFollowUp}),i.jsx(gs,{label:"Note",value:s.mdNote})]})]})]}),i.jsx("footer",{className:"mt-16 pt-4 border-t absolute bottom-8 w-[calc(100%-4rem)]",children:i.jsxs("div",{className:"grid grid-cols-2 gap-8",children:[i.jsxs("div",{children:[i.jsx("p",{className:"font-semibold",children:n.nurseSign||"Nurse Signature"}),i.jsx("p",{className:"text-xs text-gray-500 border-t mt-1 pt-1",children:"Nurse"})]}),i.jsxs("div",{children:[i.jsx("p",{className:"font-semibold",children:n.doctorSign||"Doctor Signature"}),i.jsx("p",{className:"text-xs text-gray-500 border-t mt-1 pt-1",children:"Doctor"})]})]})})]})},fn=({label:n,value:e})=>{if(!e||Array.isArray(e)&&e.length===0)return null;let s;return typeof e=="object"&&!Array.isArray(e)?s=Object.entries(e).map(([a,l])=>`${a}: ${l}`).join(", "):s=Array.isArray(e)?e.join(", "):e,i.jsxs("p",{children:[i.jsxs("strong",{className:"font-semibold",children:[n,":"]})," ",s]})},s4=({visit:n,patient:e})=>{const{ptNote:s}=n,a=e.assessments.find(l=>l.role===rt.PhysicalTherapist);return i.jsxs("div",{className:"p-8 font-sans text-sm",style:{width:"210mm",height:"297mm"},children:[i.jsxs("header",{className:"flex items-center justify-between pb-4 border-b",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Physical Therapy Note"}),i.jsx("p",{className:"text-lg text-gray-600",children:"       "}),"\\n            ",i.jsx("p",{className:"text-sm text-gray-500",children:"  "})]}),i.jsx("div",{className:"text-right text-xs text-gray-500",children:i.jsxs("p",{children:[i.jsx("strong",{children:"Date:"})," ",new Date(n.date).toLocaleDateString()]})})]}),i.jsxs("section",{className:"grid grid-cols-2 gap-x-8 gap-y-2 mt-4 pb-4 border-b text-sm",children:[i.jsx("h2",{className:"col-span-2 text-base font-bold text-gray-700 mb-1",children:"Patient Information"}),i.jsx(fn,{label:"Name",value:e.nameAr}),i.jsx(fn,{label:"National ID",value:e.nationalId}),i.jsx(fn,{label:"Area",value:e.areaId}),i.jsx(fn,{label:"Phone",value:e.phone})]}),i.jsxs("div",{className:"mt-4 space-y-4",children:[a&&i.jsxs("section",{children:[i.jsx("h2",{className:"text-base font-bold text-gray-700 mb-2 underline",children:"Assessment Summary"}),i.jsxs("div",{className:"space-y-1",children:[i.jsx(fn,{label:"Dx Focus",value:a.dxFocus}),i.jsx(fn,{label:"Phase",value:a.phase}),i.jsx(fn,{label:"Function",value:a.function}),i.jsx(fn,{label:"Interventions",value:a.interventions})]})]}),s&&i.jsxs("section",{children:[i.jsx("h2",{className:"text-base font-bold text-gray-700 mb-2 underline",children:"Follow-up Note"}),i.jsxs("div",{className:"space-y-1",children:[i.jsx(fn,{label:"Changes Since Last",value:s.changeSinceLast}),i.jsx(fn,{label:"Tolerance",value:s.tolerance}),i.jsx(fn,{label:"HEP",value:s.hep}),i.jsx(fn,{label:"Plan",value:s.plan}),i.jsx(fn,{label:"Plan Focus",value:s.planFocus}),i.jsx(fn,{label:"Note",value:s.ptNote})]})]})]}),i.jsx("footer",{className:"mt-16 pt-4 border-t absolute bottom-8 w-[calc(100%-4rem)]",children:i.jsxs("div",{children:[i.jsx("p",{className:"font-semibold",children:n.ptSign||"Therapist Signature"}),i.jsx("p",{className:"text-xs text-gray-500 border-t mt-1 pt-1",children:"Physical Therapist"})]})})]})},mn=({label:n,value:e})=>{if(!e||Array.isArray(e)&&e.length===0)return null;let s;return typeof e=="object"&&!Array.isArray(e)?s=Object.entries(e).map(([a,l])=>l).join(", "):s=Array.isArray(e)?e.join(", "):e,i.jsxs("p",{children:[i.jsxs("strong",{className:"font-semibold",children:[n,":"]})," ",s]})},n4=({visit:n,patient:e})=>{var l;const{swNote:s}=n,a=e.assessments.find(d=>d.role===rt.SocialWorker);return i.jsxs("div",{className:"p-8 font-sans text-sm",style:{width:"210mm",height:"297mm"},dir:"rtl",children:[i.jsxs("header",{className:"flex items-center justify-between pb-4 border-b",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"  "}),i.jsx("p",{className:"text-lg text-gray-600",children:"       "}),"\\n            ",i.jsx("p",{className:"text-sm text-gray-500",children:"  "})]}),i.jsx("div",{className:"text-right text-xs text-gray-500",children:i.jsxs("p",{children:[i.jsx("strong",{children:":"})," ",new Date(n.date).toLocaleDateString()]})})]}),i.jsxs("section",{className:"grid grid-cols-2 gap-x-8 gap-y-2 mt-4 pb-4 border-b text-sm",children:[i.jsx("h2",{className:"col-span-2 text-base font-bold text-gray-700 mb-1",children:" "}),i.jsx(mn,{label:"",value:e.nameAr}),i.jsx(mn,{label:" ",value:e.nationalId}),i.jsx(mn,{label:"",value:e.areaId}),i.jsx(mn,{label:"",value:e.phone})]}),i.jsxs("div",{className:"mt-4 space-y-4",children:[a&&i.jsxs("section",{children:[i.jsx("h2",{className:"text-base font-bold text-gray-700 mb-2 underline",children:"  "}),i.jsxs("div",{className:"space-y-1",children:[i.jsx(mn,{label:" ",value:a.residence}),i.jsx(mn,{label:" ",value:a.economic}),i.jsx(mn,{label:" ",value:(l=a.homeSafety)==null?void 0:l.risks}),i.jsx(mn,{label:"",value:a.needs}),i.jsx(mn,{label:" ",value:a.psychosocial}),i.jsx(mn,{label:"",value:a.actions})]})]}),s&&i.jsxs("section",{children:[i.jsx("h2",{className:"text-base font-bold text-gray-700 mb-2 underline",children:" "}),i.jsxs("div",{className:"space-y-1",children:[i.jsx(mn,{label:" ",value:s.situationChange}),i.jsx(mn,{label:" ",value:s.actionsTaken}),i.jsx(mn,{label:"",value:s.plan}),i.jsx(mn,{label:"",value:s.swNote})]})]})]}),i.jsx("footer",{className:"mt-16 pt-4 border-t absolute bottom-8 w-[calc(100%-4rem)]",children:i.jsxs("div",{children:[i.jsx("p",{className:"font-semibold",children:n.swSign||"  "}),i.jsx("p",{className:"text-xs text-gray-500 border-t mt-1 pt-1",children:" "})]})})]})},r4=({visit:n})=>i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 text-sm md:text-base",children:[i.jsxs("div",{className:"bg-blue-50 rounded-xl p-4 border-2 border-blue-200",children:[i.jsxs("h4",{className:"font-bold text-blue-800 flex items-center gap-2 mb-3",children:[i.jsx(Ui,{size:16})," Doctor's Assessment"]}),n.doctorNote?i.jsxs("div",{className:"space-y-2 text-gray-700",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full"}),i.jsxs("span",{children:[i.jsx("strong",{children:"Status:"})," ",n.doctorNote.status]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full"}),i.jsxs("span",{children:[i.jsx("strong",{children:"Response:"})," ",n.doctorNote.responseToPlan]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full"}),i.jsxs("span",{children:[i.jsx("strong",{children:"Plan:"})," ",n.doctorNote.plan," ",n.doctorNote.planDetails?`(${n.doctorNote.planDetails.join(", ")})`:""]})]}),n.doctorNote.mdNote&&i.jsx("div",{className:"bg-white rounded-lg p-3 border-l-4 border-blue-500",children:i.jsxs("p",{className:"italic text-blue-700",children:['"',n.doctorNote.mdNote,'"']})})]}):i.jsxs("div",{className:"text-center py-4",children:[i.jsx(Kr,{size:24,className:"text-gray-400 mx-auto mb-2"}),i.jsx("p",{className:"italic text-gray-500",children:"Pending Assessment"})]}),n.doctorSign&&i.jsx("div",{className:"mt-3 pt-2 border-t border-blue-200",children:i.jsxs("p",{className:"text-blue-600 text-sm font-medium",children:[" Signed by: ",n.doctorSign]})})]}),i.jsxs("div",{className:"bg-green-50 rounded-xl p-4 border-2 border-green-200",children:[i.jsxs("h4",{className:"font-bold text-green-800 flex items-center gap-2 mb-3",children:[i.jsx(ih,{size:16})," Nursing Care"]}),n.nurseNote?i.jsxs("div",{className:"space-y-2 text-gray-700",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full"}),i.jsxs("span",{children:[i.jsx("strong",{children:"Status:"})," ",n.nurseNote.status]})]}),n.nurseNote.vitals&&i.jsxs("div",{className:"bg-white rounded-lg p-3 border-l-4 border-green-500",children:[i.jsx("p",{children:i.jsx("strong",{children:"Vitals:"})}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-1 text-sm",children:[n.nurseNote.vitals.temp&&i.jsxs("span",{children:["T: ",n.nurseNote.vitals.temp,"C"]}),n.nurseNote.vitals.o2sat&&i.jsxs("span",{children:["SpO: ",n.nurseNote.vitals.o2sat,"%"]}),n.nurseNote.vitals.bp&&i.jsxs("span",{children:["BP: ",n.nurseNote.vitals.bp]}),n.nurseNote.vitals.hr&&i.jsxs("span",{children:["HR: ",n.nurseNote.vitals.hr]})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full"}),i.jsxs("span",{children:[i.jsx("strong",{children:"Tasks:"})," ",n.nurseNote.tasks.join(", ")]})]}),n.nurseNote.nurseNote&&i.jsx("div",{className:"bg-white rounded-lg p-3 border-l-4 border-green-500",children:i.jsxs("p",{className:"italic text-green-700",children:['"',n.nurseNote.nurseNote,'"']})})]}):i.jsxs("div",{className:"text-center py-4",children:[i.jsx(Kr,{size:24,className:"text-gray-400 mx-auto mb-2"}),i.jsx("p",{className:"italic text-gray-500",children:"Pending Assessment"})]}),n.nurseSign&&i.jsx("div",{className:"mt-3 pt-2 border-t border-green-200",children:i.jsxs("p",{className:"text-green-600 text-sm font-medium",children:[" Signed by: ",n.nurseSign]})})]}),n.ptNote&&i.jsxs("div",{className:"space-y-2",children:[i.jsxs("h4",{className:"font-bold text-gray-600 flex items-center gap-1",children:[i.jsx(gg,{size:14})," PT Note"]}),i.jsxs("div",{className:"pl-2 border-l-2 border-purple-200 space-y-1 text-gray-700",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Tolerance:"})," ",n.ptNote.tolerance]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Plan:"})," ",n.ptNote.plan]}),n.ptNote.ptNote&&i.jsxs("p",{className:"italic",children:['"',n.ptNote.ptNote,'"']})]}),n.ptSign&&i.jsxs("p",{className:"text-gray-400 text-[10px] pt-1",children:["Signed by: ",n.ptSign]})]}),n.swNote&&i.jsxs("div",{className:"space-y-2",dir:"rtl",children:[i.jsxs("h4",{className:"font-bold text-gray-600 flex items-center gap-1",children:[i.jsx(pg,{size:14}),"   "]}),i.jsxs("div",{className:"pr-2 border-r-2 border-yellow-200 space-y-1 text-gray-700",children:[i.jsxs("p",{children:[i.jsx("strong",{children:":"})," ",n.swNote.situationChange]}),i.jsxs("p",{children:[i.jsx("strong",{children:":"})," ",n.swNote.actionsTaken.join(", ")]}),n.swNote.swNote&&i.jsxs("p",{className:"italic",children:['"',n.swNote.swNote,'"']})]}),n.swSign&&i.jsxs("p",{className:"text-gray-400 text-[10px] pt-1",children:["  : ",n.swSign]})]})]}),i4=({visit:n,patient:e})=>{const{state:s,dispatch:a}=os(),[l,d]=Pe.useState(!1);if(!e)return null;const h=s.currentRole;let f,b,v=!1;switch(h){case rt.Doctor:f=_1,b=n.doctorNote,v=!!n.doctorNote;break;case rt.Nurse:f=w1,b=n.nurseNote,v=!!n.nurseNote;break;case rt.PhysicalTherapist:f=N1,b=n.ptNote,v=!!n.ptNote;break;case rt.SocialWorker:f=S1,b=n.swNote,v=!!n.swNote;break}const E=R=>{const U=s.staff.find(ie=>ie..includes(""))||{:h};a({type:"SAVE_VISIT_NOTE",payload:{visitId:`${n.patientId}_${n.date}`,role:h,note:R,user:U.}}),d(!1)},D=R=>{const U=window.open("","_blank");if(U){U.document.write('<html><head><title>Visit Note</title><script src="https://cdn.tailwindcss.com"><\/script></head><body><div id="print-root"></div></body></html>'),U.document.close();const ie=U.document.getElementById("print-root");ie&&(bg.createRoot(ie).render(R),setTimeout(()=>{U.print(),U.close()},500))}},_=()=>{switch(n.status){case"Completed":return i.jsx(mg,{size:18,className:"text-green-500"});case"DoctorCompleted":return i.jsxs("div",{className:"flex items-center gap-1",title:"Doctor completed",children:[i.jsx(Ui,{size:16,className:"text-green-500"}),i.jsx(Kr,{size:16,className:"text-yellow-500"})]});case"NurseCompleted":return i.jsxs("div",{className:"flex items-center gap-1",title:"Nurse completed",children:[i.jsx(Kr,{size:16,className:"text-yellow-500"}),i.jsx(ih,{size:16,className:"text-green-500"})]});default:return i.jsx(Kr,{size:18,className:"text-yellow-500"})}};return i.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 space-y-4",children:[i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center font-bold text-black bg-gray-100 border-2 border-gray-300",children:i.jsx(xg,{size:20})}),i.jsxs("div",{children:[i.jsx("h3",{className:"font-bold text-gray-800",children:e.nameAr}),i.jsxs("p",{className:"text-xs text-gray-500",children:[e.nationalId," | ",e.areaId]})]})]}),i.jsxs("div",{className:"flex items-center gap-2 text-xs font-semibold text-gray-600",children:[_(),i.jsx("span",{children:n.status})]})]}),l&&f?i.jsx(f,{initialData:b,onSave:E,onCancel:()=>d(!1)}):i.jsx(r4,{visit:n}),i.jsxs("div",{className:"border-t pt-3 flex justify-end items-center gap-2",children:[n.status==="Completed"&&i.jsxs("button",{onClick:()=>D(i.jsx(t4,{visit:n,patient:e})),className:"text-xs px-3 py-1 rounded-md text-gray-600 bg-gray-100 hover:bg-gray-200 flex items-center gap-1",children:[i.jsx(Pi,{size:14})," Print DN/RN"]}),n.ptNote&&i.jsxs("button",{onClick:()=>D(i.jsx(s4,{visit:n,patient:e})),className:"text-xs px-3 py-1 rounded-md text-gray-600 bg-gray-100 hover:bg-gray-200 flex items-center gap-1",children:[i.jsx(Pi,{size:14})," Print PT"]}),n.swNote&&i.jsxs("button",{onClick:()=>D(i.jsx(n4,{visit:n,patient:e})),className:"text-xs px-3 py-1 rounded-md text-gray-600 bg-gray-100 hover:bg-gray-200 flex items-center gap-1",children:[i.jsx(Pi,{size:14})," Print SW"]}),f&&!l&&i.jsxs("button",{onClick:()=>d(!0),className:"text-xs px-3 py-1 rounded-md text-blue-600 bg-blue-50 hover:bg-blue-100 flex items-center gap-1 flex-shrink-0",children:[i.jsx(Vv,{size:14})," ",v?"Edit Note":"Add Note"]})]})]})},a4=()=>{const{state:n}=os(),e=new Date().toISOString().split("T")[0],s=n.visits.filter(a=>a.date===e);return i.jsxs("div",{className:"max-w-4xl mx-auto",children:[i.jsxs("h1",{className:"text-2xl font-bold mb-4",children:["Visits for ",e]}),n.teams.map(a=>{const l=s.filter(d=>d.teamId===a.id);return l.length===0?null:i.jsxs("div",{className:"mb-8",children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-700 mb-3 border-b pb-2",children:a.name}),i.jsx("div",{className:"space-y-4",children:l.map(d=>i.jsx(i4,{visit:d,patient:n.patients.find(h=>h.nationalId===d.patientId)},d.patientId))})]},a.id)}),s.length===0&&i.jsx("div",{className:"text-center py-10 text-gray-500",children:i.jsx("p",{children:"No visits scheduled for today."})})]})},o4=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],l4=()=>{const{state:n,dispatch:e}=os(),[s,a]=Pe.useState(new Date),[l,d]=Pe.useState("month"),[h,f]=Pe.useState(null),[b,v]=Pe.useState(null),[E,D]=Pe.useState(!1),[_,R]=Pe.useState([]),U=new Date(s.getFullYear(),s.getMonth(),1),ie=new Date(s.getFullYear(),s.getMonth()+1,0),he=new Date(U);he.setDate(he.getDate()-U.getDay());const Se=new Date(ie);Se.setDate(Se.getDate()+(6-ie.getDay()));const Be=V=>{a(new Date(s.getFullYear(),s.getMonth()+V,1))},xe=[];let _e=new Date(he);for(;_e<=Se;)xe.push(new Date(_e)),_e.setDate(_e.getDate()+1);const Ne=n.visits.reduce((V,L)=>((V[L.date]=V[L.date]||[]).push(L),V),{}),De=()=>{h&&(window.confirm("Are you sure you want to cancel this visit?")&&e({type:"CANCEL_VISIT",payload:{patientId:h.visit.patientId,date:h.visit.date}}),f(null))},G=(V,L)=>{V.stopPropagation(),f({x:V.clientX,y:V.clientY,visit:L})};return Pe.useEffect(()=>{const V=()=>f(null);return window.addEventListener("click",V),()=>window.removeEventListener("click",V)},[]),i.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border-2 border-gray-200 overflow-hidden",children:[i.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 text-white p-4 md:p-6",children:[i.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(rr,{size:24,className:"text-blue-200"}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-xl md:text-2xl font-bold",children:s.toLocaleString("default",{month:"long",year:"numeric"})}),i.jsx("p",{className:"text-blue-200 text-sm",children:"Schedule & Appointments"})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("button",{onClick:()=>D(!0),className:"flex items-center gap-2 px-4 py-2 bg-green-500 text-white rounded-xl hover:bg-green-600 transition-all duration-200 shadow-sm",title:"   | Bulk Schedule",children:[i.jsx(Ir,{size:16}),i.jsx("span",{className:"hidden md:inline",children:" "})]}),i.jsx("div",{className:"flex bg-white/20 rounded-xl p-1",children:["month","week","day"].map(V=>i.jsx("button",{onClick:()=>d(V),className:`px-3 py-2 text-sm font-medium rounded-lg transition-all duration-200 touch-target-44 ${l===V?"bg-white text-blue-700 shadow-md":"text-white hover:bg-white/30"}`,children:V.charAt(0).toUpperCase()+V.slice(1)},V))})]})]}),i.jsxs("div",{className:"flex items-center justify-between mt-4",children:[i.jsx("button",{onClick:()=>Be(-1),className:"p-2 md:p-3 rounded-xl hover:bg-white/20 transition-colors touch-target-44",children:i.jsx(ES,{size:20})}),i.jsx("button",{onClick:()=>a(new Date),className:"px-4 py-2 bg-white/20 rounded-xl text-sm font-medium hover:bg-white/30 transition-colors",children:"Today"}),i.jsx("button",{onClick:()=>Be(1),className:"p-2 md:p-3 rounded-xl hover:bg-white/20 transition-colors touch-target-44",children:i.jsx(Rc,{size:20})})]})]}),i.jsxs("div",{className:"p-4 md:p-6",children:[l==="month"&&i.jsxs("div",{className:"grid grid-cols-7 gap-1 md:gap-2",children:[o4.map(V=>i.jsx("div",{className:"text-center text-sm md:text-base font-bold text-gray-700 py-3 bg-gray-50 rounded-lg",children:V},V)),xe.map((V,L)=>{const z=V.toISOString().split("T")[0],Q=Ne[z]||[],Y=new Date().toISOString().split("T")[0]===z,J=V.getMonth()===s.getMonth();return i.jsxs("div",{className:`border-2 border-gray-200 rounded-xl h-32 md:h-36 p-2 flex flex-col transition-all duration-200 hover:shadow-md cursor-pointer ${J?"bg-white":"bg-gray-50"} ${Y?"ring-2 ring-blue-500 bg-blue-50":""}`,onClick:()=>v(V),children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("span",{className:`text-sm md:text-base font-bold ${Y?"bg-blue-600 text-white rounded-full w-6 h-6 md:w-8 md:h-8 flex items-center justify-center":J?"text-gray-800":"text-gray-400"}`,children:V.getDate()}),Q.length>0&&i.jsx("span",{className:"bg-red-500 text-white text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center",children:Q.length})]}),i.jsxs("div",{className:"flex-1 space-y-1 overflow-y-auto",children:[Q.slice(0,3).map(pt=>{const Ct=n.patients.find(Ue=>Ue.nationalId===pt.patientId),Ae=n.teams.find(Ue=>Ue.id===pt.teamId);return Ct?i.jsx("div",{onClick:Ue=>{Ue.stopPropagation(),G(Ue,pt)},className:`rounded-lg px-2 py-1 text-xs font-medium truncate cursor-pointer transition-colors ${pt.status==="Completed"?"bg-green-100 text-green-800 hover:bg-green-200":pt.status==="DoctorCompleted"||pt.status==="NurseCompleted"?"bg-yellow-100 text-yellow-800 hover:bg-yellow-200":"bg-blue-100 text-blue-800 hover:bg-blue-200"}`,title:`${Ct.nameAr} - ${Ae==null?void 0:Ae.name} (${pt.status})`,children:i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(ah,{size:10}),i.jsx("span",{children:Ct.nameAr})]})},pt.patientId):null}),Q.length>3&&i.jsxs("div",{className:"text-xs text-gray-500 text-center py-1",children:["+",Q.length-3," more"]})]})]},L)})]}),i.jsx("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-4 gap-4",children:[{label:"Total Visits",value:n.visits.length,color:"blue"},{label:"Completed",value:n.visits.filter(V=>V.status==="Completed").length,color:"green"},{label:"In Progress",value:n.visits.filter(V=>V.status==="DoctorCompleted"||V.status==="NurseCompleted").length,color:"yellow"},{label:"Scheduled",value:n.visits.filter(V=>V.status==="Scheduled").length,color:"gray"}].map(V=>i.jsxs("div",{className:`bg-${V.color}-50 border-2 border-${V.color}-200 rounded-xl p-4 text-center`,children:[i.jsx("div",{className:`text-2xl md:text-3xl font-bold text-${V.color}-600`,children:V.value}),i.jsx("div",{className:`text-sm text-${V.color}-700 font-medium`,children:V.label})]},V.label))})]}),h&&i.jsx("div",{className:"fixed z-50 bg-white rounded-xl shadow-2xl border-2 border-gray-200 p-4 min-w-64 animate-fade-in",style:{top:Math.min(h.y+10,window.innerHeight-200),left:Math.min(h.x,window.innerWidth-280)},onClick:V=>V.stopPropagation(),children:(()=>{const V=n.patients.find(z=>z.nationalId===h.visit.patientId),L=n.teams.find(z=>z.id===h.visit.teamId);return i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center justify-between mb-3 pb-2 border-b border-gray-200",children:[i.jsx("h3",{className:"font-bold text-gray-800",children:"Visit Details"}),i.jsx("button",{onClick:()=>f(null),className:"p-1 hover:bg-gray-100 rounded-lg",children:i.jsx(xn,{size:16})})]}),i.jsxs("div",{className:"space-y-2 text-sm",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Patient:"})," ",(V==null?void 0:V.nameAr)||"Unknown"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Team:"})," ",(L==null?void 0:L.name)||"Unknown"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Date:"})," ",new Date(h.visit.date).toLocaleDateString()]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Status:"}),i.jsx("span",{className:`ml-1 px-2 py-1 rounded-full text-xs font-medium ${h.visit.status==="Completed"?"bg-green-100 text-green-800":h.visit.status==="DoctorCompleted"||h.visit.status==="NurseCompleted"?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"}`,children:h.visit.status})]})]}),i.jsxs("div",{className:"flex gap-2 mt-4",children:[i.jsxs("button",{onClick:()=>{e({type:"MARK_VISIT_COMPLETED",payload:{patientId:h.visit.patientId,date:h.visit.date}}),f(null)},className:"flex-1 bg-green-500 text-white px-3 py-2 rounded-lg hover:bg-green-600 transition-colors flex items-center justify-center gap-2 text-sm font-medium",disabled:h.visit.status==="Completed",children:[i.jsx(Vv,{size:14}),h.visit.status==="Completed"?"":" "]}),i.jsxs("button",{onClick:De,className:"flex-1 bg-red-500 text-white px-3 py-2 rounded-lg hover:bg-red-600 transition-colors flex items-center justify-center gap-2 text-sm font-medium",children:[i.jsx(xn,{size:14})," "]})]})]})})()})]})},c4=({visits:n,patients:e,date:s})=>{const a=n.reduce((d,h)=>{const f=e.find(b=>b.nationalId===h.patientId);return f&&f.areaId&&(d[f.areaId]=d[f.areaId]||[]).push(h),d},{}),l=Object.keys(a).sort();return i.jsxs("div",{className:"p-8 font-sans text-sm",style:{width:"210mm",minHeight:"297mm"},dir:"rtl",children:[i.jsxs("header",{className:"flex items-center justify-between pb-4 border-b",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"  "}),i.jsx("p",{className:"text-lg text-gray-600",children:"       "}),"\\n                    ",i.jsx("p",{className:"text-sm text-gray-500",children:"  "})]}),i.jsx("div",{className:"text-right text-xs text-gray-500",children:i.jsxs("p",{children:[i.jsx("strong",{children:":"})," ",new Date(s).toLocaleDateString()]})})]}),i.jsx("div",{className:"mt-6 space-y-6",children:l.map(d=>i.jsxs("div",{children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-700 mb-3 pb-2 border-b-2 border-gray-300",children:d}),i.jsx("div",{className:"space-y-4",children:a[d].map(h=>{const f=e.find(D=>D.nationalId===h.patientId);if(!f)return null;const b=`${f.areaId}, ${f.nameAr}`,v=`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(b)}`,E=`https://api.qrserver.com/v1/create-qr-code/?size=100x100&data=${encodeURIComponent(v)}`;return i.jsxs("div",{className:"p-3 border rounded-lg bg-gray-50/50 flex items-center justify-between gap-4 break-inside-avoid",children:[i.jsxs("div",{className:"flex-grow",children:[i.jsx("h3",{className:"font-bold text-lg text-gray-800",children:f.nameAr}),i.jsx("p",{className:"text-gray-600",children:f.areaId}),i.jsx("p",{className:"text-gray-600 font-mono",dir:"ltr",children:f.phone||"  "}),i.jsx("a",{href:v,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline text-xs",children:"   "})]}),i.jsx("div",{className:"flex-shrink-0",children:i.jsx("img",{src:E,alt:"QR Code",className:"w-20 h-20 rounded border"})})]},f.nationalId)})})]},d))})]})},u4=({visit:n,patient:e})=>{const s=`${e.areaId}, ${e.nameAr}`,a=`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(s)}`,l=`https://api.qrserver.com/v1/create-qr-code/?size=100x100&data=${encodeURIComponent(a)}`;return i.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 flex items-center justify-between",dir:"rtl",children:[i.jsxs("div",{className:"flex-grow",children:[i.jsx("h3",{className:"font-bold text-lg text-gray-800",children:e.nameAr}),i.jsxs("div",{className:"space-y-1 mt-2 text-sm text-gray-600",children:[i.jsxs("p",{className:"flex items-center gap-2",children:[i.jsx(Gc,{size:14}),i.jsx("span",{children:e.areaId})]}),i.jsxs("p",{className:"flex items-center gap-2",children:[i.jsx(Yr,{size:14}),i.jsx("span",{className:"font-mono",dir:"ltr",children:e.phone||" "})]})]})]}),i.jsxs("div",{className:"flex items-center gap-4 flex-shrink-0",children:[i.jsx("a",{href:a,target:"_blank",rel:"noopener noreferrer",className:"p-3 rounded-full bg-blue-100 text-blue-600 hover:bg-blue-200 transition-colors",title:"   ",children:i.jsx(Gc,{size:24})}),i.jsx("img",{src:l,alt:"QR Code",className:"w-24 h-24 rounded-md border"})]})]})},d4=()=>{const{state:n}=os(),e=new Date().toISOString().split("T")[0],s=n.visits.filter(h=>h.date===e),a=s.reduce((h,f)=>{const b=n.patients.find(v=>v.nationalId===f.patientId);return b&&b.areaId&&(h[b.areaId]=h[b.areaId]||[]).push(f),h},{}),l=Object.keys(a).sort(),d=()=>{const h=window.open("","_blank");if(h){h.document.write('<html><head><title>Driver Route</title><script src="https://cdn.tailwindcss.com"><\/script></head><body><div id="print-root"></div></body></html>'),h.document.close();const f=h.document.getElementById("print-root");f&&(bg.createRoot(f).render(i.jsx(c4,{visits:s,patients:n.patients,date:e})),setTimeout(()=>{h.print(),h.close()},500))}};return i.jsx("div",{className:"flex-1 overflow-y-auto p-4 md:p-6",dir:"rtl",children:i.jsxs("div",{className:"max-w-4xl mx-auto",children:[i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[i.jsxs("h1",{className:"text-2xl font-bold",children:["  - ",e]}),s.length>0&&i.jsxs("button",{onClick:d,className:"flex items-center gap-2 px-4 py-2 text-sm rounded-lg text-gray-700 bg-gray-200 hover:bg-gray-300",children:[i.jsx(Pi,{size:16}),"  "]})]}),l.length>0?i.jsx("div",{className:"space-y-6",children:l.map(h=>i.jsxs("div",{children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-700 mb-3 pb-2 border-b",children:h}),i.jsx("div",{className:"space-y-3",children:a[h].map(f=>{const b=n.patients.find(v=>v.nationalId===f.patientId);return b?i.jsx(u4,{visit:f,patient:b},f.patientId):null})})]},h))}):i.jsx("div",{className:"text-center py-16 text-gray-500",children:i.jsx("p",{className:"text-lg",children:"     ."})})]})})},h4=()=>{const{state:n}=os(),[e,s]=Pe.useState(!1),a=()=>K(null,null,function*(){s(!0),setTimeout(()=>{s(!1),window.location.reload()},1e3)});return i.jsxs("div",{className:"max-w-4xl mx-auto p-4 space-y-6",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[i.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:i.jsx(Ov,{size:24,className:"text-blue-600"})}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"System Settings"}),i.jsx("p",{className:"text-gray-600",children:"Home Healthcare Management System Configuration"})]})]}),i.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[i.jsxs("h2",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[i.jsx(_l,{size:20,className:"text-blue-600"}),"System Status"]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsxs("div",{className:"flex items-center gap-3 p-4 bg-green-50 rounded-lg border border-green-200",children:[i.jsx(mg,{size:20,className:"text-green-600"}),i.jsxs("div",{children:[i.jsx("p",{className:"font-medium text-green-800",children:"System Online"}),i.jsx("p",{className:"text-sm text-green-600",children:"All services running"})]})]}),i.jsxs("div",{className:"flex items-center gap-3 p-4 bg-blue-50 rounded-lg border border-blue-200",children:[i.jsx(Mx,{size:20,className:"text-blue-600"}),i.jsxs("div",{children:[i.jsx("p",{className:"font-medium text-blue-800",children:"Data Loaded"}),i.jsx("p",{className:"text-sm text-blue-600",children:"JSON Bundle Active"})]})]}),i.jsxs("div",{className:"flex items-center gap-3 p-4 bg-purple-50 rounded-lg border border-purple-200",children:[i.jsx(ah,{size:20,className:"text-purple-600"}),i.jsxs("div",{children:[i.jsx("p",{className:"font-medium text-purple-800",children:"User Session"}),i.jsx("p",{className:"text-sm text-purple-600",children:"Authenticated"})]})]})]})]}),i.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[i.jsxs("h2",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[i.jsx(yn,{size:20,className:"text-blue-600"}),"Data Statistics"]}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[i.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[i.jsx("div",{className:"text-2xl font-bold text-blue-600",children:n.patients.length}),i.jsx("div",{className:"text-sm text-gray-600",children:"Total Patients"})]}),i.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[i.jsx("div",{className:"text-2xl font-bold text-green-600",children:n.staff.length}),i.jsx("div",{className:"text-sm text-gray-600",children:"Staff Members"})]}),i.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[i.jsx("div",{className:"text-2xl font-bold text-purple-600",children:n.areas.length}),i.jsx("div",{className:"text-sm text-gray-600",children:"Coverage Areas"})]}),i.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[i.jsx("div",{className:"text-2xl font-bold text-orange-600",children:n.visits.length}),i.jsx("div",{className:"text-sm text-gray-600",children:"Scheduled Visits"})]})]})]}),i.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[i.jsxs("h2",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[i.jsx(Kr,{size:20,className:"text-blue-600"}),"System Actions"]}),i.jsxs("div",{className:"space-y-3",children:[i.jsx("button",{onClick:a,disabled:e,className:"w-full md:w-auto flex items-center justify-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors",children:e?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Refreshing..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Mx,{size:18}),"Refresh Data"]})}),i.jsx("p",{className:"text-sm text-gray-500",children:"Refresh the application to reload patient data and clear cache."})]})]}),i.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Organization Information"}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"font-medium text-gray-800",children:"       "}),i.jsx("p",{className:"text-sm text-gray-600",children:"Aseer Health Cluster  King Abdullah Hospital, Bishah"})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium text-gray-800",children:"  "}),i.jsx("p",{className:"text-sm text-gray-600",children:"Home Healthcare Department"})]}),i.jsx("div",{className:"pt-3 border-t border-gray-200",children:i.jsx("p",{className:"text-xs text-gray-500",children:"Home Healthcare Management System - Version 1.0"})})]})]})]})},Rv=()=>null,f4=({currentUser:n})=>{var f,b;const{state:e}=os(),[s,a]=Pe.useState("patients"),[l,d]=Pe.useState(!1);Pe.useEffect(()=>{n&&n.mappedRole==="Driver"&&a("driver")},[n]);const h=()=>K(null,null,function*(){try{yield Ta.signOut(),window.location.reload()}catch(v){console.error("Logout error:",v)}});return e.currentRole===rt.Driver?i.jsxs("div",{className:"flex h-screen bg-gradient-to-br from-blue-50 to-indigo-50 font-sans text-gray-800",dir:"ltr",children:[i.jsxs("main",{className:"flex-1 flex flex-col overflow-hidden",children:[i.jsx(Ev,{activeView:s,setActiveView:a}),i.jsx("div",{className:"flex-1 overflow-y-auto p-3 md:p-4 lg:p-6 mobile-spacing",children:i.jsx("div",{className:"animate-fade-in",children:i.jsx(d4,{})})})]}),i.jsx(Rv,{})]}):i.jsxs("div",{className:"flex h-screen bg-gradient-to-br from-blue-50 to-indigo-50 font-sans text-gray-800",dir:"ltr",children:[l&&i.jsxs("div",{className:"fixed inset-0 z-40 lg:hidden",children:[i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50",onClick:()=>d(!1)}),i.jsxs("div",{className:"fixed left-0 top-0 bottom-0 w-80 bg-white shadow-xl z-50",children:[i.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[i.jsx("h2",{className:"text-lg font-bold text-gray-800",children:"Filters & Search"}),i.jsx("button",{onClick:()=>d(!1),className:"p-2 hover:bg-gray-100 rounded-lg",children:i.jsx(xn,{size:20})})]}),i.jsx("div",{className:"h-full overflow-hidden",children:i.jsx(jv,{})})]})]}),i.jsx("div",{className:"hidden lg:block",children:i.jsx(jv,{})}),i.jsxs("main",{className:"flex-1 flex flex-col overflow-hidden",children:[i.jsx(Ev,{activeView:s,setActiveView:a}),i.jsxs("div",{className:"bg-white border-b border-gray-200 px-4 py-2 flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs("button",{onClick:()=>d(!0),className:"lg:hidden flex items-center gap-2 px-3 py-1.5 bg-blue-600 text-white rounded-lg font-medium text-sm",children:[i.jsx(jS,{size:16}),"Filters"]}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:i.jsx("span",{className:"text-blue-600 font-bold text-sm",children:((b=(f=n==null?void 0:n.name)==null?void 0:f.split(" ")[0])==null?void 0:b.charAt(0))||"U"})}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-800",children:n==null?void 0:n.name}),i.jsxs("p",{className:"text-xs text-gray-500",children:[n==null?void 0:n.role," - ",e.currentRole]})]})]})]}),i.jsx("button",{onClick:h,className:"px-3 py-1.5 text-sm text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:" "})]}),i.jsx("div",{className:"flex-1 overflow-y-auto p-3 md:p-4 lg:p-6 mobile-spacing",children:i.jsxs("div",{className:"animate-fade-in",children:[s==="patients"&&i.jsx(T1,{}),s==="visits"&&i.jsx(a4,{}),s==="scheduler"&&i.jsx(l4,{}),s==="settings"&&i.jsx(h4,{})]})})]}),i.jsx(Rv,{})]})},m4=()=>{const[n,e]=Pe.useState(null),[s,a]=Pe.useState(!1),[l,d]=Pe.useState(!0);Pe.useEffect(()=>{const f=Ta.getCurrentUser();f?(e(f),a(!0)):Ta.signIn("salshahrani173@moh.gov.sa","12345").then(b=>{b.success&&(e(b.user),a(!0))}).catch(console.error),d(!1)},[]);const h=f=>{e(f),a(!0)};return l?i.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-600 to-indigo-800 flex items-center justify-center",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"w-16 h-16 border-4 border-white border-t-transparent rounded-full animate-spin mb-4 mx-auto"}),i.jsx("p",{className:"text-white text-lg font-medium",children:"  ..."})]})}):s?i.jsx(JS,{children:i.jsx(f4,{currentUser:n})}):i.jsx(ER,{onLoginSuccess:h})};class g4 extends Pe.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,s){console.error(" React Error Boundary caught an error:",e),console.error("Error Info:",s),this.setState({error:e,errorInfo:s})}render(){var e,s;return this.state.hasError?i.jsxs("div",{style:{padding:"20px",backgroundColor:"#fee2e2",border:"1px solid #ef4444",borderRadius:"8px",margin:"20px",fontFamily:"Arial, sans-serif"},children:[i.jsx("h2",{style:{color:"#dc2626",marginBottom:"16px"},children:" Application Error"}),i.jsxs("details",{style:{marginBottom:"16px"},children:[i.jsx("summary",{style:{cursor:"pointer",fontWeight:"bold"},children:"Error Details"}),i.jsx("pre",{style:{backgroundColor:"#f3f4f6",padding:"12px",borderRadius:"4px",fontSize:"12px",overflow:"auto",marginTop:"8px"},children:(e=this.state.error)==null?void 0:e.toString()})]}),i.jsxs("details",{children:[i.jsx("summary",{style:{cursor:"pointer",fontWeight:"bold"},children:"Component Stack"}),i.jsx("pre",{style:{backgroundColor:"#f3f4f6",padding:"12px",borderRadius:"4px",fontSize:"12px",overflow:"auto",marginTop:"8px"},children:(s=this.state.errorInfo)==null?void 0:s.componentStack})]}),i.jsx("button",{onClick:()=>window.location.reload(),style:{backgroundColor:"#2563eb",color:"white",padding:"8px 16px",border:"none",borderRadius:"4px",cursor:"pointer",marginTop:"16px"},children:"Reload Page"})]}):this.props.children}}const A1=document.getElementById("root");if(!A1)throw new Error("Could not find root element to mount to");const p4=LS.createRoot(A1);p4.render(i.jsx(TS.StrictMode,{children:i.jsx(g4,{children:i.jsx(m4,{})})}))});export default y4();
